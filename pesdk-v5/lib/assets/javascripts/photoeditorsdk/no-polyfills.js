var PhotoEditorSDK=(()=>{var wh=Object.defineProperty,Fw=Object.prototype.hasOwnProperty,Pw=Object.getOwnPropertySymbols,nM=Object.getOwnPropertyDescriptor,sM=Object.prototype.propertyIsEnumerable,y=Object.assign,Jt=(e,t)=>{var i={};for(var r in e)Fw.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&Pw)for(var r of Pw(e))t.indexOf(r)<0&&sM.call(e,r)&&(i[r]=e[r]);return i},at=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),Bw=e=>wh(e,"__esModule",{value:!0}),ut=(e,t)=>{Bw(e);for(var i in t)wh(e,i,{get:t[i],enumerable:!0})},aM=(e,t)=>{if(Bw(e),typeof t=="object"||typeof t=="function")for(let i in t)!Fw.call(e,i)&&i!=="default"&&wh(e,i,{get:()=>t[i],enumerable:!0});return e},v=e=>e&&e.__esModule?e:aM(wh({},"default",{value:e,enumerable:!0}),e),u=(e,t,i,r)=>{for(var o=r>1?void 0:r?nM(t,i):t,n=e.length-1,s;n>=0;n--)(s=e[n])&&(o=(r?s(t,i,o):s(o))||o);return r&&o&&wh(t,i,o),o},Z=(e,t,i)=>new Promise((r,o)=>{var n=l=>{try{a(i.next(l))}catch(d){o(d)}},s=l=>{try{a(i.throw(l))}catch(d){o(d)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(n,s);a((i=i.apply(e,t)).next())});var Sh=at((Mw,Ch)=>{(function(){var e,t,i,r,o,n;typeof performance!="undefined"&&performance!==null&&performance.now?Ch.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(Ch.exports=function(){return(e()-o)/1e6},t=process.hrtime,e=function(){var s;return s=t(),s[0]*1e9+s[1]},r=e(),n=process.uptime()*1e9,o=r-n):Date.now?(Ch.exports=function(){return Date.now()-i},i=Date.now()):(Ch.exports=function(){return new Date().getTime()-i},i=new Date().getTime())}).call(Mw)});var Lw=at((AV,Kb)=>{var Th=function(){function e(c){return r.appendChild(c.dom),c}function t(c){for(var p=0;p<r.children.length;p++)r.children[p].style.display=p===c?"block":"none";i=c}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(c){c.preventDefault(),t(++i%r.children.length)},!1);var o=(performance||Date).now(),n=o,s=0,a=e(new Th.Panel("FPS","#0ff","#002")),l=e(new Th.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=e(new Th.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){s++;var c=(performance||Date).now();if(l.update(c-o,200),c>n+1e3&&(a.update(1e3*s/(c-n),100),n=c,s=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return c},update:function(){o=this.end()},domElement:r,setMode:t}};Th.Panel=function(e,t,i){var r=Infinity,o=0,n=Math.round,s=n(window.devicePixelRatio||1),a=80*s,l=48*s,d=3*s,c=2*s,p=3*s,h=15*s,m=74*s,b=30*s,_=document.createElement("canvas");_.width=a,_.height=l,_.style.cssText="width:80px;height:48px";var g=_.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,d,c),g.fillRect(p,h,m,b),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(p,h,m,b),{dom:_,update:function(S,x){r=Math.min(r,S),o=Math.max(o,S),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,a,h),g.fillStyle=t,g.fillText(n(S)+" "+e+" ("+n(r)+"-"+n(o)+")",d,c),g.drawImage(_,p+s,h,m-s,b,p,h,m-s,b),g.fillRect(p+m-s,h,s,b),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(p+m-s,h,s,n((1-S/x)*b))}}};typeof Kb=="object"&&(Kb.exports=Th)});var zw=at((od,nd)=>{(function(e){var t=typeof od=="object"&&od&&!od.nodeType&&od,i=typeof nd=="object"&&nd&&!nd.nodeType&&nd,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(e=r);var o,n=2147483647,s=36,a=1,l=26,d=38,c=700,p=72,h=128,m="-",b=/^xn--/,_=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=s-a,C=Math.floor,R=String.fromCharCode,T;function k(V){throw RangeError(S[V])}function M(V,Q){for(var ne=V.length,Fe=[];ne--;)Fe[ne]=Q(V[ne]);return Fe}function U(V,Q){var ne=V.split("@"),Fe="";ne.length>1&&(Fe=ne[0]+"@",V=ne[1]),V=V.replace(g,".");var K=V.split("."),Y=M(K,Q).join(".");return Fe+Y}function L(V){for(var Q=[],ne=0,Fe=V.length,K,Y;ne<Fe;)K=V.charCodeAt(ne++),K>=55296&&K<=56319&&ne<Fe?(Y=V.charCodeAt(ne++),(Y&64512)==56320?Q.push(((K&1023)<<10)+(Y&1023)+65536):(Q.push(K),ne--)):Q.push(K);return Q}function ee(V){return M(V,function(Q){var ne="";return Q>65535&&(Q-=65536,ne+=R(Q>>>10&1023|55296),Q=56320|Q&1023),ne+=R(Q),ne}).join("")}function de(V){return V-48<10?V-22:V-65<26?V-65:V-97<26?V-97:s}function ge(V,Q){return V+22+75*(V<26)-((Q!=0)<<5)}function xe(V,Q,ne){var Fe=0;for(V=ne?C(V/c):V>>1,V+=C(V/Q);V>x*l>>1;Fe+=s)V=C(V/x);return C(Fe+(x+1)*V/(V+d))}function Oe(V){var Q=[],ne=V.length,Fe,K=0,Y=h,ie=p,rt,st,sr,An,Ei,jr,fo,Ds,Va;for(rt=V.lastIndexOf(m),rt<0&&(rt=0),st=0;st<rt;++st)V.charCodeAt(st)>=128&&k("not-basic"),Q.push(V.charCodeAt(st));for(sr=rt>0?rt+1:0;sr<ne;){for(An=K,Ei=1,jr=s;!(sr>=ne&&k("invalid-input"),fo=de(V.charCodeAt(sr++)),(fo>=s||fo>C((n-K)/Ei))&&k("overflow"),K+=fo*Ei,Ds=jr<=ie?a:jr>=ie+l?l:jr-ie,fo<Ds);jr+=s)Va=s-Ds,Ei>C(n/Va)&&k("overflow"),Ei*=Va;Fe=Q.length+1,ie=xe(K-An,Fe,An==0),C(K/Fe)>n-Y&&k("overflow"),Y+=C(K/Fe),K%=Fe,Q.splice(K++,0,Y)}return ee(Q)}function ft(V){var Q,ne,Fe,K,Y,ie,rt,st,sr,An,Ei,jr=[],fo,Ds,Va,Vb;for(V=L(V),fo=V.length,Q=h,ne=0,Y=p,ie=0;ie<fo;++ie)Ei=V[ie],Ei<128&&jr.push(R(Ei));for(Fe=K=jr.length,K&&jr.push(m);Fe<fo;){for(rt=n,ie=0;ie<fo;++ie)Ei=V[ie],Ei>=Q&&Ei<rt&&(rt=Ei);for(Ds=Fe+1,rt-Q>C((n-ne)/Ds)&&k("overflow"),ne+=(rt-Q)*Ds,Q=rt,ie=0;ie<fo;++ie)if(Ei=V[ie],Ei<Q&&++ne>n&&k("overflow"),Ei==Q){for(st=ne,sr=s;!(An=sr<=Y?a:sr>=Y+l?l:sr-Y,st<An);sr+=s)Vb=st-An,Va=s-An,jr.push(R(ge(An+Vb%Va,0))),st=C(Vb/Va);jr.push(R(ge(st,0))),Y=xe(ne,Ds,Fe==K),ne=0,++Fe}++ne,++Q}return jr.join("")}function kt(V){return U(V,function(Q){return b.test(Q)?Oe(Q.slice(4).toLowerCase()):Q})}function Ae(V){return U(V,function(Q){return _.test(Q)?"xn--"+ft(Q):Q})}if(o={version:"1.3.2",ucs2:{decode:L,encode:ee},decode:Oe,encode:ft,toASCII:Ae,toUnicode:kt},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return o});else if(t&&i)if(nd.exports==t)i.exports=o;else for(T in o)o.hasOwnProperty(T)&&(t[T]=o[T]);else e.punycode=o})(od)});var Uw=at((FV,Nw)=>{"use strict";Nw.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}});var Gw=at((PV,Hw)=>{"use strict";function lM(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Hw.exports=function(e,t,i,r){t=t||"&",i=i||"=";var o={};if(typeof e!="string"||e.length===0)return o;var n=/\+/g;e=e.split(t);var s=1e3;r&&typeof r.maxKeys=="number"&&(s=r.maxKeys);var a=e.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var d=e[l].replace(n,"%20"),c=d.indexOf(i),p,h,m,b;c>=0?(p=d.substr(0,c),h=d.substr(c+1)):(p=d,h=""),m=decodeURIComponent(p),b=decodeURIComponent(h),lM(o,m)?Array.isArray(o[m])?o[m].push(b):o[m]=[o[m],b]:o[m]=b}return o}});var Ww=at((BV,jw)=>{"use strict";var kh=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};jw.exports=function(e,t,i,r){return t=t||"&",i=i||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(o){var n=encodeURIComponent(kh(o))+i;return Array.isArray(e[o])?e[o].map(function(s){return n+encodeURIComponent(kh(s))}).join(t):n+encodeURIComponent(kh(e[o]))}).join(t):r?encodeURIComponent(kh(r))+i+encodeURIComponent(kh(e)):""}});var Vw=at(Eh=>{"use strict";Eh.decode=Eh.parse=Gw();Eh.encode=Eh.stringify=Ww()});var Xw=at(sd=>{"use strict";var dM=zw(),Zo=Uw();sd.parse=Dh;sd.resolve=cM;sd.resolveObject=hM;sd.format=pM;sd.Url=Wr;function Wr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var uM=/^([a-z0-9.+-]+:)/i,mM=/:[0-9]*$/,fM=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,gM=["<",">",'"',"`"," ","\r",`
`,"	"],bM=["{","}","|","\\","^","`"].concat(gM),$b=["'"].concat(bM),Kw=["%","/","?",";","#"].concat($b),$w=["/","?","#"],yM=255,qw=/^[+a-z0-9A-Z_-]{0,63}$/,vM=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_M={javascript:!0,"javascript:":!0},qb={javascript:!0,"javascript:":!0},ad={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Xb=Vw();function Dh(e,t,i){if(e&&Zo.isObject(e)&&e instanceof Wr)return e;var r=new Wr;return r.parse(e,t,i),r}Wr.prototype.parse=function(e,t,i){if(!Zo.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=r!==-1&&r<e.indexOf("#")?"?":"#",n=e.split(o),s=/\\/g;n[0]=n[0].replace(s,"/"),e=n.join(o);var a=e;if(a=a.trim(),!i&&e.split("#").length===1){var l=fM.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=Xb.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var d=uM.exec(a);if(d){d=d[0];var c=d.toLowerCase();this.protocol=c,a=a.substr(d.length)}if(i||d||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var p=a.substr(0,2)==="//";p&&!(d&&qb[d])&&(a=a.substr(2),this.slashes=!0)}if(!qb[d]&&(p||d&&!ad[d])){for(var h=-1,m=0;m<$w.length;m++){var b=a.indexOf($w[m]);b!==-1&&(h===-1||b<h)&&(h=b)}var _,g;h===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",h),g!==-1&&(_=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(_)),h=-1;for(var m=0;m<Kw.length;m++){var b=a.indexOf(Kw[m]);b!==-1&&(h===-1||b<h)&&(h=b)}h===-1&&(h=a.length),this.host=a.slice(0,h),a=a.slice(h),this.parseHost(),this.hostname=this.hostname||"";var S=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!S)for(var x=this.hostname.split(/\./),m=0,C=x.length;m<C;m++){var R=x[m];if(!R)continue;if(!R.match(qw)){for(var T="",k=0,M=R.length;k<M;k++)R.charCodeAt(k)>127?T+="x":T+=R[k];if(!T.match(qw)){var U=x.slice(0,m),L=x.slice(m+1),ee=R.match(vM);ee&&(U.push(ee[1]),L.unshift(ee[2])),L.length&&(a="/"+L.join(".")+a),this.hostname=U.join(".");break}}}this.hostname.length>yM?this.hostname="":this.hostname=this.hostname.toLowerCase(),S||(this.hostname=dM.toASCII(this.hostname));var de=this.port?":"+this.port:"",ge=this.hostname||"";this.host=ge+de,this.href+=this.host,S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!_M[c])for(var m=0,C=$b.length;m<C;m++){var xe=$b[m];if(a.indexOf(xe)===-1)continue;var Oe=encodeURIComponent(xe);Oe===xe&&(Oe=escape(xe)),a=a.split(xe).join(Oe)}var ft=a.indexOf("#");ft!==-1&&(this.hash=a.substr(ft),a=a.slice(0,ft));var kt=a.indexOf("?");if(kt!==-1?(this.search=a.substr(kt),this.query=a.substr(kt+1),t&&(this.query=Xb.parse(this.query)),a=a.slice(0,kt)):t&&(this.search="",this.query={}),a&&(this.pathname=a),ad[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var de=this.pathname||"",Ae=this.search||"";this.path=de+Ae}return this.href=this.format(),this};function pM(e){return Zo.isString(e)&&(e=Dh(e)),e instanceof Wr?e.format():Wr.prototype.format.call(e)}Wr.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",r=this.hash||"",o=!1,n="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&Zo.isObject(this.query)&&Object.keys(this.query).length&&(n=Xb.stringify(this.query));var s=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||ad[t])&&o!==!1?(o="//"+(o||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):o||(o=""),r&&r.charAt(0)!=="#"&&(r="#"+r),s&&s.charAt(0)!=="?"&&(s="?"+s),i=i.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),s=s.replace("#","%23"),t+o+i+s+r};function cM(e,t){return Dh(e,!1,!0).resolve(t)}Wr.prototype.resolve=function(e){return this.resolveObject(Dh(e,!1,!0)).format()};function hM(e,t){return e?Dh(e,!1,!0).resolveObject(t):t}Wr.prototype.resolveObject=function(e){if(Zo.isString(e)){var t=new Wr;t.parse(e,!1,!0),e=t}for(var i=new Wr,r=Object.keys(this),o=0;o<r.length;o++){var n=r[o];i[n]=this[n]}if(i.hash=e.hash,e.href==="")return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),a=0;a<s.length;a++){var l=s[a];l!=="protocol"&&(i[l]=e[l])}return ad[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!ad[e.protocol]){for(var d=Object.keys(e),c=0;c<d.length;c++){var p=d[c];i[p]=e[p]}return i.href=i.format(),i}if(i.protocol=e.protocol,!e.host&&!qb[e.protocol]){for(var C=(e.pathname||"").split("/");C.length&&!(e.host=C.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),C[0]!==""&&C.unshift(""),C.length<2&&C.unshift(""),i.pathname=C.join("/")}else i.pathname=e.pathname;if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var h=i.pathname||"",m=i.search||"";i.path=h+m}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var b=i.pathname&&i.pathname.charAt(0)==="/",_=e.host||e.pathname&&e.pathname.charAt(0)==="/",g=_||b||i.host&&e.pathname,S=g,x=i.pathname&&i.pathname.split("/")||[],C=e.pathname&&e.pathname.split("/")||[],R=i.protocol&&!ad[i.protocol];if(R&&(i.hostname="",i.port=null,i.host&&(x[0]===""?x[0]=i.host:x.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(C[0]===""?C[0]=e.host:C.unshift(e.host)),e.host=null),g=g&&(C[0]===""||x[0]==="")),_)i.host=e.host||e.host===""?e.host:i.host,i.hostname=e.hostname||e.hostname===""?e.hostname:i.hostname,i.search=e.search,i.query=e.query,x=C;else if(C.length)x||(x=[]),x.pop(),x=x.concat(C),i.search=e.search,i.query=e.query;else if(!Zo.isNullOrUndefined(e.search)){if(R){i.hostname=i.host=x.shift();var T=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;T&&(i.auth=T.shift(),i.host=i.hostname=T.shift())}return i.search=e.search,i.query=e.query,(!Zo.isNull(i.pathname)||!Zo.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!x.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var k=x.slice(-1)[0],M=(i.host||e.host||x.length>1)&&(k==="."||k==="..")||k==="",U=0,L=x.length;L>=0;L--)k=x[L],k==="."?x.splice(L,1):k===".."?(x.splice(L,1),U++):U&&(x.splice(L,1),U--);if(!g&&!S)for(;U--;U)x.unshift("..");g&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),M&&x.join("/").substr(-1)!=="/"&&x.push("");var ee=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(R){i.hostname=i.host=ee?"":x.length?x.shift():"";var T=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;T&&(i.auth=T.shift(),i.host=i.hostname=T.shift())}return g=g||i.host&&x.length,g&&!ee&&x.unshift(""),x.length?i.pathname=x.join("/"):(i.pathname=null,i.path=null),(!Zo.isNull(i.pathname)||!Zo.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i};Wr.prototype.parseHost=function(){var e=this.host,t=mM.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}});var Yw=at(xM=>{ut(xM,{default:()=>Yb});class Yb{constructor(e){this._editor=e}serialize(...e){const t=new ld(this._editor);return t.serialize(...e)}deserialize(e){const t=new dd(this._editor,e);return t.deserialize()}}Yb.version="1.0.0"});var Jw=at(wM=>{ut(wM,{default:()=>Jb});class Jb{constructor(e){this._editor=e}serialize(...e){const t=new cd(this._editor);return t.serialize(...e)}deserialize(e){const t=new hd(this._editor,e);return t.deserialize()}}Jb.version="1.0.1"});var Zw=at(CM=>{ut(CM,{default:()=>Zb});class Zb{constructor(e){this._editor=e}serialize(...e){const t=new pd(this._editor);return t.serialize(...e)}deserialize(e){const t=new ud(this._editor,e);return t.deserialize()}}Zb.version="2.0.0"});var Qw=at(SM=>{ut(SM,{default:()=>Qb});class Qb{constructor(e){this._editor=e}serialize(...e){const t=new md(this._editor);return t.serialize(...e)}deserialize(e){const t=new fd(this._editor,e);return t.deserialize()}}Qb.version="3.0.0"});var e0=at(TM=>{ut(TM,{default:()=>ey});class ey{constructor(e){this._editor=e}serialize(...e){const t=new gd(this._editor);return t.serialize(...e)}deserialize(e){const t=new bd(this._editor,e);return t.deserialize()}}ey.version="3.1.0"});var t0=at(kM=>{ut(kM,{default:()=>ty});class ty{constructor(e){this._editor=e}serialize(...e){const t=new yd(this._editor);return t.serialize(...e)}deserialize(e){const t=new vd(this._editor,e);return t.deserialize()}}ty.version="3.2.0"});var i0=at(EM=>{ut(EM,{default:()=>iy});class iy{constructor(e){this._editor=e}serialize(...e){const t=new _d(this._editor);return t.serialize(...e)}deserialize(e){const t=new xd(this._editor,e);return t.deserialize()}}iy.version="3.4.0"});var r0=at(DM=>{ut(DM,{default:()=>ry});class ry{constructor(e){this._editor=e}serialize(...e){const t=new wd(this._editor);return t.serialize(...e)}deserialize(e){const t=new Cd(this._editor,e);return t.deserialize()}}ry.version="3.5.0"});var o0=at(IM=>{ut(IM,{default:()=>oy});class oy{constructor(e){this._editor=e}serialize(...e){const t=new Sd(this._editor);return t.serialize(...e)}deserialize(e){const t=new Td(this._editor,e);return t.deserialize()}}oy.version="3.6.0"});var n0=at(OM=>{ut(OM,{default:()=>ny});class ny{constructor(e){this._editor=e}serialize(...e){const t=new kd(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ed(this._editor,e);return t.deserialize()}}ny.version="3.7.0"});var s0=at(RM=>{ut(RM,{default:()=>sy});class sy{constructor(e){this._editor=e}serialize(...e){const t=new Dd(this._editor);return t.serialize(...e)}deserialize(e){const t=new Id(this._editor,e);return t.deserialize()}}sy.version="3.8.0"});var a0=at(AM=>{ut(AM,{default:()=>ay});class ay{constructor(e){this._editor=e}serialize(...e){const t=new Ru(this._editor);return t.serialize(...e)}deserialize(e){const t=new Au(this._editor,e);return t.deserialize()}}ay.version="3.9.0"});var Ve=at((FM,ly)=>{ut(FM,{$mobx:()=>lC,IDerivationState:()=>Ze,ObservableMap:()=>Ph,ObservableSet:()=>Bh,Reaction:()=>Uh,_allowStateChanges:()=>cL,_allowStateChangesInsideComputed:()=>hL,_endAction:()=>A0,_getAdministration:()=>tn,_getGlobalState:()=>gL,_interceptReads:()=>zL,_isComputingDerivation:()=>oL,_resetGlobalState:()=>bL,_startAction:()=>R0,action:()=>Ps,autorun:()=>Dy,comparer:()=>qa,computed:()=>S0,configure:()=>AL,createAtom:()=>f0,decorate:()=>FL,entries:()=>KL,extendObservable:()=>xy,extendShallowObservable:()=>PL,flow:()=>LL,get:()=>qL,getAtom:()=>Vr,getDebugName:()=>Vu,getDependencyTree:()=>z0,getObserverTree:()=>BL,has:()=>J0,intercept:()=>HL,isAction:()=>DL,isArrayLike:()=>GM,isBoxedObservable:()=>Ey,isComputed:()=>GL,isComputedProp:()=>jL,isObservable:()=>Ad,isObservableArray:()=>Ii,isObservableMap:()=>li,isObservableObject:()=>ji,isObservableProp:()=>WL,isObservableSet:()=>Gi,keys:()=>Md,observable:()=>di,observe:()=>JL,onBecomeObserved:()=>m0,onBecomeUnobserved:()=>yy,onReactionError:()=>_L,reaction:()=>RL,remove:()=>$L,runInAction:()=>EL,set:()=>Y0,spy:()=>H0,toJS:()=>QL,trace:()=>N0,transaction:()=>rn,untracked:()=>Sy,values:()=>VL,when:()=>i5});var dy=function(e,t){return dy=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},dy(e,t)};function l0(e,t){dy(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var Di=function(){return Di=Object.assign||function(t){for(var i,r=1,o=arguments.length;r<o;r++){i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Di.apply(this,arguments)};function d0(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,n=[],s;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}}return n}function cy(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d0(arguments[t]));return e}var PM="An invariant failed, however the error is obfuscated because this is an production build.",Fu=[];Object.freeze(Fu);var hy={};Object.freeze(hy);var BM={};function Od(){return typeof window!="undefined"?window:typeof global!="undefined"?global:BM}function Hi(){return++q.mobxGuid}function Pe(e){throw go(!1,e),"X"}function go(e,t){if(!e)throw new Error("[mobx] "+(t||PM))}var c0=[];function bo(e,t){return!1;if(t)return bo("'"+e+"', use '"+t+"' instead.");if(c0.indexOf(e)!==-1)return!1}function py(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}var Pu=function(){};function MM(e){var t=[];return e.forEach(function(i){t.indexOf(i)===-1&&t.push(i)}),t}function uy(e){return e!==null&&typeof e=="object"}function Ka(e){if(e===null||typeof e!="object")return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function LM(e){return Rd(e)||li(e)?e:Array.isArray(e)?new Map(e):Ka(e)?new Map(Object.entries(e)):Pe("Cannot convert to map from '"+e+"'")}function zM(e,t){for(var i=0;i<t.length;i++)$a(e,t[i],e[t[i]])}function $a(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}function Ih(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:i})}function NM(e,t){var i=Object.getOwnPropertyDescriptor(e,t);return!i||i.configurable!==!1&&i.writable!==!1}function UM(e,t){}function Is(e,t){var i="isMobX"+e;return t.prototype[i]=!0,function(r){return uy(r)&&r[i]===!0}}function HM(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)}function GM(e){return Array.isArray(e)||Ii(e)}function Rd(e){return Od().Map!==void 0&&e instanceof Od().Map}function Oh(e){return e instanceof Set}function Fn(e){for(var t=[];;){var i=e.next();if(i.done)break;t.push(i.value)}return t}function h0(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function p0(e){return e===null?null:typeof e=="object"?""+e:e}function my(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function fy(e,t){Ih(e,my(),t)}function Rh(e){return e[my()]=jM,e}function gy(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function jM(){return this}var Bu=function(){function e(t){t===void 0&&(t="Atom@"+Hi()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Ze.NOT_TRACKING}return e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.reportObserved=function(){return u0(this)},e.prototype.reportChanged=function(){yo(),WM(this),vo()},e.prototype.toString=function(){return this.name},e}(),by=Is("Atom",Bu);function f0(e,t,i){t===void 0&&(t=Pu),i===void 0&&(i=Pu);var r=new Bu(e);return m0(r,t),yy(r,i),r}function g0(e,t){return e===t}function VM(e,t){return vy(e,t)}function KM(e,t){return vy(e,t,1)}function $M(e,t){return HM(e,t)||g0(e,t)}var qa={identity:g0,structural:VM,default:$M,shallow:KM},qM={},XM={};function YM(e,t){var i=t?qM:XM;return i[e]||(i[e]={configurable:!0,enumerable:t,get:function(){return Xa(this),this[e]},set:function(r){Xa(this),this[e]=r}})}function Xa(e){if(e.__mobxDidRunLazyInitializers===!0)return;var t=e.__mobxDecorators;if(t){$a(e,"__mobxDidRunLazyInitializers",!0);for(var i in t){var r=t[i];r.propertyCreator(e,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}function y0(e,t){return function(){var r,o=function(s,a,l,d){if(d===!0)return t(s,a,l,s,r),null;if(!Object.prototype.hasOwnProperty.call(s,"__mobxDecorators")){var c=s.__mobxDecorators;$a(s,"__mobxDecorators",Di({},c))}return s.__mobxDecorators[a]={prop:a,propertyCreator:t,descriptor:l,decoratorTarget:s,decoratorArguments:r},YM(a,e)};return b0(arguments)?(r=Fu,o.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),o)}}function b0(e){return(e.length===2||e.length===3)&&typeof e[1]=="string"||e.length===4&&e[3]===!0}function Ah(e,t,i){return Ad(e)?e:Array.isArray(e)?di.array(e,{name:i}):Ka(e)?di.object(e,void 0,{name:i}):Rd(e)?di.map(e,{name:i}):Oh(e)?di.set(e,{name:i}):e}function JM(e,t,i){return e==null||(ji(e)||Ii(e)||li(e)||Gi(e))?e:Array.isArray(e)?di.array(e,{name:i,deep:!1}):Ka(e)?di.object(e,void 0,{name:i,deep:!1}):Rd(e)?di.map(e,{name:i,deep:!1}):Oh(e)?di.set(e,{name:i,deep:!1}):Pe(!1)}function Fh(e){return e}function ZM(e,t,i){return vy(e,t)?t:e}function Mu(e){var t=y0(!0,function(r,o,n,s,a){var l=n?n.initializer?n.initializer.call(r):n.value:void 0;v0(r,o,l,e)}),i=typeof process!="undefined"&&process.env&&!1?function(){return arguments.length<2?Pe("Incorrect decorator invocation. @observable decorator doesn't expect any arguments"):t.apply(null,arguments)}:t;return i.enhancer=e,i}var _0={deep:!0,name:void 0,defaultDecorator:void 0},x0={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(_0);Object.freeze(x0);function Fd(e){return e==null?_0:typeof e=="string"?{name:e,deep:!0}:e}function Lu(e){return e.defaultDecorator?e.defaultDecorator.enhancer:e.deep===!1?Fh:Ah}var _y=Mu(Ah),QM=Mu(JM),w0=Mu(Fh),eL=Mu(ZM);function tL(e,t,i){if(typeof arguments[1]=="string")return _y.apply(null,arguments);if(Ad(e))return e;var r=Ka(e)?di.object(e,t,i):Array.isArray(e)?di.array(e,t):Rd(e)?di.map(e,t):Oh(e)?di.set(e,t):e;if(r!==e)return r;Pe(!1)}var C0={box:function(e,t){arguments.length>2&&Pn("box");var i=Fd(t);return new Os(e,Lu(i),i.name,!0,i.equals)},shallowBox:function(e,t){return arguments.length>2&&Pn("shallowBox"),bo("observable.shallowBox","observable.box(value, { deep: false })"),di.box(e,{name:t,deep:!1})},array:function(e,t){arguments.length>2&&Pn("array");var i=Fd(t);return new Bn(e,Lu(i),i.name)},shallowArray:function(e,t){return arguments.length>2&&Pn("shallowArray"),bo("observable.shallowArray","observable.array(values, { deep: false })"),di.array(e,{name:t,deep:!1})},map:function(e,t){arguments.length>2&&Pn("map");var i=Fd(t);return new Ph(e,Lu(i),i.name)},shallowMap:function(e,t){return arguments.length>2&&Pn("shallowMap"),bo("observable.shallowMap","observable.map(values, { deep: false })"),di.map(e,{name:t,deep:!1})},set:function(e,t){arguments.length>2&&Pn("set");var i=Fd(t);return new Bh(e,Lu(i),i.name)},object:function(e,t,i){typeof arguments[1]=="string"&&Pn("object");var r=Fd(i);return xy({},e,t,r)},shallowObject:function(e,t){return typeof arguments[1]=="string"&&Pn("shallowObject"),bo("observable.shallowObject","observable.object(values, {}, { deep: false })"),di.object(e,{},{name:t,deep:!1})},ref:w0,shallow:QM,deep:_y,struct:eL},di=tL;Object.keys(C0).forEach(function(e){return di[e]=C0[e]});function Pn(e){Pe("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}var zu=y0(!1,function(e,t,i,r,o){var n=i.get,s=i.set,a=o[0]||{};iL(e,t,Di({get:n,set:s},a))}),rL=zu({equals:qa.structural}),S0=function(t,i,r){if(typeof i=="string")return zu.apply(null,arguments);if(t!==null&&typeof t=="object"&&arguments.length===1)return zu.apply(null,arguments);var o=typeof i=="object"?i:{};return o.get=t,o.set=typeof i=="function"?i:o.set,o.name=o.name||t.name||"",new Rs(o)};S0.struct=rL;var Ze;(function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"})(Ze||(Ze={}));var _o;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(_o||(_o={}));var Nu=function(){function e(t){this.cause=t}return e}();function Mh(e){return e instanceof Nu}function wy(e){switch(e.dependenciesState){case Ze.UP_TO_DATE:return!1;case Ze.NOT_TRACKING:case Ze.STALE:return!0;case Ze.POSSIBLY_STALE:{for(var t=Pd(),i=e.observing,r=i.length,o=0;o<r;o++){var n=i[o];if(Bd(n)){if(q.disableErrorBoundaries)n.get();else try{n.get()}catch(s){return As(t),!0}if(e.dependenciesState===Ze.STALE)return As(t),!0}}return T0(e),As(t),!1}}}function oL(){return q.trackingDerivation!==null}function Uu(e){var t=e.observers.length>0;q.computationDepth>0&&t&&Pe(!1),!q.allowStateChanges&&(t||q.enforceActions==="strict")&&Pe(!1)}function nL(e){}function D0(e,t,i){var r=k0(!0);T0(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++q.runId;var o=q.trackingDerivation;q.trackingDerivation=e;var n;if(q.disableErrorBoundaries===!0)n=t.call(i);else try{n=t.call(i)}catch(s){n=new Nu(s)}return q.trackingDerivation=o,aL(e),e.observing.length===0&&sL(e),E0(r),n}function sL(e){return}function aL(e){for(var t=e.observing,i=e.observing=e.newObserving,r=Ze.UP_TO_DATE,o=0,n=e.unboundDepsCount,s=0;s<n;s++){var a=i[s];a.diffValue===0&&(a.diffValue=1,o!==s&&(i[o]=a),o++),a.dependenciesState>r&&(r=a.dependenciesState)}for(i.length=o,e.newObserving=null,n=t.length;n--;){var a=t[n];a.diffValue===0&&I0(a,e),a.diffValue=0}for(;o--;){var a=i[o];a.diffValue===1&&(a.diffValue=0,lL(a,e))}r!==Ze.UP_TO_DATE&&(e.dependenciesState=r,e.onBecomeStale())}function Cy(e){var t=e.observing;e.observing=[];for(var i=t.length;i--;)I0(t[i],e);e.dependenciesState=Ze.NOT_TRACKING}function Sy(e){var t=Pd(),i=e();return As(t),i}function Pd(){var e=q.trackingDerivation;return q.trackingDerivation=null,e}function As(e){q.trackingDerivation=e}function k0(e){var t=q.allowStateReads;return q.allowStateReads=e,t}function E0(e){q.allowStateReads=e}function T0(e){if(e.dependenciesState===Ze.UP_TO_DATE)return;e.dependenciesState=Ze.UP_TO_DATE;for(var t=e.observing,i=t.length;i--;)t[i].lowestObserverState=Ze.UP_TO_DATE}var Hu=0,dL=1;function Fs(e,t){var i=function(){return O0(e,t,this,arguments)};return i.isMobxAction=!0,i}function O0(e,t,i,r){var o=R0(e,i,r);try{return t.apply(i,r)}catch(n){throw o.error=n,n}finally{A0(o)}}function R0(e,t,i){var r=yi()&&!!e,o=0;if(r){o=Date.now();var n=i&&i.length||0,s=new Array(n);if(n>0)for(var a=0;a<n;a++)s[a]=i[a];wr({type:"action",name:e,object:t,arguments:s})}var l=Pd();yo();var d=Ty(!0),c=k0(!0),p={prevDerivation:l,prevAllowStateChanges:d,prevAllowStateReads:c,notifySpy:r,startTime:o,actionId:dL++,parentActionId:Hu};return Hu=p.actionId,p}function A0(e){Hu!==e.actionId&&Pe("invalid action stack. did you forget to finish an action?"),Hu=e.parentActionId,e.error!==void 0&&(q.suppressReactionErrors=!0),ky(e.prevAllowStateChanges),E0(e.prevAllowStateReads),vo(),As(e.prevDerivation),e.notifySpy&&Cr({time:Date.now()-e.startTime}),q.suppressReactionErrors=!1}function cL(e,t){var i=Ty(e),r;try{r=t()}finally{ky(i)}return r}function Ty(e){var t=q.allowStateChanges;return q.allowStateChanges=e,t}function ky(e){q.allowStateChanges=e}function hL(e){var t=q.computationDepth;q.computationDepth=0;var i;try{i=e()}finally{q.computationDepth=t}return i}var Os=function(e){l0(t,e);function t(i,r,o,n,s){o===void 0&&(o="ObservableValue@"+Hi()),n===void 0&&(n=!0),s===void 0&&(s=qa.default);var a=e.call(this,o)||this;return a.enhancer=r,a.name=o,a.equals=s,a.hasUnreportedChange=!1,a.value=r(i,void 0,o),n&&yi()&&Ya({type:"create",name:a.name,newValue:""+a.value}),a}return t.prototype.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.prototype.set=function(i){var r=this.value;if(i=this.prepareNewValue(i),i!==q.UNCHANGED){var o=yi();o&&wr({type:"update",name:this.name,newValue:i,oldValue:r}),this.setNewValue(i),o&&Cr()}},t.prototype.prepareNewValue=function(i){if(Uu(this),Qo(this)){var r=en(this,{object:this,type:"update",newValue:i});if(!r)return q.UNCHANGED;i=r.newValue}return i=this.enhancer(i,this.value,this.name),this.equals(this.value,i)?q.UNCHANGED:i},t.prototype.setNewValue=function(i){var r=this.value;this.value=i,this.reportChanged(),xo(this)&&wo(this,{type:"update",object:this,newValue:i,oldValue:r})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(i){return Lh(this,i)},t.prototype.observe=function(i,r){return r&&i({object:this,type:"update",newValue:this.value,oldValue:void 0}),zh(this,i)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return p0(this.get())},t}(Bu);Os.prototype[h0()]=Os.prototype.valueOf;var Ey=Is("ObservableValue",Os),Rs=function(){function e(t){this.dependenciesState=Ze.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Ze.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Hi(),this.value=new Nu(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=_o.NONE,this.derivation=t.get,this.name=t.name||"ComputedValue@"+Hi(),t.set&&(this.setter=Fs(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?qa.structural:qa.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return e.prototype.onBecomeStale=function(){uL(this)},e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.get=function(){this.isComputing&&Pe("Cycle detected in computation "+this.name+": "+this.derivation),q.inBatch===0&&this.observers.length===0&&!this.keepAlive?wy(this)&&(this.warnAboutUntrackedRead(),yo(),this.value=this.computeValue(!1),vo()):(u0(this),wy(this)&&(this.trackAndCompute()&&pL(this)));var t=this.value;if(Mh(t))throw t.cause;return t},e.prototype.peek=function(){var t=this.computeValue(!1);if(Mh(t))throw t.cause;return t},e.prototype.set=function(t){if(this.setter){go(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else go(!1,!1)},e.prototype.trackAndCompute=function(){yi()&&Ya({object:this.scope,type:"compute",name:this.name});var t=this.value,i=this.dependenciesState===Ze.NOT_TRACKING,r=this.computeValue(!0),o=i||Mh(t)||Mh(r)||!this.equals(t,r);return o&&(this.value=r),o},e.prototype.computeValue=function(t){this.isComputing=!0,q.computationDepth++;var i;if(t)i=D0(this,this.derivation,this.scope);else if(q.disableErrorBoundaries===!0)i=this.derivation.call(this.scope);else try{i=this.derivation.call(this.scope)}catch(r){i=new Nu(r)}return q.computationDepth--,this.isComputing=!1,i},e.prototype.suspend=function(){this.keepAlive||(Cy(this),this.value=void 0)},e.prototype.observe=function(t,i){var r=this,o=!0,n=void 0;return Dy(function(){var s=r.get();if(!o||i){var a=Pd();t({type:"update",object:r,newValue:s,oldValue:n}),As(a)}o=!1,n=s})},e.prototype.warnAboutUntrackedRead=function(){return},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return p0(this.get())},e}();Rs.prototype[h0()]=Rs.prototype.valueOf;var Bd=Is("ComputedValue",Rs),mL=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED"],Nh=function(){function e(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return e}(),Gu=!0,F0=!1,q=function(){var e=Od();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(Gu=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new Nh().version&&(Gu=!1),Gu?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new Nh):(setTimeout(function(){F0||Pe("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new Nh)}();function fL(){(q.pendingReactions.length||q.inBatch||q.isRunningReactions)&&Pe("isolateGlobalState should be called before MobX is running any reactions"),F0=!0,Gu&&(--Od().__mobxInstanceCount===0&&(Od().__mobxGlobals=void 0),q=new Nh)}function gL(){return q}function bL(){var e=new Nh;for(var t in e)mL.indexOf(t)===-1&&(q[t]=e[t]);q.allowStateChanges=!q.enforceActions}function yL(e){return e.observers&&e.observers.length>0}function vL(e){return e.observers}function lL(e,t){var i=e.observers.length;i&&(e.observersIndexes[t.__mapid]=i),e.observers[i]=t,e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function I0(e,t){if(e.observers.length===1)e.observers.length=0,P0(e);else{var i=e.observers,r=e.observersIndexes,o=i.pop();if(o!==t){var n=r[t.__mapid]||0;n?r[o.__mapid]=n:delete r[o.__mapid],i[n]=o}delete r[t.__mapid]}}function P0(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,q.pendingUnobservations.push(e))}function yo(){q.inBatch++}function vo(){if(--q.inBatch===0){B0();for(var e=q.pendingUnobservations,t=0;t<e.length;t++){var i=e[t];i.isPendingUnobservation=!1,i.observers.length===0&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBecomeUnobserved()),i instanceof Rs&&i.suspend())}q.pendingUnobservations=[]}}function u0(e){nL(e);var t=q.trackingDerivation;return t!==null?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(e.observers.length===0&&q.inBatch>0&&P0(e),!1)}function WM(e){if(e.lowestObserverState===Ze.STALE)return;e.lowestObserverState=Ze.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===Ze.UP_TO_DATE&&(r.isTracing!==_o.NONE&&M0(r,e),r.onBecomeStale()),r.dependenciesState=Ze.STALE}}function pL(e){if(e.lowestObserverState===Ze.STALE)return;e.lowestObserverState=Ze.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===Ze.POSSIBLY_STALE?r.dependenciesState=Ze.STALE:r.dependenciesState===Ze.UP_TO_DATE&&(e.lowestObserverState=Ze.UP_TO_DATE)}}function uL(e){if(e.lowestObserverState!==Ze.UP_TO_DATE)return;e.lowestObserverState=Ze.POSSIBLY_STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===Ze.UP_TO_DATE&&(r.dependenciesState=Ze.POSSIBLY_STALE,r.isTracing!==_o.NONE&&M0(r,e),r.onBecomeStale())}}function M0(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===_o.BREAK){var i=[];L0(z0(e),i,1),new Function(`debugger;
/*
Tracing '`+e.name+`'

You are entering this break point because derivation '`+e.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof Rs?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+i.join(`
`)+`
*/
    `)()}}function L0(e,t,i){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(i).join("	")+e.name),e.dependencies&&e.dependencies.forEach(function(r){return L0(r,t,i+1)})}var Uh=function(){function e(t,i,r,o){t===void 0&&(t="Reaction@"+Hi()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=i,this.errorHandler=r,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=Ze.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Hi(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=_o.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,q.pendingReactions.push(this),B0())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(yo(),this._isScheduled=!1,wy(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&yi()&&Ya({name:this.name,type:"scheduled-reaction"})}catch(t){this.reportExceptionInDerivation(t)}}vo()}},e.prototype.track=function(t){yo();var i=yi(),r;i&&(r=Date.now(),wr({name:this.name,type:"reaction"})),this._isRunning=!0;var o=D0(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&Cy(this),Mh(o)&&this.reportExceptionInDerivation(o.cause),i&&Cr({time:Date.now()-r}),vo()},e.prototype.reportExceptionInDerivation=function(t){var i=this;if(this.errorHandler){this.errorHandler(t,this);return}if(q.disableErrorBoundaries)throw t;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";q.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(r,t),yi()&&Ya({type:"error",name:this.name,message:r,error:""+t}),q.globalReactionErrorHandlers.forEach(function(o){return o(t,i)})},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(yo(),Cy(this),vo()))},e.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(t){t===void 0&&(t=!1),N0(this,t)},e}();function _L(e){return q.globalReactionErrorHandlers.push(e),function(){var t=q.globalReactionErrorHandlers.indexOf(e);t>=0&&q.globalReactionErrorHandlers.splice(t,1)}}var U0=100,Iy=function(e){return e()};function B0(){if(q.inBatch>0||q.isRunningReactions)return;Iy(xL)}function xL(){q.isRunningReactions=!0;for(var e=q.pendingReactions,t=0;e.length>0;){++t===U0&&(console.error("Reaction doesn't converge to a stable state after "+U0+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0])),e.splice(0));for(var i=e.splice(0),r=0,o=i.length;r<o;r++)i[r].runReaction()}q.isRunningReactions=!1}var ju=Is("Reaction",Uh);function wL(e){var t=Iy;Iy=function(i){return e(function(){return t(i)})}}function yi(){return!!q.spyListeners.length}function Ya(e){if(!q.spyListeners.length)return;for(var t=q.spyListeners,i=0,r=t.length;i<r;i++)t[i](e)}function wr(e){var t=Di({},e,{spyReportStart:!0});Ya(t)}var CL={spyReportEnd:!0};function Cr(e){Ya(e?Di({},e,{spyReportEnd:!0}):CL)}function H0(e){return q.spyListeners.push(e),py(function(){q.spyListeners=q.spyListeners.filter(function(t){return t!==e})})}function SL(){Pe(!1)}function G0(e){return function(t,i,r){if(r){if(r.value)return{value:Fs(e,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Fs(e,o.call(this))}}}return TL(e).apply(this,arguments)}}function TL(e){return function(t,i,r){Object.defineProperty(t,i,{configurable:!0,enumerable:!1,get:function(){return},set:function(o){$a(this,i,Ps(e,o))}})}}function kL(e,t,i,r){return r===!0?(Oy(e,t,i.value),null):i?{configurable:!0,enumerable:!1,get:function(){return Oy(this,t,i.value||i.initializer.call(this)),this[t]},set:SL}:{enumerable:!1,configurable:!0,set:function(o){Oy(this,t,o)},get:function(){return}}}var Ps=function(t,i,r,o){if(arguments.length===1&&typeof t=="function")return Fs(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof i=="function")return Fs(t,i);if(arguments.length===1&&typeof t=="string")return G0(t);if(o===!0)t[i]=Fs(t.name||i,r.value);else return G0(i).apply(null,arguments)};Ps.bound=kL;function EL(e,t){var i=typeof e=="string"?e:e.name||"<unnamed action>",r=typeof e=="function"?e:t;return O0(i,r,this,void 0)}function DL(e){return typeof e=="function"&&e.isMobxAction===!0}function Oy(e,t,i){$a(e,t,Fs(t,i.bind(e)))}function Dy(e,t){t===void 0&&(t=hy);var i=t&&t.name||e.name||"Autorun@"+Hi(),r=!t.scheduler&&!t.delay,o;if(r)o=new Uh(i,function(){this.track(a)},t.onError,t.requiresObservable);else{var n=j0(t),s=!1;o=new Uh(i,function(){s||(s=!0,n(function(){s=!1,o.isDisposed||o.track(a)}))},t.onError,t.requiresObservable)}function a(){e(o)}return o.schedule(),o.getDisposer()}var IL=function(e){return e()};function j0(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:IL}function RL(e,t,i){i===void 0&&(i=hy),typeof i=="boolean"&&(i={fireImmediately:i},bo("Using fireImmediately as argument is deprecated. Use '{ fireImmediately: true }' instead"));var r=i.name||"Reaction@"+Hi(),o=Ps(r,i.onError?OL(i.onError,t):t),n=!i.scheduler&&!i.delay,s=j0(i),a=!0,l=!1,d,c=i.compareStructural?qa.structural:i.equals||qa.default,p=new Uh(r,function(){a||n?h():l||(l=!0,s(h))},i.onError,i.requiresObservable);function h(){if(l=!1,p.isDisposed)return;var m=!1;p.track(function(){var b=e(p);m=a||!c(d,b),d=b}),a&&i.fireImmediately&&o(d,p),!a&&m===!0&&o(d,p),a&&(a=!1)}return p.schedule(),p.getDisposer()}function OL(e,t){return function(){try{return t.apply(this,arguments)}catch(i){e.call(this,i)}}}function m0(e,t,i){return W0("onBecomeObserved",e,t,i)}function yy(e,t,i){return W0("onBecomeUnobserved",e,t,i)}function W0(e,t,i,r){var o=typeof r=="function"?Vr(t,i):Vr(t),n=typeof r=="function"?r:i,s=o[e];return typeof s!="function"?Pe(!1):(o[e]=function(){s.call(this),n.call(this)},function(){o[e]=s})}function AL(e){var t=e.enforceActions,i=e.computedRequiresReaction,r=e.computedConfigurable,o=e.disableErrorBoundaries,n=e.arrayBuffer,s=e.reactionScheduler,a=e.reactionRequiresObservable,l=e.observableRequiresReaction;if(e.isolateGlobalState===!0&&fL(),t!==void 0){(typeof t=="boolean"||t==="strict")&&bo(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var d=void 0;switch(t){case!0:case"observed":d=!0;break;case!1:case"never":d=!1;break;case"strict":case"always":d="strict";break;default:Pe("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}q.enforceActions=d,q.allowStateChanges=!(d===!0||d==="strict")}i!==void 0&&(q.computedRequiresReaction=!!i),a!==void 0&&(q.reactionRequiresObservable=!!a),l!==void 0&&(q.observableRequiresReaction=!!l,q.allowStateReads=!q.observableRequiresReaction),r!==void 0&&(q.computedConfigurable=!!r),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),q.disableErrorBoundaries=!!o),typeof n=="number"&&Ry(n),s&&wL(s)}function FL(e,t){var i=typeof e=="function"?e.prototype:e,r=function(n){var s=t[n];Array.isArray(s)||(s=[s]);var a=Object.getOwnPropertyDescriptor(i,n),l=s.reduce(function(d,c){return c(i,n,d)},a);l&&Object.defineProperty(i,n,l)};for(var o in t)r(o);return e}function PL(e,t,i){return bo("'extendShallowObservable' is deprecated, use 'extendObservable(target, props, { deep: false })' instead"),xy(e,t,i,x0)}function xy(e,t,i,r){if(!1&&i)for(var o in i);r=Fd(r);var n=r.defaultDecorator||(r.deep===!1?w0:_y);Xa(e),Ay(e,r.name,n.enhancer),yo();try{for(var o in t){var s=Object.getOwnPropertyDescriptor(t,o),a=i&&o in i?i[o]:s.get?zu:n,l=a(e,o,s,!0);l&&Object.defineProperty(e,o,l)}}finally{vo()}return e}function z0(e,t){return V0(Vr(e,t))}function V0(e){var t={name:e.name};return e.observing&&e.observing.length>0&&(t.dependencies=MM(e.observing).map(V0)),t}function BL(e,t){return K0(Vr(e,t))}function K0(e){var t={name:e.name};return yL(e)&&(t.observers=vL(e).map(K0)),t}var ML=0;function LL(e){arguments.length!==1&&Pe("Flow expects one 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var i=this,r=arguments,o=++ML,n=Ps(t+" - runid: "+o+" - init",e).apply(i,r),s,a=void 0,l=new Promise(function(d,c){var p=0;s=c;function h(_){a=void 0;var g;try{g=Ps(t+" - runid: "+o+" - yield "+p++,n.next).call(n,_)}catch(S){return c(S)}b(g)}function m(_){a=void 0;var g;try{g=Ps(t+" - runid: "+o+" - yield "+p++,n.throw).call(n,_)}catch(S){return c(S)}b(g)}function b(_){if(_&&typeof _.then=="function"){_.then(b,c);return}return _.done?d(_.value):(a=Promise.resolve(_.value),a.then(h,m))}h(void 0)});return l.cancel=Ps(t+" - runid: "+o+" - cancel",function(){try{a&&$0(a);var d=n.return(),c=Promise.resolve(d.value);c.then(Pu,Pu),$0(c),s(new Error("FLOW_CANCELLED"))}catch(p){s(p)}}),l}}function $0(e){typeof e.cancel=="function"&&e.cancel()}function zL(e,t,i){var r;if(li(e)||Ii(e)||Ey(e))r=tn(e);else if(ji(e)){if(typeof t!="string")return Pe(!1);r=tn(e,t)}else return Pe(!1);return r.dehancer!==void 0?Pe(!1):(r.dehancer=typeof t=="function"?t:i,function(){r.dehancer=void 0})}function HL(e,t,i){return typeof i=="function"?UL(e,t,i):NL(e,t)}function NL(e,t){return tn(e).intercept(t)}function UL(e,t,i){return tn(e,t).intercept(i)}function q0(e,t){if(e==null)return!1;if(t!==void 0){if(ji(e)===!1)return!1;if(!e.$mobx.values[t])return!1;var i=Vr(e,t);return Bd(i)}return Bd(e)}function GL(e){return arguments.length>1?Pe(!1):q0(e)}function jL(e,t){return typeof t!="string"?Pe(!1):q0(e,t)}function X0(e,t){if(e==null)return!1;if(t!==void 0){if(ji(e)){var i=e.$mobx;return i.values&&!!i.values[t]}return!1}return ji(e)||!!e.$mobx||by(e)||ju(e)||Bd(e)}function Ad(e){return arguments.length!==1&&Pe(!1),X0(e)}function WL(e,t){return typeof t!="string"?Pe(!1):X0(e,t)}function Md(e){return ji(e)?e.$mobx.getKeys():li(e)?e._keys.slice():Gi(e)?Fn(e.keys()):Ii(e)?e.map(function(t,i){return i}):Pe(!1)}function VL(e){return ji(e)?Md(e).map(function(t){return e[t]}):li(e)?Md(e).map(function(t){return e.get(t)}):Gi(e)?Fn(e.values()):Ii(e)?e.slice():Pe(!1)}function KL(e){return ji(e)?Md(e).map(function(t){return[t,e[t]]}):li(e)?Md(e).map(function(t){return[t,e.get(t)]}):Gi(e)?Fn(e.entries()):Ii(e)?e.map(function(t,i){return[i,t]}):Pe(!1)}function Y0(e,t,i){if(arguments.length===2&&!Gi(e)){yo();var r=t;try{for(var o in r)Y0(e,o,r[o])}finally{vo()}return}if(ji(e)){var n=e.$mobx,s=n.values[t];s?n.write(e,t,i):v0(e,t,i,n.defaultEnhancer)}else if(li(e))e.set(t,i);else if(Gi(e))e.add(t);else if(Ii(e))typeof t!="number"&&(t=parseInt(t,10)),go(t>=0,"Not a valid index: '"+t+"'"),yo(),t>=e.length&&(e.length=t+1),e[t]=i,vo();else return Pe(!1)}function $L(e,t){if(ji(e))e.$mobx.remove(t);else if(li(e))e.delete(t);else if(Gi(e))e.delete(t);else if(Ii(e))typeof t!="number"&&(t=parseInt(t,10)),go(t>=0,"Not a valid index: '"+t+"'"),e.splice(t,1);else return Pe(!1)}function J0(e,t){if(ji(e)){var i=tn(e);return i.getKeys(),!!i.values[t]}else return li(e)||Gi(e)?e.has(t):Ii(e)?t>=0&&t<e.length:Pe(!1)}function qL(e,t){return J0(e,t)?ji(e)?e[t]:li(e)?e.get(t):Ii(e)?e[t]:Pe(!1):void 0}function JL(e,t,i,r){return typeof i=="function"?YL(e,t,i,r):XL(e,t,i)}function XL(e,t,i){return tn(e).observe(t,i)}function YL(e,t,i,r){return tn(e,t).observe(i,r)}var ZL={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function Ld(e,t,i,r){return r.detectCycles&&e.set(t,i),i}function Bs(e,t,i){if(!t.recurseEverything&&!Ad(e))return e;if(typeof e!="object")return e;if(e===null)return null;if(e instanceof Date)return e;if(Ey(e))return Bs(e.get(),t,i);Ad(e)&&Md(e);var r=t.detectCycles===!0;if(r&&e!==null&&i.has(e))return i.get(e);if(Ii(e)||Array.isArray(e)){var o=Ld(i,e,[],t),n=e.map(function(b){return Bs(b,t,i)});o.length=n.length;for(var s=0,a=n.length;s<a;s++)o[s]=n[s];return o}if(Gi(e)||Object.getPrototypeOf(e)===Set.prototype)if(t.exportMapsAsObjects===!1){var l=Ld(i,e,new Set,t);return e.forEach(function(b){l.add(Bs(b,t,i))}),l}else{var d=Ld(i,e,[],t);return e.forEach(function(b){d.push(Bs(b,t,i))}),d}if(li(e)||Object.getPrototypeOf(e)===Map.prototype)if(t.exportMapsAsObjects===!1){var c=Ld(i,e,new Map,t);return e.forEach(function(b,_){c.set(_,Bs(b,t,i))}),c}else{var p=Ld(i,e,{},t);return e.forEach(function(b,_){p[_]=Bs(b,t,i)}),p}var h=Ld(i,e,{},t);for(var m in e)h[m]=Bs(e[m],t,i);return h}function QL(e,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=ZL),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var i;return t.detectCycles&&(i=new Map),Bs(e,t,i)}function N0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;typeof e[e.length-1]=="boolean"&&(i=e.pop());var r=e5(e);if(!r)return Pe(!1);r.isTracing===_o.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=i?_o.BREAK:_o.LOG}function e5(e){switch(e.length){case 0:return q.trackingDerivation;case 1:return Vr(e[0]);case 2:return Vr(e[0],e[1])}}function rn(e,t){t===void 0&&(t=void 0),yo();try{return e.apply(t)}finally{vo()}}function i5(e,t,i){return arguments.length===1||t&&typeof t=="object"?t5(e,t):Z0(e,t,i||{})}function Z0(e,t,i){var r;typeof i.timeout=="number"&&(r=setTimeout(function(){if(!n.$mobx.isDisposed){n();var s=new Error("WHEN_TIMEOUT");if(i.onError)i.onError(s);else throw s}},i.timeout)),i.name=i.name||"When@"+Hi();var o=Fs(i.name+"-effect",t),n=Dy(function(s){e()&&(s.dispose(),r&&clearTimeout(r),o())},i);return n}function t5(e,t){var i,r=new Promise(function(o,n){var s=Z0(e,o,Di({},t,{onError:n}));i=function(){s(),n("WHEN_CANCELLED")}});return r.cancel=i,r}function Qo(e){return e.interceptors!==void 0&&e.interceptors.length>0}function Lh(e,t){var i=e.interceptors||(e.interceptors=[]);return i.push(t),py(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function en(e,t){var i=Pd();try{var r=e.interceptors;if(r)for(var o=0,n=r.length;o<n&&!(t=r[o](t),go(!t||t.type,"Intercept handlers should return nothing or a change object"),!t);o++);return t}finally{As(i)}}function xo(e){return e.changeListeners!==void 0&&e.changeListeners.length>0}function zh(e,t){var i=e.changeListeners||(e.changeListeners=[]);return i.push(t),py(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function wo(e,t){var i=Pd(),r=e.changeListeners;if(!r)return;r=r.slice();for(var o=0,n=r.length;o<n;o++)r[o](t);As(i)}var r5=1e4,o5=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)["0"]=1,e===!1}(),Fy=0,Py=function(){function e(){}return e}();function n5(e,t){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(e.prototype,t):typeof e.prototype.__proto__!="undefined"?e.prototype.__proto__=t:e.prototype=t}n5(Py,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(Py.prototype,e,{configurable:!0,writable:!0,value:Array.prototype[e]})});var Q0=function(){function e(t,i,r,o){this.array=r,this.owned=o,this.values=[],this.lastKnownLength=0,this.atom=new Bu(t||"ObservableArray@"+Hi()),this.enhancer=function(n,s){return i(n,s,t+"[..]")}}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},e.prototype.intercept=function(t){return Lh(this,t)},e.prototype.observe=function(t,i){return i===void 0&&(i=!1),i&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),zh(this,t)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var i=this.values.length;if(t===i)return;if(t>i){for(var r=new Array(t-i),o=0;o<t-i;o++)r[o]=void 0;this.spliceWithArray(i,0,r)}else this.spliceWithArray(t,i-t)},e.prototype.updateArrayLength=function(t,i){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=i,i>0&&t+i+1>Fy&&Ry(t+i+1)},e.prototype.spliceWithArray=function(t,i,r){var o=this;Uu(this.atom);var n=this.values.length;if(t===void 0?t=0:t>n?t=n:t<0&&(t=Math.max(0,n+t)),arguments.length===1?i=n-t:i==null?i=0:i=Math.max(0,Math.min(i,n-t)),r===void 0&&(r=Fu),Qo(this)){var s=en(this,{object:this.array,type:"splice",index:t,removedCount:i,added:r});if(!s)return Fu;i=s.removedCount,r=s.added}r=r.length===0?r:r.map(function(d){return o.enhancer(d,void 0)});var a=r.length-i;this.updateArrayLength(n,a);var l=this.spliceItemsIntoValues(t,i,r);return(i!==0||r.length!==0)&&this.notifyArraySplice(t,r,l),this.dehanceValues(l)},e.prototype.spliceItemsIntoValues=function(t,i,r){var o;if(r.length<r5)return(o=this.values).splice.apply(o,cy([t,i],r));var n=this.values.slice(t,t+i);return this.values=this.values.slice(0,t).concat(r,this.values.slice(t+i)),n},e.prototype.notifyArrayChildUpdate=function(t,i,r){var o=!this.owned&&yi(),n=xo(this),s=n||o?{object:this.array,type:"update",index:t,newValue:i,oldValue:r}:null;o&&wr(Di({},s,{name:this.atom.name})),this.atom.reportChanged(),n&&wo(this,s),o&&Cr()},e.prototype.notifyArraySplice=function(t,i,r){var o=!this.owned&&yi(),n=xo(this),s=n||o?{object:this.array,type:"splice",index:t,removed:r,added:i,removedCount:r.length,addedCount:i.length}:null;o&&wr(Di({},s,{name:this.atom.name})),this.atom.reportChanged(),n&&wo(this,s),o&&Cr()},e}(),Bn=function(e){l0(t,e);function t(i,r,o,n){o===void 0&&(o="ObservableArray@"+Hi()),n===void 0&&(n=!1);var s=e.call(this)||this,a=new Q0(o,r,s,n);if(Ih(s,"$mobx",a),i&&i.length){var l=Ty(!0);s.spliceWithArray(0,0,i),ky(l)}return o5&&Object.defineProperty(a.array,"0",s5),s}return t.prototype.intercept=function(i){return this.$mobx.intercept(i)},t.prototype.observe=function(i,r){return r===void 0&&(r=!1),this.$mobx.observe(i,r)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),i.map(function(o){return Ii(o)?o.peek():o}))},t.prototype.replace=function(i){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,i)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&bo("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return n===-1?void 0:this.get(n)},t.prototype.findIndex=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&bo("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var n=this.peek(),s=n.length,a=o;a<s;a++)if(i.call(r,n[a],a,this))return a;return-1},t.prototype.splice=function(i,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(i);case 2:return this.$mobx.spliceWithArray(i,r)}return this.$mobx.spliceWithArray(i,r,o)},t.prototype.spliceWithArray=function(i,r,o){return this.$mobx.spliceWithArray(i,r,o)},t.prototype.push=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(o.values.length,0,i),o.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(0,0,i),o.values.length},t.prototype.reverse=function(){var i=this.slice();return i.reverse.apply(i,arguments)},t.prototype.sort=function(i){var r=this.slice();return r.sort.apply(r,arguments)},t.prototype.remove=function(i){var r=this.$mobx.dehanceValues(this.$mobx.values).indexOf(i);return r>-1?(this.splice(r,1),!0):!1},t.prototype.move=function(i,r){bo("observableArray.move is deprecated, use .slice() & .replace() instead");function o(a){if(a<0)throw new Error("[mobx.array] Index out of bounds: "+a+" is negative");var l=this.$mobx.values.length;if(a>=l)throw new Error("[mobx.array] Index out of bounds: "+a+" is not smaller than "+l)}if(o.call(this,i),o.call(this,r),i===r)return;var n=this.$mobx.values,s;i<r?s=cy(n.slice(0,i),n.slice(i+1,r+1),[n[i]],n.slice(r+1)):s=cy(n.slice(0,r),[n[i]],n.slice(r,i),n.slice(i+1)),this.replace(s)},t.prototype.get=function(i){var r=this.$mobx;if(r){if(i<r.values.length)return r.atom.reportObserved(),r.dehanceValue(r.values[i]);console.warn("[mobx.array] Attempt to read an array index ("+i+") that is out of bounds ("+r.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}return},t.prototype.set=function(i,r){var o=this.$mobx,n=o.values;if(i<n.length){Uu(o.atom);var s=n[i];if(Qo(o)){var a=en(o,{type:"update",object:this,index:i,newValue:r});if(!a)return;r=a.newValue}r=o.enhancer(r,s);var l=r!==s;l&&(n[i]=r,o.notifyArrayChildUpdate(i,r,s))}else if(i===n.length)o.spliceWithArray(i,0,[r]);else throw new Error("[mobx.array] Index out of bounds, "+i+" is larger than "+n.length)},t}(Py);fy(Bn.prototype,function(){this.$mobx.atom.reportObserved();var e=this,t=0;return Rh({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(Bn.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}});$a(Bn.prototype,gy(),"Array");["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];go(typeof t=="function","Base function not defined on Array prototype: '"+e+"'"),$a(Bn.prototype,e,function(){return t.apply(this.peek(),arguments)})});zM(Bn.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var s5=eC(0);function eC(e){return{enumerable:!1,configurable:!1,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function a5(e){Object.defineProperty(Bn.prototype,""+e,eC(e))}function Ry(e){for(var t=Fy;t<e;t++)a5(t);Fy=e}Ry(1e3);var l5=Is("ObservableArrayAdministration",Q0);function Ii(e){return uy(e)&&l5(e.$mobx)}var d5={},Ph=function(){function e(t,i,r){if(i===void 0&&(i=Ah),r===void 0&&(r="ObservableMap@"+Hi()),this.enhancer=i,this.name=r,this.$mobx=d5,this._keys=new Bn(void 0,Fh,this.name+".keys()",!0),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return e.prototype._has=function(t){return this._data.has(t)},e.prototype.has=function(t){var i=this;if(!q.trackingDerivation)return this._has(t);var r=this._hasMap.get(t);if(!r){var o=r=new Os(this._has(t),Fh,this.name+"."+Wu(t)+"?",!1);this._hasMap.set(t,o),yy(o,function(){return i._hasMap.delete(t)})}return r.get()},e.prototype.set=function(t,i){var r=this._has(t);if(Qo(this)){var o=en(this,{type:r?"update":"add",object:this,newValue:i,name:t});if(!o)return this;i=o.newValue}return r?this._updateValue(t,i):this._addValue(t,i),this},e.prototype.delete=function(t){var i=this;if(Qo(this)){var r=en(this,{type:"delete",object:this,name:t});if(!r)return!1}if(this._has(t)){var o=yi(),n=xo(this),r=n||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return o&&wr(Di({},r,{name:this.name,key:t})),rn(function(){i._keys.remove(t),i._updateHasMapEntry(t,!1);var a=i._data.get(t);a.setNewValue(void 0),i._data.delete(t)}),n&&wo(this,r),o&&Cr(),!0}return!1},e.prototype._updateHasMapEntry=function(t,i){var r=this._hasMap.get(t);r&&r.setNewValue(i)},e.prototype._updateValue=function(t,i){var r=this._data.get(t);if(i=r.prepareNewValue(i),i!==q.UNCHANGED){var o=yi(),n=xo(this),s=n||o?{type:"update",object:this,oldValue:r.value,name:t,newValue:i}:null;o&&wr(Di({},s,{name:this.name,key:t})),r.setNewValue(i),n&&wo(this,s),o&&Cr()}},e.prototype._addValue=function(t,i){var r=this;rn(function(){var a=new Os(i,r.enhancer,r.name+"."+Wu(t),!1);r._data.set(t,a),i=a.value,r._updateHasMapEntry(t,!0),r._keys.push(t)});var o=yi(),n=xo(this),s=n||o?{type:"add",object:this,name:t,newValue:i}:null;o&&wr(Di({},s,{name:this.name,key:t})),n&&wo(this,s),o&&Cr()},e.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.keys=function(){return this._keys[my()]()},e.prototype.values=function(){var t=this,i=0;return Rh({next:function(){return i<t._keys.length?{value:t.get(t._keys[i++]),done:!1}:{value:void 0,done:!0}}})},e.prototype.entries=function(){var t=this,i=0;return Rh({next:function(){if(i<t._keys.length){var r=t._keys[i++];return{value:[r,t.get(r)],done:!1}}return{done:!0}}})},e.prototype.forEach=function(t,i){var r=this;this._keys.forEach(function(o){return t.call(i,r.get(o),o,r)})},e.prototype.merge=function(t){var i=this;return li(t)&&(t=t.toJS()),rn(function(){Ka(t)?Object.keys(t).forEach(function(r){return i.set(r,t[r])}):Array.isArray(t)?t.forEach(function(r){var o=d0(r,2),n=o[0],s=o[1];return i.set(n,s)}):Rd(t)?t.constructor!==Map?Pe("Cannot initialize from classes that inherit from Map: "+t.constructor.name):t.forEach(function(r,o){return i.set(o,r)}):t!=null&&Pe("Cannot initialize map from "+t)}),this},e.prototype.clear=function(){var t=this;rn(function(){Sy(function(){t._keys.slice().forEach(function(i){return t.delete(i)})})})},e.prototype.replace=function(t){var i=this;return rn(function(){for(var r=LM(t),o=i._keys,n=Array.from(r.keys()),s=!1,a=0;a<o.length;a++){var l=o[a];o.length===n.length&&l!==n[a]&&(s=!0),r.has(l)||(s=!0,i.delete(l))}r.forEach(function(d,c){i._data.has(c)||(s=!0),i.set(c,d)}),s&&i._keys.replace(n)}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var t=this,i={};return this._keys.forEach(function(r){return i[typeof r=="symbol"?r:Wu(r)]=t.get(r)}),i},e.prototype.toJS=function(){var t=this,i=new Map;return this._keys.forEach(function(r){return i.set(r,t.get(r))}),i},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var t=this;return this.name+"[{ "+this._keys.map(function(i){return Wu(i)+": "+(""+t.get(i))}).join(", ")+" }]"},e.prototype.observe=function(t,i){return zh(this,t)},e.prototype.intercept=function(t){return Lh(this,t)},e}();function Wu(e){return e&&e.toString?e.toString():new String(e).toString()}fy(Ph.prototype,function(){return this.entries()});Ih(Ph.prototype,gy(),"Map");var li=Is("ObservableMap",Ph),c5={},Bh=function(){function e(t,i,r){if(i===void 0&&(i=Ah),r===void 0&&(r="ObservableSet@"+Hi()),this.name=r,this.$mobx=c5,this._data=new Set,this._atom=f0(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,n){return i(o,n,r)},t&&this.replace(t)}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.clear=function(){var t=this;rn(function(){Sy(function(){t._data.forEach(function(i){t.delete(i)})})})},e.prototype.forEach=function(t,i){var r=this;this._data.forEach(function(o){t.call(i,o,o,r)})},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(t){var i=this;if(Uu(this._atom),Qo(this)){var r=en(this,{type:"add",object:this,newValue:t});if(!r)return this}if(!this.has(t)){rn(function(){i._data.add(i.enhancer(t,void 0)),i._atom.reportChanged()});var o=yi(),n=xo(this),r=n||o?{type:"add",object:this,newValue:t}:null;o&&!1&&wr(r),n&&wo(this,r),o&&!1&&Cr()}return this},e.prototype.delete=function(t){var i=this;if(Qo(this)){var r=en(this,{type:"delete",object:this,oldValue:t});if(!r)return!1}if(this.has(t)){var o=yi(),n=xo(this),r=n||o?{type:"delete",object:this,oldValue:t}:null;return o&&!1&&wr(Di({},r,{name:this.name})),rn(function(){i._atom.reportChanged(),i._data.delete(t)}),n&&wo(this,r),o&&!1&&Cr(),!0}return!1},e.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},e.prototype.entries=function(){var t=0,i=Fn(this.keys()),r=Fn(this.values());return Rh({next:function(){var o=t;return t+=1,o<r.length?{value:[i[o],r[o]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var t=this,i=0,r;return this._data.values!==void 0?r=Fn(this._data.values()):(r=[],this._data.forEach(function(o){return r.push(o)})),Rh({next:function(){return i<r.length?{value:t.dehanceValue(r[i++]),done:!1}:{done:!0}}})},e.prototype.replace=function(t){var i=this;return Gi(t)&&(t=t.toJS()),rn(function(){Array.isArray(t)?(i.clear(),t.forEach(function(r){return i.add(r)})):Oh(t)?(i.clear(),t.forEach(function(r){return i.add(r)})):t!=null&&Pe("Cannot initialize set from "+t)}),this},e.prototype.observe=function(t,i){return zh(this,t)},e.prototype.intercept=function(t){return Lh(this,t)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+Fn(this.keys()).join(", ")+" ]"},e}();fy(Bh.prototype,function(){return this.values()});Ih(Bh.prototype,gy(),"Set");var Gi=Is("ObservableSet",Bh),tC=function(){function e(t,i,r){this.target=t,this.name=i,this.defaultEnhancer=r,this.values={}}return e.prototype.read=function(t,i){return this.target!==t&&(this.illegalAccess(t,i),!this.values[i])?void 0:this.values[i].get()},e.prototype.write=function(t,i,r){var o=this.target;o!==t&&this.illegalAccess(t,i);var n=this.values[i];if(n instanceof Rs){n.set(r);return}if(Qo(this)){var s=en(this,{type:"update",object:o,name:i,newValue:r});if(!s)return;r=s.newValue}if(r=n.prepareNewValue(r),r!==q.UNCHANGED){var a=xo(this),l=yi(),s=a||l?{type:"update",object:o,oldValue:n.value,name:i,newValue:r}:null;l&&wr(Di({},s,{name:this.name,key:i})),n.setNewValue(r),a&&wo(this,s),l&&Cr()}},e.prototype.remove=function(t){if(!this.values[t])return;var i=this.target;if(Qo(this)){var r=en(this,{object:i,name:t,type:"remove"});if(!r)return}try{yo();var o=xo(this),n=yi(),s=this.values[t].get();this.keys&&this.keys.remove(t),delete this.values[t],delete this.target[t];var r=o||n?{type:"remove",object:i,oldValue:s,name:t}:null;n&&wr(Di({},r,{name:this.name,key:t})),o&&wo(this,r),n&&Cr()}finally{vo()}},e.prototype.illegalAccess=function(t,i){console.warn("Property '"+i+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(t,i){return zh(this,t)},e.prototype.intercept=function(t){return Lh(this,t)},e.prototype.getKeys=function(){var t=this;return this.keys===void 0&&(this.keys=new Bn(Object.keys(this.values).filter(function(i){return t.values[i]instanceof Os}),Fh,"keys("+this.name+")",!0)),this.keys.slice()},e}();function Ay(e,t,i){t===void 0&&(t=""),i===void 0&&(i=Ah);var r=e.$mobx;return r||(Ka(e)||(t=(e.constructor.name||"ObservableObject")+"@"+Hi()),t||(t="ObservableObject@"+Hi()),r=new tC(e,t,i),Ih(e,"$mobx",r),r)}function v0(e,t,i,r){var o=Ay(e);if(UM(e,t),Qo(o)){var n=en(o,{object:e,name:t,type:"add",newValue:i});if(!n)return;i=n.newValue}var s=o.values[t]=new Os(i,r,o.name+"."+t,!1);i=s.value,Object.defineProperty(e,t,h5(t)),o.keys&&o.keys.push(t),p5(o,e,t,i)}function iL(e,t,i){var r=Ay(e);i.name=r.name+"."+t,i.context=e,r.values[t]=new Rs(i),Object.defineProperty(e,t,u5(t))}var iC=Object.create(null),rC=Object.create(null);function h5(e){return iC[e]||(iC[e]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}function oC(e){var t=e.$mobx;return t||(Xa(e),e.$mobx)}function u5(e){return rC[e]||(rC[e]={configurable:q.computedConfigurable,enumerable:!1,get:function(){return oC(this).read(this,e)},set:function(t){oC(this).write(this,e,t)}})}function p5(e,t,i,r){var o=xo(e),n=yi(),s=o||n?{type:"add",object:t,name:i,newValue:r}:null;n&&wr(Di({},s,{name:e.name,key:i})),o&&wo(e,s),n&&Cr()}var m5=Is("ObservableObjectAdministration",tC);function ji(e){return uy(e)?(Xa(e),m5(e.$mobx)):!1}function Vr(e,t){if(typeof e=="object"&&e!==null){if(Ii(e))return t!==void 0&&Pe(!1),e.$mobx.atom;if(Gi(e))return e.$mobx;if(li(e)){var i=e;if(t===void 0)return Vr(i._keys);var r=i._data.get(t)||i._hasMap.get(t);return r||Pe(!1),r}if(Xa(e),t&&!e.$mobx&&e[t],ji(e)){if(!t)return Pe(!1);var r=e.$mobx.values[t];return r||Pe(!1),r}if(by(e)||Bd(e)||ju(e))return e}else if(typeof e=="function"&&ju(e.$mobx))return e.$mobx;return Pe(!1)}function tn(e,t){if(e||Pe("Expecting some object"),t!==void 0)return tn(Vr(e,t));if(by(e)||Bd(e)||ju(e))return e;if(li(e)||Gi(e))return e;if(Xa(e),e.$mobx)return e.$mobx;Pe(!1)}function Vu(e,t){var i;return t!==void 0?i=Vr(e,t):ji(e)||li(e)||Gi(e)?i=tn(e):i=Vr(e),i.name}var nC=Object.prototype.toString;function vy(e,t,i){return i===void 0&&(i=-1),By(e,t,i)}function By(e,t,i,r,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var n=typeof e;if(n!=="function"&&n!=="object"&&typeof t!="object")return!1;e=sC(e),t=sC(t);var s=nC.call(e);if(s!==nC.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":return+e!==+e?+t!==+t:+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var a=s==="[object Array]";if(!a){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,d=t.constructor;if(l!==d&&!(typeof l=="function"&&l instanceof l&&typeof d=="function"&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(i===0)return!1;i<0&&(i=-1),r=r||[],o=o||[];for(var c=r.length;c--;)if(r[c]===e)return o[c]===t;if(r.push(e),o.push(t),a){if(c=e.length,c!==t.length)return!1;for(;c--;)if(!By(e[c],t[c],i-1,r,o))return!1}else{var p=Object.keys(e),h=void 0;if(c=p.length,Object.keys(t).length!==c)return!1;for(;c--;)if(h=p[c],!(f5(t,h)&&By(e[h],t[h],i-1,r,o)))return!1}return r.pop(),o.pop(),!0}function sC(e){return Ii(e)?e.peek():Rd(e)||li(e)||(Oh(e)||Gi(e))?Fn(e.entries()):e}function f5(e,t){return Object.prototype.hasOwnProperty.call(e,t)}try{}catch(e){var aC=Od();typeof process=="undefined"&&(aC.process={}),aC.process.env={}}(function(){function e(){}if(e.name!=="testCodeMinification"&&!1&&process.env.IGNORE_MOBX_MINIFY_WARNING!=="true"){var t=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+t+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var lC="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:H0,extras:{getDebugName:Vu},$mobx:lC});if(!1)var _K});var Ly=at((xK,dC)=>{var cC="Expected a function",hC=0/0,g5="[object Symbol]",b5=/^\s+|\s+$/g,y5=/^[-+]0x[0-9a-f]+$/i,v5=/^0b[01]+$/i,_5=/^0o[0-7]+$/i,x5=parseInt,w5=typeof global=="object"&&global&&global.Object===Object&&global,C5=typeof self=="object"&&self&&self.Object===Object&&self,S5=w5||C5||Function("return this")(),T5=Object.prototype,k5=T5.toString,E5=Math.max,D5=Math.min,My=function(){return S5.Date.now()};function I5(e,t,i){var r,o,n,s,a,l,d=0,c=!1,p=!1,h=!0;if(typeof e!="function")throw new TypeError(cC);t=pC(t)||0,Ku(i)&&(c=!!i.leading,p="maxWait"in i,n=p?E5(pC(i.maxWait)||0,t):n,h="trailing"in i?!!i.trailing:h);function m(k){var M=r,U=o;return r=o=void 0,d=k,s=e.apply(U,M),s}function b(k){return d=k,a=setTimeout(S,t),c?m(k):s}function _(k){var M=k-l,U=k-d,L=t-M;return p?D5(L,n-U):L}function g(k){var M=k-l,U=k-d;return l===void 0||M>=t||M<0||p&&U>=n}function S(){var k=My();if(g(k))return x(k);a=setTimeout(S,_(k))}function x(k){return a=void 0,h&&r?m(k):(r=o=void 0,s)}function C(){a!==void 0&&clearTimeout(a),d=0,r=l=o=a=void 0}function R(){return a===void 0?s:x(My())}function T(){var k=My(),M=g(k);if(r=arguments,o=this,l=k,M){if(a===void 0)return b(l);if(p)return a=setTimeout(S,t),m(l)}return a===void 0&&(a=setTimeout(S,t)),s}return T.cancel=C,T.flush=R,T}function O5(e,t,i){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(cC);return Ku(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),I5(e,t,{leading:r,maxWait:t,trailing:o})}function Ku(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function R5(e){return!!e&&typeof e=="object"}function A5(e){return typeof e=="symbol"||R5(e)&&k5.call(e)==g5}function pC(e){if(typeof e=="number")return e;if(A5(e))return hC;if(Ku(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ku(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(b5,"");var i=v5.test(e);return i||_5.test(e)?x5(e.slice(2),i?2:8):y5.test(e)?hC:+e}dC.exports=O5});var Uy=at((wK,uC)=>{var F5="Expected a function",mC=0/0,P5="[object Symbol]",B5=/^\s+|\s+$/g,M5=/^[-+]0x[0-9a-f]+$/i,L5=/^0b[01]+$/i,z5=/^0o[0-7]+$/i,N5=parseInt,U5=typeof global=="object"&&global&&global.Object===Object&&global,H5=typeof self=="object"&&self&&self.Object===Object&&self,G5=U5||H5||Function("return this")(),j5=Object.prototype,W5=j5.toString,V5=Math.max,K5=Math.min,zy=function(){return G5.Date.now()};function $5(e,t,i){var r,o,n,s,a,l,d=0,c=!1,p=!1,h=!0;if(typeof e!="function")throw new TypeError(F5);t=fC(t)||0,Ny(i)&&(c=!!i.leading,p="maxWait"in i,n=p?V5(fC(i.maxWait)||0,t):n,h="trailing"in i?!!i.trailing:h);function m(k){var M=r,U=o;return r=o=void 0,d=k,s=e.apply(U,M),s}function b(k){return d=k,a=setTimeout(S,t),c?m(k):s}function _(k){var M=k-l,U=k-d,L=t-M;return p?K5(L,n-U):L}function g(k){var M=k-l,U=k-d;return l===void 0||M>=t||M<0||p&&U>=n}function S(){var k=zy();if(g(k))return x(k);a=setTimeout(S,_(k))}function x(k){return a=void 0,h&&r?m(k):(r=o=void 0,s)}function C(){a!==void 0&&clearTimeout(a),d=0,r=l=o=a=void 0}function R(){return a===void 0?s:x(zy())}function T(){var k=zy(),M=g(k);if(r=arguments,o=this,l=k,M){if(a===void 0)return b(l);if(p)return a=setTimeout(S,t),m(l)}return a===void 0&&(a=setTimeout(S,t)),s}return T.cancel=C,T.flush=R,T}function Ny(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function q5(e){return!!e&&typeof e=="object"}function X5(e){return typeof e=="symbol"||q5(e)&&W5.call(e)==P5}function fC(e){if(typeof e=="number")return e;if(X5(e))return mC;if(Ny(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ny(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(B5,"");var i=L5.test(e);return i||z5.test(e)?N5(e.slice(2),i?2:8):M5.test(e)?mC:+e}uC.exports=$5});var SC=at((CK,gC)=>{var Y5="Expected a function",bC="__lodash_hash_undefined__",J5="[object Function]",Z5="[object GeneratorFunction]",Q5=/[\\^$.*+?()[\]{}|]/g,ez=/^\[object .+?Constructor\]$/,tz=typeof global=="object"&&global&&global.Object===Object&&global,iz=typeof self=="object"&&self&&self.Object===Object&&self,yC=tz||iz||Function("return this")();function rz(e,t){return e==null?void 0:e[t]}function oz(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch(i){}return t}var nz=Array.prototype,sz=Function.prototype,vC=Object.prototype,Hy=yC["__core-js_shared__"],_C=function(){var e=/[^.]+$/.exec(Hy&&Hy.keys&&Hy.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),xC=sz.toString,Gy=vC.hasOwnProperty,az=vC.toString,lz=RegExp("^"+xC.call(Gy).replace(Q5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dz=nz.splice,cz=wC(yC,"Map"),Hh=wC(Object,"create");function Ja(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function hz(){this.__data__=Hh?Hh(null):{}}function pz(e){return this.has(e)&&delete this.__data__[e]}function uz(e){var t=this.__data__;if(Hh){var i=t[e];return i===bC?void 0:i}return Gy.call(t,e)?t[e]:void 0}function mz(e){var t=this.__data__;return Hh?t[e]!==void 0:Gy.call(t,e)}function fz(e,t){var i=this.__data__;return i[e]=Hh&&t===void 0?bC:t,this}Ja.prototype.clear=hz;Ja.prototype.delete=pz;Ja.prototype.get=uz;Ja.prototype.has=mz;Ja.prototype.set=fz;function zd(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function gz(){this.__data__=[]}function bz(e){var t=this.__data__,i=$u(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():dz.call(t,i,1),!0}function yz(e){var t=this.__data__,i=$u(t,e);return i<0?void 0:t[i][1]}function vz(e){return $u(this.__data__,e)>-1}function _z(e,t){var i=this.__data__,r=$u(i,e);return r<0?i.push([e,t]):i[r][1]=t,this}zd.prototype.clear=gz;zd.prototype.delete=bz;zd.prototype.get=yz;zd.prototype.has=vz;zd.prototype.set=_z;function Za(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function xz(){this.__data__={hash:new Ja,map:new(cz||zd),string:new Ja}}function wz(e){return qu(this,e).delete(e)}function Cz(e){return qu(this,e).get(e)}function Sz(e){return qu(this,e).has(e)}function Tz(e,t){return qu(this,e).set(e,t),this}Za.prototype.clear=xz;Za.prototype.delete=wz;Za.prototype.get=Cz;Za.prototype.has=Sz;Za.prototype.set=Tz;function $u(e,t){for(var i=e.length;i--;)if(kz(e[i][0],t))return i;return-1}function Oz(e){if(!CC(e)||Ez(e))return!1;var t=Iz(e)||oz(e)?lz:ez;return t.test(Dz(e))}function qu(e,t){var i=e.__data__;return Rz(t)?i[typeof t=="string"?"string":"hash"]:i.map}function wC(e,t){var i=rz(e,t);return Oz(i)?i:void 0}function Rz(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ez(e){return!!_C&&_C in e}function Dz(e){if(e!=null){try{return xC.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function jy(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(Y5);var i=function(){var r=arguments,o=t?t.apply(this,r):r[0],n=i.cache;if(n.has(o))return n.get(o);var s=e.apply(this,r);return i.cache=n.set(o,s),s};return i.cache=new(jy.Cache||Za),i}jy.Cache=Za;function kz(e,t){return e===t||e!==e&&t!==t}function Iz(e){var t=CC(e)?az.call(e):"";return t==J5||t==Z5}function CC(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}gC.exports=jy});var kC=at((SK,TC)=>{var Az=!!(typeof window!="undefined"&&window.document&&window.document.createElement);TC.exports=Az});var Wy=at(Fz=>{ut(Fz,{Deserializer:()=>Oi,Serializer:()=>Qa})});var DC=at(Pz=>{ut(Pz,{Color:()=>Kr,ColorPicker:()=>EC})});var Yu=at(Bz=>{ut(Bz,{AdvancedUI:()=>IC,CardLabel:()=>Mz,ToolbarItem:()=>Xu});const{CardLabel:Mz}=B});var Vy=at(Lz=>{ut(Lz,{BasicUI:()=>OC})});var oS=at(zz=>{ut(zz,{AdjustmentConfiguration:()=>cm,AdjustmentIdentifier:()=>Re,AdvancedUICardLabel:()=>Hd.CardLabel,AdvancedUICategoryCard:()=>XC,AdvancedUIItemCard:()=>YC,AdvancedUIToolbarItem:()=>Hd.ToolbarItem,BlendMode:()=>ye,BrushConfiguration:()=>dm,CanvasAction:()=>he,CanvasBarTextSecondaryButton:()=>Gh,CardType:()=>pe,CategoryHeaderType:()=>Ft,Checkbox:()=>VC,CheckboxBase:()=>KC,CheckboxCheckMark:()=>qC,CheckboxInput:()=>$C,ColorItem:()=>RC,ColorItemActiveOverlay:()=>BC,ColorItemBackground:()=>FC,ColorItemBase:()=>AC,ColorItemTiledBackground:()=>PC,Configuration:()=>eS,ContainedPrimaryButton:()=>Ud,Dialog:()=>MC,DialogBackdrop:()=>NC,DialogBase:()=>LC,DialogBody:()=>HC,DialogContainer:()=>zC,DialogFooter:()=>GC,DialogHeader:()=>UC,DialogSpinner:()=>jC,EventEmitter:()=>Tr,ExportConfiguration:()=>tS,ExportFormat:()=>ci,FilterConfiguration:()=>am,FocusConfiguration:()=>sm,FocusIdentifier:()=>Ce,FrameConfiguration:()=>nm,IconButton:()=>on,ImageFormat:()=>Ut,Label:()=>WC,LibraryCategory:()=>QC,LibraryConfiguration:()=>om,LibraryImage:()=>ZC,LibraryProvider:()=>JC,ModalType:()=>ot,OutlinedPrimaryButton:()=>Nd,OutlinedSecondaryButton:()=>Mn,OverlayConfiguration:()=>rm,PhotoEditorSDKUI:()=>Ky,PhotoEditorSDKUIComponent:()=>$y,SerializationExportType:()=>pm,SnappingConfiguration:()=>hm,SpriteActionButton:()=>Co,StickerConfiguration:()=>im,TextConfiguration:()=>Qu,TextDesignConfiguration:()=>Zu,TextPrimaryButton:()=>Ms,TextSecondaryButton:()=>$r,Tool:()=>w,TransformConfiguration:()=>Ju,TransformIdentifier:()=>Et,UIEvent:()=>Ie,deepmergeAll:()=>Sr,defaultConfig:()=>Gd,isDuoToneFilterAsset:()=>el,isExistingCategory:()=>rS,isExistingItem:()=>iS,isGoogleFontAsset:()=>tm,isLUTFilterAsset:()=>lm,isStickerAssetDynamic:()=>Ls,isStickerCategoryDynamic:()=>jd,isWebFontAsset:()=>em})});const nS={react:"React","react-dom":"ReactDOM","styled-components":"styled"};window.require=e=>{if(Object.hasOwnProperty.call(nS,e)){const t=nS[e];if(Object.hasOwnProperty.call(window,t))return window[t];console.log(`Cannot find umd script for ${e}`)}return};const jh=()=>window&&window.navigator&&window.navigator.userAgent||"",tl=(e=jh())=>e.indexOf("Edge")!==-1,ti=(e=jh())=>!!e.match(/msie|trident/i),sS=(e=jh())=>!!e.match(/windows/i),aS=(e=jh())=>e.indexOf("Safari")!==-1&&e.indexOf("Chrome")===-1,lS=(e=jh())=>!!e.match(/iP(hone|od|ad)|AppleWebKit/),dS=()=>{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext};function iS(e){return!Object.prototype.hasOwnProperty.call(e,"name")}function rS(e){return!Object.prototype.hasOwnProperty.call(e,"name")}var he;(function(e){e.UNDO="undo",e.REDO="redo",e.DELETE="delete",e.BRING_TO_FRONT="bringtofront",e.EDIT="edit",e.DUPLICATE="duplicate",e.ADD="add",e.FLIP="flip",e.INVERT="invert",e.CLOSE="close",e.EXPORT="export"})(he||(he={}));var w;(function(e){e.LIBRARY="library",e.ART_FILTER="artFilter",e.TRANSFORM="transform",e.FILTER="filter",e.ADJUSTMENT="adjustment",e.FOCUS="focus",e.STICKER="sticker",e.TEXT="text",e.TEXT_DESIGN="textdesign",e.OVERLAY="overlay",e.FRAME="frame",e.BRUSH="brush"})(w||(w={}));var Ft;(function(e){e.TEXT="text",e.CARD="card"})(Ft||(Ft={}));var pe;(function(e){e.LARGE="large",e.MEDIUM="medium",e.SMALL="small"})(pe||(pe={}));var ot;(function(e){e.ERROR="error",e.WARNING="warning",e.INFO="info",e.TEXT_EDIT="textEdit"})(ot||(ot={}));class Nz{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}}class Uz{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}}class hm{constructor(){this.position=new Nz;this.rotation=new Uz}}var pm;(function(e){e.OBJECT="object"})(pm||(pm={}));class tS{}var ci;(function(e){e.IMAGE="image",e.DATA_URL="data-url",e.BLOB="blob",e.MSBLOB="ms-blob"})(ci||(ci={}));var Ut;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.RAW="raw"})(Ut||(Ut={}));class eS{constructor(){this.order="default";this.language="en";this.theme="dark";this.assetBaseUrl="assets/";this.displayResizeWarning=!0;this.displayCloseWarning=!0;this.displayCanvasRendererWarning=!0;this.displayToolControlBarTitle=!0;this.forceCrop=!1;this.enableZoom=!0;this.defaultTool=w.FILTER}}w.FILTER,w.FOCUS,w.ADJUSTMENT,w.LIBRARY,w.OVERLAY,w.STICKER,w.TEXT,w.TEXT_DESIGN,w.FRAME,w.BRUSH,w.TRANSFORM;var Re;(function(e){e.BRIGHTNESS="brightness",e.CONTRAST="contrast",e.SATURATION="saturation",e.CLARITY="clarity",e.SHADOWS="shadows",e.HIGHLIGHTS="highlights",e.EXPOSURE="exposure",e.GAMMA="gamma",e.BLACKS="blacks",e.WHITES="whites",e.TEMPERATURE="temperature",e.SHARPNESS="sharpness"})(Re||(Re={}));class cm{constructor(){this.categories=[];this.flattenCategories=!1}}class am{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=Ft.CARD;this.enablePreviewThumbnails=!1}}function el(e){return e.lightColor!==void 0}function lm(e){return e.lutURI!==void 0}class sm{constructor(){this.items=[]}}var Ce;(function(e){e.RADIAL="radial",e.LINEAR="linear",e.MIRRORED="mirrored",e.GAUSSIAN="gaussian"})(Ce||(Ce={}));class nm{constructor(){this.items=[]}}class QC{constructor(e){this.name=e.name,this.coverImageUrl=e.coverImageUrl}loadCoverImage(e="anonymous"){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.coverImage}`))}),r.crossOrigin=e,r.src=this.coverImageUrl,this.coverImage=r})}}class ZC{constructor(e){this.category=e.title,this.thumbUrl=e.thumbUrl,this.rawUrl=e.rawUrl}loadThumbImage(e="anonymous"){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.thumbUrl}`))}),r.crossOrigin=e,r.src=this.thumbUrl,this.thumbImage=r})}getThumbImage(){return this.thumbUrl}}class om{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.flattenCategories=!1;this.categoryHeaderType=Ft.CARD}}class qy{getData(e){return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="json",r.onload=()=>{const{status:o}=r;o===200?t(r.response):i(new Error(`HTTP Status ${o}`))},r.send()})}}class JC{constructor(e){this.data={};this.data=e}loadJSON(e){const t=new qy;return t.getData(e)}getCategories(){return Promise.resolve([])}searchImages(e){return Promise.resolve([])}}class rm{constructor(){this.items=[]}}var ye;(function(e){e.NORMAL="normal",e.OVERLAY="overlay",e.SOFT_LIGHT="softLight",e.HARD_LIGHT="hardLight",e.MULTIPLY="multiply",e.DARKEN="darken",e.COLOR_BURN="colorBurn",e.SCREEN="screen",e.LIGHTEN="lighten"})(ye||(ye={}));class im{constructor(){this.categories=[];this.canvasActions=[he.BRING_TO_FRONT,he.FLIP,he.DUPLICATE,he.DELETE];this.flattenCategories=!1;this.categoryHeaderType=Ft.CARD;this.enableCustomUpload=!0;this.customStickerTintMode="none"}}function Ls(e){return e.sticker!==void 0}function jd(e){return e.thumbnail!==void 0}class Qu{constructor(){this.fonts=[];this.canvasActions=[he.EDIT,he.BRING_TO_FRONT,he.DUPLICATE,he.DELETE];this.disableAutoScaling=!1}}function em(e){return e.provider===void 0||e.provider==="file"}function tm(e){return e.provider==="google"}class dm{constructor(){this.defaultSize=.05;this.defaultHardness=.5}}class Zu{constructor(){this.items=[];this.canvasActions=[he.EDIT,he.BRING_TO_FRONT,he.INVERT,he.DUPLICATE,he.DELETE]}}class Ju{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=Ft.TEXT}}var Et;(function(e){e.CommonCategory="imgly_transforms_common",e.FacebookCategory="imgly_transforms_facebook",e.TwitterCategory="imgly_transforms_twitter",e.InstagramCategory="imgly_transforms_instagram",e.Custom="imgly_transform_common_custom",e.Square="imgly_transform_common_square",e.ThreeByFour="imgly_transform_common_3",e.FourByThree="imgly_transform_common_4",e.NineBySixteen="imgly_transform_common_9",e.SixteenByNine="imgly_transform_common_16",e.FacebookPost="imgly_transform_facebook_post",e.FacebookProfile="imgly_transform_facebook_profile",e.FacebookTitle="imgly_transform_facebook_title",e.InstagramLandscape="imgly_transform_instagram_landscape",e.InstagramPortrait="imgly_transform_instagram_portrait",e.InstagramSquare="imgly_transform_instagram_square",e.InstagramStory="imgly_transform_instagram_story",e.TwitterPost="imgly_transform_twitter_post",e.TwitterProfile="imgly_transform_twitter_profile",e.TwitterTitle="imgly_transform_twitter_title"})(Et||(Et={}));var Ie;(function(e){e.EXPORT="export",e.CLOSE="close",e.HISTORY_CHANGE="historyChange",e.EDITOR_READY="editorReady",e.ERROR_IMAGE_LOADING="errorImageLoading"})(Ie||(Ie={}));class Tr{constructor(){this.events={}}addListener(e,t){const i=this.events[e]||(this.events[e]=[]);return i.push(t),this}removeListener(e,t){const i=this.events[e];if(!i)return this;const r=i.lastIndexOf(t);return r===-1?this:(i.splice(r,1),this)}removeAllListeners(e){return this.events[e]=void 0,this}on(e,t){return this.addListener(e,t)}off(e,t){return this.removeListener(e,t)}emit(e,...t){const i=this.events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}}const Hz=[{identifier:"imgly_overlay_golden",name:"Golden",defaultBlendMode:ye.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:"imgly_overlay_lightleak1",name:"Lightleak",defaultBlendMode:ye.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:"imgly_overlay_rain",name:"Rain",defaultBlendMode:ye.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:"imgly_overlay_mosaic",name:"Mosaic",defaultBlendMode:ye.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:"imgly_overlay_vintage",name:"Vintage",defaultBlendMode:ye.DARKEN,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:"imgly_overlay_paper",name:"Paper",defaultBlendMode:ye.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:"imgly_overlay_bokeh",name:"Bokeh",defaultBlendMode:ye.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:"imgly_overlay_hearts",name:"Hearts",defaultBlendMode:ye.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:"imgly_overlay_lightleak2",name:"Lightleak 2",defaultBlendMode:ye.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:"imgly_overlay_wood",name:"Wood",defaultBlendMode:ye.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:"imgly_overlay_chop",name:"Chop",defaultBlendMode:ye.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:"imgly_overlay_metal",name:"Metal",defaultBlendMode:ye.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:"imgly_overlay_painting",name:"Painting",defaultBlendMode:ye.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:"imgly_overlay_grain",name:"Grain",defaultBlendMode:ye.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:"imgly_overlay_clouds",name:"Clouds",defaultBlendMode:ye.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:"imgly_overlay_wall1",name:"Wall",defaultBlendMode:ye.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:"imgly_overlay_wall2",name:"Wall 2",defaultBlendMode:ye.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}];var um=Hz;const Gz=[{identifier:"imgly_filter_category_duotone",name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:"imgly_duotone_desert",name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:"imgly_duotone_peach",name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:"imgly_duotone_clash",name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:"imgly_duotone_plum",name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:"imgly_duotone_breezy",name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:"imgly_duotone_deepblue",name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:"imgly_duotone_frog",name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:"imgly_duotone_sunset",name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:"imgly_filter_category_bw",name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:"imgly_lut_ad1920",name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_bw",name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_x400",name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_litho",name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_sepiahigh",name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_plate",name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_sin",name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filter_category_vintage",name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:"imgly_lut_blues",name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_front",name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:"imgly_filter_category_smooth",name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:"imgly_lut_chest",name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_kdynamic",name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_fall",name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_lenin",name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_pola669",name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:"imgly_filter_category_cold",name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:"imgly_lut_elder",name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_orchid",name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_bleached",name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_bleachedblue",name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_breeze",name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_blueshadows",name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:"imgly_filter_category_warm",name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:"imgly_lut_sunset",name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_eighties",name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_evening",name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_k2",name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:"imgly_filter_category_legacy",name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:"imgly_lut_ancient",name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_cottoncandy",name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_classic",name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_colorful",name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_creamy",name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_fixie",name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_fridge",name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_gobblin",name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_highcontrast",name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_highcarb",name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_k1",name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_k6",name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_keen",name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_lomo",name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_lucid",name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_mellow",name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_pale",name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_pitched",name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_polasx",name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_pro400",name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_quozi",name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_settled",name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_seventies",name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_soft",name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_steel",name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_summer",name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_tender",name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:"imgly_lut_twilight",name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}];var mm=Gz;const jz=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-640}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1919,descender:-409}},{identifier:"imgly_font_amaticsc",fontFamily:"Amaticsc",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2332,descender:-583}},{identifier:"imgly_font_bernier_regular",fontFamily:"Bernier",fontWeight:"normal",fontURI:"./fonts/imgly_font_bernier_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2007,descender:-552}},{identifier:"imgly_font_cheque_regular",fontFamily:"Cheque",fontWeight:"normal",fontURI:"./fonts/imgly_font_cheque_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2007,descender:-552}},{identifier:"imgly_font_gagalin_regular",fontFamily:"Gagalin",fontWeight:"normal",fontURI:"./fonts/imgly_font_gagalin_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1987,descender:-628}},{identifier:"imgly_font_hagin_caps_thin",fontFamily:"Hagin Caps",fontWeight:200,fontURI:"./fonts/imgly_font_hagin_caps_thin.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1964,descender:-482}},{identifier:"imgly_font_intro_inline",fontFamily:"Intro Inline",fontWeight:"normal",fontURI:"./fonts/imgly_font_intro_inline.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1944,descender:-548}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2048,descender:-552}},{identifier:"imgly_font_nexa_script",fontFamily:"Nexa Script",fontWeight:"normal",fontURI:"./fonts/imgly_font_nexa_script.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:903,descender:-297}},{identifier:"imgly_font_panton_blackitalic_caps",fontFamily:"Panton",fontWeight:800,fontStyle:"italic",fontURI:"./fonts/imgly_font_panton_blackitalic_caps.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-572}},{identifier:"imgly_font_panton_lightitalic_caps",fontFamily:"Panton",fontWeight:200,fontStyle:"italic",fontURI:"./fonts/imgly_font_panton_lightitalic_caps.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1961,descender:-556}},{identifier:"imgly_font_perfograma",fontFamily:"Perfograma",fontWeight:"normal",fontURI:"./fonts/imgly_font_perfograma.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1982,descender:-842}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1554,descender:-663}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1849,descender:-1123}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2272,descender:-686}},{identifier:"imgly_font_panton_light_italic_caps",fontFamily:"Panton Caps",fontWeight:"lighter",fontStyle:"italic",fontURI:"./fonts/imgly_font_panton_light_italic_caps.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_black_italic_caps",fontFamily:"Panton Caps",fontWeight:800,fontStyle:"italic",fontURI:"./fonts/imgly_font_panton_black_italic_caps.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_light_caps",fontFamily:"Panton Caps",fontWeight:"lighter",fontStyle:"normal",fontURI:"./fonts/imgly_font_panton_light_caps.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_black_caps",fontFamily:"Panton Caps",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_panton_black_caps.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_summer_font_light",fontFamily:"Summer Font",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_summer_font_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}];var Xy=jz;const Wz=[{identifier:Ce.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:Ce.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:Ce.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:Ce.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}];var Yy=Wz;const Vz=[{identifier:"basics",name:"Basics",items:[{identifier:Re.BRIGHTNESS},{identifier:Re.CONTRAST},{identifier:Re.SATURATION},{identifier:Re.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:Re.CLARITY},{identifier:Re.SHADOWS},{identifier:Re.HIGHLIGHTS},{identifier:Re.EXPOSURE},{identifier:Re.BLACKS},{identifier:Re.WHITES},{identifier:Re.TEMPERATURE},{identifier:Re.SHARPNESS}]}];var fm=Vz;const Kz=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}];var gm=Kz;const $z=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var cS=$z;const qz=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var hS=qz;const Xz=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}];var bm=Xz;const Yz=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:!0,lockDimensions:!0}]}];var ym=Yz;const pS=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_bernier_regular","imgly_font_cheque_regular","imgly_font_gagalin_regular","imgly_font_hagin_caps_thin","imgly_font_intro_inline","imgly_font_lobster","imgly_font_nexa_script","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_panton_blackitalic_caps","imgly_font_panton_lightitalic_caps","imgly_font_perfograma","imgly_font_trash_hand"],uS=["imgly_font_abril_fatface_regular","imgly_font_montserrat_light","imgly_font_wolesbro","imgly_font_permanent_marker","imgly_font_panton_light_italic_caps","imgly_font_panton_black_italic_caps","imgly_font_panton_light_caps","imgly_font_panton_black_caps","imgly_font_amberlight","imgly_font_ultra","imgly_font_galano_grotesque_bold","imgly_font_bungee_inline","imgly_font_petit_formal_script","imgly_font_summer_font_light","imgly_font_handycheera_regular","imgly_font_rasa_regular","imgly_font_rasa_500","imgly_font_campton_bold","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy"];const zs=e=>{try{return new URL(e),!0}catch(t){return!1}};function mS(){if(typeof navigator=="undefined")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}function So(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})}const PX=window.performance.now.bind(window.performance);class vm{constructor(e){this.text=e;this.lastOffsetWidth=-1;const t="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div"),this.element.setAttribute("aria-hidden","true"),this.element.appendChild(document.createTextNode(e)),this.collapsible=document.createElement("span"),this.expandable=document.createElement("span"),this.collapsibleInner=document.createElement("span"),this.expandableInner=document.createElement("span"),this.collapsible.style.cssText=t,this.expandable.style.cssText=t,this.expandableInner.style.cssText=t,this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.collapsible.appendChild(this.collapsibleInner),this.expandable.appendChild(this.expandableInner),this.element.appendChild(this.collapsible),this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(e){this.element.style.cssText=`max-width:none;
      min-width:20px;
      min-height:20px;
      display:inline-block;
      overflow:hidden;
      position:absolute;
      width:auto;
      margin:0;
      padding:0;
      top:-999px;
      white-space:nowrap;
      font-synthesis:none;
      font:${e};`}getWidth(){return this.element.offsetWidth}setWidth(e){this.element.style.width=`${e}px`}onResize(e){const t=()=>{this.onScroll(e)};this.collapsible.addEventListener("scroll",t),this.expandable.addEventListener("scroll",t),this.reset()}reset(){const e=this.getWidth(),t=e+100;return this.expandableInner.style.width=`${t}px`,this.expandable.scrollLeft=t,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==e?(this.lastOffsetWidth=e,!0):!1}onScroll(e){this.reset()&&this.element.parentNode!==null&&e(this.lastOffsetWidth)}}class lt{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(lt.HAS_WEBKIT_FALLBACK_BUG===null){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(lt.getUserAgent());lt.HAS_WEBKIT_FALLBACK_BUG=!!e&&(parseInt(e[1],10)<536||parseInt(e[1],10)===536&&parseInt(e[2],10)<=11)}return lt.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(lt.HAS_SAFARI_10_BUG===null)if(lt.supportsNativeFontLoading()&&/Apple/.test(lt.getNavigatorVendor())){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(lt.getUserAgent());lt.HAS_SAFARI_10_BUG=!!e&&parseInt(e[1],10)<603}else lt.HAS_SAFARI_10_BUG=!1;return lt.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){return lt.SUPPORTS_NATIVE_FONT_LOADING===null&&(lt.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),lt.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(lt.SUPPORTS_STRETCH===null){const e=document.createElement("div");try{e.style.font="condensend 100px sans-serif"}catch(t){lt.SUPPORTS_STRETCH=!1}lt.SUPPORTS_STRETCH=e.style.font!==""}return lt.SUPPORTS_STRETCH}constructor(e){this.font=y({fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal"},e)}load(e,t){const i="BESbswy";let r=null;const o=t||lt.DEFAULT_TIMEOUT,n=this.getTime();return new Promise((s,a)=>{if(lt.supportsNativeFontLoading()&&!lt.hasSafari10Bug()){const l=new Promise((c,p)=>{const h=()=>{const m=this.getTime();m-n>=o?p(new Error(""+o+"ms timeout exceeded")):document.fonts.load(this.getStyle(`"${this.font.fontFamily}"`),i).then(b=>{b.length>=1?c():setTimeout(h,25)},a)};h()}),d=new Promise((c,p)=>{r=setTimeout(()=>{p(new Error(`${o} ms timeout exceeded`))},o)});Promise.race([d,l]).then(()=>{clearTimeout(r),s(this)},a)}else{const l=new vm(i),d=new vm(i),c=new vm(i);let p=-1,h=-1,m=-1,b=-1,_=-1,g=-1;const S=document.createElement("div"),x=()=>{S.parentNode!==null&&S.parentNode.removeChild(S)},C=()=>{if((p!==-1&&h!==-1||p!==-1&&m!==-1||h!==-1&&m!==-1)&&(p===h||p===m||h===m)){if(lt.hasWebKitFallbackBug()&&(p===b&&h===b&&m===b||p===_&&h===_&&m===_||p===g&&h===g&&m===g))return;x(),clearTimeout(r),s(this)}};S.dir="ltr",l.setFont(this.getStyle("sans-serif")),d.setFont(this.getStyle("serif")),c.setFont(this.getStyle("monospace")),S.appendChild(l.getElement()),S.appendChild(d.getElement()),S.appendChild(c.getElement()),document.body.appendChild(S),b=l.getWidth(),_=d.getWidth(),g=c.getWidth();const R=()=>{const T=this.getTime();if(T-n>=o)x(),a(new Error(`${o} ms timeout exceeded`));else{const k=document.hidden;(k===!0||k===void 0)&&(p=l.getWidth(),h=d.getWidth(),m=c.getWidth(),C()),r=setTimeout(R,50)}};R(),l.onResize(T=>{p=T,C()}),l.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`)),d.onResize(T=>{h=T,C()}),d.setFont(this.getStyle(`"${this.font.fontFamily}",serif`)),c.onResize(T=>{m=T,C()}),c.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}})}getStyle(e){return[this.font.fontStyle,this.font.fontWeight,lt.supportsStretch()?this.font.fontStretch:"","100px",e].join(" ")}getTime(){return new Date().getTime()}}lt.HAS_WEBKIT_FALLBACK_BUG=null,lt.HAS_SAFARI_10_BUG=null,lt.SUPPORTS_STRETCH=null,lt.SUPPORTS_NATIVE_FONT_LOADING=null,lt.DEFAULT_TIMEOUT=3e3;class E{static fromSize(e){return new E(e.width,e.height)}static distance(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}static dot(e,t){return e.x*t.x+e.y*t.y}static lerp(e,t,i){const r=Math.min(Math.max(i,0),1);return new E(e.x*r+t.x*(1-r),e.y*r+t.y*(1-r))}static lerpUnclamped(e,t,i){return new E(e.x*i+t.x*(1-i),e.y*i+t.y*(1-i))}static proportionalFit(e,t){const i=e.x/e.y,r=t.x/t.y;return i>r?t.multiply(e.y/t.y):t.multiply(e.x/t.x)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){const e=this.magnitude;return new E(this.x/e,this.y/e)}get floored(){return new E(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new E(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new E(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new E(this.y,this.x)}constructor(e,t){typeof e=="number"?(this.x=e,this.y=t):(this.x=e.x,this.y=e.y)}clone(){return new E(this.x,this.y)}add(e,t){return typeof e=="number"?new E(this.x+e,this.y+t):new E(this.x+e.x,this.y+e.y)}subtract(e,t){return typeof e=="number"?new E(this.x-e,this.y-t):new E(this.x-e.x,this.y-e.y)}multiply(e,t){return typeof e=="number"?new E(this.x*e,this.y*(t===void 0?e:t)):new E(this.x*e.x,this.y*e.y)}divide(e,t){return typeof e=="number"?new E(this.x/e,this.y/(t===void 0?e:t)):new E(this.x/e.x,this.y/e.y)}equals(e){return this.x===e.x&&this.y===e.y}clamp(e,t){const i=Math.max(e.x,Math.min(t.x,this.x)),r=Math.max(e.y,Math.min(t.y,this.y));return new E(i,r)}}E.ZERO=new E(0,0),E.ONE=new E(1,1),E.UP=new E(0,1),E.DOWN=new E(0,-1),E.RIGHT=new E(1,0),E.LEFT=new E(-1,0);var Ln;(function(e){e.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",e.IMAGE_DOWNSCALED="imageDownscaled"})(Ln||(Ln={}));class _m extends Tr{constructor(e,t){super();this.image=e,this.options=t}needsResize(){const e=this.resizedDimensions();return e.x<this.image.width||e.y<this.image.height}resizedDimensions(){const{options:e}=this,t={width:this.image.width,height:this.image.height};let i=E.fromSize(t),r=E.fromSize(t);const{maxMegaPixels:o}=e;if(o){const a=(mS()?o.mobile:o.desktop)*1e6,l=t.width/t.height,d=t.height/t.width,c=new E(Math.floor(Math.sqrt(a*l)),Math.floor(Math.sqrt(a*d)));c.x<=t.width&&c.y<=t.height&&(i=c)}const n=e.maxDimensions;n&&((n.height<t.height||n.width<t.width)&&(r=new E(n.width,n.height)));const s=new E(Math.min(i.x,r.x),Math.min(i.y,r.y));return E.proportionalFit(s,E.fromSize(t)).floored}downscaleIfNecessary(){const e=this.resizedDimensions(),t=e.x<this.image.width||e.y<this.image.height;if(!t)return this.image;this.emit(Ln.BEGAN_IMAGE_DOWNSCALING,this.image);const i=document.createElement("canvas");i.width=e.x,i.height=e.y;const r=i.getContext("2d"),{image:o}=this;return r.drawImage(o,0,0,o.width,o.height,0,0,e.x,e.y),this.emit(Ln.IMAGE_DOWNSCALED),i}downscaleImageIfNecessary(){const e=this.image,t=this.resizedDimensions(),i=t.x<this.image.width||t.y<this.image.height;if(!i)return e;this.emit(Ln.BEGAN_IMAGE_DOWNSCALING,e);const r=new Image;return r.width=t.x,r.height=t.y,r.src=e.src,this.emit(Ln.IMAGE_DOWNSCALED),r}}const Zz=e=>e.key==="Enter",Qz=e=>e.key==="Escape",fS=e=>t=>{Zz(t)&&e(t)},gS=e=>t=>{Qz(t)&&e(t)};var xm;(function(e){e[e.EditorContainer=0]="EditorContainer",e[e.ToolControlBar=1]="ToolControlBar",e[e.CanvasContainer=2]="CanvasContainer",e[e.Canvas=3]="Canvas",e[e.MainBarButtonClose=4]="MainBarButtonClose",e[e.Tooltip=5]="Tooltip",e[e.Cursor=6]="Cursor",e[e.CursorContainer=7]="CursorContainer"})(xm||(xm={}));const bS={};for(const e in xm){const t=xm[e];typeof t=="string"&&(bS[t]=t)}const hi=bS,yS=Boolean(window.Cypress);function e4(e,t){let i=0;for(let r=e.length-1;r>=0;r--){const o=e[r];o==="."?e.splice(r,1):o===".."?(e.splice(r,1),i++):i&&(e.splice(r,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function t4(e){return e.charAt(0)==="/"}function i4(e){const t=t4(e),i=e.substr(-1)==="/";return e=e4(e.split("/").filter(Boolean),!t).join("/"),!e&&!t&&(e="."),e&&i&&(e+="/"),(t?"/":"")+e}const Wh=(...e)=>i4(e.join("/"));const Jy=(e,t,[i,r],o=0)=>{const n=e[t];if(n){if(n<i)return console.error(`${t} must be greater than or equal to ${i}`),i;if(n>r)return console.error(`${t} must be less than or equal to ${r}`),r}return n||o};const r4={italic:"i"};class Zy{constructor(e){this.assetManager=e;this.injectedFonts={};this.loadedFonts={};this.getGoogleFamiliesString=e=>{const t=e.reduce((i,r)=>{const{fontFamily:o,fontStyle:n,fontWeight:s=400}=r;return i[o]=(i[o]||[]).concat(`${s}${r4[n]||""}`),i},{});return Object.keys(t).map(i=>{const r=t[i].length?`:${t[i].join(",")}`:"",o=i.replace(" ","+")+r;return o}).join("|")}}static createFontFacesCSS(e,t){return e.map(i=>{const r=t(i.fontURI);return`@font-face {
        font-family: "${i.fontFamily}";
        src: url('${r}') format('${i.format||"woff"}');
        font-weight: ${i.fontWeight||"normal"};
        font-style: ${i.fontStyle||"normal"};
      }`})}getFontWithId(e){const t=this.assetManager.getFontAsset(e);if(!t)throw new Error("The requested font does not exist as an asset.");return t}isFontLoaded(e){return this.loadedFonts[e]!==void 0}injectAllFonts(){const e=this.assetManager.getFontAssets();this.injectFonts(e)}loadAllFonts(){return Z(this,null,function*(){const e=this.assetManager.getFontAssets();return this.loadFonts(e)})}loadFontsWithIdentifiers(e){return Z(this,null,function*(){const t=e.map(i=>this.getFontWithId(i));return this.loadFonts(t)})}loadFonts(e){return Z(this,null,function*(){this.injectFonts(e);const t=new Array;return e.forEach(i=>{t.push(this.loadFont(i,!1))}),new Promise((i,r)=>{Promise.all(t).then(()=>i()).catch(o=>r(o))})})}loadFont(e,t=!0){return Z(this,null,function*(){return new Promise((i,r)=>{this.isFontLoaded(e.identifier)&&i(),t&&this.injectFonts([e]);const o=new lt(e);o.load().then(()=>{this.loadedFonts[e.identifier]=e,i()}).catch(()=>{r(e.identifier)})})})}loadFontWithIdentifier(e,t=!0){return Z(this,null,function*(){const i=this.assetManager.getFontAsset(e);if(!i)throw new Error(`The requested font asset with identifier ${e} does not exist!`);return this.loadFont(i,t)})}injectFonts(e,t=this.assetManager.getPathForCategory("font")){const i=e.filter(tm),r=e.filter(em);i.length>0&&this.addGoogleFontLinks(i),r.length>0&&this.addWebFontCSS(r,t)}addGoogleFontLinks(e){const t=e.filter(n=>!this.injectedFonts[n.identifier]);if(t.length===0)return;const i=this.getGoogleFamiliesString(t),r=document.createElement("link");r.rel="stylesheet",r.href=`https://fonts.googleapis.com/css?family=${i}`;const o=document.getElementsByTagName("head")[0];o.appendChild(r),e.forEach(n=>{this.injectedFonts[n.identifier]=n})}addWebFontCSS(e,t){const i=e.filter(s=>!this.injectedFonts[s.identifier]);if(i.length===0)return;const r=Zy.createFontFacesCSS(i,t),o=`
      /* Injected by PhotoEditorSDK */
      ${r.join(`
`)}
    `,n=document.createElement("style");n.innerHTML=o,document.head.appendChild(n),e.forEach(s=>{this.injectedFonts[s.identifier]=s})}}class wm{constructor(e,t=!1){this.basePath="assets/";this.areCustomAssetsAllowed=!1;this.getAssets=e=>{switch(e){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories}return[]};this.getPath=(e,...t)=>{const i=Wh(e,...t);if(t&&t.length!==0&&zs(Wh(...t)))return Wh(...t);if((!t||t.length===0)&&zs(e))return e;if(this.basePath.match(/(ftp|http|https):\/\//)){const{length:r}=this.basePath;return this.basePath[r-1]!=="/"&&(this.basePath=`${this.basePath}/`),this.basePath+i}return Wh(this.basePath,i)};this.getPathForCategory=e=>(...t)=>this.getPath(e,...t);this.addCustomStickerAsset=(e,t,i)=>{e.forEach(r=>{const{thumbnailURI:o,name:n,sticker:s,identifier:a,tintMode:l,resizeMode:d}=r,c=this.stickerCategories.find(h=>h.identifier===t),p={identifier:a,name:n,thumbnailURI:o,sticker:s,tintMode:l,resizeMode:d};if(c&&jd(c))c.items.push(p);else{const h={identifier:t,name:i,thumbnail:o,items:[p]};this.stickerCategories=[h,...this.stickerCategories]}}),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(e,t,i)=>{const r=e.find(o=>o.identifier===t);return r&&(r[i]||r.path)||""};this.isNonExistingFont=e=>!Xy.find(t=>t.identifier===e.identifier);e&&e.basePath&&(this.basePath=e.basePath),this.areCustomAssetsAllowed=t;const i=mm.reduce(this.allOptions,[]);e&&e.filter?this.filterCategories=this.configuredCategory(mm,e.filter,i):this.filterCategories=mm,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>lm(d)),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>el(d));const r=fm.reduce(this.allOptions,[]);e&&e.adjustment?this.adjustmentCategories=this.configuredCategory(fm,e.adjustment,r):this.adjustmentCategories=fm,this.fontAssets=Xy.reduce(this.allOptions,[]);let o=pS.map(d=>this.getFontAsset(d));if(e&&e.text&&e.text.fonts&&e.text.fonts.length>0){const d=e.text.fonts.filter(this.isNonExistingFont),c=e.text.fonts.filter(p=>!this.isNonExistingFont(p)).map(p=>this.getFontAsset(p.identifier));o=e.text.fonts?[...c,...d]:o,this.fontAssets=e.text.fonts?[...this.fontAssets,...d]:this.fontAssets}this.textToolFontAssets=o;const n=e&&e.focus&&e.focus.items&&e.focus.items.length?e.focus.items.map(d=>Yy.find(c=>c.identifier===d.identifier)):Yy;this.focusAssets=n,e&&e.overlay&&e.overlay.items?this.overlayAssets=this.configuredItem(e.overlay.items,um,um):this.overlayAssets=um,e&&e.frame&&e.frame.items?this.frameAssets=this.configuredItem(e.frame.items,bm,bm):this.frameAssets=bm;const s=gm.reduce(this.allOptions,[]);e&&e.sticker?this.stickerCategories=this.configuredCategory(gm,e.sticker,s):this.stickerCategories=gm,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let a=cS;e&&e.theme==="light"&&(a=hS),this.textDesignAssets=e&&e.textdesign&&e.textdesign.items&&e.textdesign.items.length?e.textdesign.items.map(d=>a.find(c=>c.identifier===d.identifier)):a,this.textDesignToolFontAssets=uS.map(d=>this.getFontAsset(d));const l=ym.reduce(this.allOptions,[]);e&&e.transform?this.transformCategories=this.configuredCategory(ym,e.transform,l):this.transformCategories=ym,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new Zy(this)}getFontManager(){return this.fontManager}getAssetSource(e,t){switch(e){case"filter":const i=this.getLUTFilterAsset(t);if(i)return this.getPath(e,this.getItemPath(this.lutFilterAssets,t,"lutURI"));break;case"overlay":return this.getPath(e,this.getItemPath(this.overlayAssets,t,"overlayURI"));case"font":return this.getPath(e,this.getItemPath(this.fontAssets,t,"fontURI"));case"sticker":const r=this.stickerAssets.find(o=>o.identifier===t);if(r){if(Ls(r))return r.sticker;if(t.includes("imgly_sticker")&&r.stickerURI.includes(".svg")&&ti()){const o=this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI")),n=o.split("/");return n.splice(n.length-1,0,"base"),n[n.length-1]=n[n.length-1].replace(".svg",".png"),n.join("/")}return this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(e,"engine",t);case"frame":return this.getPath(e,t)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(e){return this.duoToneFilterAssets.filter(t=>t.identifier===e)[0]}getLUTFilterAsset(e){return this.lutFilterAssets.filter(t=>t.identifier===e)[0]}getOverlayAsset(e){return this.overlayAssets.filter(t=>t.identifier===e)[0]}getStickerAsset(e){return this.stickerAssets.filter(t=>t.identifier===e)[0]}getFontAsset(e){return this.fontAssets.filter(t=>t.identifier===e)[0]}getTextDesignAssets(e){return this.textDesignAssets.filter(t=>t.identifier===e)[0]}getFrameAsset(e){return this.frameAssets.filter(t=>t.identifier===e)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(e,t){return Object.prototype.hasOwnProperty.call(t,"items")?[...e,...t.items]:[...e,t]}configuredCategory(e,t,i){return t.categories&&t.categories.length?t.categories.reduce((r,o)=>{const n=e.find(s=>s.identifier===o.identifier);return n?r.push(y(y(y({},n),o),{items:this.configuredItem(o.items,i,n.items).filter(Boolean)})):this.areCustomAssetsAllowed&&r.push(y(y({},o),{items:this.configuredItem(o.items,i,o.items).filter(Boolean)})),r},[]):e}configuredItem(e,t,i){return e&&e.length?e.reduce((r,o)=>{const n=t.find(s=>s.identifier===o.identifier);return n?r.push(y(y({},n),o)):this.areCustomAssetsAllowed&&r.push(o),r},[]).filter(Boolean):i}}class qt{static contains(e,t){return t.x>=e.minX&&t.x<=e.maxX&&t.y>=e.minY&&t.y<=e.maxY}constructor(e,t,i,r){if(typeof e=="number")if(typeof t=="number"&&i!==void 0&&r!==void 0)this.origin={x:e,y:t},this.size={width:i||0,height:r||0};else throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)");else{if(this.origin=e,typeof t=="number")throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)");this.size=t}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}}qt.ZERO=new qt({x:0,y:0},{width:0,height:0});class ve{constructor(e,t,i,r,o,n){this.a=e;this.b=t;this.c=i;this.d=r;this.tx=o;this.ty=n}static fromScale(e,t){return new ve(e,0,0,t,0,0)}static fromRotation(e){const t=Math.cos(e),i=Math.sin(e);return new ve(t,-i,i,t,0,0)}static fromRotationDeg(e){const t=Math.PI*e/180;return this.fromRotation(t)}static fromTranslation(e,t){return new ve(1,0,0,1,e,t)}static fromTRS(e,t,i,r,o){const n=Math.cos(i),s=Math.sin(i);return new ve(r*n,-o*s,r*s,o*n,e,t)}static multiply(e,t){const i=e.a*t.a+e.b*t.c,r=e.a*t.b+e.b*t.d,o=e.c*t.a+e.d*t.c,n=e.c*t.b+e.d*t.d,s=e.a*t.tx+e.b*t.ty+e.tx,a=e.c*t.tx+e.d*t.ty+e.ty;return new ve(i,r,o,n,s,a)}static transformPoint(e,t){return{x:e.a*t.x+e.b*t.y+e.tx,y:e.c*t.x+e.d*t.y+e.ty}}static getInverted(e){const t=e.a*e.d-e.b*e.c;if(t===0)return e;const i=1/t,r=i*e.d,o=-i*e.b,n=-i*e.c,s=i*e.a,a=i*(e.b*e.ty-e.d*e.tx),l=i*(e.c*e.tx-e.a*e.ty);return new ve(r,o,n,s,a,l)}}ve.IDENTITY=ve.fromScale(1,1);function nn(e){return typeof e=="number"}class mt{static get IDENTITY(){return new mt({x:0,y:0})}constructor(e,t={x:1,y:1},i=0){this.position=e,this.scale=t,this.rotation=i}}const Ns="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o4={encode(e){let t="",i,r,o,n,s,a,l,d=0;do i=e[d++],r=e[d++],o=e[d++],n=i>>2,s=(i&3)<<4|r>>4,a=(r&15)<<2|o>>6,l=o&63,isNaN(r)?a=l=64:isNaN(o)&&(l=64),t=t+Ns.charAt(n)+Ns.charAt(s)+Ns.charAt(a)+Ns.charAt(l),i=r=o="",n=s=a=l="";while(d<e.length);return t},decode(e){let t,i,r,o,n,s,a,l=0,d=[];var c=/[^A-Za-z0-9+/=]/g;if(c.exec(e))throw new Error(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`);e=e.replace(/[^A-Za-z0-9+/=]/g,"");do o=Ns.indexOf(e.charAt(l++)),n=Ns.indexOf(e.charAt(l++)),s=Ns.indexOf(e.charAt(l++)),a=Ns.indexOf(e.charAt(l++)),t=o<<2|n>>4,i=(n&15)<<4|s>>2,r=(s&3)<<6|a,d.push(t),s!==64&&d.push(i),a!==64&&d.push(r),t=i=r="",o=n=s=a="";while(l<e.length);return d}};var kr=o4;class vS{static head(e){return e[0]}static tail(e){return e.slice(1)}static last(e){return e[e.length-1]}static init(e){return e.slice(0,e.length-1)}static remove(e,t){return e.filter((i,r,o)=>!t(i,r,o))}static findIndex(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i;return-1}static find(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return e[i];return}static flatten(e){return e.reduce(function(t,i){return t.concat(Array.isArray(i)?vS.flatten(i):i)},[])}static range(e,t){let i=[];if(t>e)for(let r=e;r<t;r++)i.push(r);return i}static repeat(e,t){let i=[];for(let r=0;r<t;r++)i[r]=e;return i}static zip(e,t){let i=Math.min(e.length,t.length),r=[];for(let o=0;o<i;o++)r[o]=[e[o],t[o]];return r}}var _S=vS;class Us{static isArray(e){return Object.prototype.toString.call(e)==="[object Array]"}static mapRange(e,t,i){return(e-t.getMin())*i.getLength()/t.getLength()+i.getMin()}static isPlainObject(e){if(typeof e!="object"||!e)return!1;if(typeof Object.getPrototypeOf=="function"){let t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}static isMobile(){if(typeof navigator=="undefined")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}static isBrowser(){return typeof window!="undefined"}static isNode(){return typeof window=="undefined"&&typeof global!="undefined"}static values(e){var t=[];for(var i in e)t.push(e[i]);return t}static generateUUID(){var e=new Date().getTime();return typeof window.performance!="undefined"&&typeof window.performance.now=="function"&&(e+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="x"?i:i&3|8).toString(16)})}static isDOMElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}static isTouchEvent(e){return e.type.indexOf("touch")!==-1}static resizeVectorToFit(e,t){const i=Math.min(t.x/e.x,t.y/e.y),r=e.clone().multiply(i);return r}static resizeVectorToFill(e,t){const i=e.x/e.y,r=t.x/t.y;return i>r?t.clone().set(t.y*i,t.y):t.clone().set(t.x,t.x/i)}static isExtendable(e){return typeof e!="undefined"&&e!==null&&(typeof e=="object"||typeof e=="function")}static defaults(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(let n in o)typeof i[n]=="undefined"&&(i[n]=o[n])}return i}static deepMerge(e,...t){const i=(r,o)=>{if(o===void 0)return i(null,r);if(Array.isArray(o))return[...o];if(!Us.isPlainObject(o))return o;if(!Us.isPlainObject(r))return y({},o);let n=y({},r);return Object.keys(o).forEach(s=>{let a=o[s];if(a===void 0)return;n[s]=i(r[s],a)}),n};return t.reduce(i,e)}static deepDefaults(e,...t){const i=[...t].reverse();return Us.deepMerge(...i,e)}static deepClone(e){let t={};for(let i in e)Us.isExtendable(e[i])?t[i]=Us.deepClone(e[i]):t[i]=e[i];return t}static getDeepProperty(e,t){if(typeof t=="string")return e[t];if(!Array.isArray(t))return;const i=(r,o)=>{let n;try{n=o(r)}catch(s){if(!(s instanceof TypeError))throw s}return n};return t.reduce((r,o)=>r?typeof o=="function"?i(r,o):r[o]:null,e)}static extend(e,...t){let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(let n in o)i[n]=o[n]}return i}static clone(e){return this.extend({},e)}static createBlobURIFromDataURI(e){const t=typeof window=="undefined"?global:window;if(!t.Blob||!t.URL||!ArrayBuffer||!Uint8Array)return e;const i=kr.decode(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(i.length),n=new Uint8Array(o);for(let a=0;a<i.length;a++)n[a]=i[a];const s=new t.Blob([o],{type:r});return t.URL.createObjectURL(s)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})}static createCanvas(){return document.createElement("canvas")}static convertHtmlImageToRGBACanvas(e,t){const i=t||Us.createCanvas();i.width=e.width,i.height=e.height;const r=i.getContext("2d");return r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0,e.width,e.height),i}static isPowerOfTwo(e){return(e.x&e.x-1)===0&&(e.y&e.y-1)===0}static nextLowestPOT(e){for(var t=1;t<32;t<<=1)e=e|e>>t;return e-(e>>1)}static nextHighestPOT(e){e--;for(var t=1;t<32;t<<=1)e=e|e>>t;return e+1}static moveArrayItem(e,t,i){if(i>=e.length){let r=i-e.length;for(;r--+1;)e.push(void 0)}e.splice(i,0,e.splice(t,1)[0])}static ensureCanvasDimensions(e,t){return e.width!==t.x||e.height!==t.y?(e.width=t.x,e.height=t.y,!0):!1}static byteArrayToString(e){return e.map(t=>String.fromCharCode(t)).join("")}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static wildCardMatch(e,t){return new RegExp("^"+t.split("*").join(".*")+"$").test(e)}static flipObject(e){const t={};for(let i in e)t[e[i]]=i;return t}static cloneOptions(e){const t={};for(let i in e){let r=e[i];Array.isArray(r)?r=r.slice():r.clone&&(r=r.clone()),t[i]=r}return t}static ISODateString(e){function t(i){return i<10?"0"+i:i}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"}static getCrossOriginValue(e){return e?e==="none"?void 0:e:"anonymous"}static shallowEqual(e,t){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(var o=hasOwnProperty.bind(t),n=0;n<i.length;n++)if(!o(i[n])||e[i[n]]!==t[i[n]])return!1;return!0}static enableIf(e,t){return e?t:void 0}static invariant(e,t){if(!e){const i=new Error(t);throw i}}static executePromises(e){let t=e.length,i=0,r=[],o=[];return new Promise((n,s)=>{const a=()=>{i++,i>=t&&(o.length<=0?n(r):s(o))},l=c=>{r.push(c),a()},d=c=>{o.push(c),a()};e.forEach(c=>{c.then(l).catch(d)})})}}Us.Array=_S;var F=Us;const n4=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],xS=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,s4=()=>typeof navigator!="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/),a4=(e,t)=>["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${e}; color: ${t}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"];class l4{constructor(e="warn",t=n4){this._levels=[...t],this._maxLevel=this.getLevelIndexByName(e),this._consoleFuncs={trace:(...i)=>{xS()?(console.groupCollapsed(...i),console.trace(),console.groupEnd()):console.trace(...i)}},this._levels.forEach(({name:i})=>{this[i]=(r,...o)=>{this._log(i,r,...o)}})}getLevelIndexByName(e){return F.Array.findIndex(this._levels,t=>t.name===e)}getLevelObjectByName(e){return F.Array.find(this._levels,t=>t.name===e)}canLog(e){const t=this.getLevelIndexByName(e);return t<0?!1:t>=this._maxLevel}setLevel(e){const t=this.getLevelIndexByName(e);if(t<0)return;this._maxLevel=t}_log(e,t,...i){const r=this.getLevelObjectByName(e);if(!r||!this.canLog(e))return;const{name:o,type:n,background:s,color:a}=r,l=i.filter(h=>h!==void 0).map(h=>h.toObject?JSON.parse(JSON.stringify(h.toObject())):h),d=this._consoleFuncs[n]||console[n]?(...h)=>console[n](...h):(...h)=>console.log(...h),c=l.length,p=a4(s,a);if(!s4()){const h=l.length;if(h<=0){d(`PhotoEditorSDK | ${t} `);return}if(h===1&&typeof l[0]=="string"){d(`PhotoEditorSDK | ${t} | ${l[0]}`);return}d(`PhotoEditorSDK | ${t} | `,...l);return}if(c<=0){d(`%c  %c PhotoEditorSDK %c  %c ${t} %c %c  `,...p);return}if(c===1&&typeof l[0]=="string"){d(`%c  %c PhotoEditorSDK %c  %c ${t} %c  ${l[0]}  %c  `,...p);return}xS()?(console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...F.Array.init(p)),d(...l),console.groupEnd()):d(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...F.Array.init(p),...l)}image(e="",t){{let i=new window.Image;const r=()=>{const{width:o}=i,{height:n}=i;e&&console.log(e),console.log("%c+",`
        font-size: 1px;
        padding: 0px ${Math.floor(o/2)}px;
        line-height: ${n}px;
        background: url(${i.src});
        color: transparent;
        background-repeat: no-repeat;
        background-size: ${o}px ${n}px;`)};return i.onload=r,t instanceof window.HTMLCanvasElement?i.src=t.toDataURL():t instanceof window.Image?(i=t,r()):typeof t=="string"?i.src=t:this.log(e,t),i}}texture(e="",t){{if(!t){this.log(e,"texture: null or undefined");return}const i=t.getBaseTexture(),r=i.getRenderers(),o=F.Array.find(r,a=>a&&a.constructor.type==="WebGL"),{width:n,height:s}=i.getFrame();if(o){const a=o.getContext(),l=i.getGLTextureForRenderer(o);this.logGlTexture(a,l,n,s,e)}else Qy.image(e,i.getSource())}}logGlTexture(e,t,i=150,r=150,o){{e.bindTexture(e.TEXTURE_2D,t);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);const s=new Uint8Array(i*r*4);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,s),e.deleteFramebuffer(n);const a=document.createElement("canvas");a.width=i,a.height=r;const l=a.getContext("2d"),d=l.createImageData(i,r);return d.data.set(s),l.putImageData(d,0,0),Qy.image(o,a)}}}const Qy=new l4("warn");var W=Qy;class qr{constructor(e,t,i,r=1){this.r=e,this.g=t,this.b=i,this.a=r}toRGBA(){var e=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)];return"rgba("+e.join(",")+")"}set(e,t,i,r=this.a){return this.r=e,this.g=t,this.b=i,this.a=r,this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){var e=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return"#"+e.join("")}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){let e=Math.max(this.r,this.g,this.b),t=Math.min(this.r,this.g,this.b),i,r,o=e,n=e-t;if(r=e===0?0:n/e,e===t)i=0;else{switch(e){case this.r:i=(this.g-this.b)/n,this.g<this.b&&(i+=6);break;case this.g:i=(this.b-this.r)/n+2;break;case this.b:i=(this.r-this.g)/n+4;break}i/=6}return[i,r,o]}fromHSV(e,t,i){return this.copy(qr.fromHSV(e,t,i)),this}static fromHSV(e,t,i,r=1){let[o,n,s]=[],a=Math.floor(e*6),l=e*6-a,d=i*(1-t),c=i*(1-l*t),p=i*(1-(1-l)*t);switch(a%6){case 0:o=i,n=p,s=d;break;case 1:o=c,n=i,s=d;break;case 2:o=d,n=i,s=p;break;case 3:o=d,n=c,s=i;break;case 4:o=p,n=d,s=i;break;case 5:o=i,n=d,s=c;break}return new qr(o,n,s,r)}static fromArray(e){return new qr(e[0],e[1],e[2],e[3])}static fromHex(e){const[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new qr(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}clone(){return new qr(this.r,this.g,this.b,this.a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}minus(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}divideScalar(e){return this.r/=e,this.g/=e,this.b/=e,this.a/=e,this}clamp(e,t){return this.r=Math.min(Math.max(this.r,e),t),this.g=Math.min(Math.max(this.g,e),t),this.b=Math.min(Math.max(this.b,e),t),this.a=Math.min(Math.max(this.a,e),t),this}mix(e,t){return this.r=(1-t)*this.r+t*e.r,this.g=(1-t)*this.g+t*e.g,this.b=(1-t)*this.b+t*e.b,this.a=(1-t)*this.a+t*e.a,this}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}_componentToHex(e){var t=e.toString(16);return t.length===1?"0"+t:t}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new qr(0,0,0,0)}static get WHITE(){return new qr(1,1,1,1)}static get BLACK(){return new qr(0,0,0,1)}static get RED(){return new qr(1,0,0,1)}static get BLUE(){return new qr(0,0,1,1)}static get GREEN(){return new qr(0,1,0,1)}}var N=qr;class ar{constructor(e,t){this.x=e,this.y=t,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0)}set(e,t){return this.x=e,this.y=t,this}clone(){return new ar(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}clamp(e,t){let i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof ar)&&i&&(e=new ar(e,e)),!(t instanceof ar)&&r&&(t=new ar(t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y)),this}divide(e,t){return e instanceof ar?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=typeof t=="undefined"?e:t),this}subtract(e,t){return e instanceof ar?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=typeof t=="undefined"?e:t),this}multiply(e,t){return e instanceof ar?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=typeof t=="undefined"?e:t),this}add(e,t){return e instanceof ar?(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=typeof t=="undefined"?e:t),this}dot(e,t){return e instanceof ar?this.x*e.x+this.y*e.y:this.x*e+this.y*(typeof t=="undefined"?e:t)}equals(e,t){return e instanceof ar?e.x===this.x&&e.y===this.y:e===this.x&&t===this.y}flip(){let e=this.x;return this.x=this.y,this.y=e,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x=this.x|0,this.y=this.y|0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this}asArray(e=!1){return e?[this.y,this.x]:[this.x,this.y]}static fromObject(e){return new ar(e.x,e.y)}static get NULL(){return new ar(0,0)}}var re=ar;class wS{constructor(){this.reset()}multiply(e){let t,i,r,o,n,s;return t=this.a*e.a+this.b*e.c,i=this.a*e.b+this.b*e.d,r=this.c*e.a+this.d*e.c,o=this.c*e.b+this.d*e.d,n=this.tx*e.a+this.ty*e.c+e.tx,s=this.tx*e.b+this.ty*e.d+e.ty,this.a=t,this.b=i,this.c=r,this.d=o,this.tx=n,this.ty=s,this}applyToVector(e){const{x:t,y:i}=e;return e=e.clone(),e.x=this.a*t+this.c*i+this.tx,e.y=this.b*t+this.d*i+this.tx,e}applyInverseToVector(e){const t=1/(this.a*this.d+this.c*-this.b),{x:i,y:r}=e;return e=e.clone(),e.x=this.d*t*i+-this.c*t*r+(this.ty*this.c-this.tx*this.d)*t,e.y=this.a*t*r+-this.b*t*i+(-this.ty*this.a+this.tx*this.b)*t,e}rectangleToCoordinates(e,t=new re(0,0)){const i=e.width*(1-t.x),r=e.width*-t.x,o=e.height*(1-t.y),n=e.height*-t.y;let s=[];return s.push(new re(this.a*r+this.c*n+this.tx,this.d*n+this.b*r+this.ty)),s.push(new re(this.a*i+this.c*n+this.tx,this.d*n+this.b*i+this.ty)),s.push(new re(this.a*i+this.c*o+this.tx,this.d*o+this.b*i+this.ty)),s.push(new re(this.a*r+this.c*o+this.tx,this.d*o+this.b*r+this.ty)),s}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){const e=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return typeof Float32Array=="undefined"?e:new Float32Array(e)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new wS}}var Xr=wS;class Cm{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r}set(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this}clone(){return new Cm(this.x,this.y,this.width,this.height)}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}equals(e,t,i,r){if(e instanceof Cm)return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height;{const o=e;return o===this.x&&t===this.y&&i===this.width&&r===this.height}}translate(e,t){return e instanceof re&&(t=e.y,e=e.x),this.x+=e,this.y+=t,this}scale(e,t){return e instanceof re?(t=e.y,e=e.x):t===void 0&&(t=e),this.width*=e,this.height*=t,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new re(this.x,this.y)}getSize(){return new re(this.width,this.height)}insetBy(e,t){return this.x+=e,this.y+=t,this.width-=2*e,this.height-=2*t,this}intersects(e){let t=new re(this.x,this.y),i=new re(this.x+this.width,this.y+this.height),r=new re(e.x,e.y),o=new re(e.x+e.width,e.y+e.height);return!(r.x>i.x||t.x>o.x||o.y<t.y||i.y<r.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(e,t){let i=!1;t.x-e.x<0&&(i=!0);const r=i?t:e,o=i?e:t,n=o.x-r.x,s=o.y-r.y;return new Cm(r.x,r.y,n,s)}}var Qe=Cm;const d4=12;class c4{constructor(){this._maxListeners=d4,this._events={},this._pipeDestinations=[]}pipeEvents(e){this._pipeDestinations.push(e)}unpipeEvents(e){const t=this._pipeDestinations.indexOf(e);if(t===-1)return;this._pipeDestinations.splice(t,1)}on(e,t){if(typeof e=="undefined")throw new Error("Invalid event type: `"+e+"`");if(typeof t!="function")throw new TypeError;let i=this._events[e]||(this._events[e]=[]);return i.indexOf(t)!==-1?this:(i.push(t),this._maxListeners&&i.length>this._maxListeners&&(W.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${e}\` listeners (current limit is ${this._maxListeners})`),typeof console!="undefined"&&console.trace()),this)}once(e,t){if(typeof e=="undefined")throw new Error("Invalid event type: `"+e+"`");let i=this;function r(){i.off(e,r),t.apply(null,arguments)}return this.on(e,r)}off(e,...t){if(typeof e=="undefined")throw new Error("Invalid event type: `"+e+"`");if(t.length===0)return this._events[e]=null,this;let i=t[0];if(typeof i!="function")throw new TypeError;let r=this._events[e];if(!r||!r.length)return this;let o=r.indexOf(i);return o===-1?this:(r.splice(o,1),this)}emit(e,...t){if(typeof e=="undefined")throw new Error("Invalid event type: `"+e+"`");this._pipeDestinations.forEach(r=>{r.emit(e,...t)});let i=this._events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}setMaxListeners(e){if(parseInt(e,10)!==e)throw new TypeError;this._maxListeners=e}}var Ri=c4;var To={checkFramebufferStatus(e,t){const i=t.checkFramebufferStatus(t.FRAMEBUFFER),r={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[t.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};i!==t.FRAMEBUFFER_COMPLETE&&W.warn(e,`Framebuffer incomplete: ${r[i]}`)},determineGPUName(e){let t=null,i=null;e||(i=document.createElement("canvas"),e=i.getContext("experimental-webgl")||i.getContext("webgl"));const r=e&&e.getExtension("WEBGL_debug_renderer_info");return r&&(t=e.getParameter(r.UNMASKED_RENDERER_WEBGL),i&&i.remove()),t},isGPUBlacklisted(e,t=null){return!1}};const Dt={};ut(Dt,{ImageFormat:()=>il,OptionType:()=>f,RenderType:()=>Er,RendererType:()=>Ee,UniformType:()=>z});const Er={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},il={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"},f={NUMBER:"number",VECTOR2:"vector2",COLOR_MATRIX:"color-matrix",COLOR:"color",ARRAY:"array",OBJECT:"object",STRING:"string",BOOLEAN:"boolean",CONFIGURABLE:"configurable",IMAGE:"image",FUNCTION:"function",TEXTURE:"texture",ALL:"*"},z={SAMPLER2D:"sampler2d",INT:"i",INT1:"1i",INT2:"2i",INT3:"3i",INT4:"4i",FLOAT:"f",FLOAT1:"1f",FLOAT2:"2f",FLOAT_VECTOR2:"2fv",FLOAT3:"3f",FLOAT4:"4f",MAT3:"mat3",MAT3FV:"mat3fv",MAT4:"mat4"},Ee={WEBGL:"webgl",CANVAS:"canvas"};const ev={};ut(ev,{BATCH_SIZE:()=>rl,Color:()=>N,Constants:()=>Dt,EventEmitter:()=>Ri,GLUtils:()=>To,Log:()=>W,Matrix:()=>Xr,Rectangle:()=>Qe,Utils:()=>F,VERTEX_BYTE_SIZE:()=>zn,VERTEX_SIZE:()=>CS,Vector2:()=>re});const rl=2e3,CS=5,zn=CS*4;const SS=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Sh();class h4{constructor(e){this._context=e,this._tracking=!1;const t=this;for(let i in e){let r=e[i];typeof r=="function"?this[i]=function(...o){const n=e[i];if(!t._tracking)return n.apply(e,o);const s=SS(),a=n.apply(e,o),l=SS()-s,d={functionName:i,arguments:o,duration:l};return t._trackedCalls.push(d),a}:this._makePropertyWrapper(i)}}_makePropertyWrapper(e){const t=["_context","_trackedCalls","_tracking"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){const e="Rendering";W.log(e,"Frame rendering results:"),W.log(e,`Context calls: ${this._trackedCalls.length}`);const t={};this._trackedCalls.forEach(({functionName:r,duration:o})=>{t[r]=t[r]||{totalDuration:0,calls:0},t[r].totalDuration+=o,t[r].calls++});let i=[];for(let r in t){const o=t[r];o.averageDuration=o.totalDuration/o.calls,i.push({functionName:r,data:o})}i.sort((r,o)=>o.data.totalDuration-r.data.totalDuration),i=i.slice(0,3),i.forEach(r=>{W.log(e,`${r.functionName}: ${r.data.calls} calls, ${r.data.totalDuration.toFixed(2)}ms`)})}}var Sm=h4;const p4={defaults:(e,...t)=>{let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(let n in o)typeof i[n]=="undefined"&&(i[n]=o[n])}return i},extend:(e,...t)=>{let i={};for(let r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(let n in o)i[n]=o[n]}return i}};var TS=p4;class u4 extends Ri{constructor(e,t,i={}){super();this._options=TS.defaults(i,{pixelRatio:1,transparent:!1,clearColor:N.BLACK}),this.setMaxListeners(0),this._width=e||800,this._height=t||600,this._dimensions=new re(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._clearColor=this._options.transparent?N.TRANSPARENT:this._options.clearColor||N.BLACK}setCanvas(e){const t=this._canvas;this._canvas=e,t!==e&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new re(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(e,t=!0){this._width=e.x*this._pixelRatio,this._height=e.y*this._pixelRatio,t&&(this._canvas.width=this._width,this._canvas.height=this._height,this._canvas.style&&(this._canvas.style.width=`${this._width/this._pixelRatio}px`,this._canvas.style.height=`${this._height/this._pixelRatio}px`)),this._dimensions=e.clone()}_createContext(){W.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){W.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(e){W.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(e)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(e){this._filterManager=e}static isSupported(){return!0}isOfType(e){return this._type===e}dispose(){W.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}var Tm=u4;class gt extends Ri{constructor(e){super();this.id=gt.id++,this._onSourceLoaded=this._onSourceLoaded.bind(this),this._renderers=[],this._glTextures={},this._source=e,this._dirty=!0,this._glUnit=0,this._mipMapping=!1,this._magFilter=gt.DefaultMagFilter,this._minFilter=gt.DefaultMinFilter,this._repeatX=gt.ClampToEdge,this._repeatY=gt.ClampToEdge,this._pixelRatio=1,this._loaded=!1,this._frame=new Qe(0,0,100,100),e&&this._loadSource()}resizeTo(e){if(this._frame.width===e.x&&this._frame.height===e.y)return;this._frame.width=e.x,this._frame.height=e.y,this._dirty=!0}_loadSource(){const e=this._source,t=e.complete,i=e.constructor.name==="Canvas"||e.tagName&&e.tagName.toUpperCase()==="CANVAS";if(t||i)return this._onSourceLoaded();e.addEventListener&&e.addEventListener("load",this._onSourceLoaded)}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){const e=new re(this._source.width,this._source.height);F.isPowerOfTwo(e)?(W.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=gt.TrilinearFilter,this._mipMapping=!0):(this._minFilter=gt.LinearFilter,this._mipMapping=!1)}update(){(this._frame.width!==this._source.width||this._frame.height!==this._source.height)&&(this._frame=new Qe(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update")}getRenderers(){return[...this._renderers]}getGLFilter(e,t){switch(t){case"min":return this.constructor.getGLFilter(e,this._minFilter);case"mag":return this.constructor.getGLFilter(e,this._magFilter)}}static getGLFilter(e,t){switch(t){case gt.LinearFilter:return e.LINEAR;case gt.NearestFilter:return e.NEAREST;case gt.BilinearFilter:return e.LINEAR_MIPMAP_NEAREST;case gt.TrilinearFilter:return e.LINEAR_MIPMAP_LINEAR}}isLoaded(){return this._loaded}setLoaded(e){this._loaded=e}getSource(){return this._source}setSource(e){this._source=e}getGLTextureForRenderer(e){return this._glTextures[e.id]}setGLTextureForRenderer(e,t){this._renderers[t.id]=t,this._glTextures[t.id]=e}getFrame(){return this._frame}setFrame(e){this._frame=e}getDimensions(){return new re(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getGLUnit(){return this._glUnit}setGLUnit(e){this._glUnit=e}setMinFilter(e){this._minFilter=e}getMinFilter(){return this._minFilter}setMagFilter(e){this._magFilter=e}getMagFilter(){return this._magFilter}setRepeatX(e){this._repeatX=e}getRepeatX(){return this._repeatX}setRepeatY(e){this._repeatY=e}getRepeatY(){return this._repeatY}getGLRepeat(e,t){const i=t==="x"?this.getRepeatX():this.getRepeatY();switch(i){case gt.ClampToEdge:return e.CLAMP_TO_EDGE;case gt.Repeat:return e.REPEAT;case gt.MirroredRepeat:return e.MIRRORED_REPEAT}}isDirty(){return this._dirty}setDirty(e){this._dirty=e}disposeGLTextures(){this._renderers.forEach(e=>{this.disposeGLTexturesForRenderer(e)})}disposeGLTexturesForRenderer(e){if(!this._glTextures[e.id])return;const t=e.getContext();t.deleteTexture(this._glTextures[e.id]),delete this._glTextures[e.id],this._renderers[e.id]||delete this._renderers[e.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(e){this._mipMapping=e}dispose(e=null){this.disposeGLTextures(),this._source=void 0}}gt.NearestFilter=0;gt.LinearFilter=1;gt.BilinearFilter=2;gt.TrilinearFilter=3;gt.DefaultMagFilter=gt.NearestFilter;gt.DefaultMinFilter=gt.LinearFilter;gt.ClampToEdge=0;gt.Repeat=1;gt.MirroredRepeat=2;gt.id=0;var Wi=gt;class m4{constructor(e,t,i,r,o){this._width=e,this._height=t,this._pixelRatio=i,this._baseTexture=new Wi,this._canvas=r||this._createCanvas(),this._context=o||this._canvas.getContext("2d"),this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filter:[]}]}_createCanvas(){return F.createCanvas()}clear(){const e=this._context;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(e){this._baseTexture.resizeTo(e),this._width!==e.x&&(this._width=e.x,this._canvas.width=this._width*this._pixelRatio),this._height!==e.y&&(this._height=e.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getDimensions(){return new re(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){this._canvas=null,this._context=null,this._baseTexture.dispose()}}var Hs=m4;class f4{constructor(e){this._renderer=e,this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}],this._currentFrame=null,this._textures=[],this._textureFrame=new Qe(0,0,e.getWidth(),e.getHeight())}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._textures.forEach(t=>t.resizeTo(e))}pushFilters(e,t){const i=e.getBounds();this._currentFrame=i;const r=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(r),this._filterStack.push({renderTarget:r,filters:t}),r.clear()}popFilters(){const{filters:e,renderTarget:t}=this._filterStack.pop(),i=this._filterStack[this._filterStack.length-1],r=t,o=i.renderTarget;return e.length===1?(e[0].apply(this._renderer,r,o),this._textures.push(r)):this._applyFilters(e,r,o),e}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0);const n=e[e.length-1];e.forEach((s,a)=>{const l=s===n;if(l)s.apply(this._renderer,r,i);else{s.apply(this._renderer,r,o);let d=r;r=o,o=d}}),this._textures.push(r),this._textures.push(o)}_getOrCreateRenderTarget(e){let t=this._textures.pop();return t||(t=new Hs(this._textureFrame.width,this._textureFrame.height,1)),e&&t.clear(),t}setFilterStack(e){this._filterStack=e}dispose(){}}var Wd=f4;const{RendererType:g4}=Dt;class km extends Tm{constructor(...e){super(...e);this._type=g4.CANVAS,this.setCanvas(this._options.canvas||this._createCanvas())}_createCanvas(){return F.createCanvas()}_createContext(){const e=this._canvas;let t=e.getContext("2d");return this._options.debug&&(t=new Sm(t)),this.id=t.id=km.contextId++,this._context=t,t.renderer=this,this.emit("context",t),t}_setupContext(){const e=this._context;"imageSmoothingEnabled"in e?e.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(t=>{e[t]&&(e[t]=!0)}),this._defaultRenderTarget=new Hs(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new Wd(this)}render(e){const t=this._renderTarget.getContext(),i=e.getParent();e.setParent(this._fakeObject),e.updateTransform(),e.setParent(i),t.setTransform(1,0,0,1,0,0),t.globalAlpha=1;const{width:r,height:o}=this._canvas;t.clearRect(0,0,r,o),this._clearColor.a!==0&&(t.save(),t.fillStyle=this._clearColor.toRGBA(),t.fillRect(0,0,r,o),t.restore()),this.renderDisplayObject(e,this._renderTarget)}renderDisplayObject(e,t){const i=this._renderTarget;this._filterManager.setFilterStack(t.getFilterStack()),this.setRenderTarget(t),e.renderCanvas(this),this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(e){this._renderTarget=e}getContext(){return this._renderTarget.getContext()}dispose(){this._filterManager.dispose()}}km.contextId=0;km.type="Canvas2D";var tv=km;class b4{constructor(e,t,i,r,o=!1){this._renderer=e,this._gl=e.getContext(),this._width=t,this._height=i,this._frame=null,this._pixelRatio=r,this._projectionMatrix=new Xr,this._mipMapping=!1,this._baseTexture=new Wi;const n=this._baseTexture.getFrame();n.width=t,n.height=i,this._baseTexture.setPixelRatio(r),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=o,this._filterStack=[{renderTarget:this,filter:[]}],o||this._initFrameBuffer()}resizeTo(e){this._width=e.x|0,this._height=e.y|0,this._baseTexture.resizeTo(e),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let e=Wi.DefaultMinFilter;return this._mipMapping&&(e=Wi.TrilinearFilter),e}_getMagFilter(){return Wi.DefaultMagFilter}_resizeTexture(){const e=this._gl,t=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&To.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e);const r=new re(this._width,this._height);F.isPowerOfTwo(r)?(W.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),e.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),e.disable(e.STENCIL_TEST)}clear(e=N.TRANSPARENT){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&To.checkFramebufferStatus("WebGLRenderTarget#clear",t),t.clearColor.apply(t,e.toGLColor()),t.clear(t.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){const e=this._projectionMatrix;e.reset();const t=this._frame||new Qe(0,0,this._width,this._height),{x:i,y:r}=t;this._isRoot?(e.a=1/this._width*2,e.d=-1/this._height*2,e.tx=-1-i*e.a,e.ty=1-r*e.d):(e.a=1/this._width*2,e.d=1/this._height*2,e.tx=-1-i*e.a,e.ty=-1-r*e.d)}_initFrameBuffer(){const e=this._gl;this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._framebuffer=e.createFramebuffer(),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new re(this._width,this._height)),this._renderer._options.debug&&To.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(e){this._frame=e}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){const e=this._gl;this._baseTexture.dispose(),this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null)}}var Gs=b4;class y4{constructor(e){this._renderer=e,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),this._renderer=null}}var Em=y4;class v4 extends Em{constructor(...e){super(...e);this._maxBatchSize=rl,this._vertices=new ArrayBuffer(rl*4*zn),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(rl*6);for(var t=0,i=0;t<rl*6;t+=6,i+=4)this._indices[t+0]=i+0,this._indices[t+1]=i+1,this._indices[t+2]=i+2,this._indices[t+3]=i+0,this._indices[t+4]=i+2,this._indices[t+5]=i+3;this._shaders=[],this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(e){const t=e.getTexture(),i=t.getFrame(),r=t.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();const o=t.getUVs();if(!o)return;const n=this._currentBatchSize*zn;this._addVertexCoordinates(e,n,i),this._addTextureUVs(e,n,o),this._addColors(e,n),this._sprites[this._currentBatchSize]=e,this._currentBatchSize++}_addColors(e,t){const i=this._colors,r=e.getTint(),o=(r>>16)+(r&65280)+((r&255)<<16)+(e.getWorldAlpha()*255<<24);i[t+4]=i[t+9]=i[t+14]=i[t+19]=o}_addTextureUVs(e,t,i){const r=this._positions;let o=i.getUVsAt(0);r[t+2]=o.x,r[t+3]=o.y,o=i.getUVsAt(1),r[t+7]=o.x,r[t+8]=o.y,o=i.getUVsAt(2),r[t+12]=o.x,r[t+13]=o.y,o=i.getUVsAt(3),r[t+17]=o.x,r[t+18]=o.y}_addVertexCoordinates(e,t,i){const r=this._positions,o=e.getWorldTransform(),n=e.getAnchor(),s=o.rectangleToCoordinates(i,n),a=5;for(var l=0;l<4;l++)r[t+l*a]=s[l].x,r[t+l*a+1]=s[l].y}_onContextChange(){const e=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW)}start(){this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){const e=this._renderer,t=e.getContext();if(this._currentBatchSize===0)return;if(this._currentBatchSize>rl*.5)t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices);else{const p=this._positions.subarray(0,this._currentBatchSize*zn);t.bufferSubData(t.ARRAY_BUFFER,0,p)}let i=0,r=null,o=null,n=null,s=null,a=!1,l=!1,d=null,c=0;for(let p=0,h=this._currentBatchSize;p<h;p++){if(d=this._sprites[p],o=d.getTexture().getBaseTexture(),s=d.getShader()||this._shader,a=n!==s,l=r!==o,(l||a)&&(this._renderBatch(r,i,c),c=p,i=0,r=o,a)){n=s,e.setShader(n);const m=e.getCurrentRenderTarget(),b=m.getProjectionMatrix().toArray();n.setUniform("u_projMatrix",b),n.syncUniforms(),t.activeTexture(t.TEXTURE0)}i++}this._renderBatch(r,i,c),this._currentBatchSize=0,this._sprites=[]}_renderBatch(e,t,i){if(t===0)return;const r=this._renderer,o=r.getContext();let n=e.getGLTextureForRenderer(r);n||(n=r.getOrCreateGLTexture(e)),e.isDirty()&&(r.updateTexture(e),e.setDirty(!1)),o.activeTexture(o.TEXTURE0+e.getGLUnit()),o.bindTexture(o.TEXTURE_2D,n);const s=t*6,a=i*6*2;o.drawElements(o.TRIANGLES,s,o.UNSIGNED_SHORT,a)}dispose(){const e=this._renderer,t=e.getContext();for(let i in this._sprites)i.dispose();this._vertexBuffer&&(t.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(t.deleteBuffer(this._indexBuffer),this._indexBuffer=null),this._vertices=null,this._positions=null,this._colors=null,this._indices=null,super.dispose()}}var kS=v4;const{Log:iv,Utils:_4}=ev;class x4{constructor(e,t,i,r,o){this._renderer=e,this._vertexSource=t,this._fragmentSource=i,this._uniforms=r||{},this._uniformLocations={},this._attributes=o||[],this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile();const e=this._renderer.getContext();e.useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(e,t){const i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,!1,zn,0),i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,!1,zn,2*4),i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,!0,zn,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(e=>{this.syncUniform(e)})}syncUniform(e){const t=this._renderer.getContext(),i=this._uniforms[e],r=this._uniformLocations[e];switch(i.type){case z.SAMPLER2D:t.uniform1i(r,i.value);break;case z.INT:case z.INT1:t.uniform1i(r,i.value);break;case z.INT2:t.uniform2i(r,i.value[0],i.value[1]);break;case z.INT3:t.uniform3i(r,i.value[0],i.value[1],i.value[2]);break;case z.INT4:t.uniform4i(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case z.FLOAT:case z.FLOAT1:t.uniform1f(r,i.value);break;case z.FLOAT2:t.uniform2f(r,i.value[0],i.value[1]);break;case z.FLOAT3:t.uniform3f(r,i.value[0],i.value[1],i.value[2]);break;case z.FLOAT4:t.uniform4f(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case z.FLOAT_VECTOR2:t.uniform2fv(r,i.value);break;case z.MAT3:case z.MAT3FV:t.uniformMatrix3fv(r,!1,i.value);break;case z.MAT4:t.uniformMatrix4fv(r,!1,i.value);break;default:iv.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){const e=this._renderer.getContext();this._attributes.forEach(t=>{this._attributeLocations[t]=e.getAttribLocation(this._program,t)})}_cacheUniformLocations(){const e=this._renderer.getContext(),t=Object.keys(this._uniforms);t.forEach(i=>{this._uniformLocations[i]=e.getUniformLocation(this._program,i)})}_addPrecisionToSource(e){const t=this._renderer.getMaxFloatPrecision();let i="mediump";return _4.isMobile()&&t==="highp"&&(i="highp"),`precision ${i} float;
${e}`}_compile(){const e=this._renderer.getContext(),t=this._compileShader(e.VERTEX_SHADER,this._vertexSource);this._vertexShader=t;const i=this._addPrecisionToSource(this._fragmentSource),r=this._compileShader(e.FRAGMENT_SHADER,i);this._fragmentShader=r;const o=e.createProgram();e.attachShader(o,t),e.attachShader(o,r),e.linkProgram(o);const n=e.getProgramParameter(o,e.LINK_STATUS);if(n)this._program=o;else{let s=e.getProgramInfoLog(o);e.isContextLost()&&(s="WebGL context lost"),e.deleteProgram(o),iv.error(this.constructor.name,`WebGL program linking error: ${s}`)}}_compileShader(e,t){const i=this._renderer.getContext(),r=i.createShader(e);i.shaderSource(r,t),i.compileShader(r);const o=i.getShaderParameter(r,i.COMPILE_STATUS);if(!o){let n=i.getShaderInfoLog(r);i.isContextLost()&&(n="WebGL context lost"),i.deleteShader(r),iv.error(this.constructor.name,`WebGL shader compilation error: ${n}`)}return r}setUniform(e,t,i=!1){this._uniforms[e].value=t,i&&this.syncUniform(e)}setUniforms(e,t=!1){for(const i in e)this._uniforms[i].value=e[i],t&&this.syncUniform(i)}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){const e=this._renderer.getContext();e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader),this._uniforms=null,this._uniformLocations=null,this._attributes=null,this._attributeLocations=null,this._renderer.off("context",this._onContextChange)}}var Vd=x4;var ES=`attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_color;
varying vec2 v_texCoord;
varying vec4 v_color;
uniform mat3 u_projMatrix;

void main() {
  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);
  v_texCoord = a_texCoord;
  v_color = vec4(a_color.rgb * a_color.a, a_color.a);
}
`;var DS=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;
}
`;const{UniformType:IS}=Dt;class Nn extends Vd{constructor(e,t,i){t=t||Nn.defaultVertexSource,i=i||Nn.defaultFragmentSource,super(e,t,i,Nn.defaultUniforms,Nn.defaultAttributes)}}Nn.defaultVertexSource=ES;Nn.defaultFragmentSource=DS;const w4=new Xr;Nn.defaultUniforms={u_image:{type:IS.SAMPLER2D,value:0},u_projMatrix:{type:IS.MAT3,value:w4.toArray()}};Nn.defaultAttributes=["a_position","a_texCoord","a_color"];var Un=Nn;class C4{constructor(){this._position=new re(0,0),this._scale=new re(1,1),this._pivot=new re(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new Xr,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new Qe(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new Qe(0,0,1,1),this._tint=16777215,this._filterRectangle=new Qe(0,0,0,0)}renderWebGL(e){W.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(e){W.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){const e=this._parent?this._parent.getWorldTransform():Xr.IDENTITY,t=this._worldTransform,i=this._rotation!==this._lastRotation;i&&(this._sinRotation=Math.sin(this._rotation),this._cosRotation=Math.cos(this._rotation),this._lastRotation=this._rotation),t.a=this._cosRotation*this._scale.x,t.b=this._sinRotation*this._scale.x,t.c=-this._sinRotation*this._scale.y,t.d=this._cosRotation*this._scale.y,t.tx=this._position.x,t.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(t.tx-=this._pivot.x*t.a+this._pivot.y*t.c,t.ty-=this._pivot.x*t.b+this._pivot.y*t.d),t.multiply(e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(e){this._shaders.push(e)}removeShader(e){const t=this._shaders.indexOf(e);return t!==-1?(this._shaders.splice(t,1),!0):!1}removeShaderAt(e){return this._shaders[e]?(this._shaders.splice(e,1),!0):!1}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(e,t){e instanceof re?this._position.copy(e):this._position.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(e,t){e instanceof re?this._scale.copy(e):this._scale.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(e,t){e instanceof re?this._pivot.copy(e):this._pivot.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(e){this._alpha=e}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(e){this._parent=e}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(e){this._filterRectangle.copy(e)}getTint(){return this._tint}setTint(e){this._tint=e}isVisible(){return this._visible}setVisible(e){this._visible=e}}var Kd=C4;class S4{constructor(e){this._renderer=e,this._context=this._renderer.getContext(),this._vertices=new Float32Array([0,0,100,0,100,100,0,100]),this._uvs=new Float32Array([0,0,1,0,1,1,0,1]),this._indices=new Uint16Array([0,1,2,0,3,2]),this._colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this._initBuffers(),this._uploadBuffers()}map(e,t){const{x:i,y:r}=t;this._uvs[2]=t.width/e.width,this._uvs[4]=this._uvs[2],this._uvs[5]=t.height/e.height,this._uvs[7]=this._uvs[5],this._vertices[0]=i,this._vertices[1]=r,this._vertices[2]=i+t.width,this._vertices[3]=r,this._vertices[4]=this._vertices[2],this._vertices[5]=r+t.height,this._vertices[6]=i,this._vertices[7]=this._vertices[5],this._uploadBuffers()}_initBuffers(){const e=this._context;this._vertexBuffer&&(e.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(e.deleteBuffer(this._indexBuffer),this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,(8+8+16)*4,e.DYNAMIC_DRAW),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)}_uploadBuffers(){const e=this._context;e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices),e.bufferSubData(e.ARRAY_BUFFER,8*4,this._uvs),e.bufferSubData(e.ARRAY_BUFFER,(8+8)*4,this._colors)}getVertexBuffer(){return this._vertexBuffer}getIndexBuffer(){return this._indexBuffer}dispose(){const e=this._context;this._vertexBuffer&&(e.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(e.deleteBuffer(this._indexBuffer),this._indexBuffer=null)}}var Dm=S4;const{RendererType:T4}=Dt;class k4{constructor(e){this._renderer=e,this._filterStack=[{filters:[]}],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new Qe(0,0,e.getWidth(),e.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._renderTargets.forEach(t=>t.resizeTo(e))}getFilterStack(){return this._filterStack}setFilterStack(e){this._filterStack=e}_getOrCreateRenderTarget(e){let t=this._renderTargets.pop();return t||(t=new Gs(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),t.setFrame(this._currentFrame),e&&t.clear(),t}pushFilters(e,t){const i=e.getBounds();this._currentFrame=i;const r=e.getFilterRectangle();r.width>0&&r.height>0&&(this._currentFrame=r);const o=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(o),o.clear(),this._filterStack.push({renderTarget:o,filters:t})}popFilters(){const{filters:e,renderTarget:t}=this._filterStack.pop(),i=this._filterStack[this._filterStack.length-1],r=t,o=i.renderTarget;this._quad.map(this._textureFrame,r.getFrame());const n=e[0].getShaderForRenderer(this._renderer),s=this._quad.getVertexBuffer(),a=this._quad.getIndexBuffer(),l=this._renderer.getContext();l.bindBuffer(l.ARRAY_BUFFER,s),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,a);const d=n.getAttributeLocations();return l.vertexAttribPointer(d.a_position,2,l.FLOAT,!1,0,0),l.vertexAttribPointer(d.a_texCoord,2,l.FLOAT,!1,0,2*4*4),l.vertexAttribPointer(d.a_color,4,l.FLOAT,!1,0,4*4*4),this._renderer.updateTexture(r.getBaseTexture(),!1),e.length===1?(e[0].apply(this._renderer,r,o),this._renderTargets.push(r)):this._applyFilters(e,r,o),e}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(o.getBaseTexture(),!1);const n=e[e.length-1];e.forEach((s,a)=>{const l=s===n;if(l)s.apply(this._renderer,r,i,!0);else{s.apply(this._renderer,r,o,!0);let d=r;r=o,o=d}}),this._renderTargets.push(r),this._renderTargets.push(o)}_onContextChange(){this._renderTargets.length=0,this._renderer.isOfType(T4.WEBGL)&&(this._quad&&this._quad.dispose(),this._quad=new Dm(this._renderer))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(e=>{e.dispose()})}}var $d=k4;const js=v(Lw());class rv{constructor(e){this._context=e,this._domAvailable=typeof document!="undefined",this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(let e in this._context){const t=this._context[e];typeof t=="number"&&(this._enums[t]=e)}}_enumValueToString(e){const t=this._enums[e];return typeof t=="undefined"?e:t}_setupStats(){if(!this._domAvailable)return;this._stats=new js.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new js.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new js.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new js.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new js.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new js.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new js.default.Panel("Shaders","#43ADEB","#282828"))}_updatePanel(e){if(!this._domAvailable)return;this._stats.begin();switch(e){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;const e=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(e,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let e=0;for(let t in this._textures)e+=this._textures[t].memory;for(let t in this._buffers)e+=this._buffers[t].memory;return e}_hookIntoContext(){for(let e in this._context){let t=this._context[e];typeof t=="function"?this[e]=function(...i){const r=this._context[e];return this._trackGLCall(r,e,i)}:this._makePropertyWrapper(e)}}_makePropertyWrapper(e){const t=["_context"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}_trackGLCall(e,t,i){const r=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"];let o;r.indexOf(t)!==-1?o=this[`_${t}`](i):o=e.apply(this._context,i);const n=this._context.getError();if(n!==0){let s=i.join(", ");s.length>100&&(s=s.substr(0,100)+"..."),console.error(new Error(`WebGL Error ${this._enumValueToString(n)} in ${t}(${s})`))}return o}_createProgram(){const e=this._context.createProgram();return e._wmmId=this._id++,this._programs[e._wmmId]=e,this._updatePanel("prg"),e}_deleteProgram([e]){if(!e||!this._programs[e._wmmId])return;delete this._programs[e._wmmId],this._context.deleteProgram(e),this._updatePanel("prg")}_createShader([e]){const t=this._context.createShader(e);return t._wmmId=this._id++,this._shaders[t._wmmId]=t,this._updatePanel("shd"),t}_deleteShader([e]){if(!e||!this._shaders[e._wmmId])return;delete this._shaders[e._wmmId],this._context.deleteShader(e),this._updatePanel("shd")}_createFramebuffer(){const e=this._context.createFramebuffer();return e._wmmId=this._id++,this._framebuffers[e._wmmId]=e,this._updatePanel("fbo"),e}_deleteFramebuffer([e]){if(!e||!this._framebuffers[e._wmmId])return;delete this._framebuffers[e._wmmId],this._context.deleteFramebuffer(e),this._updatePanel("fbo")}_createBuffer(){const e=this._context.createBuffer();return e._wmmId=this._id++,this._buffers[e._wmmId]={buffer:e,memory:0},this._updatePanel("buf"),e}_bindBuffer([e,t]){this._context.bindBuffer(e,t),this._boundBuffer=t._wmmId}_bufferData([e,t,i]){this._context.bufferData(e,t,i);let r;typeof t=="number"?r=t:"byteLength"in t?r=t.byteLength:"length"in t&&(r=t.length),this._buffers[this._boundBuffer].memory=r}_deleteBuffer([e]){if(!e||!this._buffers[e._wmmId])return;delete this._buffers[e._wmmId],this._context.deleteBuffer(e),this._updatePanel("buf")}_createTexture(){const e=this._context.createTexture();return e._wmmId=this._id++,this._textures[e._wmmId]={texture:e,memory:0},this._updatePanel("tex"),e}_deleteTexture([e]){if(!e||!this._textures[e._wmmId])return;delete this._textures[e._wmmId],this._context.deleteTexture(e),this._updatePanel("tex")}_bindTexture([e,t]){this._context.bindTexture(e,t),this._boundTexture=t._wmmId}_texImage2D(e){let[,,t,i,r,o,,,n]=e;typeof n=="undefined"&&(n=o),this._context.texImage2D.apply(this._context,e);const s=this._calculateByteCountForTexture(t,i,r,n);this._textures[this._boundTexture].memory=s}_calculateByteCountForTexture(e,t,i,r){if(r!==null)if("width"in r)t=r.width,i=r.height;else return r.length;let o=1;switch(e){case this._context.ALPHA:o=1;break;case this._context.RGB:o=3;break;case this._context.RGBA:o=4;break}return t*i*o}}class Vh{constructor(e,t,i){this.width=e,this.height=t,this.data=i}static fromNodeCanvasImage(e){}}const{RendererType:E4}=Dt;class Im extends Tm{constructor(...e){super(...e);this._type=E4.WEBGL,this._fakeObject=new Kd,this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||F.createCanvas()),this._cachedBlitCanvas=F.createCanvas(),this.shaders=this._initShaders(),this.renderers=this._initRenderers()}_onContextLost(e){e.preventDefault(),W.warn(this.constructor.name,"WebGL context has been lost - trying to restore.")}_onContextCreationError(e){e.preventDefault(),W.warn(this.constructor.name,`Failed to create WebGL context: ${e.statusMessage||"Unknown error"}`)}_onContextRestored(){W.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new $d(this),this._currentObjectRenderer=new Em(this)}setShader(e){this._currentShader=e,this._context.useProgram(e.getProgram()),this._setAttributesForShader(e)}setCanvas(e){this._canvas&&this._removeContextEventListeners(),super.setCanvas(e),this._canvas.addEventListener&&this._addContextEventListeners()}_addContextEventListeners(){this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError)}_removeContextEventListeners(){this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError)}_setAttributesForShader(e){const t=this._context,i=e.getAttributes(),r=e.getAttributeLocations();i.forEach(o=>{const n=r[o];t.enableVertexAttribArray(n)})}_initShaders(){return{default:new Un(this)}}_initRenderers(){return{sprite:new kS(this)}}_createContext(){const e=this._canvas;let t=null;const i={preserveDrawingBuffer:!0};if(t=e.getContext("webgl",i)||e.getContext("experimental-webgl",i),typeof window!="undefined"&&window.WebGLDebugUtils&&this._options.debug){const r=(o,n)=>{console.error("gl."+o+"("+window.WebGLDebugUtils.glFunctionArgsToString(o,n)+")")};t=window.WebGLDebugUtils.makeDebugContext(t,null,r)}return this._options.debug&&(t=new Sm(t),t=new rv(t)),this.id=t.id=Im.contextId++,this._context=t,t.renderer=this,this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.emit("context",t),t}_setupContext(){const e=this._context;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new Gs(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}_getMaxPrecision(){const e=this._context,t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);this._maxFloatPrecision=t.precision!==0?"highp":"mediump";const i=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT);this._maxIntPrecision=i.rangeMax!==0?"highp":"lowp"}resizeTo(e,t=!0){super.resizeTo(e,t),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(e)}setRenderTarget(e=this._defaultRenderTarget){this._currentRenderTarget=e,this._currentRenderTarget.activate()}setObjectRenderer(e){this._currentObjectRenderer.stop(),this._currentObjectRenderer=e,this._currentObjectRenderer.start()}render(e){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);const t=e.getParent();e.setParent(this._fakeObject),e.updateTransform(),e.setParent(t),this.renderDisplayObject(e,this._defaultRenderTarget)}renderDisplayObject(e,t){this.setRenderTarget(t),this._filterManager.setFilterStack(t.getFilterStack()),e.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){const e=this._context;e.clearColor.apply(e,this._clearColor.toGLColor()),e.clear(e.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(e){this.setRenderTarget(e.renderTarget),this._filterManager.setFilterStack(e.filterStack),this._currentObjectRenderer=e.objectRenderer}getOrCreateGLTexture(e){const t=this._context;let i=e.getGLTextureForRenderer(this);return i||(i=t.createTexture(),e.setGLTextureForRenderer(i,this)),i}updateTexture(e,t=!0){let i=e.getSource();const r=!!i,o=this._context,n=e.getGLUnit(),s=this.getOrCreateGLTexture(e);if(o.activeTexture(o.TEXTURE0+n),o.bindTexture(o.TEXTURE_2D,s),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t&&r)if(i instanceof Vh)o.texImage2D(o.TEXTURE_2D,0,o.RGBA,i.width,i.height,0,o.RGBA,o.UNSIGNED_BYTE,i.data);else{const a=F.convertHtmlImageToRGBACanvas(i,this._cachedBlitCanvas);o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,a)}e.isMipMappingEnabled()?o.generateMipmap(o.TEXTURE_2D):(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e.getGLRepeat(o,"x")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e.getGLRepeat(o,"y"))),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e.getGLFilter(o,"min")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,e.getGLFilter(o,"mag")),o.activeTexture(o.TEXTURE0)}getMaxDimensions(){let e=this.maxTextureDimensions;if(e===void 0){{const t=F.createCanvas(),i=t.getContext("webgl")||t.getContext("experimental-webgl");if(!i)e=null;else{const r=i.getParameter(i.MAX_TEXTURE_SIZE),o=i.getExtension("WEBGL_lose_context");o&&o.loseContext(),e=r}}this.maxTextureDimensions=e}return e}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}static isSupported(){{let e=F.createCanvas();e.addEventListener("webglcontextcreationerror",this.prototype._onContextCreationError);let t=e.getContext("webgl")||e.getContext("experimental-webgl"),i=!!t;if(i){const r=To.determineGPUName(t),o=To.isGPUBlacklisted(r);i&=!o}return e.removeEventListener("webglcontextcreationerror",this.prototype._onContextCreationError),i}return!0}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(let i in this.shaders)this.shaders[i].dispose(),delete this.shaders[i];this._removeContextEventListeners();const e=this._context,t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}}Im.contextId=0;Im.type="WebGL";var Om=Im;class D4 extends Kd{constructor(...e){super(...e);this._children=[],this._filters=[]}addFilter(e){this._filters.push(e)}removeFilter(e){const t=this._filters.indexOf(e);return t!==-1?(this._filters.splice(t,1),!0):!1}setFilters(e){this._filters=e}addChild(e){const t=e.getParent();t!==null&&t.removeChild(e),e.setParent(this),this._children.push(e)}prependChild(e){const t=e.getParent();t!==null&&t.removeChild(e),e.setParent(this),this._children.unshift(e)}hasChild(e){const t=this._children.indexOf(e);return t!==-1}removeChild(e){const t=this._children.indexOf(e);t!==-1?(this._children.splice(t,1),e.setParent(null)):W.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(e){if(!this._visible)return;const t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),e.getCurrentObjectRenderer().start(),this._renderWebGL(e),this._children.forEach(i=>{i.renderWebGL(e)}),e.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&t.popFilters(),e.getCurrentObjectRenderer().start()}_renderWebGL(e){}renderCanvas(e){if(!this._visible)return;const t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),this._renderCanvas(e),this._children.forEach(i=>{i.renderCanvas(e)}),this._filters&&this._filters.length&&t.popFilters()}_renderCanvas(e){}updateTransform(){super.updateTransform(),this._children.forEach(e=>{e.updateTransform()})}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}var Rm=D4;class I4{constructor(){this._uvs=[new re(0,0),new re(1,0),new re(1,1),new re(0,1)]}update(e,t){let i=this._uvs[0];i.x=e.x/t.width,i.y=e.y/t.height,i=this._uvs[1],i.x=(e.x+e.width)/t.width,i.y=e.y/t.height,i=this._uvs[2],i.x=(e.x+e.width)/t.width,i.y=(e.y+e.height)/t.height,i=this._uvs[3],i.x=e.x/t.width,i.y=(e.y+e.height)/t.height}getUVsAt(e){return this._uvs[e]}getUVs(){return this._uvs}}var OS=I4;class ov extends Ri{constructor(e,t){super();if(!(e instanceof Wi))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=new OS,this._frame=t?t.clone():null,this._frameLocked=!!t,this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this._frame||(this._frame=new Qe(0,0,1,1)),this.setBaseTexture(e)}static fromImage(e){const t=new Wi(e);return new ov(t)}static fromCanvas(e){const t=new Wi(e);return new ov(t)}_onBaseTextureLoaded(){if(!this._frameLocked){const e=this._baseTexture.getFrame().clone();this.setFrame(e)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){const{width:e,height:t}=this._baseTexture.getFrame();this._frame.width=e,this._frame.height=t,this.emit("update")}_updateUVs(){this._uvs.update(this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(e){if(this._baseTexture=e,!this._baseTexture.isLoaded())this._baseTexture.once("loaded",this._onBaseTextureLoaded);else{const{width:t,height:i}=e.getFrame();this._frameLocked||(this._frame=new Qe(0,0,t,i)),this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(e){this._frame=e,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new re(this._frame.width,this._frame.height)}dispose(e=!0){e&&this._baseTexture.dispose()}}var Am=ov;const{RendererType:qd}=Dt;class O4 extends Am{constructor(e,t=100,i=100,r=1){super(new Wi,new Qe(0,0,t,i));this._loaded=!0,this._width=t,this._height=i,this._pixelRatio=r,this._renderer=e,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),this._renderer.isOfType(qd.WEBGL)?this._filterManager=new $d(this._renderer):this._renderer.isOfType(qd.CANVAS)&&(this._filterManager=new Wd(this._renderer)),this._filterManager.resizeTo(new re(this._width,this._height))}_setupBuffer(){this._renderer.isOfType(qd.WEBGL)?this._setupWebGLRenderTarget():this._renderer.isOfType(qd.CANVAS)&&this._setupCanvasRenderTarget()}_setupWebGLRenderTarget(){this._renderTarget&&this._renderTarget.dispose(),this._renderTarget=new Gs(this._renderer,this._width,this._height,this._pixelRatio)}_setupCanvasRenderTarget(){this._renderTarget&&this._renderTarget.dispose(),this._renderTarget=new Hs(this._width,this._height,this._pixelRatio)}clear(e){this._renderTarget.clear(e)}resizeTo(e){if(this._width===e.x&&this._height===e.y)return;this._width=e.x,this._height=e.y,this._frame.width=e.x,this._frame.height=e.y,this._renderTarget.resizeTo(e),this._filterManager.resizeTo(e)}render(e){if(this._renderer.isOfType(qd.WEBGL))this._renderWebGL(e);else if(this._renderer.isOfType(qd.CANVAS))this._renderCanvas(e);else throw new Error(`RenderTexture does not support rendering via ${this._renderer.constructor.name}`)}_renderWebGL(e){this._renderTarget.activate(),e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}_renderCanvas(e){e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}}var RS=O4;class nv{constructor(){this._container=new A.Container,this._sprite=new A.Sprite,this._container.addChild(this._sprite)}render(e,t,i){const r=i.getDimensions(),o=this._getNextHighestPOT(r);this._renderTexture?this._renderTexture.resizeTo(o):this._renderTexture=new A.RenderTexture(e,o.x,o.y);const n=this._renderTexture.getDimensions();this._sprite.setTexture(i),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(e,t,r,n)}_updateSprite(e,t,i,r){t.setTexture(this._renderTexture),this._renderTexture.setFrame(new Qe(0,0,i.x,i.y))}_getNextHighestPOT(e){return new re(F.nextHighestPOT(e.x),F.nextHighestPOT(e.y))}getRenderTexture(){return this._renderTexture}dispose(){if(!this._renderTexture)return;this._renderTexture.dispose(),this._renderTexture=null}}class R4 extends Rm{constructor(e){super();this._onTextureUpdate=this._onTextureUpdate.bind(this),this._texture=e,this._shader=null,this._width=0,this._height=0,this._anchor=new re(0,0),this._canvasSmoothingEnabled=!0,this.setTexture(e)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(e){const t=e.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new nv),this._potRenderer.render(e,this,this._texture)),e.restore(t),e.setObjectRenderer(e.renderers.sprite),e.renderers.sprite.render(this)}_renderCanvas(e){const t=this._worldTransform,i=this._texture.getFrame(),{width:r,height:o}=i,n=e.getCurrentRenderTarget().getPixelRatio(),s=this._anchor.x*-r|0,a=this._anchor.y*-o|0,l=e.getContext();l.setTransform(t.a,t.b,t.c,t.d,t.tx*n,t.ty*n),l.globalAlpha=this.getWorldAlpha();const d=this._texture.getBaseTexture(),c=d.getPixelRatio(),p=d.getSource();l.imageSmoothingEnabled=this._canvasSmoothingEnabled,e.beforeDraw&&e.beforeDraw(l),l.drawImage(p,0,0,(p.naturalWidth||r)*c,(p.naturalHeight||o)*c,s*n,a*n,r*n,o*n)}isAtPosition(e){const t=this._worldTransform.applyInverseToVector(e),i=this._texture.getFrame(),{width:r,height:o}=i,n=new re(-r,-o);n.multiply(this._anchor);const s=n.clone().add(r,o);return!(t.x<n.x||t.x>s.x||t.y<n.y||t.y>s.y)}getLocalBounds(){if(this._localBoundsNeedUpdate){const e=this._localBounds,t=this._texture.getFrame();e.x=-t.width*this._anchor.x,e.y=-t.height*this._anchor.y,e.width=t.width,e.height=t.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate){const e=this._bounds,t=this._texture.getFrame(),i=this._worldTransform,r=this._anchor,o=i.rectangleToCoordinates(t,r);let n=o[0].x,s=o[0].y,a=n,l=s;o.forEach(({x:d,y:c})=>{n=Math.min(n,d),s=Math.min(s,c),a=Math.max(a,d),l=Math.max(l,c)}),e.x=n,e.width=Math.abs(a-n),e.y=s,e.height=Math.abs(l-s),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(e=!0){if(!this._texture)return;this._texture.off("update",this._onTextureUpdate),e&&this._texture.dispose(),this._texture=null,this._potRenderer&&(e&&this._potRenderer.dispose(),this._potRenderer=null)}setTexture(e){if(!e)return;this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=e,e.getBaseTexture().isLoaded()&&this._onTextureUpdate(),e.on("update",this._onTextureUpdate)}getShader(){return this._shader}setShader(e){this._shader=e}getWidth(){return this._width}setWidth(e){this._scale.x=e/this._texture.getFrame().width,this._width=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getHeight(){return this._height}setHeight(e){this._scale.y=e/this._texture.getFrame().height,this._height=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getDimensions(){return new re(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(e,t){e instanceof re?this._anchor.copy(e):this._anchor.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(e){this._smoothDownscaling=e}dispose(e=!1,t=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(e||t)&&this._texture.dispose(t),this._potRenderer&&this._potRenderer.dispose()}}var AS=R4;var FS={TextureShader:Un};const A4=function(){"use strict";var t,i,r,o=Object.prototype.toString,n=typeof setImmediate!="undefined"?function(x){return setImmediate(x)}:setTimeout;try{Object.defineProperty({},"x",{}),t=function(x,C,R,T){return Object.defineProperty(x,C,{value:R,writable:!0,configurable:T!==!1})}}catch(S){t=function(C,R,T){return C[R]=T,C}}r=function(){var x,C,R;function T(k,M){this.fn=k,this.self=M,this.next=void 0}return{add:function(M,U){R=new T(M,U),C?C.next=R:x=R,C=R,R=void 0},drain:function(){var M=x;for(x=C=i=void 0;M;)M.fn.call(M.self),M=M.next}}}();function s(S,x){r.add(S,x),i||(i=n(r.drain))}function a(S){var x,C=typeof S;return S!=null&&(C=="object"||C=="function")&&(x=S.then),typeof x=="function"?x:!1}function l(){for(var S=0;S<this.chain.length;S++)d(this,this.state===1?this.chain[S].success:this.chain[S].failure,this.chain[S]);this.chain.length=0}function d(S,x,C){var R,T;try{x===!1?C.reject(S.msg):(x===!0?R=S.msg:R=x.call(void 0,S.msg),R===C.promise?C.reject(TypeError("Promise-chain cycle")):(T=a(R))?T.call(R,C.resolve,C.reject):C.resolve(R))}catch(k){C.reject(k)}}function c(S){var x,C=this;if(C.triggered)return;C.triggered=!0,C.def&&(C=C.def);try{(x=a(S))?s(function(){var R=new m(C);try{x.call(S,function(){c.apply(R,arguments)},function(){p.apply(R,arguments)})}catch(T){p.call(R,T)}}):(C.msg=S,C.state=1,C.chain.length>0&&s(l,C))}catch(R){p.call(new m(C),R)}}function p(S){var x=this;if(x.triggered)return;x.triggered=!0,x.def&&(x=x.def),x.msg=S,x.state=2,x.chain.length>0&&s(l,x)}function h(S,x,C,R){for(var T=0;T<x.length;T++)(function(M){S.resolve(x[M]).then(function(L){C(M,L)},R)})(T)}function m(S){this.def=S,this.triggered=!1}function b(S){this.promise=S,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function _(S){if(typeof S!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var x=new b(this);this.then=function(R,T){var k={success:typeof R=="function"?R:!0,failure:typeof T=="function"?T:!1};return k.promise=new this.constructor(function(U,L){if(typeof U!="function"||typeof L!="function")throw TypeError("Not a function");k.resolve=U,k.reject=L}),x.chain.push(k),x.state!==0&&s(l,x),k.promise},this.catch=function(R){return this.then(void 0,R)};try{S.call(void 0,function(R){c.call(x,R)},function(R){p.call(x,R)})}catch(C){p.call(x,C)}}var g=t({},"constructor",_,!1);return _.prototype=g,t(g,"__NPO__",0,!1),t(_,"resolve",function(x){var C=this;return x&&typeof x=="object"&&x.__NPO__===1?x:new C(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");T(x)})}),t(_,"reject",function(x){return new this(function(R,T){if(typeof R!="function"||typeof T!="function")throw TypeError("Not a function");T(x)})}),t(_,"all",function(x){var C=this;return o.call(x)!="[object Array]"?C.reject(TypeError("Not an array")):x.length===0?C.resolve([]):new C(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");var M=x.length,U=Array(M),L=0;h(C,x,function(de,ge){U[de]=ge,++L===M&&T(U)},k)})}),t(_,"race",function(x){var C=this;return o.call(x)!="[object Array]"?C.reject(TypeError("Not an array")):new C(function(T,k){if(typeof T!="function"||typeof k!="function")throw TypeError("Not a function");h(C,x,function(U,L){T(L)},k)})}),_};var PS=typeof global=="undefined"?window:global;const BS=typeof Promise!="undefined"?Promise:A4();PS.Promise=PS.Promise||BS;var ce=BS;let MS;MS=window.Image;var vi=MS;class Ws{constructor(e=1,t=0,i=0,r=0,o=0,n=0,s=1,a=0,l=0,d=0,c=0,p=0,h=1,m=0,b=0,_=0,g=0,S=0,x=1,C=0){this.set(e,t,i,r,o,n,s,a,l,d,c,p,h,m,b,_,g,S,x,C)}set(e,t,i,r,o,n,s,a,l,d,c,p,h,m,b,_,g,S,x,C){this.a=e,this.b=t,this.c=i,this.d=r,this.e=o,this.f=n,this.g=s,this.h=a,this.i=l,this.j=d,this.k=c,this.l=p,this.m=h,this.n=m,this.o=b,this.p=_,this.q=g,this.r=S,this.s=x,this.t=C}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(e){let t=this.a*e.r+this.b*e.g+this.c*e.b+this.d*e.a+this.e,i=this.f*e.r+this.g*e.g+this.h*e.b+this.i*e.a+this.j,r=this.k*e.r+this.l*e.g+this.m*e.b+this.n*e.a+this.o,o=this.p*e.r+this.q*e.g+this.r*e.b+this.s*e.a+this.t;return new N(t,i,r,o)}multiply(e){let t,i,r,o,n,s,a,l,d,c,p,h,m,b,_,g,S,x,C,R,T=e,k=this;return t=T.a*k.a+T.b*k.f+T.c*k.k+T.d*k.p,i=T.a*k.b+T.b*k.g+T.c*k.l+T.d*k.q,r=T.a*k.c+T.b*k.h+T.c*k.m+T.d*k.r,o=T.a*k.d+T.b*k.i+T.c*k.n+T.d*k.s,s=T.f*k.a+T.g*k.f+T.h*k.k+T.i*k.p,a=T.f*k.b+T.g*k.g+T.h*k.l+T.i*k.q,l=T.f*k.c+T.g*k.h+T.h*k.m+T.i*k.r,d=T.f*k.d+T.g*k.i+T.h*k.n+T.i*k.s,p=T.k*k.a+T.l*k.f+T.m*k.k+T.n*k.p,h=T.k*k.b+T.l*k.g+T.m*k.l+T.n*k.q,m=T.k*k.c+T.l*k.h+T.m*k.m+T.n*k.r,b=T.k*k.d+T.l*k.i+T.m*k.n+T.n*k.s,g=T.p*k.a+T.q*k.f+T.r*k.k+T.s*k.p,S=T.p*k.b+T.q*k.g+T.r*k.l+T.s*k.q,x=T.p*k.c+T.q*k.h+T.r*k.m+T.s*k.r,C=T.p*k.d+T.q*k.i+T.r*k.n+T.s*k.s,n=T.a*k.e+T.b*k.j+T.c*k.o+T.d*k.t+T.e,c=T.f*k.e+T.g*k.j+T.h*k.o+T.i*k.t+T.j,_=T.k*k.e+T.l*k.j+T.m*k.o+T.n*k.t+T.o,R=T.p*k.e+T.q*k.j+T.r*k.o+T.s*k.t+T.t,this.a=t,this.b=i,this.c=r,this.d=o,this.e=n,this.f=s,this.g=a,this.h=l,this.i=d,this.j=c,this.k=p,this.l=h,this.m=m,this.n=b,this.o=_,this.p=g,this.q=S,this.r=x,this.s=C,this.t=R,this}clone(){let e=new Ws;return e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),e}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f&&this.g===e.g&&this.h===e.h&&this.i===e.i&&this.j===e.j&&this.k===e.k&&this.l===e.l&&this.m===e.m&&this.n===e.n&&this.o===e.o&&this.p===e.p&&this.q===e.q&&this.r===e.r&&this.s===e.s&&this.t===e.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(e=>this[e])}static get IDENTITY(){return new Ws}static createBrightnessMatrix(e){let t=new Ws;return t.e=e,t.j=e,t.o=e,t}static createContrastMatrix(e){let t=new Ws,i=(1-e)/2;return t.a=t.g=t.m=e,t.e=t.j=t.o=i,t}static createSaturationMatrix(e=1){let t=new Ws,i=1-e,r=.213*i,o=.715*i,n=.072*i;return t.a=r+e,t.b=o,t.c=n,t.f=r,t.g=o+e,t.h=n,t.k=r,t.l=o,t.m=n+e,t}static createExposureMatrix(e=0){const t=Math.pow(2,e);return new Ws(t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0)}static createLinearMatrix(e=1,t=0){let i=new Ws;return i.a=i.g=i.m=e,i.e=i.j=i.o=t,i}}var Kh=Ws;class Fm extends Ri{constructor(e={},t={}){super();this.availableOptions=this.availableOptions||{},this.availableOptions=F.extend(this.availableOptions,t),this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(e)}_buildConfigError(e){let t="";return this.constructor.name&&(t=`${this.constructor.name}: `),t+=e,new Error(t)}_onOptionsChange(){}validateSettings(){return new ce((e,t)=>{for(let i in this.availableOptions){let r=this.availableOptions[i];if(r.required&&typeof this._options[i]=="undefined")return t(this._buildConfigError(`Option \`${i}\` is required.`))}e()})}_initOptions(e={}){this._options={};let t,i,r,o=this;for(t in this.availableOptions){if(r=t.charAt(0).toUpperCase()+t.slice(1),i=this.availableOptions[t],[f.STRING,f.NUMBER,f.BOOLEAN,f.OBJECT,f.VECTOR2,f.COLOR,f.CONFIGURABLE,f.COLOR_MATRIX,f.ARRAY,f.IMAGE,f.FUNCTION,f.ALL].indexOf(i.type)===-1)throw this._buildConfigError(`Unknown option type: \`${i.type}\``);let n=function(s,a){o["set"+r]=function(l,d,c){o.setOption(s,l,d,c)},o["get"+r]=function(){return o.getOption(s)}};if(n(t,i),i.type===f.CONFIGURABLE&&(this._options[t]=new Fm(void 0,i.structure||{}),this._options[t].on("update",this._onConfigurableUpdate)),!(t in e)||typeof e[t]=="undefined")if(typeof i.default!="undefined"){let s=i.default;typeof i.default=="function"&&(s=i.default()),this["set"+r](s,!1,!0)}else i.type!==f.CONFIGURABLE&&(this._options[t]=void 0)}for(t in e){if(typeof this.availableOptions[t]=="undefined")throw new Error(`Invalid option: ${t}`);typeof e[t]!="undefined"&&(r=t.charAt(0).toUpperCase()+t.slice(1),this["set"+r](e[t],!1,!0))}}set(e,t=!0){for(let i in e)this.setOption(i,e[i],!1);this._onOptionsChange(),t&&this.emit("update",this,e)}getOption(e){return this._options[e]}hasOption(e){return!!this.availableOptions[e]}getOptionDefault(e){const t=this.availableOptions[e];if(!t)throw new Error(`Invalid option: ${e}`);return t.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){let e={};for(let t in this.availableOptions){const i=this.availableOptions[t].default;if(typeof i=="undefined")continue;e[t]=i}return e}getOptions(){return y({},this._options)}equals(e){const t=e.getOptions();return this.optionsEqual(t)}optionsEqual(e){for(let t in e){const i=e[t];if(!this._optionEquals(t,i))return!1}return!0}_optionEquals(e,t){const i=this.availableOptions[e];if(typeof i=="undefined")throw new Error(`Invalid option: ${e}`);const r=this.availableOptions[e].type,o=this._options[e];if(o===t)return!0;if(typeof t=="undefined"||typeof o=="undefined")return!1;switch(r){case f.OBJECT:return typeof o.optionsEqual=="function"?o.optionsEqual(t._options):o===t;case f.STRING:case f.NUMBER:case f.BOOLEAN:case f.FUNCTION:case"*":return o===t;case f.VECTOR2:return o.equals(t);case f.COLOR:case f.COLOR_MATRIX:return t.equals(o);case f.CONFIGURABLE:return o.optionsEqual(t);case f.ARRAY:return this._arrayOptionEquals(e,t);case f.IMAGE:return o.src===t.src}}_arrayOptionEquals(e,t){let i=this._options[e];if(t.length!==i.length)return!1;let r=!0;for(let o=0;o<i.length;o++){const n=i[o],s=t[o];if(n instanceof Fm){if(typeof s=="undefined"||!n.optionsEqual(s)){r=!1;break}}else if(s!==n){r=!1;break}}return r}serializeOptions(e=Object.keys(this._options),t=!1){let i={};return e.forEach(r=>{if(typeof this.availableOptions[r]=="undefined")return W.warn(`Trying to serialize a key that does not exist: ${r}`);if(this.availableOptions[r].serializable===!1)return;i[r]=this.serializeOption(r,t)}),i}serializeOption(e,t=!1){const i=this.availableOptions[e],r=i.type,o=this._options[e];if(!o)return o;if(i.serializable===!1)throw new Error(`Option \`${e}\` is not serializable.`);switch(r){case f.STRING:case f.NUMBER:case f.BOOLEAN:case f.OBJECT:case f.FUNCTION:case f.ALL:return o;case f.VECTOR2:return t?o.toObject():o.clone();case f.COLOR:case f.COLOR_MATRIX:return t?o.toArray():o.clone();case f.CONFIGURABLE:return o.serializeOptions(void 0,t);case f.ARRAY:return o.slice(0);case f.IMAGE:return t?o.src:o}}setOption(e,t,i=!0,r=!1){var o=this.availableOptions[e];if(!o)throw new Error(`Invalid option: ${e}`);if(typeof o.setter!="undefined"&&(t=o.setter.call(this,t,r)),typeof o.validation!="undefined"&&o.validation(t),t===null||typeof t=="undefined"){if(o.required)throw this._buildConfigError(`Option \`${e}\` is required.`);this._options[e]=t}else switch(o.type){case f.STRING:if(typeof t!==f.STRING)throw this._buildConfigError(`Option \`${e}\` has to be a string.`);var n=o.available;if(typeof n!="undefined"&&n.indexOf(t)===-1)throw this._buildConfigError(`Invalid value for \`${e}\` (valid values are: ${o.available.join(", ")})`);this._options[e]=t;break;case f.NUMBER:if(typeof t!==f.NUMBER)throw this._buildConfigError(`Option \`${e}\` has to be a number.`);this._options[e]=t;break;case f.BOOLEAN:if(typeof t!==f.BOOLEAN)throw this._buildConfigError(`Option \`${e}\` has to be a boolean.`);this._options[e]=t;break;case f.VECTOR2:if(!(t instanceof re)&&!(typeof t=="object"&&"x"in t&&"y"in t))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Vector2 or an Object holding x and y values.`);t instanceof re?this._options[e]=t.clone():this._options[e]=re.fromObject(t);break;case f.COLOR:if(!(t instanceof N))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Color.`);this._options[e]=t;break;case f.COLOR_MATRIX:if(!(t instanceof Kh))throw this._buildConfigError(`Option \`${e}\` has to be an instance of ColorMatrix.`);this._options[e]=t.clone();break;case f.FUNCTION:if(typeof t!="function")throw this._buildConfigError(`Option \`${e}\` has to be a function.`);this._options[e]=t;break;case f.OBJECT:case"*":this._options[e]=t;break;case f.IMAGE:if(typeof t=="string"){let s=new vi;s.crossOrigin=F.getCrossOriginValue(o.crossOrigin),s.src=t,this._options[e]=s}else if(t instanceof vi||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement)this._options[e]=t;else throw this._buildConfigError(`Option \`${e}\` has to be an Image, Canvas or String.`);break;case f.CONFIGURABLE:t instanceof Fm?this._options[e]=t:this._options[e].set(t);break;case f.ARRAY:if(!(t instanceof Array))throw this._buildConfigError(`Option \`${e}\` has to be an Array.`);this._options[e]=t.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${o.type}\``)}i&&(this._onOptionsChange(),this.emit("update",this,{[e]:t}))}_onConfigurableUpdate(...e){this.emit("update",...e)}hasChanges(){const e=this.getDefaultOptions();return!this.optionsEqual(e)}}var _e=Fm;"use strict";var F4=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],P4=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function zS(e,t,i,r,o,n){if(isNaN(n)||n<1)return;n|=0;var s=e.data,a,l,d,c,p,h,m,b,_,g,S,x,C,R,T,k,M,U,L,ee,de,ge,xe,Oe,ft=n+n+1,kt=r-1,Ae=o-1,V=n+1,Q=V*(V+1)/2,ne=new LS,Fe,K=ne;for(d=1;d<ft;d++)K=K.next=new LS,d==V&&(Fe=K);K.next=ne;var Y=null,ie=null;m=h=0;var rt=F4[n],st=P4[n];for(l=0;l<o;l++){for(k=M=U=L=b=_=g=S=0,x=V*(ee=s[h]),C=V*(de=s[h+1]),R=V*(ge=s[h+2]),T=V*(xe=s[h+3]),b+=Q*ee,_+=Q*de,g+=Q*ge,S+=Q*xe,K=ne,d=0;d<V;d++)K.r=ee,K.g=de,K.b=ge,K.a=xe,K=K.next;for(d=1;d<V;d++)c=h+((kt<d?kt:d)<<2),b+=(K.r=ee=s[c])*(Oe=V-d),_+=(K.g=de=s[c+1])*Oe,g+=(K.b=ge=s[c+2])*Oe,S+=(K.a=xe=s[c+3])*Oe,k+=ee,M+=de,U+=ge,L+=xe,K=K.next;for(Y=ne,ie=Fe,a=0;a<r;a++)s[h+3]=xe=S*rt>>st,xe!==0?(xe=255/xe,s[h]=(b*rt>>st)*xe,s[h+1]=(_*rt>>st)*xe,s[h+2]=(g*rt>>st)*xe):s[h]=s[h+1]=s[h+2]=0,b-=x,_-=C,g-=R,S-=T,x-=Y.r,C-=Y.g,R-=Y.b,T-=Y.a,c=m+((c=a+n+1)<kt?c:kt)<<2,k+=Y.r=s[c],M+=Y.g=s[c+1],U+=Y.b=s[c+2],L+=Y.a=s[c+3],b+=k,_+=M,g+=U,S+=L,Y=Y.next,x+=ee=ie.r,C+=de=ie.g,R+=ge=ie.b,T+=xe=ie.a,k-=ee,M-=de,U-=ge,L-=xe,ie=ie.next,h+=4;m+=r}for(a=0;a<r;a++){for(M=U=L=k=_=g=S=b=0,h=a<<2,x=V*(ee=s[h]),C=V*(de=s[h+1]),R=V*(ge=s[h+2]),T=V*(xe=s[h+3]),b+=Q*ee,_+=Q*de,g+=Q*ge,S+=Q*xe,K=ne,d=0;d<V;d++)K.r=ee,K.g=de,K.b=ge,K.a=xe,K=K.next;for(p=r,d=1;d<=n;d++)h=p+a<<2,b+=(K.r=ee=s[h])*(Oe=V-d),_+=(K.g=de=s[h+1])*Oe,g+=(K.b=ge=s[h+2])*Oe,S+=(K.a=xe=s[h+3])*Oe,k+=ee,M+=de,U+=ge,L+=xe,K=K.next,d<Ae&&(p+=r);for(h=a,Y=ne,ie=Fe,l=0;l<o;l++)c=h<<2,s[c+3]=xe=S*rt>>st,xe>0?(xe=255/xe,s[c]=b*rt>>st,s[c+1]=_*rt>>st,s[c+2]=g*rt>>st):s[c]=s[c+1]=s[c+2]=0,b-=x,_-=C,g-=R,S-=T,x-=Y.r,C-=Y.g,R-=Y.b,T-=Y.a,c=a+((c=l+V)<Ae?c:Ae)*r<<2,b+=k+=Y.r=s[c],_+=M+=Y.g=s[c+1],g+=U+=Y.b=s[c+2],S+=L+=Y.a=s[c+3],Y=Y.next,x+=ee=ie.r,C+=de=ie.g,R+=ge=ie.b,T+=xe=ie.a,k-=ee,M-=de,U-=ge,L-=xe,ie=ie.next,h+=r}}function LS(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const{OptionType:sv,UniformType:av,RendererType:NS}=Dt;class B4 extends _e{_initOptions(e={}){this._shaders=[],this._availableUniforms=Un.defaultUniforms,this._attributes=Un.defaultAttributes,this._vertexSource=Un.defaultVertexSource,this._fragmentSource=Un.defaultFragmentSource,this._initUniforms(),super._initOptions(e)}_initUniforms(){this._uniforms={};for(let e in this._availableUniforms){const t=this._availableUniforms[e];this._uniforms[e]={type:t.type,value:t.default||null}}for(let e in this.availableOptions){const t=this.availableOptions[e];t.uniformType?this._uniforms[`u_${e}`]={type:t.uniformType,value:t.default||null}:W.trace(this.constructor.name,`Option \`${e}\` is missing a \`uniformType\`!`)}}setOption(e,t,i=!0){super.setOption(e,t,i);let r=t;const o=this.availableOptions[e];if(!o.uniformType)return;let n=`u_${e}`;switch(o.type){case sv.COLOR:o.uniformType===av.FLOAT4?r=t.toGLColor():o.uniformType===av.FLOAT3&&(r=t.toRGBGLColor());break;case sv.VECTOR2:r=[t.x,t.y];break;case sv.COLOR_MATRIX:r=[t.a,t.b,t.c,t.d,t.f,t.g,t.h,t.i,t.k,t.l,t.m,t.n,t.p,t.q,t.r,t.s];let s=[t.e,t.j,t.o,t.t];this._uniforms[n+"_vec"]={value:s,type:av.FLOAT4}}this.setUniform(n,r)}setUniform(e,t,i=!1){this._uniforms[e].value=t}setUniforms(e,t=!1){for(let i in e)this._uniforms[i].value=e[i],t&&this.syncUniform(i)}syncUniform(e){this._shaders.forEach(t=>{t.syncUniform(e)})}syncUniforms(){this._shaders.forEach(e=>{e.syncUniforms()})}getShaderForRenderer(e){const t=e.getContext();let i=this._shaders[t.id];return i||(i=new Vd(e,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[t.id]=i),i}apply(e,t,i,r=!1){e.isOfType(NS.WEBGL)?this._applyWebGL(e,t,i,r):e.isOfType(NS.CANVAS)&&this._applyCanvas(e,t,i,r)}_applyWebGL(e,t,i,r=!1){const o=e.getContext(),n=this.getShaderForRenderer(e);e.setRenderTarget(i),r&&i.clear(),e.setShader(n);const s=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",s),n.syncUniforms(),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=i.getContext();W.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),n.clearRect(0,0,o.width,o.height),n.drawImage(o,0,0)}dispose(){this._shaders.forEach(e=>e.dispose()),this._shaders=[]}_blurImage(e,t,i){const r=10,o=e.getCanvas(),n=Math.min(1,r/(i*Math.min(o.width,o.height))),s=F.createCanvas();s.width=Math.round(o.width*n),s.height=Math.round(o.height*n);const a=s.getContext("2d");a.drawImage(o,0,0,o.width,o.height,0,0,s.width,s.height);const l=i*Math.min(s.width,s.height),d=a.getImageData(0,0,s.width,s.height);zS(d,0,0,s.width,s.height,l),a.putImageData(d,0,0),t.getContext().drawImage(s,0,0,s.width,s.height,0,0,o.width,o.height)}}var sn=B4;class lv extends sn{constructor(){super();this._fragmentSource=rFragUnpremultiply}}var US=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
}
`;const{OptionType:M4,UniformType:L4}=Dt;class HS extends sn{constructor(...e){super(...e);this._fragmentSource=US}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),{color:a}=this._options,l=n.getImageData(0,0,o.width,o.height),d=s.getImageData(0,0,o.width,o.height),c=o.width*o.height;let p=new N,h=new N;for(let m=0;m<c*4;m+=4){p.set(l.data[m]/255,l.data[m+1]/255,l.data[m+2]/255,l.data[m+3]/255),h.set(d.data[m]/255,d.data[m+1]/255,d.data[m+2]/255,d.data[m+3]/255);const b=h.r+p.a*(p.r-h.r);d.data[m]=(b+p.a*(a.r-b))*255;const _=h.g+p.a*(p.g-h.g);d.data[m+1]=(_+p.a*(a.g-_))*255;const g=h.b+p.a*(p.b-h.b);d.data[m+2]=(g+p.a*(a.b-g))*255}s.putImageData(d,0,0)}}HS.prototype.availableOptions={color:{type:M4.COLOR,default:N.WHITE,uniformType:L4.FLOAT4}};var GS=HS;var jS=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;
uniform int u_mode;

vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  if (u_mode == 0) {
    gl_FragColor = color * color.a;
  } else if (u_mode == 1) {
    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
  } else if (u_mode == 2) {
    float luminance = dot(color.rgb, W);
    vec3 colorized = vec3(luminance) * u_color.rgb;
    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;
  }
}
`;const{OptionType:WS,UniformType:VS}=Dt;class Xd extends sn{constructor(...e){super(...e);this._fragmentSource=jS}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),{mode:l,color:d}=this._options,{r:c,g:p,b:h,a:m}=d,b=[.2125,.7154,.0721];switch(l){case Xd.MODES.SOLID:for(let _=0;_<o.width*o.height;_++){const g=_*4;a.data[g]+=(c*255-a.data[g])*m,a.data[g+1]+=(p*255-a.data[g+1])*m,a.data[g+2]+=(h*255-a.data[g+2])*m}break;case Xd.MODES.COLORIZED:for(let _=0;_<o.width*o.height;_++){const g=_*4,S=a.data[g]/255*b[0]+a.data[g+1]/255*b[1]+a.data[g+2]/255*b[2],x=new N(S*c,S*p,S*h);a.data[g]+=(x.r*255-a.data[g])*m,a.data[g+1]+=(x.g*255-a.data[g+1])*m,a.data[g+2]+=(x.b*255-a.data[g+2])*m}break}s.putImageData(a,0,0)}}Xd.MODES={NONE:0,SOLID:1,COLORIZED:2};Xd.prototype.availableOptions={color:{type:WS.COLOR,default:N.WHITE,uniformType:VS.FLOAT4},mode:{type:WS.NUMBER,default:Xd.MODES.NONE,uniformType:VS.INT}};var KS=Xd;var $S=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform sampler2D u_overlayImage;
uniform int u_blendMode;
uniform float u_alpha;

const float EPSILON = 0.000001;

vec4 overlay(vec4 a, vec4 b) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 hardLight(vec4 b, vec4 a) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(b, vec4(result, b.a), u_alpha * a.a);
}

vec4 softLight(vec4 a, vec4 b) {
    vec3 result = mix(
          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),
          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),
          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 multiply(vec4 a, vec4 b) {
    vec3 result = a.rgb * b.rgb;
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 darken(vec4 a, vec4 b) {
    vec3 result = min(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 lighten(vec4 a, vec4 b) {
    vec3 result = max(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 screen(vec4 a, vec4 b) {
    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 colorBurn(vec4 a, vec4 b) {
    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 normal(vec4 a, vec4 b) {
    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);
}

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);

  vec4 resultColor;
  if (u_blendMode == 0) {
    resultColor = normal(color, overlayColor);
  } else if (u_blendMode == 1) {
    resultColor = overlay(color, overlayColor);
  } else if (u_blendMode == 2) {
    resultColor = hardLight(color, overlayColor);
  } else if (u_blendMode == 3) {
    resultColor = softLight(color, overlayColor);
  } else if (u_blendMode == 4) {
    resultColor = multiply(color, overlayColor);
  } else if (u_blendMode == 5) {
    resultColor = darken(color, overlayColor);
  } else if (u_blendMode == 6) {
    resultColor = lighten(color, overlayColor);
  } else if (u_blendMode == 7) {
    resultColor = screen(color, overlayColor);
  } else if (u_blendMode == 8) {
    resultColor = colorBurn(color, overlayColor);
  }
  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);
}
`;const{OptionType:Pm,UniformType:dv}=Dt,cv=1e-6;class Dr extends sn{constructor(...e){super(...e);this._fragmentSource=$S,this._lastImage=null}_applyCanvas(e,t,i,r=!1){const o=this._options.overlayTexture.getRenderTarget().getContext(),n=t.getCanvas(),s=t.getContext(),a=i.getContext(),l=s.getImageData(0,0,n.width,n.height),d=o.getImageData(0,0,n.width,n.height),{blendMode:c,alpha:p}=this._options;let h=new N,m=new N,b=new N;for(let _=0;_<n.width*n.height*4;_+=4){h.set(l.data[_]/255,l.data[_+1]/255,l.data[_+2]/255,l.data[_+3]/255),m.set(d.data[_]/255,d.data[_+1]/255,d.data[_+2]/255,d.data[_+3]/255);let g,S,x,C,R,T,k,M,U;switch(c){case Dr.BLEND_MODES.NORMAL:b.set(h.r+m.a*p*(m.r-h.r),h.g+m.a*p*(m.g-h.g),h.b+m.a*p*(m.b-h.b),h.a);break;case Dr.BLEND_MODES.OVERLAY:g=1-2*(1-h.r)*(1-m.r),S=2*h.r*m.r,x=g+(h.r<.5?1:0)*(S-g),C=1-2*(1-h.g)*(1-m.g),R=2*h.g*m.g,T=C+(h.g<.5?1:0)*(R-C),k=1-2*(1-h.b)*(1-m.b),M=2*h.b*m.b,U=k+(h.b<.5?1:0)*(M-k),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.HARD_LIGHT:g=1-2*(1-m.r)*(1-h.r),S=2*m.r*h.r,x=g+(m.r<.5?1:0)*(S-g),C=1-2*(1-m.g)*(1-h.g),R=2*m.g*h.g,T=C+(m.g<.5?1:0)*(R-C),k=1-2*(1-m.b)*(1-h.b),M=2*m.b*h.b,U=k+(m.b<.5?1:0)*(M-k),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.SOFT_LIGHT:g=2*h.r*(1-m.r)+(2*m.r-1)*Math.sqrt(h.r),S=2*h.r*m.r+h.r*h.r*(1-2*m.r),x=g+(m.r<.5?1:0)*(S-g),C=2*h.g*(1-m.g)+(2*m.g-1)*Math.sqrt(h.g),R=2*h.g*m.g+h.g*h.g*(1-2*m.g),T=C+(m.g<.5?1:0)*(R-C),k=2*h.b*(1-m.b)+(2*m.b-1)*Math.sqrt(h.b),M=2*h.b*m.b+h.b*h.b*(1-2*m.b),U=k+(m.b<.5?1:0)*(M-k),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.MULTIPLY:x=h.r*m.r,T=h.g*m.g,U=h.b*m.b,b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.DARKEN:x=Math.min(h.r,m.r),T=Math.min(h.g,m.g),U=Math.min(h.b,m.b),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.LIGHTEN:x=Math.max(h.r,m.r),T=Math.max(h.g,m.g),U=Math.max(h.b,m.b),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.SCREEN:x=1-(1-h.r)*(1-m.r),T=1-(1-h.g)*(1-m.g),U=1-(1-h.b)*(1-m.b),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break;case Dr.BLEND_MODES.COLOR_BURN:x=Math.max(0,Math.min(1,1-(1-h.r)/Math.max(m.r,cv))),T=Math.max(0,Math.min(1,1-(1-h.g)/Math.max(m.g,cv))),U=Math.max(0,Math.min(1,1-(1-h.b)/Math.max(m.b,cv))),b.set(h.r+m.a*p*(x-h.r),h.g+m.a*p*(T-h.g),h.b+m.a*p*(U-h.b),h.a);break}l.data[_]=b.r*255,l.data[_+1]=b.g*255,l.data[_+2]=b.b*255,l.data[_+3]=b.a*255}a.putImageData(l,0,0)}}Dr.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};Dr.prototype.availableOptions={blendMode:{type:Pm.NUMBER,default:Dr.BLEND_MODES.NORMAL,uniformType:dv.INT},overlayImage:{type:Pm.NUMBER,required:!0,uniformType:dv.SAMPLER2D},overlayTexture:{type:Pm.OBJECT,required:!0},alpha:{type:Pm.NUMBER,default:1,uniformType:dv.FLOAT}};var qS=Dr;const hv={};ut(hv,{ColorOverlayFilter:()=>GS,OverlayFilter:()=>qS,TintFilter:()=>KS,UnpremultiplyFilter:()=>lv});const z4={WebGLRenderer:Om,CanvasRenderer:tv,WebGLFilterManager:$d,CanvasFilterManager:Wd,DisplayObject:Kd,Container:Rm,BaseTexture:Wi,Texture:Am,RenderTexture:RS,WebGLRenderTarget:Gs,CanvasRenderTarget:Hs,Sprite:AS,Shaders:FS,Shader:Vd,Filter:sn,Filters:hv,PixelArrayImage:Vh,autoDetectRenderer:function(e,t,i={}){return Om.isSupported()?new Om(e,t,i):new tv(e,t,i)}};var A=z4;var XS=[{defaultName:"Natasha Wescoat",identifier:"imgly_art_filter_june_tree",rootPath:"art-filters/imgly_june_tree",thumbnail:"art-filters/imgly_june_tree/thumbnail.jpg"},{defaultName:"Hive",identifier:"imgly_art_filter_hive",rootPath:"art-filters/imgly_hive",thumbnail:"art-filters/imgly_hive/thumbnail.jpg"},{defaultName:"Udnie",identifier:"imgly_art_filter_udnie",rootPath:"art-filters/imgly_udnie",thumbnail:"art-filters/imgly_udnie/thumbnail.jpg"},{defaultName:"Vince Low",identifier:"imgly_art_filter_vince_low",rootPath:"art-filters/imgly_vince_low",thumbnail:"art-filters/imgly_vince_low/thumbnail.jpg"},{defaultName:"Mosaic",identifier:"imgly_art_filter_mosaic",rootPath:"art-filters/imgly_mosaic",thumbnail:"art-filters/imgly_mosaic/thumbnail.jpg"},{defaultName:"Wave",identifier:"imgly_art_filter_wave",rootPath:"art-filters/imgly_wave",thumbnail:"art-filters/imgly_wave/thumbnail.jpg"},{defaultName:"Malikova Darya",identifier:"imgly_art_filter_watercolor",rootPath:"art-filters/imgly_watercolor",thumbnail:"art-filters/imgly_watercolor/thumbnail.jpg"}];const Yd={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"};var ko={DEFAULTS:{ART_FILTERS:XS,FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}};const N4=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,U4=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;class Jd{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(e,t=!1){const i=t?U4:N4,r=i.exec(e);i.lastIndex=0,this._major=r[1],this._minor=r[2],this._patch=r[3]||0}equals(e){return this._major===e._major&&this._minor===e._minor&&this._patch===e._patch}isMoreRecentThan(e){if(this._major<e.major)return!1;if(this._major>e.major)return!0;if(this._minor<e.minor)return!1;if(this._minor>e.minor)return!0;if(this._patch<=e.patch)return!1;if(this._patch>e.patch)return!0}}let pv={};pv=window.navigator;var Vs,H4=244837814094590,YS=(H4&16777215)==15715070;function j(e,t,i){e!=null&&(typeof e=="number"?this.fromNumber(e,t,i):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function $e(){return new j(null)}function G4(e,t,i,r,o,n){for(;--n>=0;){var s=t*this[e++]+i[r]+o;o=Math.floor(s/67108864),i[r++]=s&67108863}return o}function j4(e,t,i,r,o,n){for(var s=t&32767,a=t>>15;--n>=0;){var l=this[e]&32767,d=this[e++]>>15,c=a*l+d*s;l=s*l+((c&32767)<<15)+i[r]+(o&1073741823),o=(l>>>30)+(c>>>15)+a*d+(o>>>30),i[r++]=l&1073741823}return o}function W4(e,t,i,r,o,n){for(var s=t&16383,a=t>>14;--n>=0;){var l=this[e]&16383,d=this[e++]>>14,c=a*l+d*s;l=s*l+((c&16383)<<14)+i[r]+o,o=(l>>28)+(c>>14)+a*d,i[r++]=l&268435455}return o}YS&&pv.appName=="Microsoft Internet Explorer"?(j.prototype.am=j4,Vs=30):YS&&pv.appName!="Netscape"?(j.prototype.am=G4,Vs=26):(j.prototype.am=W4,Vs=28);j.prototype.DB=Vs;j.prototype.DM=(1<<Vs)-1;j.prototype.DV=1<<Vs;var uv=52;j.prototype.FV=Math.pow(2,uv);j.prototype.F1=uv-Vs;j.prototype.F2=2*Vs-uv;var V4="0123456789abcdefghijklmnopqrstuvwxyz",Bm=new Array,Zd,Yr;Zd="0".charCodeAt(0);for(Yr=0;Yr<=9;++Yr)Bm[Zd++]=Yr;Zd="a".charCodeAt(0);for(Yr=10;Yr<36;++Yr)Bm[Zd++]=Yr;Zd="A".charCodeAt(0);for(Yr=10;Yr<36;++Yr)Bm[Zd++]=Yr;function JS(e){return V4.charAt(e)}function ZS(e,t){var i=Bm[e.charCodeAt(t)];return i==null?-1:i}function K4(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function $4(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Ks(e){var t=$e();return t.fromInt(e),t}function q4(e,t){var i;if(t==16)i=4;else if(t==8)i=3;else if(t==256)i=8;else if(t==2)i=1;else if(t==32)i=5;else if(t==4)i=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,o=!1,n=0;--r>=0;){var s=i==8?e[r]&255:ZS(e,r);if(s<0){e.charAt(r)=="-"&&(o=!0);continue}o=!1,n==0?this[this.t++]=s:n+i>this.DB?(this[this.t-1]|=(s&(1<<this.DB-n)-1)<<n,this[this.t++]=s>>this.DB-n):this[this.t-1]|=s<<n,n+=i,n>=this.DB&&(n-=this.DB)}i==8&&(e[0]&128)!=0&&(this.s=-1,n>0&&(this[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),o&&j.ZERO.subTo(this,this)}function X4(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function Y4(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var i=(1<<t)-1,r,o=!1,n="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(o=!0,n=JS(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&i,a<=0&&(a+=this.DB,--s)),r>0&&(o=!0),o&&(n+=JS(r));return o?n:"0"}function J4(){var e=$e();return j.ZERO.subTo(this,e),e}function Z4(){return this.s<0?this.negate():this}function Q4(e){var t=this.s-e.s;if(t!=0)return t;var i=this.t;if(t=i-e.t,t!=0)return this.s<0?-t:t;for(;--i>=0;)if((t=this[i]-e[i])!=0)return t;return 0}function Mm(e){var t=1,i;return(i=e>>>16)!=0&&(e=i,t+=16),(i=e>>8)!=0&&(e=i,t+=8),(i=e>>4)!=0&&(e=i,t+=4),(i=e>>2)!=0&&(e=i,t+=2),(i=e>>1)!=0&&(e=i,t+=1),t}function e3(){return this.t<=0?0:this.DB*(this.t-1)+Mm(this[this.t-1]^this.s&this.DM)}function t3(e,t){var i;for(i=this.t-1;i>=0;--i)t[i+e]=this[i];for(i=e-1;i>=0;--i)t[i]=0;t.t=this.t+e,t.s=this.s}function i3(e,t){for(var i=e;i<this.t;++i)t[i-e]=this[i];t.t=Math.max(this.t-e,0),t.s=this.s}function r3(e,t){var i=e%this.DB,r=this.DB-i,o=(1<<r)-1,n=Math.floor(e/this.DB),s=this.s<<i&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+n+1]=this[a]>>r|s,s=(this[a]&o)<<i;for(a=n-1;a>=0;--a)t[a]=0;t[n]=s,t.t=this.t+n+1,t.s=this.s,t.clamp()}function o3(e,t){t.s=this.s;var i=Math.floor(e/this.DB);if(i>=this.t){t.t=0;return}var r=e%this.DB,o=this.DB-r,n=(1<<r)-1;t[0]=this[i]>>r;for(var s=i+1;s<this.t;++s)t[s-i-1]|=(this[s]&n)<<o,t[s-i]=this[s]>>r;r>0&&(t[this.t-i-1]|=(this.s&n)<<o),t.t=this.t-i,t.clamp()}function n3(e,t){for(var i=0,r=0,o=Math.min(e.t,this.t);i<o;)r+=this[i]-e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r-=e[i],t[i++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[i++]=this.DV+r:r>0&&(t[i++]=r),t.t=i,t.clamp()}function s3(e,t){var i=this.abs(),r=e.abs(),o=i.t;for(t.t=o+r.t;--o>=0;)t[o]=0;for(o=0;o<r.t;++o)t[o+i.t]=i.am(0,r[o],t,o,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&j.ZERO.subTo(t,t)}function a3(e){for(var t=this.abs(),i=e.t=2*t.t;--i>=0;)e[i]=0;for(i=0;i<t.t-1;++i){var r=t.am(i,t[i],e,2*i,0,1);(e[i+t.t]+=t.am(i+1,2*t[i],e,2*i+1,r,t.t-i-1))>=t.DV&&(e[i+t.t]-=t.DV,e[i+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(i,t[i],e,2*i,0,1)),e.s=0,e.clamp()}function l3(e,t,i){var r=e.abs();if(r.t<=0)return;var o=this.abs();if(o.t<r.t){t!=null&&t.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=$e());var n=$e(),s=this.s,a=e.s,l=this.DB-Mm(r[r.t-1]);l>0?(r.lShiftTo(l,n),o.lShiftTo(l,i)):(r.copyTo(n),o.copyTo(i));var d=n.t,c=n[d-1];if(c==0)return;var p=c*(1<<this.F1)+(d>1?n[d-2]>>this.F2:0),h=this.FV/p,m=(1<<this.F1)/p,b=1<<this.F2,_=i.t,g=_-d,S=t==null?$e():t;for(n.dlShiftTo(g,S),i.compareTo(S)>=0&&(i[i.t++]=1,i.subTo(S,i)),j.ONE.dlShiftTo(d,S),S.subTo(n,n);n.t<d;)n[n.t++]=0;for(;--g>=0;){var x=i[--_]==c?this.DM:Math.floor(i[_]*h+(i[_-1]+b)*m);if((i[_]+=n.am(0,x,i,g,0,d))<x)for(n.dlShiftTo(g,S),i.subTo(S,i);i[_]<--x;)i.subTo(S,i)}t!=null&&(i.drShiftTo(d,t),s!=a&&j.ZERO.subTo(t,t)),i.t=d,i.clamp(),l>0&&i.rShiftTo(l,i),s<0&&j.ZERO.subTo(i,i)}function d3(e){var t=$e();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(j.ZERO)>0&&e.subTo(t,t),t}function ol(e){this.m=e}function c3(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function h3(e){return e}function p3(e){e.divRemTo(this.m,null,e)}function u3(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function m3(e,t){e.squareTo(t),this.reduce(t)}ol.prototype.convert=c3;ol.prototype.revert=h3;ol.prototype.reduce=p3;ol.prototype.mulTo=u3;ol.prototype.sqrTo=m3;function f3(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function nl(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function g3(e){var t=$e();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(j.ZERO)>0&&this.m.subTo(t,t),t}function b3(e){var t=$e();return e.copyTo(t),this.reduce(t),t}function y3(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var i=e[t]&32767,r=i*this.mpl+((i*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(i=t+this.m.t,e[i]+=this.m.am(0,r,e,t,0,this.m.t);e[i]>=e.DV;)e[i]-=e.DV,e[++i]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function v3(e,t){e.squareTo(t),this.reduce(t)}function _3(e,t,i){e.multiplyTo(t,i),this.reduce(i)}nl.prototype.convert=g3;nl.prototype.revert=b3;nl.prototype.reduce=y3;nl.prototype.mulTo=_3;nl.prototype.sqrTo=v3;function x3(){return(this.t>0?this[0]&1:this.s)==0}function w3(e,t){if(e>4294967295||e<1)return j.ONE;var i=$e(),r=$e(),o=t.convert(this),n=Mm(e)-1;for(o.copyTo(i);--n>=0;)if(t.sqrTo(i,r),(e&1<<n)>0)t.mulTo(r,o,i);else{var s=i;i=r,r=s}return t.revert(i)}function C3(e,t){var i;return e<256||t.isEven()?i=new ol(t):i=new nl(t),this.exp(e,i)}j.prototype.copyTo=K4;j.prototype.fromInt=$4;j.prototype.fromString=q4;j.prototype.clamp=X4;j.prototype.dlShiftTo=t3;j.prototype.drShiftTo=i3;j.prototype.lShiftTo=r3;j.prototype.rShiftTo=o3;j.prototype.subTo=n3;j.prototype.multiplyTo=s3;j.prototype.squareTo=a3;j.prototype.divRemTo=l3;j.prototype.invDigit=f3;j.prototype.isEven=x3;j.prototype.exp=w3;j.prototype.toString=Y4;j.prototype.negate=J4;j.prototype.abs=Z4;j.prototype.compareTo=Q4;j.prototype.bitLength=e3;j.prototype.mod=d3;j.prototype.modPowInt=C3;j.ZERO=Ks(0);j.ONE=Ks(1);function S3(){var e=$e();return this.copyTo(e),e}function T3(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function k3(){return this.t==0?this.s:this[0]<<24>>24}function E3(){return this.t==0?this.s:this[0]<<16>>16}function D3(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function I3(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function O3(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),i=Math.pow(e,t),r=Ks(i),o=$e(),n=$e(),s="";for(this.divRemTo(r,o,n);o.signum()>0;)s=(i+n.intValue()).toString(e).substr(1)+s,o.divRemTo(r,o,n);return n.intValue().toString(e)+s}function R3(e,t){this.fromInt(0),t==null&&(t=10);for(var i=this.chunkSize(t),r=Math.pow(t,i),o=!1,n=0,s=0,a=0;a<e.length;++a){var l=ZS(e,a);if(l<0){e.charAt(a)=="-"&&this.signum()==0&&(o=!0);continue}s=t*s+l,++n>=i&&(this.dMultiply(r),this.dAddOffset(s,0),n=0,s=0)}n>0&&(this.dMultiply(Math.pow(t,n)),this.dAddOffset(s,0)),o&&j.ZERO.subTo(this,this)}function A3(e,t,i){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(j.ONE.shiftLeft(e-1),mv,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(j.ONE.shiftLeft(e-1),this);else{var r=new Array,o=e&7;r.length=(e>>3)+1,t.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}}function F3(){var e=this.t,t=new Array;t[0]=this.s;var i=this.DB-e*this.DB%8,r,o=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[o++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),(r&128)!=0&&(r|=-256),o==0&&(this.s&128)!=(r&128)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t}function P3(e){return this.compareTo(e)==0}function B3(e){return this.compareTo(e)<0?this:e}function M3(e){return this.compareTo(e)>0?this:e}function L3(e,t,i){var r,o,n=Math.min(e.t,this.t);for(r=0;r<n;++r)i[r]=t(this[r],e[r]);if(e.t<this.t){for(o=e.s&this.DM,r=n;r<this.t;++r)i[r]=t(this[r],o);i.t=this.t}else{for(o=this.s&this.DM,r=n;r<e.t;++r)i[r]=t(o,e[r]);i.t=e.t}i.s=t(this.s,e.s),i.clamp()}function z3(e,t){return e&t}function N3(e){var t=$e();return this.bitwiseTo(e,z3,t),t}function mv(e,t){return e|t}function U3(e){var t=$e();return this.bitwiseTo(e,mv,t),t}function QS(e,t){return e^t}function H3(e){var t=$e();return this.bitwiseTo(e,QS,t),t}function eT(e,t){return e&~t}function G3(e){var t=$e();return this.bitwiseTo(e,eT,t),t}function j3(){for(var e=$e(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function W3(e){var t=$e();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function V3(e){var t=$e();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function K3(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function $3(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+K3(this[e]);return this.s<0?this.t*this.DB:-1}function q3(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function X3(){for(var e=0,t=this.s&this.DM,i=0;i<this.t;++i)e+=q3(this[i]^t);return e}function Y3(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function J3(e,t){var i=j.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i}function Z3(e){return this.changeBit(e,mv)}function Q3(e){return this.changeBit(e,eT)}function eN(e){return this.changeBit(e,QS)}function tN(e,t){for(var i=0,r=0,o=Math.min(e.t,this.t);i<o;)r+=this[i]+e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r+=e[i],t[i++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[i++]=r:r<-1&&(t[i++]=this.DV+r),t.t=i,t.clamp()}function iN(e){var t=$e();return this.addTo(e,t),t}function rN(e){var t=$e();return this.subTo(e,t),t}function oN(e){var t=$e();return this.multiplyTo(e,t),t}function nN(){var e=$e();return this.squareTo(e),e}function sN(e){var t=$e();return this.divRemTo(e,t,null),t}function aN(e){var t=$e();return this.divRemTo(e,null,t),t}function lN(e){var t=$e(),i=$e();return this.divRemTo(e,t,i),new Array(t,i)}function dN(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function cN(e,t){if(e==0)return;for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}function $h(){}function tT(e){return e}function hN(e,t,i){e.multiplyTo(t,i)}function pN(e,t){e.squareTo(t)}$h.prototype.convert=tT;$h.prototype.revert=tT;$h.prototype.mulTo=hN;$h.prototype.sqrTo=pN;function uN(e){return this.exp(e,new $h)}function mN(e,t,i){var r=Math.min(this.t+e.t,t);for(i.s=0,i.t=r;r>0;)i[--r]=0;var o;for(o=i.t-this.t;r<o;++r)i[r+this.t]=this.am(0,e[r],i,r,0,this.t);for(o=Math.min(e.t,t);r<o;++r)this.am(0,e[r],i,r,0,t-r);i.clamp()}function fN(e,t,i){--t;var r=i.t=this.t+e.t-t;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)i[this.t+r-t]=this.am(t-r,e[r],i,0,0,this.t+r-t);i.clamp(),i.drShiftTo(1,i)}function Qd(e){this.r2=$e(),this.q3=$e(),j.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function gN(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=$e();return e.copyTo(t),this.reduce(t),t}function bN(e){return e}function yN(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function vN(e,t){e.squareTo(t),this.reduce(t)}function _N(e,t,i){e.multiplyTo(t,i),this.reduce(i)}Qd.prototype.convert=gN;Qd.prototype.revert=bN;Qd.prototype.reduce=yN;Qd.prototype.mulTo=_N;Qd.prototype.sqrTo=vN;function xN(e,t){var i=e.bitLength(),r,o=Ks(1),n;if(i<=0)return o;i<18?r=1:i<48?r=3:i<144?r=4:i<768?r=5:r=6,i<8?n=new ol(t):t.isEven()?n=new Qd(t):n=new nl(t);var s=new Array,a=3,l=r-1,d=(1<<r)-1;if(s[1]=n.convert(this),r>1){var c=$e();for(n.sqrTo(s[1],c);a<=d;)s[a]=$e(),n.mulTo(c,s[a-2],s[a]),a+=2}var p=e.t-1,h,m=!0,b=$e(),_;for(i=Mm(e[p])-1;p>=0;){for(i>=l?h=e[p]>>i-l&d:(h=(e[p]&(1<<i+1)-1)<<l-i,p>0&&(h|=e[p-1]>>this.DB+i-l)),a=r;(h&1)==0;)h>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),m)s[h].copyTo(o),m=!1;else{for(;a>1;)n.sqrTo(o,b),n.sqrTo(b,o),a-=2;a>0?n.sqrTo(o,b):(_=o,o=b,b=_),n.mulTo(b,s[h],o)}for(;p>=0&&(e[p]&1<<i)==0;)n.sqrTo(o,b),_=o,o=b,b=_,--i<0&&(i=this.DB-1,--p)}return n.revert(o)}function wN(e){var t=this.s<0?this.negate():this.clone(),i=e.s<0?e.negate():e.clone();if(t.compareTo(i)<0){var r=t;t=i,i=r}var o=t.getLowestSetBit(),n=i.getLowestSetBit();if(n<0)return t;for(o<n&&(n=o),n>0&&(t.rShiftTo(n,t),i.rShiftTo(n,i));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=i.getLowestSetBit())>0&&i.rShiftTo(o,i),t.compareTo(i)>=0?(t.subTo(i,t),t.rShiftTo(1,t)):(i.subTo(t,i),i.rShiftTo(1,i));return n>0&&i.lShiftTo(n,i),i}function CN(e){if(e<=0)return 0;var t=this.DV%e,i=this.s<0?e-1:0;if(this.t>0)if(t==0)i=this[0]%e;else for(var r=this.t-1;r>=0;--r)i=(t*i+this[r])%e;return i}function SN(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return j.ZERO;for(var i=e.clone(),r=this.clone(),o=Ks(1),n=Ks(0),s=Ks(0),a=Ks(1);i.signum()!=0;){for(;i.isEven();)i.rShiftTo(1,i),t?((!o.isEven()||!n.isEven())&&(o.addTo(this,o),n.subTo(e,n)),o.rShiftTo(1,o)):n.isEven()||n.subTo(e,n),n.rShiftTo(1,n);for(;r.isEven();)r.rShiftTo(1,r),t?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);i.compareTo(r)>=0?(i.subTo(r,i),t&&o.subTo(s,o),n.subTo(a,n)):(r.subTo(i,r),t&&s.subTo(o,s),a.subTo(n,a))}if(r.compareTo(j.ONE)!=0)return j.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var Vi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],TN=(1<<26)/Vi[Vi.length-1];function kN(e){var t,i=this.abs();if(i.t==1&&i[0]<=Vi[Vi.length-1]){for(t=0;t<Vi.length;++t)if(i[0]==Vi[t])return!0;return!1}if(i.isEven())return!1;for(t=1;t<Vi.length;){for(var r=Vi[t],o=t+1;o<Vi.length&&r<TN;)r*=Vi[o++];for(r=i.modInt(r);t<o;)if(r%Vi[t++]==0)return!1}return i.millerRabin(e)}function EN(e){var t=this.subtract(j.ONE),i=t.getLowestSetBit();if(i<=0)return!1;var r=t.shiftRight(i);e=e+1>>1,e>Vi.length&&(e=Vi.length);for(var o=$e(),n=0;n<e;++n){o.fromInt(Vi[Math.floor(Math.random()*Vi.length)]);var s=o.modPow(r,this);if(s.compareTo(j.ONE)!=0&&s.compareTo(t)!=0){for(var a=1;a++<i&&s.compareTo(t)!=0;)if(s=s.modPowInt(2,this),s.compareTo(j.ONE)==0)return!1;if(s.compareTo(t)!=0)return!1}}return!0}j.prototype.chunkSize=D3;j.prototype.toRadix=O3;j.prototype.fromRadix=R3;j.prototype.fromNumber=A3;j.prototype.bitwiseTo=L3;j.prototype.changeBit=J3;j.prototype.addTo=tN;j.prototype.dMultiply=dN;j.prototype.dAddOffset=cN;j.prototype.multiplyLowerTo=mN;j.prototype.multiplyUpperTo=fN;j.prototype.modInt=CN;j.prototype.millerRabin=EN;j.prototype.clone=S3;j.prototype.intValue=T3;j.prototype.byteValue=k3;j.prototype.shortValue=E3;j.prototype.signum=I3;j.prototype.toByteArray=F3;j.prototype.equals=P3;j.prototype.min=B3;j.prototype.max=M3;j.prototype.and=N3;j.prototype.or=U3;j.prototype.xor=H3;j.prototype.andNot=G3;j.prototype.not=j3;j.prototype.shiftLeft=W3;j.prototype.shiftRight=V3;j.prototype.getLowestSetBit=$3;j.prototype.bitCount=X3;j.prototype.testBit=Y3;j.prototype.setBit=Z3;j.prototype.clearBit=Q3;j.prototype.flipBit=eN;j.prototype.add=iN;j.prototype.subtract=rN;j.prototype.multiply=oN;j.prototype.divide=sN;j.prototype.remainder=aN;j.prototype.divideAndRemainder=lN;j.prototype.modPow=xN;j.prototype.modInverse=SN;j.prototype.pow=uN;j.prototype.gcd=wN;j.prototype.isProbablePrime=kN;j.prototype.square=nN;var iT=j;const fv=v(Xw()),DN=5e3,qh=typeof window!="undefined"?window:global;class lr{constructor(e){this._url=e,this._parsedUrl=fv.default.parse(this._url,!0)}_isJSONPRequest(){const{query:e}=this._parsedUrl;for(let t in e){const i=e[t];if(i==="?")return!0}return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new ce((e,t)=>{let i;qh.XDomainRequest?(i=new qh.XDomainRequest,i.onload=function(){const r=JSON.parse(i.responseText);e(r)},i.onerror=function(r){t(r)},i.open("GET",this._url,!0),i.send()):qh.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(r){if(i.readyState===4)if(i.status===200){const o=JSON.parse(i.responseText);e(o)}else t(new Error(`HTTP Status ${i.status}`))},i.open("GET",this._url,!0),i.send())})}_loadJSONP(){let e=!1,t=!1;const i="pesdk"+Math.round(Math.random()*99999999999999);return new ce((r,o)=>{const n=this._createJSONPNode(i);qh[i]=s=>{this._removeJSONPNode(n),e||(t=!0,r(s))},qh.setTimeout(()=>{t||(this._removeJSONPNode(n),e=!0,o(new Error("Timeout of 5 seconds exceeded.")))},DN)})}_createJSONPNode(e){const t=this._buildJSONPUrl(e),i=document.querySelector("head"),r=document.createElement("script");return r.src=t,i.appendChild(r),r}_removeJSONPNode(e){e.parentNode.removeChild(e)}_buildJSONPUrl(e){const{query:t}=this._parsedUrl;let i=null;for(let r in t)if(t[r]==="?"){i=r;break}return delete this._parsedUrl.search,t[i]=e,fv.default.format(this._parsedUrl)}}function rT(e){var t=8,i=0;function r(g,S){var x=(g&65535)+(S&65535),C=(g>>16)+(S>>16)+(x>>16);return C<<16|x&65535}function o(g,S){return g>>>S|g<<32-S}function n(g,S){return g>>>S}function s(g,S,x){return g&S^~g&x}function a(g,S,x){return g&S^g&x^S&x}function l(g){return o(g,2)^o(g,13)^o(g,22)}function d(g){return o(g,6)^o(g,11)^o(g,25)}function c(g){return o(g,7)^o(g,18)^n(g,3)}function p(g){return o(g,17)^o(g,19)^n(g,10)}function h(g,S){var x=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),C=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),R=new Array(64),T,k,M,U,L,ee,de,ge,xe,Oe,ft,kt;g[S>>5]|=128<<24-S%32,g[(S+64>>9<<4)+15]=S;for(var xe=0;xe<g.length;xe+=16){T=C[0],k=C[1],M=C[2],U=C[3],L=C[4],ee=C[5],de=C[6],ge=C[7];for(var Oe=0;Oe<64;Oe++)Oe<16?R[Oe]=g[Oe+xe]:R[Oe]=r(r(r(p(R[Oe-2]),R[Oe-7]),c(R[Oe-15])),R[Oe-16]),ft=r(r(r(r(ge,d(L)),s(L,ee,de)),x[Oe]),R[Oe]),kt=r(l(T),a(T,k,M)),ge=de,de=ee,ee=L,L=r(U,ft),U=M,M=k,k=T,T=r(ft,kt);C[0]=r(T,C[0]),C[1]=r(k,C[1]),C[2]=r(M,C[2]),C[3]=r(U,C[3]),C[4]=r(L,C[4]),C[5]=r(ee,C[5]),C[6]=r(de,C[6]),C[7]=r(ge,C[7])}return C}function m(g){for(var S=Array(),x=(1<<t)-1,C=0;C<g.length*t;C+=t)S[C>>5]|=(g.charCodeAt(C/t)&x)<<24-C%32;return S}function b(g){g=g.replace(/\r\n/g,`
`);for(var S="",x=0;x<g.length;x++){var C=g.charCodeAt(x);C<128?S+=String.fromCharCode(C):C>127&&C<2048?(S+=String.fromCharCode(C>>6|192),S+=String.fromCharCode(C&63|128)):(S+=String.fromCharCode(C>>12|224),S+=String.fromCharCode(C>>6&63|128),S+=String.fromCharCode(C&63|128))}return S}function _(g){for(var S=i?"0123456789ABCDEF":"0123456789abcdef",x="",C=0;C<g.length*4;C++)x+=S.charAt(g[C>>2]>>(3-C%4)*8+4&15)+S.charAt(g[C>>2]>>(3-C%4)*8&15);return x}return e=b(e),_(h(m(e),e.length*t))}const _i=e=>F.byteArrayToString(kr.decode(e));function IN(e){return e.map(t=>("0"+(t&255).toString(16)).slice(-2)).join("")}const ON="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=",RN="ZW50ZXJwcmlzZV9saWNlbnNl",oT="YXBwX2lkZW50aWZpZXJz",AN="cGxhdGZvcm0=",nT="ZmVhdHVyZXM=",gv="ZXhwaXJlc19hdA==",FN="ZG9tYWlucw==",PN="YXBpX3Rva2Vu",bv="c2lnbmF0dXJl",BN="dmVyc2lvbg==";class MN{constructor(e){this._version="2.4",this._l=typeof e=="string"?e.trim():e,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(e){return this._decLic={},!1}return!0}_hostnameValid(){if(typeof window=="undefined")return!0;if(!this._decLic[_i(oT)].length)return!0;const{hostname:e}=window.location;let t=!1;return this._decLic[_i(oT)].forEach(i=>{F.wildCardMatch(e,i)&&(t=!0)}),t}_platformValid(){const e=this._decLic[_i(AN)],t="HTML5";return t===e}c(){return new Promise((e,t)=>{const i=this._validateError();i!==null&&t(i),e()})}validate(){const e=this._validateError();return!(e!==null)}_validateError(){const e=typeof this._l;if(e!=="string"||!this._jsonValid()){const t=new Error;return t.code="ELICINVFMT",t}if(!this._sigValid()){const t=new Error;return t.code="ELICINV",t}if(!this._hostnameValid()){const t=new Error;return t.code="ELICINVHOST",t}if(!this._platformValid()){const t=new Error;return t.code="ELICINVPLAT",t}if(this.isExp()){const t=new Error;return t.code="ELICEXP",t}return null}isToolAllowed(e){return this._includesFeature(e)}isWhiteLabel(){return this._includesFeature("whitelabel",new Jd("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new Jd("2.4",!0))}t(){if(this._decLic.enterprise_license)return Promise.resolve();if(this._includesFeature("noexporttracking",new Jd("2.4",!0)))return Promise.resolve();const e=this._decLic[_i(FN)][0]+_i(_i(ON))+this._decLic[_i(PN)],t=new lr(e);return t.load()}isENT(){return this._decLic?this._decLic[_i(RN)]:!1}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[_i(gv)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(e=Date.now()){return this._decLic[_i(gv)]===null?!1:e>this._expAt()}_expAt(){return this._decLic[_i(gv)]*1e3}_verify(e,t){let i,r;r=this._encodeMessage(e),i=this._decodeSignature(t),i=i.substr(-64);const o=r===i;return o}_encodeMessage(e){const t=rT(e);return t}_decodeSignature(e){let t;return e=kr.decode(e),e=IN(e),e=this._parseBigInt(e,16),t=e.modPowInt(this._e,this._n),t=t.toString(16),t}_parseBigInt(e,t){return new iT(e,t)}_parseLicense(){if(typeof this._l!="string")return;if(!this._jsonValid())return;this._sig=this._decLic[_i(bv)]||"",delete this._decLic[_i(bv)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${_i(bv)}":"([^"]*)"`),"")}_includesFeature(e,t=new Jd("1.0",!0)){const i=new Jd(this._decLic[_i(BN)],!0);return t.isMoreRecentThan(i)?!0:this._decLic[_i(nT)]&&this._decLic[_i(nT)].indexOf(e)!==-1}}class sT{v(){return!0}c(){return Promise.resolve()}isToolAllowed(e){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(e=Date.now()){return!1}}var Lm=MN;const sl=typeof window=="undefined"?global:window;let Hn=sl.requestAnimationFrame,$s=sl.cancelAnimationFrame,aT=0;const zm=["ms","moz","webkit","o"];for(let e=0;e<zm.length&&!Hn;++e)Hn=sl[zm[e]+"RequestAnimationFrame"],$s=sl[zm[e]+"CancelAnimationFrame"]||sl[zm[e]+"CancelRequestAnimationFrame"];Hn&&(Hn=Hn.bind(sl));$s&&($s=$s.bind(sl));Hn||(Hn=function(e,t){const i=new Date().getTime(),r=Math.max(0,16-(i-aT)),o=setTimeout(function(){e(i+r)},r);return aT=i+r,o});$s||($s=function(e){clearTimeout(e)});class Ir{constructor(e,t,i){this.x=e,this.y=t,this.z=i,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0),typeof this.z=="undefined"&&(this.z=0)}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}clone(){return new Ir(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clamp(e,t){let i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof Ir)&&i&&(e=new Ir(e,e,e)),!(t instanceof Ir)&&r&&(t=new Ir(t,t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y),this.z=Math.max(e.z,this.z)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y),this.z=Math.min(t.z,this.z)),this}divide(e){return e instanceof Ir?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e),this}subtract(e){return e instanceof Ir?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e),this}multiply(e){return e instanceof Ir?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e),this}add(e){return e instanceof Ir?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e),this}equals(e){return e instanceof Ir?e.x===this.x&&e.y===this.y&&e.z===this.z:e===this.x&&e===this.y&&e===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x=this.x%1,this.y=this.y%1,this.z=this.z%1,this}toInt(){return this.x=this.x|0,this.y=this.y|0,this.z=this.z|0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this.z=parseFloat(this.z.toFixed(e)),this}static fromObject(e){return new Ir(e.x,e.y,e.z)}static get NULL(){return new Ir(0,0,0)}}var yv=Ir;class LN{constructor(e,t){this.min=e,this.max=t}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(e){return this.min<=e&&e<=this.max}}var vv=LN;class zN{constructor(e=new re(0,0),t=new re(1,1),i=new re(2,-1),r=new re(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone(),this._segments=[],this._length=-1,this._sample=[]}set(e=new re(0,0),t=new re(1,1),i=new re(2,1),r=new re(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone()}getLength(){return this._length}calculateSegments(e=100){let t=0,i=0,r=[],o=1/e,n=this._p0.clone();for(let s=1;s<=e;s++){let a=[];a.push({t,s:i,point:n}),t+=o,t=Math.min(t,1);let l=this.evalAt(t),d=l.clone().subtract(n);i+=d.len(),a.push({t,s:i,point:l}),r.push(a),n=l}return this._segments=r,this._length=i,i}evalAt(e){e=this.normalizeParameter(e);const t=this._p0.clone().multiply((1-e)**3),i=this._p1.clone().multiply(3*(1-e)*(1-e)*e),r=this._p2.clone().multiply(3*(1-e)*e*e),o=this._p3.clone().multiply(e*e*e);return t.add(i).add(r).add(o)}isInSegment(e,t){return e=this.normalizeArcLength(e),e>=t[0].s&&e<=t[1].s}getArcLengthSegment(e){e=this.normalizeArcLength(e);for(let t=0;t<this._segments.length;t++){let i=this._segments[t];if(this.isInSegment(e,i))return i}return null}normalizeArcLength(e){return Math.max(Math.min(this._length,e),0)}normalizeParameter(e){return Math.max(Math.min(1,e),0)}getParameterForArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return W.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return r*i[0].t+(1-r)*i[1].t}evalAtArcLength(e){return this.evalAt(this.getParameterForArcLength(e))}approximateAtArcLength(e){let t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return-1;let r=(t-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(r).add(i[1].point.clone().multiply(1-r))}parameterSample(e=100){const t=1/e;let i=[],r=0;for(let o=0;o<=e+1;o++)i.push(this.evalAt(r)),r+=t;return this._sample=i,[...i]}arcLengthApproxSample(e=100,t=!1,i=!1){const r=this._length/e;let o=[],n=0;for(let s=t?1:0;s<e+1;s++)o.push(this.approximateAtArcLength(n)),n+=r;return i&&o.pop(),this._sample=o,[...o]}}var _v=zN;const H={};ut(H,{ColorMatrix:()=>Kh,CubicBezierCurve:()=>_v,Matrix:()=>Xr,Range:()=>vv,Rectangle:()=>Qe,Vector2:()=>re,Vector3:()=>yv});const Xh={};ut(Xh,{Base64:()=>kr,Color:()=>N,ColorMatrix:()=>Kh,Configurable:()=>_e,Constants:()=>Dt,CubicBezierCurve:()=>_v,Engine:()=>A,EventEmitter:()=>Ri,Events:()=>Yd,FreeLicenseChecker:()=>sT,GLUtils:()=>To,LicenseChecker:()=>Lm,Log:()=>W,Matrix:()=>Xr,Promise:()=>ce,Range:()=>vv,Rectangle:()=>Qe,Utils:()=>F,Vector2:()=>re,Vector3:()=>yv,cancelAnimationFrame:()=>$s,requestAnimationFrame:()=>Hn});Function.prototype.name===void 0&&Object.defineProperty!==void 0&&Object.defineProperty(Function.prototype,"name",{get:function(){var e=/function\s([^(]{1,})\(/,t=e.exec(this.toString());return t&&t.length>1?t[1].trim():""},set:function(e){}});const lT=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Sh();class NN{constructor(e,t){this._tag=e,this._name=t,this._start=lT()}stop(){const e=lT(),t=e-this._start,i=Math.round(1e3/t);W.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${i} FPS)`)}}var Nm=NN;class dT extends _e{constructor(e,t={}){super(t,{enabled:{type:f.BOOLEAN,default:!0,serializable:!1}});this._sdk=e,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new A.Sprite,this._container=new A.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(e){if(!this.getEnabled())return W.info(this.constructor.name,"Disabled - skipping"),ce.resolve(e);if(!this._renderTexture){const o=e.getDimensions().floor();this._renderTexture=new A.RenderTexture(this._sdk.getRenderer(),o.x,o.y)}const t=this._sdk.getRenderer();let i,r;if(W.canLog("info")&&(r=new Nm(this.constructor.name,"Rendering")),this.isDirtyForRenderer(t)){this._sprite.setTexture(e);const o=this.getNewDimensions(e.getDimensions()).floor();this._renderTexture.resizeTo(o),this._renderTexture.clear(),i=this._render(e).then((n=!1)=>(this.setDirtyForRenderer(n,t),this._renderTexture))}else W.info(this.constructor.name,"Rendering from cache"),i=ce.resolve(this._renderTexture);return i.then(o=>(r&&r.stop(),o))}_render(e){let t;return this._sdk.getRenderer().isOfType(Ee.WEBGL)?t=this._renderWebGL.bind(this):t=this._renderCanvas.bind(this),t(e)}_renderWebGL(e){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(e){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(e){return e.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(e,t){this._tempTransformChange=e,this._tempInverseTransformChange=t}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(e){const t=this._dirtiness[e.id];return typeof t=="undefined"?!0:t}setDirtyForRenderer(e,t,i=!1){this._dirtiness[t.id]=e}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,{id:i},t)}getSDK(){return this._sdk}getInputDimensions(e=!0){let t=this._sdk.getInputDimensions();e&&t.multiply(this._sdk.getZoom()).floor();let i;return this._sdk.getOperationsStack().forEach(r=>{if(i)return;if(r===this){i=!0;return}t=r.getNewDimensions(t)}),t.floor()}clone(){const e=this.constructor;return new e(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}}dT.identifier=null;var Ge=dT;const{OptionType:UN}=Dt;class xv extends Ge{getRotation(){let e=0;switch(this.getTags().Orientation){case 7:case 8:e=-90;break;case 3:case 4:e=-180;break;case 5:case 6:e=90;break}return e}_getFlipVertically(){const{Orientation:e}=this.getTags();return[5,7].indexOf(e)!==-1}_getFlipHorizontally(){const{Orientation:e}=this.getTags();return[2,4].indexOf(e)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(e){const t=this._getFinalOptions(),i=t.rotation%360,r=i*(Math.PI/180);this._sprite.setScale(t.flipHorizontally?-1:1,t.flipVertically?-1:1),this._sprite.setRotation(r),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const o=this._sprite.getBounds();return this._renderTexture.resizeTo(new re(o.width,o.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),ce.resolve()}getNewDimensions(e){const t=this._getFinalOptions();return e=e.clone(),t.rotation%180&&e.flip(),e}applyTo(e){const t=this._getFinalOptions();let i=F.createCanvas();Math.abs(t.rotation%180)===90?(i.width=e.height,i.height=e.width):(i.width=e.width,i.height=e.height);const r=i.getContext("2d"),o=t.rotation*Math.PI/180,n=.5*(i.width-e.width),s=.5*(i.height-e.height);return r.translate(n,s),r.translate(.5*e.width,.5*e.height),r.rotate(o),r.translate(-.5*e.width,-.5*e.height),t.flipVertically&&(r.translate(0,e.height),r.scale(1,-1)),t.flipHorizontally&&(r.translate(e.width,0),r.scale(-1,1)),r.drawImage(e,0,0),i}}xv.identifier="exif-orientation";xv.prototype.availableOptions={tags:{type:UN.OBJECT,default:{}}};var cT=xv;const ec={};ut(ec,{ExifOrientationOperation:()=>cT});class hT extends Ri{constructor(e=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=e,this._stack.forEach(t=>{t.on("update",this._onOperationUpdate)})}clear(){this.forEach(e=>this.remove(e)),this._stack=[]}hasChanges(){return this._stack.filter(e=>!!e).some(e=>e.hasChanges())}_onOperationUpdate(e,t){this.emit(Yd.OPERATION_UPDATED,e,t)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(e){return this._stack.filter(t=>!!t).forEach(e)}render(e,t){let i=t;const r=this._stack.filter(l=>!!l).filter(l=>l.getEnabled());r.reverse();let o=r.filter(l=>!l.isDirtyForRenderer(e.getRenderer()))[0],n=r.indexOf(o);r.reverse();let s=0;n!==-1&&(s=r.length-n-1);for(let l=0;l<s;l++)W.info(this.constructor.name,`Skipping ${r[l].constructor.name}`);let a=ce.resolve(i);for(let l=s;l<r.length;l++){const d=r[l];let c,p;a=a.then(h=>d.render(h).then(m=>(c&&m!==c&&!this._cacheEnabled&&p.disposeRenderTextures(),c=m,p=d,m)))}return a.then(l=>{const d=!r.some(c=>c.isDirtyForRenderer(e.getRenderer()));return{outputTexture:l,renderDone:d}})}validateSettings(){return ce.all(this._stack.filter(e=>!!e).map(e=>e.validateSettings()))}setAllToDirty(e=!1){this.forEach(t=>t.setDirty(!0,e))}updateDirtinessForRenderer(e){let t=!1;for(let i=0;i<this._stack.length;i++){let r=this._stack[i];if(!r)continue;r.isDirtyForRenderer(e)&&(t=!0),t&&r.setDirtyForRenderer(!0,e)}}push(e){this._stack.push(e),e.on("update",this._onOperationUpdate)}pop(){const e=this._stack.pop();e&&(e.off("update",this._onOperationUpdate),e.dispose())}unshift(e){this._stack.unshift(e),e.on("update",this._onOperationUpdate)}clone(){return new hT(this._stack.slice(0))}get(e){return this._stack[e]}getByIdentifier(e){return F.Array.find(this._stack,t=>t&&t.constructor.identifier===e)}getIndexByIdentifier(e){return F.Array.findIndex(this._stack,t=>t&&t.constructor.identifier===e)}moveToTop(e){let t=F.Array.findIndex(this._stack,r=>r&&r.constructor.identifier===e);if(t<0||t===this._stack.length-1)return;const i=this.getByIdentifier(e);this._stack.splice(t,1),this._stack[this._stack.length]=i}set(e,t){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack[e]=t,t.on("update",this._onOperationUpdate)}remove(e){const t=this._stack.indexOf(e);if(t===-1)return;this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack.splice(t,1)}removeAt(e){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),delete this._stack[e]}getStack(){return this._stack}dispose(){this.forEach(e=>{e.dispose()})}}var Um=hT;class HN{constructor(e){this._head=0,this._buf=e}peekInt8(){return this._buf[this._head]}peekInt16(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1];return e?(i<<8)+t:(t<<8)+i}peekInt24(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2];return e?(r<<16)+(i<<8)+t:(t<<16)+(i<<8)+r}peekInt32(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2],o=this._buf[this._head+3];return e?(o<<32)+(r<<16)+(i<<8)+t:(t<<32)+(i<<16)+(r<<8)+o}writeInt8(e){this._buf[this._head]=e&255}writeInt16(e){this._buf[this._head]=e>>8,this._buf[this._head+1]=e&255}readInt8(){const e=this.peekInt8();return this._head+=1,e}readInt16(e=!1){const t=this.peekInt16(e);return this._head+=2,t}readInt24(e=!1){const t=this.peekInt24(e);return this._head+=3,t}readInt32(e=!1){const t=this.peekInt32(e);return this._head+=4,t}readString(e){let t="";for(let i=0;i<e;i++){const r=this.readInt8();t+=String.fromCharCode(r)}return t}getHead(){return this._head}setHead(e){this._head=e}}var al=HN;const GN={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},jN={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var tc={MARKERS:GN,EXIF_TAGS:jN};const{MARKERS:WN}=tc;class VN{constructor(e){this._buf=e,this._stream=new al(this._buf),this._stream.setHead(0)}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==WN.APP0)return!1;const t=this._stream.readInt16();if(!(t>=16))return!1;const i=this._stream.readString(4),r=this._stream.readInt8();return i==="JFIF"?r===0:!1}setUnitDensity(e){this._stream.setHead(11),this._stream.writeInt8(e)}setDensityX(e){this._stream.setHead(12),this._stream.writeInt16(e)}setDensityY(e){this._stream.setHead(14),this._stream.writeInt16(e)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}}var wv=VN;const{invariant:Cv}=F,{MARKERS:KN,EXIF_TAGS:pT}=tc;class $N{constructor(e){this._buf=e,this._stream=new al(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==KN.EXIF)return!1;const t=this._stream.readInt16();if(!(t>0))return!1;const i=this._stream.readString(4);return!(i!=="Exif")}_parse(){if(!this.isValid())return;this._stream.setHead(10);const e=this._stream.getHead();this._bigEndian=!1;const t=this._stream.readInt16();t===18761?this._bigEndian=!1:t===19789?this._bigEndian=!0:Cv(!1,"Invalid TIFF data: No endian type found"),Cv(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");const i=this._stream.readInt32(!this._bigEndian);Cv(i>=8,"Invalid TIFF data: First IFD offset < 8");const r=e+i,o=this._readTags(this._stream,e,r,this._bigEndian);this._tags=o.tags,this._tagData=o.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(e){if(this._tagData.Orientation){const{entryOffset:t}=this._tagData.Orientation;this._stream.setHead(t+8),this._stream.writeInt16(this._bigEndian?e:(e&255)<<8|e>>8&255)}}_readTags(e,t,i,r){e.setHead(i);const o=e.readInt16(!r);let n={},s=[];for(let a=0;a<o;a++){const l=i+a*12+2;e.setHead(l);let d=e.readInt16(!r),c,p,h;if(pT[d]){d=pT[d],c=e.readInt16(!r),p=e.readInt32(!r),h=e.readInt32(!r)+t;let m=null;switch(c){case 1:case 7:if(p===1)m=e.readInt8(!r);else{m=[];for(let b=0;b<p;b++)m.push(e.readInt8(!r))}break;case 2:e.setHead(p>4?h:l+8),m=e.readString(p);break;case 3:if(e.setHead(p>2?h:l+8),p===1)m=e.readInt16(!r);else{m=[];for(let b=0;b<p;b++)m.push(e.readInt16(!r))}break;case 4:case 9:if(e.setHead(p>1?h:l+8),p===1)m=e.readInt32(!r);else{m=[];for(let b=0;b<p;b++)m.push(e.readInt32(!r))}break;case 5:case 10:if(e.setHead(h),p===1){const b=e.readInt32(!r),_=e.readInt32(!r);m=b/_}else{m=[];for(let b=0;b<p;b++){const _=e.readInt32(!r),g=e.readInt32(!r),S=_/g;m.push(S)}}break}n[d]=m,s[d]={value:m,numValues:p,entryOffset:l,valueOffset:h,type:c}}}return{tags:n,tagData:s}}getBuffer(){return this._buf}}var uT=$N;const{invariant:Hte}=F,{MARKERS:Yh}=tc,Hm="data:image/jpeg;base64,",qN=new RegExp(`^${Hm}`,"i");class qs{constructor(e){this._buf=e,this._stream=new al(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new uT(this._getMarkerBuffer(Yh.EXIF)),this._jfifData=new wv(this._getMarkerBuffer(Yh.JFIF))}static toDataURL(e){return Hm+kr.encode(e)}static fromDataURL(e){const t=e.replace(Hm,""),i=kr.decode(t);return i}restoreSegmentsInArray(e){return e=this.restoreExifTagsToImageData(e),this.restoreJfifSegmentToImageData(e)}restoreSegments(e){let t=qs.fromDataURL(e);return t=this.restoreSegmentsInArray(t),qs.toDataURL(t)}restoreExifTagsToImageData(e){if(!this._exifData.isValid())return e;const t=this._sliceIntoSegments(e),i=t[1][0],r=e.slice(0,i),o=e.slice(i);let n=r.concat(this._exifData.getBuffer());return n=n.concat(o),n}restoreJfifSegmentToImageData(e){if(!this._jfifData.isValid())return e;const t=this._sliceIntoSegments(e);let i=this._findSegment(Yh.JFIF,t),r=[];if(i){const o=i[0],n=i[1],s=e.slice(0,o),a=e.slice(o,n),l=e.slice(n),d=new wv(a);d.setDensityX(this._jfifData.getDensityX()),d.setDensityY(this._jfifData.getDensityY()),d.setUnitDensity(this._jfifData.getUnitDensity()),r=s.concat(a).concat(l)}else return e;return r}restoreExifTags(e){const t=qs.fromDataURL(e),i=this.restoreExifTagsToImageData(t);return qs.toDataURL(i)}restoreJfifSegment(e){if(!this._jfifData.isValid())return e;const t=qs.fromDataURL(e),i=this.restoreJfifSegmentToImageData(t);return qs.toDataURL(i)}setOrientation(e){return this._exifData.setOrientation(e)}static isJPEG(e){return qN.test(e)}static bufferIsJPEG(e){return e[0]===255&&e[1]===216&&e[2]===255}static fromBase64String(e){const t=e.replace(Hm,""),i=kr.decode(t);return new qs(i)}_findSegment(e,t=this._segments){for(let i=0;i<t.length;i++){const r=t[i][0],o=t[i][1];this._stream.setHead(r);const n=this._stream.peekInt16();if(n===e)return[r,o]}return!1}_getLastSegment(e=this._segments){return e[e.length-1]}_getMarkerBuffer(e,t=this._segments){const i=this._findSegment(e,t);if(i){const r=i[0],o=i[1];return this._buf.slice(r,o)}return!1}_sliceIntoSegments(e){let t=new al(e),i=[];for(;t.getHead()<e.length;){const r=t.readInt16();if(r===Yh.SOI)continue;if(r===Yh.SOS)break;if(r>=65280&&r<=65535){const o=t.readInt16(),n=t.getHead()+o-2;i.push([t.getHead()-4,n]),t.setHead(n)}else throw new Error("Invalid marker: 0x"+r.toString(16))}return this._stream.setHead(0),i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}}var Jh=qs;class mT extends _e{constructor(e,t={}){super(t);this._sdk=e}export(){const{imageFormat:e}=this._options,t=i=>i.renderDone?i:this._sdk.render().then(r=>t(r));return this.validateSettings().then(()=>this._prepareSDK().then(i=>t(i))).then(i=>{const{outputTexture:r,renderDone:o}=i,n=this._sdk.getRenderer();let s=n.getCanvas();return n.isOfType(Ee.WEBGL)&&(s=this._createCanvasFromTexture(r)),this._encodeImageFormat(s)}).then(i=>this._restoreExifMetadata(i,e)).then(i=>this._restoreSDK().then(()=>i))}_restoreExifMetadata(e,t,i){if(t===il.JPEG){const r=this._sdk.getExif();r&&(typeof e=="string"&&(e=r.restoreSegments(e)))}return Promise.resolve(e)}_encodeAsDataURL(e,t,i){return F.isBrowser?Promise.resolve(e.toDataURL(t,i)):new Promise((r,o)=>{e.toDataURL(t,i,(n,s)=>{n?o(n):r(s)})})}_encodeAsHTMLImage(e,t,i){return this._encodeAsDataURL(e,t,i).then(r=>{let o=new vi;return o.src=r,Promise.resolve(o)})}_encodeAsBuffer(e,t,i){return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(e,t,i){return Promise.resolve(e.msToBlob())}_encodeAsBLOB(e,t,i){return new Promise((r,o)=>{e.toBlob(n=>{r(n)},t,i)})}_encodeImageFormat(e){const{imageFormat:t,quality:i}=this._options;let r=this._options.renderType;r===Er.BLOB&&e.msToBlob&&!e.toBlob&&(r=Er.MSBLOB);switch(r){case Er.IMAGE:return this._encodeAsHTMLImage(e,t,i);case Er.DATAURL:return this._encodeAsDataURL(e,t,i);case Er.BUFFER:return this._encodeAsBuffer(e,t,i);case Er.MSBLOB:return this._encodeAsMSBlob(e,t,i);case Er.BLOB:return this._encodeAsBLOB(e,t,i)}return Promise.reject(new Error(`Unsupported RenderType: ${r}!`))}_prepareSDK(){const e=this._sdk.getRenderer();this._sdkSettings={dimensions:e.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),pixelRatio:this._sdk.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);const t=e.isOfType(Ee.CANVAS);e.setPixelRatio(1),e.resizeTo(this._sdk.getFinalDimensions(),t),this._sdk.setAllOperationsToDirty(!0);const i=this._sdk.getOperationsStack();return i.forEach(r=>{r.disposeRenderTextures()}),i.disableCache(),this._sdk.render()}_restoreSDK(){const e=this._sdk.getOperationsStack();e.enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);const t=this._sdk.getRenderer(),i=t.isOfType(Ee.CANVAS);return t.setPixelRatio(this._sdkSettings.pixelRatio),t.resizeTo(this._sdkSettings.dimensions,i),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(e){const t=this._sdk.getRenderer(),i=this._sdk.getFinalDimensions(),r=this._sdk.getRenderer().getContext(),o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);const n=e.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const s=new Uint8Array(i.x*i.y*4);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,s);const a=this._checkPixelsForTransparency(s);let l;if(a){const h=new A.Sprite(e);h.setFilters([new A.Filters.UnpremultiplyFilter]);const m=new A.Container;m.addChild(h),l=new A.RenderTexture(t,i.x,i.y),l.render(m);const b=l.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,b,0),r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,s),t.setRenderTarget(),l.dispose()}const d=F.createCanvas();d.width=i.x,d.height=i.y;const c=d.getContext("2d"),p=c.createImageData(i.x,i.y);return p.data.set(s),c.putImageData(p,0,0),r.deleteFramebuffer(o),d}_checkPixelsForTransparency(e){const t=this._sdk.getFinalDimensions(),i=t.x*t.y*4;let r;for(let o=3;o<i;o+=4)if(r=e[o],r!==255)return!0;return!1}}mT.prototype.availableOptions={renderType:{type:f.STRING,available:F.values(Er),default:Er.IMAGE},imageFormat:{type:f.STRING,available:F.values(il),default:il.PNG},quality:{type:f.NUMBER,default:.8}};var fT=mT;const tt=e=>Zh.byteArrayToString(XN.decode(e)),{Rectangle:YN,Constants:JN,Engine:Jr,Utils:Zh,EventEmitter:ZN,Events:Sv,Vector2:Tv,Log:Eo,Base64:XN,Color:QN}=Xh,{RenderType:e8,ImageFormat:t8,RendererType:gT}=JN;class i8 extends ZN{constructor(e,t={}){super();if(this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="3.9.0",this[tt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=e,this._options=Zh.defaults(t,{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,clearColor:QN.TRANSPARENT,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1}),this._options.smoothUpscaling&&(Jr.BaseTexture.DefaultMagFilter=Jr.BaseTexture.LinearFilter),this._options.extensions=Zh.defaults(this._options.extensions,{operations:[],controls:[],languages:[]}),Eo.setLevel(this._options.logLevel),this[tt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,!this[tt("X29wdGlvbnM=")][tt("bGljZW5zZQ==")])this[tt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new Xh[tt("RnJlZUxpY2Vuc2VDaGVja2Vy")];else{if(!this._v())return;const r=Xh[tt("TGljZW5zZUNoZWNrZXI=")];this._l=new r(this[tt("X29wdGlvbnM=")][tt("bGljZW5zZQ==")]),this._cv(!0).then(()=>{this._ct()}).catch(o=>{Eo.error(tt("TGljZW5zaW5n"),o.message)})}this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new Tv,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new Um),this._container=new Jr.Container,this._sprite=new Jr.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new Jr.Container,this._resizedSprite=new Jr.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();const i=this._renderer.constructor.type;this._options.displayWelcomeMessage,this[tt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&Eo.log(tt("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS91c2Vycy9uZXcgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2RvY3MucGhvdG9lZGl0b3JzZGsuY29tL2d1aWRlcy9odG1sNS92NC9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg==")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_v(){return this[tt("X29wdGlvbnM=")][tt("bGljZW5zZQ==")]?!0:(Eo.error(tt("TGljZW5zaW5n"),tt("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),Eo.error(tt("TGljZW5zaW5n"),tt("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_ct(){if(this._l.exp()){const e=this._l.isExp();e?Eo.error(tt("TGljZW5zaW5n"),tt("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4=")):Eo.warn(tt("TGljZW5zaW5n"),tt("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl()))}}_cv(e=!1){return this._l.c().catch(t=>{this[tt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let i=tt("SW52YWxpZCBsaWNlbnNlLg==");throw e&&(t.code==="ELICEXP"?i=tt("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4="):t.code==="ELICINVHOST"?i=tt("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGhvc3RuYW1lIA==")+window.location.hostname+".":t.code==="ELICINVPLAT"?i=tt("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0u"):t.code==="ELICINVFMT"?i=tt("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):t.code==="ELICINV"?i=tt("SW52YWxpZCBsaWNlbnNlISBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc3VwcG9ydEBwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZSBvciBsb2cgaW4gdG8geW91ciBjdXN0b21lciBkYXNoYm9hcmQu"):i=tt("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),t.message=i,new Error(t)})}_t(){this._l.t()}_fl(){return this[tt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...e){this.emit(Sv.OPERATION_UPDATED,...e)}_onContextRestored(){Eo.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(e=>{e.disposeRenderTextures()}),this.render()}export(e=e8.DATAURL,t=t8.PNG,i=.8){return this._cv(!0).then(()=>{this.hasChanges()&&this._t(),this._operationsStack.forEach(o=>{o.onBeforeExport()});const r=new fT(this,{renderType:e,imageFormat:t,quality:i});return r.export().then(o=>(this._operationsStack.forEach(n=>{n.onAfterExport()}),Promise.resolve(o)))})}render(e=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");let t=this._renderer.getContext();t.startFrame&&t.startFrame();let i;Eo.canLog("info")&&(i=new Nm("","Frame rendering")),Eo.info("","Rendering starts");const r=this._operationsStack;return r.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(o=>{this._renderMode==="export"&&(o=this._inputTexture),this._currentTexture=o,this._sprite.setTexture(o),this._container.updateTransform()}).then(()=>r.validateSettings()).then(()=>((this._fl()||!this[tt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")])&&(r.getByIdentifier("license-watermark")?r.moveToTop("license-watermark"):this.createOperation("license-watermark")),r.render(this,this._currentTexture))).then(o=>{const{outputTexture:n}=o;this._currentTexture=n,this._sprite.setTexture(this._currentTexture);switch(this._renderMode){case"dynamic":const s=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(s),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break;case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0);break}return e&&this._renderer.render(this._container),o}).then(o=>(i&&i.stop(),t.endFrame&&t.endFrame(),this._disposeTextures(),o))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((e,t)=>{const i=this.getTextureScale();if(this._textureQuality===1)return e(this._inputTexture);const r=this.getInputDimensions().multiply(i).floor();let o;this._resizedTexture?this._resizedTexture.getDimensions().equals(r)||(this._resizedTexture.resizeTo(r),o=!0):(this._resizedTexture=new Jr.RenderTexture(this._renderer,r.x,r.y),o=!0),o&&(this._resizedSprite.setScale(i,i),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),e(this._resizedTexture)})}_registerOperations(){this._operations={};for(let e in ec){const t=ec[e];this._operations[t.identifier]=t}this._operations=Zh.extend(this._operations,this._options.extensions.operations)}registerOperations(e){e.forEach(t=>{this._operations[t.identifier]=t})}setAllOperationsToDirty(e=!1){this._operationsStack.setAllToDirty(e)}createOperation(e,t={},i=!0){const r=this._operations[e];if(!r)throw new Error(`No operation with identifier \`${e}\` found.`);const o=new r(this,t);return i&&this.addOperation(o),o}addOperation(e){this._operationsStack.push(e)}removeOperation(e){this._operationsStack.remove(e)}getInputDimensions(){const e=this._inputTexture.getFrame();return new Tv(e.width,e.height)}getFinalDimensions(e=!1){let t=this.getInputDimensions();const i=this._operationsStack;return i.forEach(r=>{if(!r.getEnabled())return;t=r.getNewDimensions(t)}),e&&t.multiply(this._spriteScale),t.floor()}getOutputDimensions(e=!1){return this.getFinalDimensions(e).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(e=!1){const t=this.getTextureScale();let i=this.getInputDimensions().multiply(t).floor();return this._operationsStack.forEach(r=>{i=r.getNewDimensions(i)}),i}getCrossOrigin(){return Zh.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){const e={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor};let t,i;if(this._renderMode!=="export"&&this._options.canvas){const{canvas:r}=this._options;t=r.width,i=r.height}else if(this._inputTexture){const r=this.getFinalDimensions();t=r.x,i=r.y}else t=1,i=1;switch(this._preferredRenderer){case gT.WEBGL:this._renderer=Jr.autoDetectRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;case gT.CANVAS:this._renderer=new Jr.CanvasRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;default:Eo.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=Jr.autoDetectRenderer(t,i,e)}}resizeTo(e){this._renderer.resizeTo(e,!0)}reset(){this._operationsStack.clear()}parseExif(e){if(!e)return;let{src:t}=e,i=!1,r=null;if(i=Jh.isJPEG(t),r=t,i){let o=null;try{o=Jh.fromBase64String(r)}catch(n){}return o||void 0}}_handleExifOrientation(){let e=this._exif.getTags();if(e&&e.Orientation){const t=e.Orientation!==1&&e.Orientation!==2,i=[2,4,5,7].indexOf(e.Orientation)!==-1;if(t||i){if(typeof navigator=="undefined")this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e);else{const r=window&&window.navigator&&window.navigator.userAgent||"";(!!r.match(/msie|trident/i)||r.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image"))&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e))}this._exif.setOrientation(1)}}}correctExifOrientation(e){let t=this.parseExif(e);if(!t)return e;const i=t.getTags();if(i&&i.Orientation){const r=i.Orientation!==1&&i.Orientation!==2,o=[2,4,5,7].indexOf(i.Orientation)!==-1;if(r||o){if(typeof navigator=="undefined"){const n=this.createOperation("exif-orientation",{},!1);n.setTags(i),e=n.applyTo(e)}else{const n=window&&window.navigator&&window.navigator.userAgent||"";if(!!n.match(/msie|trident/i)||n.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){const s=this.createOperation("exif-orientation",{},!1);s.setTags(i),e=s.applyTo(e)}}return t.setOrientation(1),i.Orientation=1,e}}return e}hasImage(){return this._image!==null&&typeof this._image!="undefined"}getImage(){return this._image}disposeTexture(e){this._texturesToDispose.push(e)}_disposeTextures(){for(let e=0;e<this._texturesToDispose.length;e++)this._texturesToDispose[e].dispose();this._texturesToDispose=[]}setImage(e,t=null,i=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=e,this._image=e,this._exif=t||this.parseExif(e),this._exif&&this._handleExifOrientation();const r=new Jr.BaseTexture(this._image),o=new YN(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);i&&(o.width=i.x,o.height=i.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new Jr.Texture(r,o),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(e){this._inputTexture=e}getCanvas(){return this._renderer.getCanvas()}setCanvas(e){this._renderer.setCanvas(e)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(e){this._operationsStack&&this._operationsStack.off(Sv.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=e,this._operationsStack.on(Sv.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(e,t){e instanceof Tv?this._offset.copy(e):this._offset.set(e,t)}getRenderMode(){return this._renderMode}setRenderMode(e){this._renderMode=e}getZoom(){return this._zoom}setZoom(e){this._zoom=e,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return this._renderMode==="export"?1:this._textureQuality}setTextureQuality(e){e!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,e),this._textureQuality===1&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(e){this._spriteScale=e,this._sprite.setScale(e,e),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(e){this._options.smoothDownscaling=e,this._sprite.setSmoothDownscaling(e),this._resizedSprite.setSmoothDownscaling(e)}setRotation(e){this._rotation=e}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}}var xt=i8;Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(this==null)throw new TypeError('"this" is null or not defined');var t=Object(this),i=t.length>>>0;if(typeof e!="function")throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<i;){var n=t[o];if(e.call(r,n,o,t))return o;o++}return-1},configurable:!0,writable:!0});class r8{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}}var bT=r8;var Or={load(e,t={cors:!0,value:"anonymous"}){const i=()=>Promise.resolve([e,e]);return i().then(([r,o])=>this._createAndLoadImage(r,o,t))},loadImage(e,t={cors:!0,value:"anonymous"}){return this._loadWithoutExif(e,t)},_loadWithoutExif(e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{const o=new window.Image;o.addEventListener("load",()=>{i(o)}),o.addEventListener("error",()=>{r(new Error(`Failed to load image at ${e}`))}),t.cors&&(o.crossOrigin=t.value),o.src=e})},_createAndLoadImage(e,t,i={cors:!0,value:"anonymous"}){return new Promise((r,o)=>{{let n=this._loadWithoutExif(t,i).then(a=>r(a)),s=new Promise((a,l)=>{this._loadAsDataURL(t,i).then(d=>{const c=new window.Image;c.addEventListener("load",()=>{a(c)}),c.src=d,c.rawSource=d}).catch(d=>{n.then(c=>a(c))})});return this._stringEndsWith(t,".svg")?n.then(a=>r(a)):s.then(a=>r(a))}})},_stringEndsWith(e,t,i=e.length){return(i===void 0||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t},_loadAsDataURL(e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{let o=new XMLHttpRequest;o.onload=function(){let n=new FileReader;n.onloadend=function(){n.error&&r(n.error),i(n.result)},n.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.withCredentials=t.cors&&t.value==="use-credentials",o.send()})},loadXHR(e,t){return new Promise((i,r)=>{let o;window.XDomainRequest?(o=new window.XDomainRequest,t&&o.overrideMimeType(t),o.onload=function(){i(o)},o.onerror=function(n){r(n)}):window.XMLHttpRequest&&(o=new window.XMLHttpRequest,t&&o.overrideMimeType(t),o.onreadystatechange=function(n){o.readyState===4&&(o.status===200?i(o):r(new Error(`HTTP Status ${o.status}`)))}),o.open("GET",e,!0),o.send()})}};const kv={};ut(kv,{ImageLoader:()=>Or,JSONLoader:()=>lr});xt.version="3.9.0";xt.Math=H;xt.Operations=ec;xt.Engine=A;xt.Color=N;xt.LicenseChecker=Lm;xt.Operation=Ge;xt.EventEmitter=Ri;xt.Utils=F;xt.Env=bT;xt.OperationsStack=Um;xt.EXIF=Jh;xt.Image=vi;xt.Promise=ce;xt.Configurable=_e;xt.Log=W;xt.Loaders=kv;xt.RenderType=Er;xt.ImageFormat=il;xt.OptionType=f;xt.RendererType=Ee;xt.UniformType=z;xt.Base64=kr;const o8={};xt.UI=o8;var ue=xt;var yT=`precision highp float;

varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform float u_gamma;
uniform float u_shadows;
uniform float u_highlights;
uniform float u_whites;
uniform float u_blacks;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.0000001;

float calculateLuminance(vec3 rgb) {
    // This is the luminance calculation part of the RGB to HSL formular.
    vec4 p = mix(
        vec4(rgb.gb, 0.0, -1.0 / 3.0),
        vec4(rgb.bg, -1.0, 2.0 / 3.0),
        vec4(rgb.g < rgb.b)
    );

    vec4 q = mix(
        vec4(rgb.r, p.yzx),
        vec4(p.xyw, rgb.r),
        vec4(rgb.r < p.x)
    );

    float croma = q.x - min(q.w, q.y);
    float luminance = q.x - croma * 0.5;
    return luminance;
}

vec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}

void main() {

  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha

  // Apply gamma
  if (u_gamma != 1.0) {
    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));
  }

  // Apply shadows and highlights
  float luminance = calculateLuminance(color.rgb);

  float shadow = u_shadows >= 0.0
    ? clamp(
          pow(luminance, 1.0 / (u_shadows + 1.0))
          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(u_shadows, 1.0))
    : -clamp(
          pow(luminance, 1.0 / (-u_shadows + 1.0))
          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(-u_shadows, 1.0));

  float highlight = u_highlights < 0.0
    ? clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0)
    : -clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0);

  // Bright color need more contrast and dark color need more brightness.
  // This is to keep saturatation because the color information of a dark colors is lost.
  float shadowContrast   = shadow * luminance * luminance;
  float shadowBrightness = shadow - shadowContrast;

  float offset = luminance + shadowContrast + highlight;
  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);
  
  // Apply Color Matrix
  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;
  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);
  color = clamp(color, 0.0, 1.0);
  color.rgb *= color.a; // Reset premultiplied alpha

  gl_FragColor = color;
}
`;const{ColorMatrix:n8}=H,ic=1e-7;function Ev(e,t,i,r,o){return(e-t)*(o-r)/(i-t)+r}const s8=e=>{const t=Math.max(e.r,e.g,e.b),i=Math.min(e.r,e.g,e.b);return(t+i)/2};class vT extends A.Filter{constructor(){super();this._fragmentSource=yT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),{colorMatrix:l,gamma:d,shadows:c,highlights:p,whites:h,blacks:m}=this._options,b=d!==1,_=c!==0||p!==0;let g=new N(0,0,0,0);for(let S=0;S<o.width*o.height;S++){const x=S*4;if(g.r=a.data[x]/255,g.g=a.data[x+1]/255,g.b=a.data[x+2]/255,b&&(g.r=Math.pow(g.r,1/Math.max(d,ic)),g.g=Math.pow(g.g,1/Math.max(d,ic)),g.b=Math.pow(g.b,1/Math.max(d,ic))),_){const C=s8(g);let R=c>=0?F.clamp(Math.pow(C,1/(c+1))+Math.pow(C,2/(c+1))*-.76-C,0,Math.max(c,1)):-F.clamp(Math.pow(C,1/(-c+1))+Math.pow(C,2/(-c+1))*-.76-C,0,Math.max(-c,1)),T=p<0?F.clamp(1-Math.pow(1-C,1/(1-p))-Math.pow(1-C,2/(1-p))*-.8-C,-1,0):-F.clamp(1-Math.pow(1-C,1/(1+p))-Math.pow(1-C,2/(1+p))*-.8-C,-1,0),k=R*C*C,M=R-k,U=C+k+T;g.r=F.clamp(U*((g.r+M)/Math.max(C,ic)),0,1),g.g=F.clamp(U*((g.g+M)/Math.max(C,ic)),0,1),g.b=F.clamp(U*((g.b+M)/Math.max(C,ic)),0,1)}g=l.apply(g).clamp(0,1),g.r=Ev(g.r,0,1,m/2,1+h/2),g.g=Ev(g.g,0,1,m/2,1+h/2),g.b=Ev(g.b,0,1,m/2,1+h/2),a.data[x]=g.r*255,a.data[x+1]=g.g*255,a.data[x+2]=g.b*255}s.putImageData(a,0,0)}}vT.prototype.availableOptions={gamma:{type:f.NUMBER,default:1,uniformType:z.FLOAT},shadows:{type:f.NUMBER,default:0,uniformType:z.FLOAT},highlights:{type:f.NUMBER,default:1,uniformType:z.FLOAT},whites:{type:f.NUMBER,default:0,uniformType:z.FLOAT},blacks:{type:f.NUMBER,default:0,uniformType:z.FLOAT},colorMatrix:{type:f.COLOR_MATRIX,default:new n8,uniformType:z.MAT4},colorOffset:{type:f.ARRAY,default:[],uniformType:z.FLOAT4}};var Gm=vT;var _T=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)
uniform vec2 u_pixelDimension;

// Range (-1.0 - 1.0)
uniform float u_clarity;

varying vec2 v_texCoord;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.000001;

vec4 unpremultiply(vec4 col) {
    col.rgb /= max(col.a, EPSILON);
    return col;
}

void main() {
    vec4 color = texture2D(u_image, v_texCoord);
    color = unpremultiply(color);

    // L = Left, R = Right, C = Center, T = Top, B = Bottom
    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));
    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));

    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));
    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));
    
    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));
    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));

    vec4 mergedColor = color;
    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;
    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;
    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;

    mergedColor /= 9.0;

    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);
    // 1.0 and 0.0 result in white not black, therefore we clamp

    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,
    // and for values between 0.1 and 0.2 it will produce a gradient.
    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.
    // And values above 0.9 will be mapped to 0.
    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));

    // here we apply the high pass filter. Its strength is determined by the uniform ,
    // and the frequence factor. That means the only the mid tones are affected by this filter.
    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.
    // Therefore we see this little magic number '3.7'.
    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;

    // apply exposure but only to the mid tones.
    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);

    // apply contrast and desaturation matrix
    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;

    color.rgb *= color.a; // Premultiply alpha

    gl_FragColor = clamp(color, 0.0, 1.0);
}
`;const{Vector2:a8,ColorMatrix:l8}=H;class xT extends A.Filter{constructor(){super();this._fragmentSource=_T}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),n=t.getCanvas(),s=t.getContext(),a=this._options.clarity,l=this._options.colorMatrix,d=new N(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),c=n.width,p=n.height,h=s.getImageData(0,0,c,p),m=o.createImageData(c,p);this.canvasShader(h,m,a,l,d),o.putImageData(m,0,0)}canvasShader(e,t,i,r,o){const n=(g,S,x)=>Math.min(Math.max(g,S),x),s=(g,S,x)=>{const C=n((x-g)/(S-g),0,1);return C*C*(3-2*C)},a=e.width*4,l=e.data.length,d=l-1,c=0,p=e.data,h=t.data;let m=new N;const b=255*9,_=g=>(g=g<c?c:g,g=g>d?d:g,p[g]);for(let g=0;g<l;g+=4){let S=_(g+0),x=_(g+1),C=_(g+2),R=_(g+3);const T=(S+_(g-4-a+0)+_(g-4+0)+_(g-4+a+0)+_(g-a+0)+_(g+a+0)+_(g+4-a+0)+_(g+4+0)+_(g+4+a))/b,k=(x+_(g-4-a+1)+_(g-4+1)+_(g-4+a+1)+_(g-a+1)+_(g+a+1)+_(g+4-a+1)+_(g+4+1)+_(g+4+a+1))/b,M=(C+_(g-4-a+2)+_(g-4+2)+_(g-4+a+2)+_(g-a+2)+_(g+a+2)+_(g+4-a+2)+_(g+4+2)+_(g+4+a+2))/b,U=(R+_(g-4-a+3)+_(g-4+3)+_(g-4+a+3)+_(g-a+3)+_(g+a+3)+_(g+4-a+3)+_(g+4+3)+_(g+4+a+3))/b;S/=255,x/=255,C/=255,R/=255;const L=n(S*.3+x*.59+C*.1,.111111,.999999),ee=Math.min(s(1-L,0,.11),s(L,0,.11)),de=i*3.7*ee,ge=Math.pow(2,i*.27*ee),xe=n(S+n((S-T)*de,0,10),0,1)*ge,Oe=n(x+n((x-k)*de,0,10),0,1)*ge,ft=n(C+n((C-M)*de,0,10),0,1)*ge,kt=n(R+n((R-U)*de,0,10),0,1);m.set(xe,Oe,ft,kt);const Ae=r.apply(m).clamp(0,1);h[g+0]=Ae.r*255,h[g+1]=Ae.g*255,h[g+2]=Ae.b*255,h[g+3]=Ae.a*255}}}xT.prototype.availableOptions={clarity:{type:f.NUMBER,default:0,uniformType:z.FLOAT},pixelDimension:{type:f.VECTOR2,default:new a8(100,100),uniformType:z.FLOAT2},colorMatrix:{type:f.COLOR_MATRIX,default:new l8,uniformType:z.MAT4},colorOffset:{type:f.ARRAY,default:[],uniformType:z.FLOAT4}};var wT=xT;var CT=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Range (-1.0 - 1.0)
uniform float u_temperature;

const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);

const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);
const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);

const float EPSILON = 0.0000001;

varying vec2 v_texCoord;
void main() {
  float temperature = u_temperature;
  const float tint = 0.0;
  vec4 source = texture2D(u_image, v_texCoord);

  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha

  vec3 yiq = RGBtoYIQ * source.rgb;
  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);
  vec3 rgb = YIQtoRGB * yiq;

  vec3 processed = mix(
    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),
    (2.0 * rgb * warmFilter),
    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)
  );

  vec4 color = vec4(mix(rgb, processed, temperature), source.a);

  color.rgb *= color.a;   // Premultiply alpha again

  gl_FragColor = color;
}
`;const{Vector3:Wie}=H;class ST extends A.Filter{constructor(){super();this._fragmentSource=CT}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),n=t.getCanvas(),s=t.getContext(),a=this._options.temperature,l=n.width,d=n.height,c=s.getImageData(0,0,l,d),p=o.createImageData(l,d);this.canvasShader(c,p,a),o.putImageData(p,0,0)}canvasShader(e,t,i){const r=(g,S,x)=>Math.min(Math.max(g,S),x),o=(g,S,x)=>g*(1-x)+S*x,n=(g,S)=>{const x=g[0]*S[0]+g[3]*S[1]+g[6]*S[2],C=g[1]*S[0]+g[4]*S[1]+g[7]*S[2],R=g[2]*S[0]+g[5]*S[1]+g[8]*S[2];return[x,C,R]},s=e.data.length,a=s-1,l=0,d=e.data,c=t.data,p=g=>(g=g<l?l:g,g=g>a?a:g,d[g]),h=[.93,.54,0],m=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],b=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702],_=0;for(let g=0;g<s;g+=4){const S=p(g+0)/255,x=p(g+1)/255,C=p(g+2)/255,R=p(g+3)/255,T=[S,x,C];let k=n(m,T);k.z=r(k.z+_*.5226*.1,-.5226,.5226);const M=n(b,k),U=[M[0]<.5?2*M[0]*h[0]:1-2*(1-M[0])*(1-h[0]),M[1]<.5?2*M[1]*h[1]:1-2*(1-M[1])*(1-h[1]),M[2]<.5?2*M[2]*h[2]:1-2*(1-M[2])*(1-h[2])];c[g+0]=o(M[0],U[0],i)*255,c[g+1]=o(M[1],U[1],i)*255,c[g+2]=o(M[2],U[2],i)*255,c[g+3]=R*255}}}ST.prototype.availableOptions={temperature:{type:f.NUMBER,default:0,uniformType:z.FLOAT}};var TT=ST;var kT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec2 u_pixelDimension;
uniform float u_sharpness;
 
const float EPSILON = 0.000001;
 
void main() {
    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);

    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));
    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;
 
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);
 
    color.rgb /= max(color.a, EPSILON); // unpremultiply
    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply
 
    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);
 
    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);
      
    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply
}`;const{Vector2:d8}=H;class ET extends A.Filter{constructor(){super();this._fragmentSource=kT}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),n=t.getCanvas(),s=t.getContext(),a=this._options.sharpness,l=n.width,d=n.height,c=s.getImageData(0,0,l,d),p=o.createImageData(l,d);this.canvasShader(c,p,a),o.putImageData(p,0,0)}canvasShader(e,t,i){const r=(C,R,T)=>Math.min(Math.max(C,R),T),o=1e-6,n=e.width,s=e.height,a=e.data,l=t.data,d=(C,R,T)=>C*(1-T)+R*T,c=C=>r(a[C]/255,0,1),p=(C,R)=>{const T=r(C,0,n-1),k=r(R,0,s-1);return 4*(T+n*k)};let h=[],m=[],b=[-1,0,0,1],_=[0,-1,1,0];const g=i>0?-1:.2,S=i>0?5:.2,x=Math.abs(i);for(let C=0;C<n;C++)for(let R=0;R<s;R++){const T=p(C,R);h[0]=c(T+0),h[1]=c(T+1),h[2]=c(T+2),h[3]=c(T+3),m[0]=S*h[0]*h[3],m[1]=S*h[1]*h[3],m[2]=S*h[2]*h[3],m[3]=S*h[3];for(let k=0;k<4;k++){const M=b[k],U=_[k],L=p(C+M,R+U),ee=c(L+3);m[3]+=g*ee;for(let de=0;de<3;de++)m[de]+=g*c(L+de)*ee}for(let k=0;k<3;k++)m[k]/=Math.max(m[3],o),m[k]=r(m[k],0,1);m[3]=r(m[3],0,1);for(let k=0;k<4;k++)h[k]=r(d(h[k],m[k],x),0,1),l[T+k]=h[k]*255}}}ET.prototype.availableOptions={sharpness:{type:f.NUMBER,default:0,uniformType:z.FLOAT},pixelDimension:{type:f.VECTOR2,default:new d8(100,100),uniformType:z.FLOAT2}};var DT=ET;const{ColorMatrix:Xs}=H;class jm extends Ge{constructor(...e){super(...e);this._clarityFilter=new wT,this._temperatureFilter=new TT,this._sharpnessFilter=new DT,this._filter=new Gm,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(e){let t=e.getDimensions();t.x=1/t.x,t.y=1/t.y;const i=new Xs;i.multiply(Xs.createSaturationMatrix(-.3*this._options.clarity+1)),i.multiply(Xs.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:t,colorMatrix:i,colorOffset:i.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:t});const r=new Xs;r.multiply(Xs.createExposureMatrix(this._options.exposure)),r.multiply(Xs.createSaturationMatrix(this._options.saturation+1)),r.multiply(Xs.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1)),r.multiply(Xs.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:r,colorOffset:r.getOffsets()});let o=[];return this._options.clarity!==0&&o.push(this._clarityFilter),this._options.sharpness!==0&&o.push(this._sharpnessFilter),this._options.temperature!==0&&o.push(this._temperatureFilter),o.push(this._filter),this._sprite.setFilters(o),this._renderTexture.render(this._container),ce.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}}jm.identifier="adjustments";jm.prototype.availableOptions={brightness:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:f.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:f.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:f.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}};ue.Operations.AdjustmentsOperation=jm;var IT=jm;var OT=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);
    float radius = u_blurRadius;

    const float steps = 30.0;

    for (float t = -steps; t <= steps; t++) {
        float percent = (t + offset - 0.5) / steps;
        float weight = 1.0 - abs(percent);

        // Somehow \`sample\` is a keyword in headless-gl
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:Wm}=H;class RT extends A.Filter{constructor(...e){super(...e);this._fragmentSource=OT,this._lastBlurRadius=null,this._lastDimensions=new Wm(0,0),this._blurredRenderTarget=new A.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1,o=null){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const n=t.getCanvas(),s=t.getContext(),a=i.getContext();this._lastBlurRadius===this._options.blurRadius&&a.drawImage(n,0,0);const l=s.getImageData(0,0,n.width,n.height),d=a.getImageData(0,0,n.width,n.height);let c=this._options.blurRadius;const p=this._options.delta,h=30;for(let m=0;m<n.width;m++)for(let b=0;b<n.height;b++){let _=m+b*n.width;const g=_*4;let S=0,x=0,C=0,R=0,T=0;o&&(c=o(m/n.width,b/n.height));let k=this._random(m,1-b/n.height);for(let M=-h;M<=h;M++){let U=(M+k-.5)/h,L=1-Math.abs(U),ee=p.x*U*c,de=p.y*U*c,ge=Math.max(Math.min(m+ee,n.width-1),0),xe=Math.max(Math.min(b+de,n.height-1),0),Oe=(Math.round(xe)*n.width+Math.round(ge))*4;const ft=l.data[Oe+3],kt=ft*l.data[Oe],Ae=ft*l.data[Oe+1],V=ft*l.data[Oe+2];S+=kt*L,x+=Ae*L,C+=V*L,R+=ft*L,T+=L}S/=T,x/=T,C/=T,R/=T,d.data[g]=S/R,d.data[g+1]=x/R,d.data[g+2]=C/R,d.data[g+3]=R}a.putImageData(d,0,0),this._lastDimensions.copy(new Wm(n.width,n.height))}_renderLQBlur(e,t,i,r){const o=t.getDimensions(),n=!this._lastDimensions.equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),i.setPixelRatio(t.getPixelRatio()),i.resizeTo(t.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||n)&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius);const s=i.getContext();s.drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(o)}_random(e,t){const i=12.9898,r=78.233,o=43758.5453,n=e*i+t*r,s=n-3.14*Math.floor(n/3.14),a=Math.sin(s)*o;return a-Math.floor(a)}}RT.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:30,uniformType:z.FLOAT},delta:{type:f.VECTOR2,default:new Wm(1,1),uniformType:z.FLOAT2},texSize:{type:f.VECTOR2,default:new Wm(100,100),uniformType:z.FLOAT2},blurQuality:{type:f.STRING,default:"low"}};var dr=RT;const{Vector2:AT}=H;class Vm extends Ge{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;const t={blurQuality:{type:f.STRING}};this._horizontalFilter=new dr({},t),this._verticalFilter=new dr({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new AT(.5,.5)),this._verticalFilter.setDelta(new AT(-.5,.5)),this._filter=new dr({},t)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{blurRadius:r}=this._options,o={blurRadius:r*i,texSize:t,blurQuality:"high"};return this._horizontalFilter.set(o),this._verticalFilter.set(o),this._renderTexture.render(this._container),ce.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t}=this._options,i=e.getDimensions();return this._filter.set({blurRadius:t,texSize:i,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),ce.resolve()}transform(e){const t=this.getBlurRadius(),i=e.applyToRelativeSize(t);this.set({blurRadius:i},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}Vm.identifier="blur";Vm.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:.025},highQualityCanvasBlur:{type:f.BOOLEAN,default:!1}};ue.Operations.BlurOperation=Vm;var FT=Vm;var PT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filteredImage;
uniform float u_intensity;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filteredImage, v_texCoord);
  gl_FragColor = mix(color0, color1, u_intensity);
}
`;class BT extends A.Filter{constructor(){super();this._fragmentSource=PT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=i.getContext(),{filteredCanvas:s}=this._options;n.save(),n.globalAlpha=1-this._options.intensity,n.drawImage(o,0,0),n.globalAlpha=this._options.intensity,n.drawImage(s,0,0),n.restore()}}BT.prototype.availableOptions={filteredImage:{type:f.NUMBER,default:1,uniformType:z.INT},filteredCanvas:{type:f.OBJECT,default:null},intensity:{type:f.NUMBER,default:1,uniformType:z.FLOAT}};class c8{constructor(e=1){this._intensity=e,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new A.Container,this._sprite=new A.Sprite,this._container.addChild(this._sprite),this._blendFilter=new BT}push(e){this._stack.push(e)}clear(){this._stack=[]}render(e,t,i){if(this.isEmpty())return ce.resolve();const r=e.getRenderer();this._sprite.setTexture(t);let o=this._renderTextures[r.id];if(!o){const a=e.getSprite().getTexture().getFrame();o=new A.RenderTexture(e.getRenderer(),a.width,a.height),this._renderTextures[r.id]=o}const n=i.getDimensions();o.resizeTo(n);const s=this.isDirtyForRenderer(r);if(s){this._stack.forEach(l=>{l.update(e)});const a=this._stack.map(l=>l.getFilter());this._sprite.setFilters(a),o.render(this._container),this.setDirtyForRenderer(!1,r)}if(this._blendFilter.setIntensity(this._intensity),r.isOfType(Ee.CANVAS))this._blendFilter.setFilteredCanvas(o.getRenderTarget().getCanvas());else if(r.isOfType(Ee.WEBGL)){const a=o.getBaseTexture();a.setGLUnit(this._blendFilter.getFilteredImage()),r.updateTexture(a,!1)}return this._sprite.setFilters([this._blendFilter]),i.clear(N.TRANSPARENT),i.render(this._container),s&&this.disposeRenderTextures(),ce.resolve()}setIntensity(e){this._intensity=e}isEmpty(){return this._stack.length===0}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this._dirtiness[t]=e}disposeRenderTextures(){for(let e in this._renderTextures)this._renderTextures[e].dispose(),delete this._renderTextures[e]}dispose(){this.disposeRenderTextures(),this._stack.forEach(e=>e.dispose()),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}}var Dv=c8;class Qh extends _e{constructor(e={},t={}){super(e,y({intensity:{type:f.NUMBER,default:1,setter:function(i){return this._stack&&this._stack.setIntensity(i),i}},dirty:{type:f.BOOLEAN,default:!0}},t));this._stack=new Dv(this._options.intensity)}render(e,t,i){return this._stack.render(e,t,i).then(r=>(this.setDirty(!1),r))}setDirtyForRenderer(e,t){this._stack.setDirtyForRenderer(e,t)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}}Qh.identifier=null;Qh.isIdentity=!1;Qh.displayName=null;Qh.PrimitivesStack=Dv;var le=Qh;class h8 extends _e{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}}var dt=h8;var MT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_brightness;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;
}
`;class Iv extends A.Filter{constructor(){super();this._fragmentSource=MT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);let{brightness:l}=this._options;if(l===0){s.putImageData(a,0,0);return}l=l*255;for(let d=0;d<o.width*o.height;d++){const c=d*4;a.data[c]+=l,a.data[c+1]+=l,a.data[c+2]+=l}s.putImageData(a,0,0)}}Iv.prototype.availableOptions={brightness:{type:f.NUMBER,default:0,uniformType:z.FLOAT}};class LT extends dt{constructor(...e){super(...e);this._filter=new Iv}update(){this._filter.setBrightness(this._options.brightness)}}LT.prototype.availableOptions=Iv.prototype.availableOptions;var ll=LT;var zT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_contrast;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);
}
`;class Ov extends A.Filter{constructor(){super();this._fragmentSource=zT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);let{contrast:l}=this._options;if(l===1)return;for(let d=0;d<o.width*o.height;d++){const c=d*4;a.data[c]=(a.data[c]-127)*l+127,a.data[c+1]=(a.data[c+1]-127)*l+127,a.data[c+2]=(a.data[c+2]-127)*l+127}s.putImageData(a,0,0)}}Ov.prototype.availableOptions={contrast:{type:f.NUMBER,default:1,uniformType:z.FLOAT}};class NT extends dt{constructor(...e){super(...e);this._filter=new Ov}update(){this._filter.setContrast(this._options.contrast)}}NT.prototype.availableOptions=Ov.prototype.availableOptions;var cr=NT;var UT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform mat4 u_colorMatrix;
uniform vec4 u_colorMatrixOffset;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;
}
`;const{ColorMatrix:p8}=H;class Rv extends A.Filter{constructor(){super();this._fragmentSource=UT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);let{colorMatrix:l}=this._options,d=new N(0,0,0,0);for(let c=0;c<o.width*o.height;c++){const p=c*4;d.r=a.data[p]/255,d.g=a.data[p+1]/255,d.b=a.data[p+2]/255,d=l.apply(d),a.data[p]=d.r*255,a.data[p+1]=d.g*255,a.data[p+2]=d.b*255}s.putImageData(a,0,0)}}Rv.prototype.availableOptions={colorMatrix:{type:f.COLOR_MATRIX,default:new p8,uniformType:z.MAT4},colorMatrixOffset:{type:f.ARRAY,default:[],uniformType:z.FLOAT4}};class HT extends dt{constructor(...e){super(...e);this._filter=new Rv}update(){this._filter.setColorMatrix(this._options.colorMatrix)}}HT.prototype.availableOptions=Rv.prototype.availableOptions;var Km=HT;var GT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_desaturation;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 grayXfer = vec3(0.3, 0.59, 0.11);
  vec3 gray = vec3(dot(grayXfer, texColor.xyz));
  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);
}
`;class Av extends A.Filter{constructor(){super();this._fragmentSource=GT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),l=[.3,.59,.11],{desaturation:d}=this._options;for(let c=0;c<o.width*o.height;c++){const p=c*4,h=l[0]*a.data[p]/255+l[1]*a.data[p+1]/255+l[2]*a.data[p+2]/255;a.data[p]+=(h*255-a.data[p])*d,a.data[p+1]+=(h*255-a.data[p+1])*d,a.data[p+2]+=(h*255-a.data[p+2])*d}s.putImageData(a,0,0)}}Av.prototype.availableOptions={desaturation:{type:f.NUMBER,default:1,uniformType:z.FLOAT}};class jT extends dt{constructor(...e){super(...e);this._filter=new Av}update(){this._filter.setDesaturation(this._options.desaturation)}}jT.prototype.availableOptions=Av.prototype.availableOptions;var an=jT;var WT=`precision highp float;

uniform sampler2D u_image;
uniform vec4 u_lightColor;
uniform vec4 u_darkColor;
uniform float u_intensity;
varying vec2 v_texCoord;

const float EPSILON = 0.0000001;
const vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);

vec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {
  vec4 color = clamp(sampledCol, 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON);
  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES
 
  // Apply intensity as "symmetric gamma"
  if (intensity > 0.0) {
    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));
  } else {
    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));
  }
 
  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);
 
  // Apply DuoTone
  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));
  duotone.a *= color.a;
  
  duotone.rgb *= duotone.a;

  return duotone;
}

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);
}`;class Fv extends A.Filter{constructor(){super();this._fragmentSource=WT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),{lightColor:l,darkColor:d,intensity:c}=this._options;for(let p=0;p<o.width*o.height;p++){const h=p*4,m=a.data[h]/255,b=a.data[h+1]/255,_=a.data[h+2]/255,g=a.data[h+3]/255,S=new N(m,b,_,g),x=this._duoToneKernel(S,l,d,c);a.data[h]=x.r*255,a.data[h+1]=x.g*255,a.data[h+2]=x.b*255,a.data[h+3]=x.a*255}s.putImageData(a,0,0)}_duoToneKernel(e,t,i,r){const o=1e-7;if(e.clone().clamp(0,1),r>0){const l=Math.max(r+1,o);e.r=1-Math.pow(1-e.r,l),e.g=1-Math.pow(1-e.g,l),e.b=1-Math.pow(1-e.b,l)}else{const l=Math.max(-r+1,o);e.r=Math.pow(e.r,l),e.g=Math.pow(e.g,l),e.b=Math.pow(e.b,l)}const n=.2126*e.r+.7152*e.g+.0722*e.b,s=Math.min(Math.max(n,0),1),a=i.clone().mix(t,s);return a.a*=e.a,a}}Fv.prototype.availableOptions={lightColor:{type:f.COLOR,default:N.RED,uniformType:z.FLOAT4},darkColor:{type:f.COLOR,default:N.BLACK,uniformType:z.FLOAT4},intensity:{type:f.NUMBER,default:.5,uniformType:z.FLOAT}};class VT extends dt{constructor(...e){super(...e);this._filter=new Fv}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);let e=2*this._options.intensity-1;this._filter.setIntensity(e)}}VT.prototype.availableOptions=Fv.prototype.availableOptions;var $m=VT;var KT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_gamma;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);
  rgb = pow(rgb, u_gamma);
  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;
}
`;class Pv extends A.Filter{constructor(){super();this._fragmentSource=KT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);let{gamma:l}=this._options,d=new Float32Array(256);for(let h=0;h<256;h++)d[h]=255*Math.pow(h/255,l.r);let c=new Float32Array(256);for(let h=0;h<256;h++)c[h]=255*Math.pow(h/255,l.g);let p=new Float32Array(256);for(let h=0;h<256;h++)p[h]=255*Math.pow(h/255,l.b);for(let h=0;h<o.width*o.height;h++){const m=h*4;a.data[m]=d[a.data[m]],a.data[m+1]=c[a.data[m+1]],a.data[m+2]=p[a.data[m+2]]}s.putImageData(a,0,0)}}Pv.prototype.availableOptions={gamma:{type:f.COLOR,default:N.WHITE,uniformType:z.FLOAT3}};class $T extends dt{constructor(...e){super(...e);this._filter=new Pv}update(){this._filter.setGamma(this._options.gamma)}}$T.prototype.availableOptions=Pv.prototype.availableOptions;var qm=$T;var qT=`varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);

  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);
  textureCoord /= 0.75;

  float d = 1.0 - dot(textureCoord, textureCoord);
  d = clamp(d, 0.2, 1.0);
  vec3 newColor = texColor.rgb * d * u_color.rgb;
  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);
}
`;class Bv extends A.Filter{constructor(){super();this._fragmentSource=qT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),{color:l}=this._options;for(var d,c=0;c<o.width;c++)for(var p=0;p<o.height;p++){var h=(o.width*p+c)*4,m=c/o.width,b=p/o.height,_=(m-.5)/.75,g=(b-.5)/.75,S=_*_,x=g*g;d=1-(S+x),d=Math.min(Math.max(d,.1),1),a.data[h]=a.data[h]*(d*l.r),a.data[h+1]=a.data[h+1]*(d*l.g),a.data[h+2]=a.data[h+2]*(d*l.b),a.data[h+3]=255}s.putImageData(a,0,0)}}Bv.prototype.availableOptions={color:{type:f.COLOR,default:N.WHITE,uniformType:z.FLOAT3}};class XT extends dt{constructor(...e){super(...e);this._filter=new Bv}update(){this._filter.setColor(this._options.color)}}XT.prototype.availableOptions=Bv.prototype.availableOptions;var rc=XT;var YT=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  texColor.b = texColor.g * 0.33;
  texColor.r = texColor.r * 0.6;
  texColor.b += texColor.r * 0.33;
  texColor.g = texColor.g * 0.7;
  gl_FragColor = texColor;
}
`;class u8 extends A.Filter{constructor(){super();this._fragmentSource=YT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);for(var l=0;l<o.width;l++)for(var d=0;d<o.height;d++){var c=(o.width*d+l)*4;a.data[c+2]=a.data[c+1]*.33,a.data[c]=a.data[c]*.6,a.data[c+2]+=a.data[c]*.33,a.data[c+1]=a.data[c+1]*.7,a.data[c+3]=255}s.putImageData(a,0,0)}}class m8 extends dt{constructor(...e){super(...e);this._filter=new u8}}var Xm=m8;var JT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, W);
  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);
}
`;class f8 extends A.Filter{constructor(){super();this._fragmentSource=JT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);for(var l=0;l<o.width;l++)for(var d=0;d<o.height;d++){var c=(o.width*d+l)*4,p=a.data[c]*.2125+a.data[c+1]*.7154+a.data[c+2]*.0721;a.data[c]=p,a.data[c+1]=p,a.data[c+2]=p}s.putImageData(a,0,0)}}class g8 extends dt{constructor(...e){super(...e);this._filter=new f8}}var oc=g8;var ZT=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;
  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;
  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;

  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);
}
`;class QT extends A.Filter{constructor(...e){super(...e);this._fragmentSource=ZT}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),l=this._options.lookupTableData;for(let h=0;h<o.width*o.height;h++){const m=h*4;var d=a.data[m];a.data[m]=l[d*4];var c=a.data[m+1];a.data[m+1]=l[1+c*4];var p=a.data[m+2];a.data[m+2]=l[2+p*4]}s.putImageData(a,0,0)}}QT.prototype.availableOptions={lookupTable:{type:f.NUMBER,default:1,uniformType:z.INT},lookupTableData:{type:f.ARRAY,default:[]}};class b8 extends dt{constructor(...e){super(...e);this._filter=new QT({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(e){const t=e.getRenderer();t.isOfType(Ee.WEBGL)?this._updateWebGLTexture(e):t.isOfType(Ee.CANVAS)&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(e){if(typeof this._options.data=="undefined")throw new Error("LookupTable: No data specified.");const t=new Uint8Array(this._options.data),i=e.getRenderer(),{id:r}=i;this._renderers[r]=i,this._textures[r]||(this._textures[r]=new A.BaseTexture);const o=this._textures[r],n=new A.PixelArrayImage(256,1,t);o.setSource(n),o.setGLUnit(this._options.textureGLUnit),i.isOfType(Ee.WEBGL)&&i.updateTexture(o)}dispose(){super.dispose();for(let e in this._textures)this._textures[e].dispose(),delete this._textures[e];delete this._options.data}}var Ym=b8;var e1=`/**
 * Based off of GPUImage's LookupFilter:
 * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m
 */

varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float blueColor = texColor.b * 63.0;

  vec2 quad1;
  quad1.y = floor(floor(blueColor) / 8.0);
  quad1.x = floor(blueColor) - (quad1.y * 8.0);

  vec2 quad2;
  quad2.y = floor(ceil(blueColor) / 8.0);
  quad2.x = ceil(blueColor) - (quad2.y * 8.0);

  vec2 texCoord1;
  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec2 texCoord2;
  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);
  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);

  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);
}
`;const{Vector2:t1}=H,i1=3;class r1 extends A.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=e1}_precomputeQuads(){this._quads=[];for(var e=0;e<256;e++){const t=e/255*63;let i=new t1;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=this._options.lookupTableImage,l=this._createImageCanvas(a),d=l.getContext("2d"),c=n.getImageData(0,0,o.width,o.height),p=d.getImageData(0,0,a.width,a.height);let h=new t1;for(let m=0;m<o.width*o.height*4;m+=4){const b=c.data[m],_=c.data[m+1],g=c.data[m+2],S=c.data[m+3]/255,x=this._quads[g],C=64;h.x=x.x*C,h.y=x.y*C,h.x+=Math.floor(b/4),h.y+=Math.floor(_/4);const R=(a.width*h.y+h.x)*4|0;let T=p.data[R];T=b*(1-S)+T*S;let k=p.data[R+1];k=_*(1-S)+k*S;let M=p.data[R+2];M=g*(1-S)+M*S,c.data[m]=T,c.data[m+1]=k,c.data[m+2]=M}s.putImageData(c,0,0)}_createImageCanvas(e){const t=F.createCanvas();t.width=e.width,t.height=e.height;const i=t.getContext("2d");return i.drawImage(e,0,0),t}}r1.prototype.availableOptions={lookupTable:{type:f.NUMBER,default:i1,uniformType:z.INT},lookupTableImage:{type:f.IMAGE,uniformType:null}};class o1 extends dt{constructor(...e){super(...e);this._filter=new r1,this._textures={}}update(e){const t=e.getRenderer();t.isOfType(Ee.WEBGL)?this._updateWebGLTexture(e):t.isOfType(Ee.CANVAS)&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(e){const t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new A.BaseTexture);const r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(i1),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}}o1.prototype.availableOptions={image:{type:f.IMAGE}};var Jm=o1;var n1=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_saturation;

const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, luminanceWeighting);

  vec3 greyScaleColor = vec3(luminance);

  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);
}
`;class Mv extends A.Filter{constructor(){super();this._fragmentSource=n1}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height),{saturation:l}=this._options;for(var d=0;d<o.width;d++)for(var c=0;c<o.height;c++){var p=(o.width*c+d)*4,h=a.data[p]*.2125+a.data[p+1]*.7154+a.data[p+2]*.0721;a.data[p]=h*(1-l)+a.data[p]*l,a.data[p+1]=h*(1-l)+a.data[p+1]*l,a.data[p+2]=h*(1-l)+a.data[p+2]*l}s.putImageData(a,0,0)}}Mv.prototype.availableOptions={saturation:{type:f.NUMBER,default:0,uniformType:z.FLOAT}};class s1 extends dt{constructor(...e){super(...e);this._filter=new Mv}update(){this._filter.setSaturation(this._options.saturation)}}s1.prototype.availableOptions=Mv.prototype.availableOptions;var hr=s1;var a1=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec4 overlayVec4 = vec4(u_color, texColor.a);
  gl_FragColor = max(overlayVec4 * texColor.a, texColor);
}
`;class Lv extends A.Filter{constructor(){super();this._fragmentSource=a1}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);for(var l=0;l<o.width;l++)for(var d=0;d<o.height;d++){var c=(o.width*d+l)*4;a.data[c]=Math.max(this._options.color.r*255,a.data[c]),a.data[c+1]=Math.max(this._options.color.g*255,a.data[c+1]),a.data[c+2]=Math.max(this._options.color.b*255,a.data[c+2])}s.putImageData(a,0,0)}}Lv.prototype.availableOptions={color:{type:f.COLOR,default:N.WHITE,uniformType:z.FLOAT3}};class l1 extends dt{constructor(...e){super(...e);this._filter=new Lv}update(){this._filter.setColor(this._options.color)}}l1.prototype.availableOptions=Lv.prototype.availableOptions;var Zm=l1;class d1 extends Ym{constructor(...e){super(...e);this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){var e=this._calculateSplineCurve(this._options.rgbControlPoints.red),t=this._calculateSplineCurve(this._options.rgbControlPoints.green),i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(e,t,i)}_buildLookupTable(e,t,i){for(var r=[],o=0;o<256;o++)r.push(Math.min(Math.max(o+e[o],0),255)),r.push(Math.min(Math.max(o+t[o],0),255)),r.push(Math.min(Math.max(o+i[o],0),255)),r.push(255);return r}_calculateSplineCurve(e){e=e.sort(function(l,d){return l[0]>d[0]});var t=this._getSplineCurve(e),i=t[0],r;if(i[0]>0)for(r=0;r<i[0];r++)t.unshift([0,0]);var o=[];for(r=0;r<t.length;r++){var n=t[r],s=[n[0],n[0]],a=Math.sqrt(Math.pow(s[0]-n[0],2)+Math.pow(s[1]-n[1],2));s[1]>n[1]&&(a=-a),o.push(a)}return o}_getSplineCurve(e){var t=this._secondDerivative(e),i=t.length,r=[],o;for(o=0;o<i;o++)r[o]=t[o];var n=[];for(o=0;o<i-1;o++)for(var s=e[o],a=e[o+1],l=s[0];l<a[0];l++){var d=(l-s[0])/(a[0]-s[0]),c=1-d,p=d,h=a[0]-s[0],m=c*s[1]+p*a[1]+h*h/6*((c*c*c-c)*r[o]+(p*p*p-p)*r[o+1]);m>255?m=255:m<0&&(m=0),n.push([l,m])}return n.length===255&&n.push(e[e.length-1]),n}_secondDerivative(e){var t=e.length;if(t<=0||t===1)return null;var i=[],r=[],o,n;for(i[0]=[0,1,0],o=1;o<t-1;o++){var s=e[o-1],a=e[o],l=e[o+1];i[o]=i[o]||[],i[o][0]=(a[0]-s[0])/6,i[o][1]=(l[0]-s[0])/3,i[o][2]=(l[0]-a[0])/6,r[o]=(l[1]-a[1])/(l[0]-a[0])-(a[1]-s[1])/(a[0]-s[0])}for(r[0]=0,r[t-1]=0,i[t-1]=[0,1,0],o=1;o<t;o++)n=i[1][0]/i[o-1][1],i[o][1]-=n*i[o-1][2],i[o][0]=0,r[o]-=n*r[o-1];for(o=t-2;o>0;o--)n=i[o][2]/i[o+1][1],i[o][1]-=n*i[o+1][0],i[o][2]=0,r[o]-=n*r[o+1];var d=[];for(o=0;o<t;o++)d[o]=r[o]/i[o][1];return d}}d1.prototype.availableOptions={rgbControlPoints:{type:f.OBJECT},controlPoints:{type:f.ARRAY,default:[]},textureGLUnit:{type:f.NUMBER,default:1}};var Se=d1;var c1=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;
  gray -= 0.2;
  gray = clamp(gray, 0.0, 1.0);
  gray += 0.15;
  gray *= 1.4;
  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);
}
`;class y8 extends A.Filter{constructor(){super();this._fragmentSource=c1}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),a=n.getImageData(0,0,o.width,o.height);for(var l=0;l<o.width;l++)for(var d=0;d<o.height;d++){var c=(o.width*d+l)*4,p=a.data[c]/255*.3+a.data[c+1]/255*.3+a.data[c+2]/255*.3;p-=.2,p=Math.max(0,Math.min(1,p)),p+=.15,p*=1.4,p*=255,a.data[c]=p,a.data[c+1]=p,a.data[c+2]=p}s.putImageData(a,0,0)}}class v8 extends dt{constructor(...e){super(...e);this._filter=new y8}}var Qm=v8;var h1=`precision highp float;

uniform sampler2D u_image;

uniform sampler2D u_lookupTable;

uniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096
uniform float u_horizontalTileCount; // Horizontal Blue Tiles
uniform float u_verticalTileCount; // Vertical Blue Tiles

varying vec2 v_texCoord;

const float EPSILON = 0.000001;

// Try to get the exact pixel of the lut map image
vec3 lutColor(int texPosX, int texPosY) {
    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;
}

vec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {
    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);
}

void main() {
    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);

    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); 

    vec3 ranges = vec3(
        floor(u_resolution / u_horizontalTileCount - 1.0),
        floor(u_resolution / u_verticalTileCount - 1.0),
        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)
    );
    
    vec3 tmp = sourceColor * ranges;
    ivec3 floors = ivec3(tmp);
    ivec3 ceils = ivec3(ceil(tmp));
    vec3 fracts = fract(tmp);

    // Map tile index to tile pixel pos.
    ivec2 pixelsPerTile = ivec2(
        u_resolution / u_horizontalTileCount, 
        u_resolution / u_verticalTileCount
      );

    ivec2 tileFloor; // Blue tile index
    tileFloor.y = floors.z / int(u_horizontalTileCount);
    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));

    ivec2 tileCeil; // Blue tile index
    tileCeil.y = ceils.z / int(u_horizontalTileCount);
    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));
    
    tileFloor *= pixelsPerTile;
    tileCeil *= pixelsPerTile; 
    
    
    // Interpolate between red and green
    vec3 lutColorFB = bilinearInterpolate(
        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),
        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),
        fracts.x, fracts.y
    );
    vec3 lutColorCB = bilinearInterpolate(
        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),
        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),
        fracts.x, fracts.y
    );

    // Interpolate between the blue values
    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);

    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;
    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);

    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);
}
`;const{Vector2:ef,Vector3:p1}=H,u1=3;class m1 extends A.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=h1}_precomputeQuads(){this._quads=[];for(var e=0;e<256;e++){const t=e/255*63;let i=new ef;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){const{resolution:o,horizontalTileCount:n,verticalTileCount:s}=this._options,a=t.getCanvas(),l=t.getContext(),d=i.getContext(),c=this._options.lookupTableImage,p=this._createImageCanvas(c),h=p.getContext("2d");let m={width:128,height:128};o?m={width:o,height:o}:c.width&&c.height&&(m={width:c.width,height:c.height});const b=l.getImageData(0,0,a.width,a.height),_=h.getImageData(0,0,m.width,m.height),g=new p1(m.width/n-1|0,m.height/s-1|0,n*s-1|0),S=new N,x=new N,C=new N,R=new N,T=new N,k=new N,M=new N,U=new N,L=new ef,ee=new ef,de=(Ae,V,Q,ne)=>{Ae.r=V.r*(1-ne)+Q.r*ne,Ae.g=V.g*(1-ne)+Q.g*ne,Ae.b=V.b*(1-ne)+Q.b*ne},ge=(Ae,V,Q)=>{V=.5+V|0,Q=.5+Q|0;const ne=(Q*m.width+V)*4;Ae.r=_.data[ne]/255,Ae.g=_.data[ne+1]/255,Ae.b=_.data[ne+2]/255,Ae.a=_.data[ne+3]/255},xe=new N,Oe=new N,ft=(Ae,V,Q,ne,Fe,K,Y)=>{de(xe,V,ne,K),de(Oe,Q,Fe,K),de(Ae,xe,Oe,Y)},kt=new ef(m.width,m.height).divide(n,s).floor();for(let Ae=0;Ae<a.width*a.height*4;Ae+=4){S.set(b.data[Ae]/255,b.data[Ae+1]/255,b.data[Ae+2]/255,b.data[Ae+3]/255);const V=new p1(S.r*g.x,S.g*g.y,S.b*g.z),Q=V.clone().floor().toInt(),ne=V.clone().ceil().toInt(),Fe=V.clone().fract();L.y=Q.z/n|0,L.x=Q.z-L.y*n|0,ee.y=ne.z/n|0,ee.x=ne.z-ee.y*n|0,L.multiply(kt),ee.multiply(kt),ge(T,L.x+Q.x,L.y+Q.y),ge(k,L.x+Q.x,L.y+ne.y),ge(M,L.x+ne.x,L.y+Q.y),ge(U,L.x+ne.x,L.y+ne.y),ft(C,T,k,M,U,Fe.x,Fe.y),ge(T,ee.x+Q.x,ee.y+Q.y),ge(k,ee.x+Q.x,ee.y+ne.y),ge(M,ee.x+ne.x,ee.y+Q.y),ge(U,ee.x+ne.x,ee.y+ne.y),ft(R,T,k,M,U,Fe.x,Fe.y),de(x,C,R,Fe.z),b.data[Ae]=Math.ceil(x.r*255),b.data[Ae+1]=Math.ceil(x.g*255),b.data[Ae+2]=Math.ceil(x.b*255)}d.putImageData(b,0,0)}_createImageCanvas(e){const t=F.createCanvas();t.width=e.width,t.height=e.height;const i=t.getContext("2d");return i.drawImage(e,0,0),t}}m1.prototype.availableOptions={lookupTable:{type:f.NUMBER,default:u1,uniformType:z.INT},lookupTableImage:{type:f.IMAGE,uniformType:null},resolution:{type:f.NUMBER,uniformType:z.FLOAT},horizontalTileCount:{type:f.NUMBER,default:5,uniformType:z.FLOAT},verticalTileCount:{type:f.NUMBER,default:5,uniformType:z.FLOAT}};class f1 extends dt{constructor(...e){super(...e);this._filter=new m1,this._textures={}}update(e){const t=e.getRenderer();t.isOfType(Ee.WEBGL)?this._updateWebGLTexture(e):t.isOfType(Ee.CANVAS)&&this._filter.setLookupTableImage(this._options.image);const{resolution:i,verticalTileCount:r,horizontalTileCount:o,image:n}=this._options;this._filter.set({resolution:i||n.width,verticalTileCount:r,horizontalTileCount:o})}_updateWebGLTexture(e){const t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new A.BaseTexture);const r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(u1),r.setMinFilter(A.BaseTexture.NearestFilter),t.updateTexture(r)}dispose(){super.dispose();for(let e in this._textures)delete this._textures[e]}}f1.prototype.availableOptions={image:{type:f.IMAGE},resolution:{type:f.NUMBER},horizontalTileCount:{type:f.NUMBER,default:5},verticalTileCount:{type:f.NUMBER,default:5}};var tf=f1;const zv={};ut(zv,{Brightness:()=>ll,ColorMatrixPrimitive:()=>Km,Contrast:()=>cr,Desaturation:()=>an,DuoTone:()=>$m,Gamma:()=>qm,Glow:()=>rc,Gobblin:()=>Xm,Grayscale:()=>oc,LookupTable:()=>Ym,LookupTableImage:()=>Jm,Saturation:()=>hr,SoftColorOverlay:()=>Zm,ThreeDLookupTableImage:()=>tf,ToneCurve:()=>Se,X400:()=>Qm});class Nv extends le{constructor(...e){super(...e);this._stack.push(new ll({brightness:0}))}render(e,t,i){return this._stack.isEmpty()&&this._stack.push(new ll({brightness:0})),super.render(e,t,i)}}Nv.isIdentity=!0;Nv.identifier="identity";var rf=Nv;class g1 extends le{constructor(...e){super(...e);this._stack.push(new cr({contrast:.63})),this._stack.push(new ll({brightness:.12})),this._stack.push(new Se({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}}g1.identifier="a15";var b1=g1;class y1 extends le{constructor(...e){super(...e);this._stack.push(new an({desaturation:.5})),this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}}y1.identifier="breeze";var v1=y1;class _1 extends le{constructor(...e){super(...e);this._stack.push(new oc)}}_1.identifier="bw";var x1=_1;class w1 extends le{constructor(...e){super(...e);this._stack.push(new oc),this._stack.push(new cr({contrast:1.5}))}}w1.identifier="bwhard";var C1=w1;class S1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}}S1.identifier="celsius";var T1=S1;class k1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}}k1.identifier="chest";var E1=k1;class Uv extends le{constructor(...e){super(...e,{intensity:{type:f.NUMBER,default:.5,required:!0,setter:function(t){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(t),this._stack.setIntensity(1)),this._dirty=!0,t}}});this._filterPrimitive=new $m({lightColor:this._options.lightColor||N.WHITE,darkColor:this._options.darkColor||N.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}}Uv.prototype.availableOptions={lightColor:{type:f.COLOR,default:N.WHITE,required:!0,setter:function(e){return this._filterPrimitive&&this._filterPrimitive.setLightColor(e),this.setDirty&&this.setDirty(!0),e}},darkColor:{type:f.COLOR,default:N.BLACK,required:!0,setter:function(e){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(e),this.setDirty&&this.setDirty(!0),e}},intensity:{type:f.NUMBER,default:.5,required:!0}};Uv.identifier="duotone";var D1=Uv;class I1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}}I1.identifier="fixie";var O1=I1;class R1 extends le{constructor(...e){super(...e);this._stack.push(new hr({saturation:1.35})),this._stack.push(new cr({contrast:1.1}))}}R1.identifier="food";var A1=R1;class F1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}}F1.identifier="fridge";var P1=F1;class B1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}}B1.identifier="front";var M1=B1;class L1 extends le{constructor(...e){super(...e);this._stack.push(new cr({contrast:1.1})),this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}}L1.identifier="glam";var z1=L1;class N1 extends le{constructor(...e){super(...e);this._stack.push(new Xm)}}N1.identifier="gobblin";var U1=N1;class H1 extends le{constructor(...e){super(...e);this._stack.push(new Se({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new hr({saturation:.9}))}}H1.identifier="k1";var G1=H1;class j1 extends le{constructor(...e){super(...e);this._stack.push(new Se({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Zm({color:new N(40/255,40/255,40/255)}))}}j1.identifier="k2";var W1=j1;class V1 extends le{constructor(...e){super(...e);this._stack.push(new hr({saturation:.5}))}}V1.identifier="k6";var K1=V1;class $1 extends le{constructor(...e){super(...e);this._stack.push(new Se({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new hr({saturation:.7}))}}$1.identifier="kdynamic";var q1=$1;class X1 extends le{constructor(...e){super(...e);this._stack.push(new an({desaturation:.4})),this._stack.push(new Se({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}}X1.identifier="lenin";var Y1=X1;class J1 extends le{constructor(...e){super(...e);this._stack.push(new Se({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}}J1.identifier="lomo";var Z1=J1;class Q1 extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}}Q1.identifier="mellow";var ek=Q1;const{ColorMatrix:_8}=H;class tk extends le{constructor(...e){super(...e);let t=new _8(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new Km({colorMatrix:t}));let i=new N(.8,.6,.9);this._stack.push(new qm({gamma:i}))}}tk.identifier="metal";var ik=tk;class rk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new rc)}}rk.identifier="morning";var ok=rk;class nk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new Se({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new an({desaturation:.65}))}}nk.identifier="orchid";var sk=nk;class ak extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new hr({saturation:.8})),this._stack.push(new cr({contrast:1.5}))}}ak.identifier="pola";var lk=ak;class dk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new hr({saturation:.8})),this._stack.push(new cr({contrast:1.5}))}}dk.identifier="pola669";var ck=dk;class hk extends le{constructor(...e){super(...e);this._stack.push(new an({desaturation:.65})),this._stack.push(new Se({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}}hk.identifier="quozi";var pk=hk;class uk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new rc)}}uk.identifier="semired";var mk=uk;class fk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new Se({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}}fk.identifier="sunny";var gk=fk;class bk extends le{constructor(...e){super(...e);this._stack.push(new Se({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}}bk.identifier="texas";var yk=bk;class vk extends le{constructor(...e){super(...e);this._stack.push(new Qm)}}vk.identifier="x400";var _k=vk;class Hv extends le{constructor(...e){super(...e);this._lutPrimitive=new Jm({image:this._options.image}),this._stack.push(this._lutPrimitive)}}Hv.prototype.availableOptions={image:{type:f.IMAGE,required:!0,setter:function(e){return this._lutPrimitive&&this._lutPrimitive.setImage(e),this.setDirty(!0),e}}};Hv.identifier="lut";var xk=Hv;class Gv extends le{constructor(...e){super(...e);const{image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}=this._options;this._lutPrimitive=new tf({image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}),this._stack.push(this._lutPrimitive)}}Gv.prototype.availableOptions={image:{type:f.IMAGE,required:!0,setter:function(e){return this._lutPrimitive&&this._lutPrimitive.setImage(e),this.setDirty(!0),e}},resolution:{type:f.NUMBER},horizontalTileCount:{type:f.NUMBER,default:5},verticalTileCount:{type:f.NUMBER,default:5}};Gv.identifier="3d-lut";var wk=Gv;const jv={};ut(jv,{A15Filter:()=>b1,BWFilter:()=>x1,BWHardFilter:()=>C1,BreezeFilter:()=>v1,CelsiusFilter:()=>T1,ChestFilter:()=>E1,DuoToneFilter:()=>D1,FixieFilter:()=>O1,FoodFilter:()=>A1,FridgeFilter:()=>P1,FrontFilter:()=>M1,GlamFilter:()=>z1,GobblinFilter:()=>U1,IdentityFilter:()=>rf,K1Filter:()=>G1,K2Filter:()=>W1,K6Filter:()=>K1,KDynamicFilter:()=>q1,LUTFilter:()=>xk,LeninFilter:()=>Y1,LomoFilter:()=>Z1,MellowFilter:()=>ek,MetalFilter:()=>ik,MorningFilter:()=>ok,OrchidFilter:()=>sk,Pola669Filter:()=>ck,PolaFilter:()=>lk,QuoziFilter:()=>pk,SemiredFilter:()=>mk,SunnyFilter:()=>gk,TexasFilter:()=>yk,ThreeDLUTFilter:()=>wk,X400Filter:()=>_k});class dl extends Ge{_render(e){return this._selectedFilter.render(this._sdk,e,this._renderTexture)}render(e){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(e):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),ce.resolve(e))}setDirtyForRenderer(e,t){super.setDirtyForRenderer(e,t),this._selectedFilter.setDirtyForRenderer(e,t)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(e){const t=y({},e);if(delete t.filter,e.filter){const i=e.filter.constructor;i.identifier==="3d-lut"?this.setFilter(new i({image:e.filter.getImage(),resolution:e.filter.getResolution(),horizontalTileCount:e.filter.getHorizontalTileCount(),verticalTileCount:e.filter.getVerticalTileCount()})):i.identifier==="duotone"?this.setFilter(new i({lightColor:e.filter.getLightColor(),darkColor:e.filter.getDarkColor(),intensity:e.filter.getIntensity()})):this.setFilter(new i)}this.set(t)}resetToDefaultFilterIntensity(){const e=this._selectedFilter&&this._selectedFilter.availableOptions,t=e&&e.intensity.default;this.setIntensity(t||1)}}dl.identifier="filter";dl.prototype.availableOptions={identifier:{type:f.STRING,default:"identity"},intensity:{type:f.NUMBER,default:1,setter:function(e){return this._selectedFilter&&this._selectedFilter.setIntensity(e),e}},filter:{type:f.OBJECT,default:new rf,setter:function(e){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=e,typeof this._options.intensity!="undefined"&&this._selectedFilter.set({intensity:this._options.intensity}),e}}};dl.FilterPrimitives=zv;dl.Filters=jv;dl.Filter=le;ue.Operations.FilterOperation=dl;var Ck=dl;const{Vector2:nc}=H;class ep extends Ge{constructor(...e){super(...e);this._colorOverlayFilter=new A.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new A.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(e){if(!e)return this._disposeSprites();const{imageGroups:t,layoutMode:i}=e;this._layoutMode=i||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(r=>{if(typeof t[r]=="undefined")return;["start","mid","end"].forEach(o=>{if(typeof t[r][o]=="undefined")return;let n=t[r][o];"image"in n&&(n=n.image);let s=A.Texture.fromImage(n);const a=new A.Sprite(s);this._spriteGroups[r][o]=a,this._sprites.push(a),this._frameContainer.addChild(a)})})}_render(e){const t=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(e)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(t):(this._frameRenderTexture=new A.RenderTexture(this._sdk.getRenderer(),t.x,t.y),this._frameSprite=new A.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),ce.resolve()}_updateSprites(e){const t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(e,"top",0),this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth),this._updateVerticalSpriteGroup(e,"left",0),this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)}_updateHorizontalSpriteGroup(e,t,i=0){const r=e.getDimensions(),o=this._layoutMode==="vertical-inside",n=this._spriteGroups[t].start,s=this._spriteGroups[t].mid,a=this._spriteGroups[t].end;let l=0,d=0,c,p;if(n){c=n.getTexture().getDimensions(),p=c.y/c.x,l=Math.floor(this._frameWidth/p);const h=new nc(0,i);h.x=o?this._frameWidth:0,n.setPosition(h),n.setHeight(this._frameWidth),n.setWidth(l)}if(a){c=a.getTexture().getDimensions(),p=c.y/c.x,d=Math.floor(this._frameWidth*p);let h=new nc(r.x-d,i);h.x-=o?this._frameWidth:0,a.setPosition(h),a.setHeight(this._frameWidth),a.setWidth(d)}if(s){c=s.getTexture().getDimensions(),p=c.y/c.x;let h=new nc(l,i),m=r.x-l-d;if(o&&(h.x+=this._frameWidth,m-=this._frameWidth*2),s.setPosition(h),s.setWidth(m),s.setHeight(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){const b=this._frameWidth/p,_=Math.ceil(m/b);let g=0;if(_!==-1){let S=Math.round(m/_);s.setWidth(S),g+=S,this._ensureRepeatSpritesExist(_-1,t,s);for(let x=0;x<_-1;x++){S=Math.round((m-g)/(_-x-1));const C=this._repeatSprites[t][x],R=h.clone().add(g,0).floor();C.setPosition(R),C.setWidth(S),C.setHeight(this._frameWidth),g+=S}}}}}_ensureRepeatSpritesExist(e,t,i){i.getTexture().setMaxListeners(e+1);const r=this._repeatSprites[t].length;if(e>r){const o=e-r;for(let n=0;n<o;n++){const s=new A.Sprite(i.getTexture());this._repeatSprites[t].push(s),this._frameContainer.addChild(s),this._sprites.push(s)}}else if(e<r){const o=this._repeatSprites[t].splice(e);o.forEach(n=>{const s=this._sprites.indexOf(n);if(s===-1)return;this._sprites.splice(s,1),this._frameContainer.removeChild(n),n.dispose()})}}_updateVerticalSpriteGroup(e,t,i=0){const r=e.getDimensions(),o=this._layoutMode==="horizontal-inside",n=this._spriteGroups[t].start,s=this._spriteGroups[t].mid,a=this._spriteGroups[t].end;let l=0,d=0,c,p;if(n){c=n.getTexture().getDimensions(),p=c.y/c.x,l=Math.floor(this._frameWidth*p);const h=new nc(i,0);h.y=o?this._frameWidth:0,n.setPosition(h),n.setWidth(this._frameWidth),n.setHeight(l)}if(a){c=a.getTexture().getDimensions(),p=c.y/c.x,d=Math.floor(this._frameWidth*p);let h=new nc(i,r.y-d);h.y-=o?this._frameWidth:0,a.setPosition(h),a.setWidth(this._frameWidth),a.setHeight(d)}if(s){c=s.getTexture().getDimensions(),p=c.y/c.x;let h=new nc(i,l),m=r.y-l-d;if(o&&(h.y+=this._frameWidth,m-=this._frameWidth*2),s.setPosition(h),s.setHeight(m),s.setWidth(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){const b=this._frameWidth*p,_=Math.ceil(m/b);let g=0;if(_!==-1){let S=Math.round(m/_);s.setHeight(S),g+=S,this._ensureRepeatSpritesExist(_-1,t,s);for(let x=0;x<_-1;x++){S=Math.round((m-g)/(_-x-1));const C=this._repeatSprites[t][x],R=h.clone().add(0,g).floor();C.setPosition(R),C.setHeight(S),C.setWidth(this._frameWidth),g+=S}}}}}_disposeSprites(){this._sprites.forEach(e=>{this._frameContainer.removeChild(e),e.getTexture().dispose(),e.dispose()}),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(e){if(!e)return;const{imageGroups:t,layoutMode:i}=e;if(typeof e.identifier!="string")throw new Error("Frame needs a property `identifier` of type String.");if(typeof e.imageGroups!="object")throw new Error("Frame needs a property `imageGroups` of type Object.");const r=o=>{const{start:n,end:s,mid:a}=t[o];if(typeof t[o]=="undefined")return;if(typeof t[o]!="object")throw new Error(`Frame: \`imageGroups.${o}\` needs to be of type Object.`);if(typeof n!="undefined"&&!(n instanceof vi||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.start\` needs to be of type Image.`);if(typeof a!="undefined"&&!(n instanceof vi||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement)&&typeof a!="object")throw new Error(`Frame: \`imageGroups.${o}.mid\` needs to be of type Image or Object.`);if(typeof s!="undefined"&&!(s instanceof vi||typeof HTMLImageElement!="undefined"&&s instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.end\` needs to be of type Image.`)};if(typeof i!="undefined"&&["vertical-inside","horizontal-inside"].indexOf(i)===-1)throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if(typeof tintable!="undefined"&&typeof tintable!="boolean")throw new Error("Frame: `tintable` needs to be of type Boolean.");r("top"),r("left"),r("right"),r("bottom")}}ep.identifier="frame";ep.prototype.availableOptions={frame:{type:f.OBJECT,validation:ep.validateFrame,setter:function(e,t){return t||this._createSpritesForFrame(e),e},default:null},alpha:{type:f.NUMBER,default:1},tintColor:{type:f.COLOR,default:new N(1,1,1,0)},scale:{type:f.NUMBER,default:.1}};ue.Operations.FrameOperation=ep;var Sk=ep;var Tk=`uniform sampler2D u_image;
uniform sampler2D u_watermarkTex;

varying vec2 v_texCoord;


void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);

  if (watermarkColor.r > 0.8) {
    gl_FragColor = mix(color, watermarkColor, 0.3);
  } else {
    gl_FragColor = color;
  }
}
`;class kk extends A.Filter{constructor(...e){super(...e);this._fragmentSource=Tk}_applyWebGL(e,t,i,r=!1){const o=e.getContext(),n=o.canvas,s=this.getShaderForRenderer(e),a=t.getFrame(),l=this._watermarkCanvas;(!l||a.width!==l.width||a.height!==l.height)&&this._createWatermarkCanvas(a.width,a.height);let d=A.Texture.fromCanvas(this._watermarkCanvas),c=d.getBaseTexture();e.updateTexture(c),c.setGLUnit(1),e.setRenderTarget(i),r&&i.clear(),e.setShader(s);const p=e.getCurrentRenderTarget().getProjectionMatrix().toArray();s.setUniform("u_projMatrix",p),s.syncUniforms(),o.uniform1i(o.getUniformLocation(s.getProgram(),"u_watermarkTex"),1),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,c.getGLTextureForRenderer(e)),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),d.dispose()}_createWatermarkCanvas(e,t){let i=this._options.watermarkImage;const r=F.createCanvas();r.width=e,r.height=t;const o=r.getContext("2d");let n,s,a,l,d;e>t?(n=e/i.width,a=(t-i.height*n)/2,s=0):(n=t/i.height,a=0,s=(e-i.width*n)/2),o.drawImage(i,0,0,i.width,i.height,s,a,i.width*n,i.height*n),this._watermarkCanvas=r,this._watermarkContext=o}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext();let a=this._options.watermarkImage;this._createWatermarkCanvas(o.width,o.height);const l=n.getImageData(0,0,o.width,o.height),d=this._watermarkContext.getImageData(0,0,o.width,o.height);let c=new N,p=new N,h=new N;for(let m=0;m<o.width*o.height*4;m+=4)c.set(l.data[m]/255,l.data[m+1]/255,l.data[m+2]/255,l.data[m+3]/255),p.set(d.data[m]/255,d.data[m+1]/255,d.data[m+2]/255,d.data[m+3]/255),p.r>.8?h.copy(c.clone().mix(p,.3)):h.copy(c),l.data[m]=h.r*255,l.data[m+1]=h.g*255,l.data[m+2]=h.b*255,l.data[m+3]=h.a*255;s.putImageData(l,0,0)}}kk.prototype.availableOptions={watermarkImage:{type:f.OBJECT,required:!0}};var Ek=kk;const x8="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDA4NDFGODc4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4NDFGODg4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMDg0MUY4NTg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMDg0MUY4Njg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppk6b2UAAAASUExURQAAAP///8zMzDMzM2ZmZpmZmer1GSkAABunSURBVHja7F3rgt6mDlzr8v6v3O5ukqaJbQSS0GDjn+c0+9lomBkJEB8fD3tEPvbz5ocO3oPw6vgfx+aA9z56HBsBL37k+H50D8UrHz6OjYAd/42ANxvAjYC3G8BfD+0ReacB3AjYBmAj4IXPcfJQVVFQaFuQSgNYiwBW2uxTbADrEMDyA4p7RaLUABYhgP8D4i5H1xrAAgT8mvzbgWIYgLkI4D9VaGtAuQGYiAD5G4NbAxAEYAoCvmz/rkJAVQAmxoKvCGhrAIABSEeAXP/81oDiDDAfASx36NvFQAgDkIcA1kLh2U+HAKTMx1b4twlAyADTEMBUgLn9DAtAcDyYCo3HfroywAQEiFl2tgbgCEAYAuzh34lgUQaokheRnvBvE1BjAOiuNiATw79NQE0GyB9JCOgN/zYBJQIgd/+nIybcH/5tAgoEQO/hMYqAofBvDZgvANTOEAYWh1mPYwNgCQFgQ45Is8K/TcB0ARBTlaAPAY7wbxNQJgD3oevIz+3WX8+YYmtAlQDEIMAcfhI+p6WtAVUCcI8AEzWzPfyXvLQBME8A1F4ssiDA7P1Ibn5tV4PnCUBPubA9NcUafr79N9sEFArALY3flwOs4q/ceDPaGhD+aJev44Fk0Mr+ym2+2QCYIwDUSxg38iyD4T8FwK4EzHGA/BGFAKP3V7ZBZ5uAUgG4n9EyXPhTtmJtA2CGA6RBR89j5k+5g562CZggADJEG395dHaGf5uAIgfYrraoJRUQb/i3CUh/OkpAtoKQ9k1/5W6F2gBId4AmkqWGEZTOqp/domwTkOwA1fFvf8bHMv1NRb3tAqFKAFYEGKY/yShH7fWgXAcovn/+ObMNub+Mk9Q2AakOkLwAOgK83wZAnQNk91+IEf9tApAdYCsVCBD/XQoqcYAU8UdC9/XKdoHfbCs8gwAk5K9EiP82AX9NNSJhxiKATiNIEgPUF5qAX8NAGgMCiTp4I3nsv13gxTwg8usBhTVg0Azvf//35eUACGACCTx6SVnsf/mqLzQB5wEbBgEHUrTJCGog9l8JALo9QxVD2xQYoqjpf/7tGwBOIuDgo9eS2ttpu0CDzvYRgUaHSdOm//kffx0ALDJL5iJLNAHcAtRfttu1QHPBzSgGGt96gbOm/3aBvdWWthhwRvcdyWvtuAHQu+7awACl9F7RvKY+2wX2L7rdYCCFAD6MXWY2ACYB4AYDlDRROU0EZBeDx9oqnmIgiwDMjYZCoPWyNICP4cdy5D6KUTVJBLYLdADgz/oAZ3n1a6LShL+7ATAqBZrZf5OTROD1LlAO9/OjIpNKAGki8HoA0BHwfElBKgF8jJ4232nADAB80UAuAWSJwOvTgCgA5BXrGmql4QCglwOAhKJQoTPAKuED8B86fnvkt+f3//15ScDn97MQHAEMNh0acYGi9P1YtO/7UZUl8XAtgcxKWATgPnM8QwO/0SDLYIFvx9OJgfghoPjf0TQD9BMJqwHgj25c42KgU17X9UMBNGcGwjJ1II4aJZ7zvqO/xHFm14oDQBhYd0UOYCAnm4o5dzg7+L/DAAsDHZXQXgzwLM3q9IFTaH/6uGRkwT4M0DzO6vixoPzWQwEfCwOgBwNpFXXHr5VH/wEA+DDe0ZD3naOHT4uZH3OpabASbiBSmQlaw+8JRPThLMD4UkgLAzz1pVuvDRN+tIuJXIuhd5yauqTae/wIJ/xwFoCd3H05tDz5rW9GFin8cJsN2B26cxpIxrnYKQAr/HD7zSTgDaXA6lopgMHC/0gAaMFnim1sFS38cLuNAhokcInQWXRH4KY/3n7DgE3RFQpgoQD2Tf9f+3z+t//r/4+IdmwdgtxxHAAAquE5akwvGY770HaeH4jQFhoYHgC9weOie9hPA+yY/t+r9THx+cLCKRDgNhwHAKAK5nRDsNIZ+5yNGitcSeMHgFbBXK5toHbEXvM26axwHYEfAFQGc7rgHnPuTzK9XsmPA0DhV8q5DbTRf+bMv34/OAvgPxdV+JV8utamtujXMJQ+DwCVXzmY6CuX4ZMXAIC6ASCFb1+t+68DQO1XDnS4mze2uoAFcG8HKDY6ghv+Re6kcwOg9isZN/yLXEjl3g9S3GGnQwNmG/A1bqPxAqC6vYZZA+ZvxaQNACAKEISRRWw+5QVA+X0LBJT4N7mJnweA8iZ7Ajn9V0kCHwAAhpz+H8tcTC7hAKD6gUYY9VVuJXYCAKDHnmKew1pEARIAoABTDWDxbYWVwBwACBAA6kR3kSTQDQCpFzqGPIari1gAbwQB7t1UyBMYtIgF8AKgvtc+Qx7AWEYB4gGAkgUK2rCC3kKxOgAEswvHMgqwPAAwT+CuowCrA0AxD+CuowCLA4Ax47+QAiwOAELk/6UUYG0ABDYOf2cV6MO9HFwLAALtwLGQAiwNAFQCWEkBVgYAAxaAllOAlQGgmA5wLQVYGACwBLCUAngX9AsBQKgEsJQCrAsAVAe4mAJ493TVLQejpoBFXROrAFC2IWQpAgBWAO+23qotYbAO8LxtzQfw41NxLgIAbAq4mgIsCgBcAlhNARIAIEWjjEEADGpNJwJgwufiOsDFigABmXxJIQA2BTzdogZtAd2ZfAUAzveBQYymLKcArUz+99sRQAAA7ADXs4CnmP3tGgz6+woN+r5CI4ZAnpUCrlcE+BhrtvnzYo1/cTC/FMjA93DoakWAz/tfD9cznwGAHeDHsZACfM7ejquOeloxvzUFXMYCfoX+SHto+iRDGWV8C3h1k9E6AAB2gOAW8Cv2x5Rn9r3xKD4L1gJOjH02AGgxAqhXAD6/2zv1yUM9sgO8UCcpfLvJE3/CjEROAT+gGlUmG/0iAEATgMD0Kq1g/SkhgXaA9x1L50GAEW5MT4oJcgrYbFo9AwJVmj+JAhYmgAkQqOf9dF+GnALa1tT00byfTQHQDtB4hWXKtVVQUz9xYkKngOZF9WAIMGT0U6T5CQTwDQFeg/h/bglSVZHPPUKnm4Sun1c5wL5dNUFuUJOCLtcbAH/SDkt7K4FOmGIwS21aYZI1NvByG/SBaiNvAsi1AhwTehVmnw7RBB9IjyKAICtA3tAzx8xS1mwKwHaAg1PRbQWkatbPV2jkfWAOMZbpwPua9utVaYGPAvm02KkDhBD7CRyN7QDP4WnN0V06YL85O39fSmadDtsB8tXbMaXrAFVP/CkUwNAO8DwI329ng4BDB7Q98bl0HAidXBIJoAMCEjs3ZrH+JKGWZQnADoFhEiCM4GemgoydAkr7q00Q0Lifr7owK4kCsFPAJgF8h8li1sZGCokdU7h6xRTwhPYsENCoFyCo2aAJfxM7BTzHvOaQAD+cAlZ0gBeQZ00hAUJySPHTldZzgNfwNLjBfhKAooBwwX4QAVitgEa8RJlHCk4FV3SADXhqeE1AoLKk2KRdF3SALXgarID6x7xskoRyNjgBjDqetg70kQBUJhjq2lbcBybj/3QU5Qw1TQKX7lbcB2aEZzsf0GUpIE63sVNA8sGzqQMdMoDVmyZMuBWaADRl3g7+McKngKMOSBPNbt9XchgJCNZUiaFu6BSQYzZ2aJQXxKKAEPO2YjeI/iFvkoA+hwJo/t+YrHJDIy4xMoDllwNm74r9wMboqUkCsiAF+PUbeR+YBJ+FlAAZ4IdRAPI+MA4/Dd0iAYsMKBYFOBkc2QFyxjm/VjrAq1GAMxUEdoCccxi+RQLyKgoAPgp0GSj326nTCCxBATSDPkriH3EAhnxGAIwCODilgSCAy/jHoFNdCECjgOFU8GKdleufy3wtyp6IywgsQQHqnQeQD6dTjGX0GMw6DzI5rxd/ySZOYzjBKGDQy9Fy8dcJ88YEADQKGMrmZLn4R4/w3bZhHqAPAaMAehgBxM8wHfYaa1CAPIsABCf+eBTQvaazoAOMvhhOPVBDo4DuVd0FU8CvL2KM+ONRQO/x2WPVJ6otizP+eMsofT6QjuPdEFC31VCwgnCXD5Rj6ccPAfLXGuAooGdJgI7j1RAIiD/edvoOCtBj/cdjB0Pif2G80Sjg7IX4eMQzCgEOir+lcyHmkoAeD3mkNP4XA46fCvLxmGeg3RsHrjXBbaixpYJ0POhRros/3pY6kw+U41lPwDmo4bgtmQqef720n3N+kZyn455WLYs/3rZ6AwWMZ6+T4W6/q9d3ut/F23AHa5q2xPPG0ysfZgw43t+p27qED9QYzqqAu/VGqKL4412y0KAAX+JSkvbYaKAtA5QR/+VSQWfeUpT2mGiAR8s/zg9Yygd64VoGd0sHeBlL/70AFjQRuNkd5hfxOrizp+mnRNeT29oCeVDIb+Mr0x4e7veXGn9fJ9OpPjAieqWL4E0IaK/9D8GuFs6KLp6O4O/iygcPHO7Pjv8qIsAxlbzqtKcBAe2x/1HAFTQROJ/qQTlc+QrY/cFe7fiPw2CLJgIdK/4cxS/1LucMAXLMiP/VgIO1D4wCKUDl41YH1DYOofe+womAdR0tvNSEQAJqiv8E1S0UAckSgEapCcMJSFv+o00LnAhQGgF8oLSX1XsEyDEx/ldvUycCnEcAMCtgcvdlk+N/NeXq1gRy7s9FSQWbKKcjP/03vYwAU0B4qWn+Rw7tcJapU67MBkjmOMCcixtAAM99F7CbJYNeDGczZO8xJ+LZpKugFMAJ4/4BjwAteBWBpADN+OOKjgAtGfEqG8CZSgi0GVKr7V9rxMtsgGZOBaDNkAoS/8s3ITgKoKw/XqN3VGz/miNeZQRl+k6oIqwbEECV411mBClxMJAoIPaW+Iy8S6AogBP/eI3l5XL5b1kRBqIAyhz0Irnj6tFvkhDSzJBMxDMU2VXbv3J7pJM9QF3OI6jyXzwwaRRAaI63MAlXhDrkZKsmaEi/hKRU/TAIAmhiJbCWArjGfnFKP6PsYeE0AsBb/aAS2OEgIMMHMiDVXcNS5/8k0tBkpIKKmPNWpKbdfXcVZlQyaQ9tHxTBxH9OVcKUCmr4MANvhtWZcMNDQHQqaNC9MgqQeSJwb/8FSSGDU0HYlHeqCHBjmgsQQcamgibhqzsWN2nM22ePBGh+RKaCtsQX7lgcT4y/NP+b2UYgMhU0Oh+09gg0L/5s4UqIA/WZlS+0HjmhI25tPaE42UCYDzSnPnA9cubEX+1+SespgGO5D1sEdH78GwggqaYAiplcinZ7Tmrrvj5lV5SqUIwPvEgn0LqmZ/Zv7e08pyiFwYhU8BJFaF3T01r33ZX/LmLZ7HDL61DAZZzhbs+hHB94G//hytkkCPh5+uYvrHGXsibGXz3OeY4QuK3azR+Ao4CM+5yGL54w5E4zMoLUG0PgLtCa1RjFBHVL+YyESyiAfN8v4aWmVLhLSfytW0ezzYCPpxsyv+hdyiHx59Hhm00DHqvWRM+CF6nGlECNDs5aRE3FgMMbN+P7aB8YsbRrP0GQh4Fxnjb8S7RUMNCWSMyyZ8cmUkp6hn/MwB2rXaQaEv++z5OhfaS4T9aAg/nAyM1d+qT4Sx7nZvpALoz/aIdjyIfyOBch7THkf2MO9zE6wOm5d1LaI6Xxf4wOaHruneUDqTj+tuuwVyQApDbSd5wkxfF/BAQ0vNQ0zwdSefwfAIHs3BuBAm4ce4SsLQ0BmbQGk5QKOsATaWvWhQAl597ZqaBAxP9zuBZNCjk394agAHUt/z67LqDTlmGzKEBh4v8x2GkClQBW2R3Gw/Gfe9R8LQeIuSQgA++jARsA/Lnmcg5wpVSQxyelvDv+7e9HSwX7KaCRn+mrDQANglpWooBppzovf4cAnmETrMtTQNOaSeKbFXumADe3BgWMF4K/xiGCBHhaqhHHTjwObMaigDEvExokQo6/axov0TPCUQyK+R5Fjr9PyJ9BAS0j4DzSycj679VxtFSQxl6ntYdTw2kJJf7eCKL5QBl9nQYCHAmhQsffzeH6DAow9HiJFQDCiL9/bxfaQaFhCmgu1gySwHiZpS4FnMshKBTQPsyhYSOMEv8QBacFKIBd0XKQACMngEEenh9DAYY1e40YYRQDGMXeYD7QQwFtGeirCQi0AYwib7RUkFxf1SYBdo4MigGIs29gB4XE91kcd1uWQhuAwAQOTOi8b9Pcxm80g4wtAIHSDZYKipeQ2vs3TXgiaAEIVW6sJQF2f1lbBmh0iQlFAGJjBuYD1f9pAZ1/CVoAgllb8Smg89sMTV6UJ44waAq4EAVkdHqSKR57AQJAwzuHvIyBBK6tgEILQMKExVoSoJiXMZDAhRVgbAeYAE8sCpCg0pSl3ZuaLxHSBxMAmumlqA+0NHdQ4whjO0BCRFUoBYx9oYUE/rIC+i4HCGd7+PzUH0eO1x0EPB1r1ksBwSjg3+BT9L4+6oSArucAI/Sp3gfeBN83B03dHX5BgN+WAkKkgq3g+77S1unrBwT0bSlgufdlIdMBfM9n2ro8fUJgRQIIClJBKvg58e3dFzh86pxAQN+XAtb4QLZO/Cg9ctwC8NRVQNskgYh9SByGu/3BEED2GlX6Ghj3cf6cakcy86SngOkME3JDmjP0YeUOWpgAJmj01fCQMo9HXvyhD6x30LIEMMGl3zXEo08UcE/gP+d8bIc1zeM5fAKYUqprb6omEvkMLp/H/N/5/jnhKaW1XtAF7n0d4J92FGicAv6GgqllXVTwIy9r7YHAqwgA9bYsCr+13ewGUQhg2jZFekH0e9wgyirAtPV6rMbolHlTuwUC2ASQgk56+tTvgsCjukGE+8BVp74dAigEMHW3hr4l+AYIQBNAVoWK3xP8JgT4hQRQB4CK4N9DAKQKPHvDJtUYvtLZJgRMALO3bNP8ic+QLEvvJICJpQCqnvj3qAd+tVRw8stif/XNIAQwf8M+vyv2lzIrwASg838yKPQCF/tLzDMsNLPfjRIi37edBIFmH3EpSBgAnKv9uKFHt4Alp3blbDT4azf3IBDAAYBrAWvOa/Ed53xt+1I9u8VS9Wu3mCwHAFwLWNO5g32CyMsBAFYBis5ssw90jLuqZudZDAtYtUJB7wKAohJAWSv3cADoagRAqC82ZzKFA4CQASCoFrCudxv5KJHWAgCqBSxsV6dvAgCsAhQ27ZE3AQBVASrbdvGbAECYBFDauO9NAEAtApS27nwTAATTAtZ27nSWcpYCAKgC1LbvfhEAQBWguHGrs5anC60GgZaBi6/weBEAMBWgunPzewDAkEWA+t7tPhVfaEcIpgLU397wGgBAKgDA5Q1vAQCkAiDcW/0WACBWgQRgX63TBK4DAEAFEIST6m8BAKACXPVn+dgAeIUCEEavGmcpeBkAoCnAZfvK2W/lXA1cBQBoCiAwJ6vkHQAAUwDF6Van7wCAIinAXffi6W9F7wAAAa0EC9ThWueC/iIAYCAFUKiOtd6THYsAAEcBms3rdQPgyQrQbstG5S8kzqkFCACUJNB0d8Xc8fMGcA0AgCSBtq6Mc5FJrwAARBnQenXN1Ddzn+6lFQBwNvTTFcDemp/XBgDgtnCAJLDnEkuphaU+DwDlSWDfNbYz383N4EsAoDgJ7L7FmBfixhUAUKsAAzfZz0OnuPlnBQBIHcuyDHXb5HW4cQUAlCWBpmtrqdIG+tOjRQEgM6Jvmvxc2bYmQBwXAECBBWBj9A/i872BkyggID1aAACTLYA5+D/jXHiFkd8CrNAncGIS2BP87+n/+ZTZwABuXKFT6BQL8NlWvbO/vt4Q8ZxpFKAACwCAL641oa9+9+yP/NfdCv0Xq8j9G/Ia3LhAs2hp3nDzfb1RDxz4+yaF4Us1/hhoqqGAiF0SC9wX0BOi/12I8eP5N9I/nv+uzjicD0kbo1yhAN2/+jAATHrU8o4Vd4X0/yj+lkCGCz+xTaakQBvleQAQtPCfjnHFqnBI53T8HWEEzv5lFHBOjequBG8A3IWfu3LV6Rbwm6Ie1SqYVwj/VTikaGBINgDitf+eXKdfGSKet10IAIps/ZovqoXSaMMAPAAInfuLKEBssOX+t6atAGOmSqb6QIp5e/i1IF4k+le1gCwfyEHfAL8WJLW2j/3vmiMCGoRj+KUACVi5GQp+XzZ9Q8sEQoznH7REd4CBvRrzg39NAVJPANcYWOm2gO+NG9lAEM8Wk/OXQ3JGf+aGtA4AfgeC5gGB4wMTb6sljOAWuzn4DyD83NQTCQZJoOZwEYgray4MgL/BIPrfhqDWjiH93CnEEj5djxk+UOKczkMAcAGJkye7DiYzRCDQ7h5PBUDZWhjli0BubURfDgCvCeYEb2kgAO060ZJngjYALnwgJRMAfww1MjjWywLT7ZQkgCp0Yt3gK4IG3gWAjMWw5Iuk9P6Ps24A+ABAOSGKEoH25kN2ScG7koCcPJgz7bVp76EDAxsAARwoef7avPt41A5sAESIoKbJa8/m4yEM6MsAICkTlbNmV+/xg34MyMsAkLQpMutKUeqPWScGeAMgRAUpZX4N7jvtwcDbAJCzHHbdW5bjYWX6k9a84G0eMMcFStIA+zaef26o2gCw2GrvcpAmueyAoydNMXgfAML3hEiazdaQiN2LgbwOAMEu0FCK5zoC+PmXromANwBcAJBEn0WhinLhCN4HgEgXyJlOO+Hc0QkINgAco6Cp5VbKKdz+HwTv84BxLjD5VilNPHPyubv+vQCIMQGd+zA44C1jPfunMaTXLQVdDS0H0EgsAuacO+UXWoAIEzCw/YIiAPbKcE0BQBe1ju3C6yPbXbWb6wJ7hnZ0E6a6f2MTAIALNLA/uVOBWYeOtwb0Ti5L+PnDjYBZbQc2ADrX2MlG9OxMBeY1HnnpM3YBt8n7yW2SSDacbQcIaAJM4f/VjkU8ySBtB4hXCtLOgq+OpwKyHSCcCTAVfv7fjYlGEXBhIHbQkgGgzvD/2VyaR9eFaDtArFKQreyr1pnciqVsB1jkAtkRfmJzKBsImNBvZD92E2Bc9JFO48hbAAABIKPhv75boB8BWwBgTID5ZI10G7rrgtAWABQTYF7xlZGU7nJO0y4BQJgAc/h14IKWGwRsAYCoBJjDb6nsS8fuAN5ndwBMgNjv5hn9oSsEbAGoNQFHT/jt81KtCNDtAKsTQXtbhZ4Le40I2AJQDoAjI/x3P6VbAKBMQKD360fAFgAAExDo/Yy/JQ08bgEA0wCSYLTJ7X+wBQALADQ8IaWBANoCgG8CSFJ+Ta4NwBYAIBNAkoU32QKArwEkiYxzUX3aawDJj84M/0f/mcJtAEA0gGQ64rYATAEATQ1/JwK2AECYAIo14roFYKlEkLgAczsDRDEByjWsswUAQQNIefpv7oNgMIkgSQnqtgHA0ABKFWBD8rEzwEoN0Ozp10TANgB1GkAygX1bCNgCUKUBOmno7xGwM8CJAKAJvr8TAdsAlJgA5TLkbQNQ+Mg85TciYBuA2SaAtGTMeXcCwMgDykb8FAHbALy7CrENwLsRsOP/cgRsA/g+C7IN4EbANoAbAdsAbATs+L/2kW0ANwK2AXz1w4+L/z8CDADebzi4XHs84QAAAABJRU5ErkJggg==";var Dk=x8;class of extends Ge{constructor(...e){super(...e);this._applyWatermarkFilter=()=>(this._watermarkFilter||(this._watermarkFilter=new Ek({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),ce.resolve());this._loadWatermarkImage=()=>this._watermarkImage?ce.resolve():new ce((e,t)=>{this._watermarkImage=new vi,this._watermarkImage.onload=e,this._watermarkImage.src=Dk});this._watermarkFilter=null,this._watermarkImage=null}_render(e){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}}of.identifier="license-watermark";of.prototype.availableOptions={};ue.Operations.LicenseWatermarkOperation=of;var Ik=of;var Ok=`/*!
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_controlPoint1;
uniform vec2 u_controlPoint2;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 vector = u_controlPoint2 - u_controlPoint1;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    float radius = smoothstep(0.0, 1.0,
      abs(
        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)
      )
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
      float percent = (t + offset - 0.5) / 30.0;
      float weight = 1.0 - abs(percent);
      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

      color += _sample * weight;
      total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:Gn}=H;class Rk extends A.Filter{constructor(...e){super(...e);this._fragmentSource=Ok,this._lastBlurRadius=null,this._lastControlPoint1=new Gn,this._lastControlPoint2=new Gn,this._blurFilter=new dr,this._blurredRenderTarget=new A.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new A.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),n=!i.getDimensions().equals(o),s=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(s){let a=new Gn(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(a);const l={blurRadius:this._options.blurRadius,texSize:o},d=(b,_,g)=>Math.min(Math.max(b,_),g),c=(b,_,g)=>{let S=d((g-b)/(_-b),0,1);return S*S*(3-2*S)};let p=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone());const h=this._options.blurRadius,m=(b,_)=>c(0,1,Math.abs(d(new Gn(b,_).subtract(this._options.controlPoint1).dot(p)/p.dot(p),0,1)))*h;this._blurFilter.set(l),this._blurFilter._applyCanvas(e,t,i,r,m),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const s=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;s&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new Gn(e.width,e.height),r=this._options.controlPoint1.clone().multiply(i),o=this._options.controlPoint2.clone().multiply(i),n=t.createLinearGradient(r.x,r.y,o.x,o.y);n.addColorStop(0,"#FFFFFF"),n.addColorStop(1,"#000000"),t.fillStyle=n,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),s=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,d=n.getImageData(0,0,r.width,r.height).data,c=s.getImageData(0,0,r.width,r.height).data;let p;for(let h=0;h<r.width*r.height*4;h+=4)p=c[h]/255,l[h]=p*l[h]+(1-p)*d[h],l[h+1]=p*l[h+1]+(1-p)*d[h+1],l[h+2]=p*l[h+2]+(1-p)*d[h+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}Rk.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:30,uniformType:z.FLOAT},controlPoint1:{type:f.VECTOR2,default:new Gn(0,.5),uniformType:z.FLOAT2},controlPoint2:{type:f.VECTOR2,default:new Gn(1,.5),uniformType:z.FLOAT2},delta:{type:f.VECTOR2,default:new Gn(1,1),uniformType:z.FLOAT2},texSize:{type:f.VECTOR2,default:new Gn(100,100),uniformType:z.FLOAT2}};var nf=Rk;const{Vector2:sf}=H;class af extends Ge{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();const t={blurQuality:{type:f.STRING}};this._horizontalFilter=new nf({},t),this._verticalFilter=new nf({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new sf(.5,.5)),this._verticalFilter.setDelta(new sf(-.5,.5)),this._filter=new nf({},t)}rotate(e){const t=this._options.controlPoint1,i=this._options.controlPoint2;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({controlPoint1:t,controlPoint2:i})}flip(e){const t=this._options.controlPoint1,i=this._options.controlPoint2;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({controlPoint1:t,controlPoint2:i})}transform(e){const t={};["controlPoint1","controlPoint2"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{blurRadius:r,controlPoint1:o,controlPoint2:n}=this._options,s={blurRadius:r*i,controlPoint1:o.clone(),controlPoint2:n.clone(),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(s),this._verticalFilter.set(s),this._renderTexture.render(this._container),ce.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions(),{blurRadius:i,controlPoint1:r,controlPoint2:o}=this._options;return this._filter.set({blurRadius:i,controlPoint1:r.clone(),controlPoint2:o.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),ce.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}af.identifier="linear-focus";af.prototype.availableOptions={controlPoint1:{type:f.VECTOR2,default:new sf(0,.5)},controlPoint2:{type:f.VECTOR2,default:new sf(1,.5)},blurRadius:{type:f.NUMBER,default:.025},highQualityCanvasBlur:{type:f.BOOLEAN,default:!1}};ue.Operations.LinearFocusOperation=af;var Ak=af;var Fk=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform float u_gradientSize;
uniform float u_size;
uniform vec2 u_start;
uniform vec2 u_end;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));
    float radius = smoothstep(0.0, 1.0,
      (abs(
        dot(v_texCoord * u_texSize - u_start, normal)
      ) - u_size) / u_gradientSize
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:jn}=H;class Pk extends A.Filter{constructor(...e){super(...e);this._fragmentSource=Fk,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new jn,this._lastEnd=new jn,this._blurFilter=new dr,this._blurredRenderTarget=new A.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new A.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),n=!i.getDimensions().equals(o),s=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(s){let a=new jn(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(a);const l={blurRadius:this._options.blurRadius,texSize:o},d=(C,R,T)=>Math.min(Math.max(C,R),T),c=(C,R,T)=>{let k=d((T-C)/(R-C),0,1);return k*k*(3-2*k)},{blurRadius:p,gradientSize:h,size:m,start:b,end:_,texSize:g}=this._options,S=new jn(b.y-_.y,_.x-b.x);S.divide(S.len());const x=(C,R)=>c(0,1,(Math.abs(g.clone().multiply(C,R).subtract(b).dot(S))-m)/h)*p;this._blurFilter.set(l),this._blurFilter._applyCanvas(e,t,i,r,x),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const s=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;s&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=this._maskRenderTarget.getPixelRatio(),r=new jn(e.width,e.height),o=this._options.size*r.min()*i,n=this._options.gradientSize*r.min()*i,s=this._options.start.clone().multiply(r),a=this._options.end.clone().multiply(r),l=a.clone().subtract(s),d=s.clone().add(l.clone().divide(2)),c=l.len(),p=l.clone().divide(c),h=d.clone().add((o+n)*p.y,-(o+n)*p.x),m=d.clone().add(-(o+n)*p.y,(o+n)*p.x),b=t.createLinearGradient(h.x,h.y,m.x,m.y),_=m.clone().subtract(h).len();b.addColorStop(0,"#000000"),b.addColorStop(n/2/_,"#FFFFFF"),b.addColorStop(1-n/2/_,"#FFFFFF"),b.addColorStop(1,"#000000"),t.fillStyle=b,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),s=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,d=n.getImageData(0,0,r.width,r.height).data,c=s.getImageData(0,0,r.width,r.height).data;let p;for(let h=0;h<r.width*r.height*4;h+=4)p=c[h]/255,l[h]=p*l[h]+(1-p)*d[h],l[h+1]=p*l[h+1]+(1-p)*d[h+1],l[h+2]=p*l[h+2]+(1-p)*d[h+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}}Pk.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:30,uniformType:z.FLOAT},size:{type:f.NUMBER,default:50,uniformType:z.FLOAT},gradientSize:{type:f.NUMBER,default:50,uniformType:z.FLOAT},start:{type:f.VECTOR2,default:new jn(0,.5),uniformType:z.FLOAT2},end:{type:f.VECTOR2,default:new jn(1,.5),uniformType:z.FLOAT2},delta:{type:f.VECTOR2,default:new jn(1,1),uniformType:z.FLOAT2},texSize:{type:f.VECTOR2,default:new jn(100,100),uniformType:z.FLOAT2}};var lf=Pk;const{Vector2:df}=H;class cf extends Ge{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;const t={blurQuality:{type:f.STRING}};this._horizontalFilter=new lf({},t),this._verticalFilter=new lf({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new df(.5,.5)),this._verticalFilter.setDelta(new df(-.5,.5)),this._filter=new lf({},t),this._renderBlur.bind(this)}rotate(e){const t=this._options.start,i=this._options.end;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({start:t,end:i})}flip(e){const t=this._options.start,i=this._options.end;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({start:t,end:i})}transform(e){const t={};["start","end"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius","size","gradientSize"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),r=this._options.start.clone(),o=this._options.end.clone(),{blurRadius:n,size:s,gradientSize:a}=this._options,l={blurRadius:n*i,size:s*i,gradientSize:a*i,start:r.clone().multiply(t),end:o.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),ce.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions(),{blurRadius:i,size:r,gradientSize:o,start:n,end:s}=this._options;return this._filter.set({blurRadius:i,gradientSize:o,size:r,start:n.clone(),end:s.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),ce.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}cf.identifier="mirrored-focus";cf.prototype.availableOptions={start:{type:f.VECTOR2,default:new df(0,.5)},end:{type:f.VECTOR2,default:new df(1,.5)},blurRadius:{type:f.NUMBER,default:.025},size:{type:f.NUMBER,default:.1},gradientSize:{type:f.NUMBER,default:.1},highQualityCanvasBlur:{type:f.BOOLEAN,default:!1}};ue.Operations.MirroredFocusOperation=cf;var Bk=cf;const{Vector2:w8}=H;class hf extends Ge{_render(e){const t=this._options.rotation%360,i=t*(Math.PI/180),r=t===90||t===270,o=this._options.flipHorizontally!==this._options.flipVertically,n=r&&o?!this._options.flipVertically:this._options.flipVertically,s=r&&o?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(s?-1:1,n?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const a=this._sprite.getBounds();return this._renderTexture.resizeTo(new w8(a.width,a.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),ce.resolve()}getNewDimensions(e){return e=e.clone(),this._options.rotation%180&&e.flip(),e}flip(e){const{rotation:t}=this._options;(t===90||t===270)&&(e==="vertical"?e="horizontal":e="vertical");switch(e){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}}hf.identifier="orientation";hf.prototype.availableOptions={rotation:{type:f.NUMBER,default:0,validation:function(e){if(e%90!==0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:e=>(e+360)%360},flipVertically:{type:f.BOOLEAN,default:!1},flipHorizontally:{type:f.BOOLEAN,default:!1}};ue.Operations.OrientationOperation=hf;var Mk=hf;const{OverlayFilter:pf}=A.Filters,{Vector2:Lk}=H,C8=4;class tp extends Ge{constructor(...e){super(...e);this._overlayTexture=A.Texture.fromImage(this._options.image),this._overlayContainer=new A.Container,this._overlaySprite=new A.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new A.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new A.Sprite,this._renderedOverlayContainer=new A.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new Lk(0,0)}setOption(e,t){if(super.setOption(e,t),e==="image"&&t&&this._sdk){const i=this._sdk.getRenderer(),r=this._overlayTexture.getBaseTexture();r.setSource(t),i.isOfType(Ee.WEBGL)&&i.updateTexture(r),this._overlayRendered=!1}}_render(e){const t=e.getDimensions(),{image:i,alpha:r,blendMode:o}=this._options;return i?((!this._overlayRendered||!this._lastInputDimensions.equals(t))&&(this._renderOverlayToRenderTexture(e),this._overlayRendered=!0,this._lastInputDimensions.copy(t)),this._overlayFilter.set({blendMode:o,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:r}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),ce.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),ce.resolve())}_renderOverlayToRenderTexture(e){const t=this._sdk.getRenderer(),i=e.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new A.RenderTexture(t,i.x,i.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));const{width:r,height:o}=this._options.image,n=F.resizeVectorToFill(new Lk(r,o),i),{flipHorizontally:s,flipVertically:a}=this._options,l=s?-1:1,d=a?-1:1;this._overlaySprite.setWidth(n.x*l),this._overlaySprite.setHeight(n.y*d),this._overlaySprite.setPosition(i.x*(1-l)*.5,i.y*(1-d)*.5);const c=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i),t.isOfType(Ee.WEBGL)&&(c.setGLUnit(C8),t.updateTexture(c,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}}tp.identifier="overlay";tp.BLEND_MODES=pf.BLEND_MODES;tp.prototype.availableOptions={identifier:{type:f.STRING},image:{type:f.IMAGE},blendMode:{type:f.NUMBER,default:pf.BLEND_MODES.MULTIPLY,available:Object.keys(pf.BLEND_MODES).map(e=>pf.BLEND_MODES[e])},alpha:{type:f.NUMBER,default:1},flipHorizontally:{type:f.BOOLEAN,default:!1},flipVertically:{type:f.BOOLEAN,default:!1}};ue.Operations.OverlayOperation=tp;var zk=tp;var Nk=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_radius;
uniform float u_blurRadius;
uniform float u_gradientRadius;
uniform vec2 u_position;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

const float blurSteps = 30.0;
const float EPSILON = 0.000000001;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 coord = v_texCoord * u_texSize;
    vec2 diff = coord - u_position;
    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);

    float blurPercentage = smoothstep( 
      0.0, 1.0,
      (abs(dist) - u_radius) / u_gradientRadius
    );

    float radius = blurPercentage * u_blurRadius;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    for (float t = -blurSteps; t <= blurSteps; t++) {
        float percent = (t + offset - 0.5) / blurSteps;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / max(total, EPSILON);
}
`;const{Vector2:sc}=H;class Uk extends A.Filter{constructor(...e){super(...e);this._fragmentSource=Nk,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new sc,this._blurFilter=new dr,this._blurredRenderTarget=new A.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new A.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),n=!i.getDimensions().equals(o),{blurRadius:s,position:a,texSize:l,gradientRadius:d}=this._options,c=t.getBaseTexture().isDirty()||this._lastBlurRadius!==s||n;if(c){let p=new sc(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(p);const h={blurRadius:s,texSize:o},m=(g,S,x)=>Math.min(Math.max(g,S),x),b=(g,S,x)=>{let C=m((x-g)/(S-g),0,1);return C*C*(3-2*C)},_=(g,S)=>b(0,1,(Math.abs(l.clone().multiply(g,S).subtract(a).len())-this._options.radius)/(d*2))*s;this._blurFilter.set(h),this._blurFilter._applyCanvas(e,t,i,r,_),this._lastBlurRadius=s}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const s=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;s&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new sc(e.width,e.height),r=this._maskRenderTarget.getPixelRatio(),o=this._options.position.clone().multiply(i);let{radius:n,gradientRadius:s}=this._options;n*=e.height,s*=e.height;const a=t.createRadialGradient(o.x,o.y,0,o.x,o.y,(n+s)*r);a.addColorStop(0,"#FFFFFF"),a.addColorStop(n/(n+s),"#FFFFFF"),a.addColorStop(1,"#000000"),t.fillStyle=a,t.fillRect(0,0,i.x,i.y)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),n=this._blurredRenderTarget.getContext(),s=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,d=n.getImageData(0,0,r.width,r.height).data,c=s.getImageData(0,0,r.width,r.height).data;let p;for(let h=0;h<r.width*r.height*4;h+=4)p=c[h]/255,l[h]=p*l[h]+(1-p)*d[h],l[h+1]=p*l[h+1]+(1-p)*d[h+1],l[h+2]=p*l[h+2]+(1-p)*d[h+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}Uk.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:30,uniformType:z.FLOAT},radius:{type:f.NUMBER,default:50,uniformType:z.FLOAT},gradientRadius:{type:f.NUMBER,default:25,uniformType:z.FLOAT},position:{type:f.VECTOR2,default:new sc(.5,.5),uniformType:z.FLOAT2},delta:{type:f.VECTOR2,default:new sc(1,1),uniformType:z.FLOAT2},texSize:{type:f.VECTOR2,default:new sc(100,100),uniformType:z.FLOAT2}};var uf=Uk;const{Vector2:Wv}=H;class mf extends Ge{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;const t={blurQuality:{type:f.STRING}};this._horizontalFilter=new uf({},t),this._verticalFilter=new uf({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Wv(.5,.5)),this._verticalFilter.setDelta(new Wv(-.5,.5)),this._filter=new uf({},t)}rotate(e){const t=this._options.position;e===90?(t.flip(),t.x=1-t.x):e===-90&&(t.flip(),t.y=1-t.y),this.set({position:t})}flip(e){const t=this._options.position;switch(e){case"horizontal":t.x=1-t.x;break;case"vertical":t.y=1-t.y;break}this.set({position:t})}transform(e){const t={},i=this.getPosition();t.position=e.applyToRelativePoint(i),["radius","blurRadius","gradientRadius"].forEach(r=>{const o=this.getOption(r);t[r]=e.applyToRelativeSize(o)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{position:r,blurRadius:o,radius:n,gradientRadius:s}=this._options,a={blurRadius:o*i,radius:n*i,gradientRadius:s*i,position:r.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),ce.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t,radius:i,gradientRadius:r,position:o}=this._options,n=e.getDimensions();return this._filter.set({blurRadius:t,radius:i,gradientRadius:r,position:o,texSize:n,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),ce.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}mf.identifier="radial-focus";mf.prototype.availableOptions={position:{type:f.VECTOR2,default:new Wv(.5,.5)},radius:{type:f.NUMBER,default:.25},gradientRadius:{type:f.NUMBER,default:.125},blurRadius:{type:f.NUMBER,default:.025},highQualityCanvasBlur:{type:f.BOOLEAN,default:!1}};ue.Operations.RadialFocusOperation=mf;var Hk=mf;const{Vector2:S8,CubicBezierCurve:T8}=H;class k8{constructor(e,t,i=3){this._path=e,this._drawnCanvases=[],this._position=t,this._smooth=i}getBezierCurve(e,t,i,r){if(!t)return null;let o,n;r?(o=(r.x-t.x)/this._smooth,n=(r.y-t.y)/this._smooth):(o=(i.x-t.x)/this._smooth,n=(i.y-t.y)/this._smooth);let s,a;e?(s=(i.x-e.x)/this._smooth,a=(i.y-e.y)/this._smooth):(s=(i.x-t.x)/this._smooth,a=(i.y-t.y)/this._smooth);const l=t.clone().add(s,a),d=i.clone().subtract(o,n);return new T8(t,l,d,i)}renderToCanvas(e,t,i,r,o,n=1){if(this._drawnCanvases.indexOf(t)!==-1)return;const s=new S8(t.width,t.height),a=t.getContext("2d"),l=this._position.clone().multiply(s),d=r?r.getPosition().clone().multiply(s):null,c=i?i.getPosition().clone().multiply(s):null,p=o?o.getPosition().clone().multiply(s):null,h=l.clone().subtract(d).len(),m=e.width/10;let b=this.getBezierCurve(c,d,l,p),_;if(!b)_=[l];else{b.calculateSegments(20);let g=b.getLength();_=b.arcLengthApproxSample(Math.ceil(g/m))}for(let g=0;g<_.length;g++){let S=_[g],x=e.width*.5/(m*2);x*=1-n,x=1/(1+x),a.globalAlpha=x,a.drawImage(e,S.x-e.width/2,S.y-e.height/2,e.width,e.height)}a.globalAlpha=1,this._drawnCanvases.push(t)}setPosition(e){this._position=e}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}}var Gk=k8;class jk extends _e{constructor(e,t,i){super(t);this._operation=e,this._canvas=i||F.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(e,t=!1){return e==="controlPoints"?this._options.controlPoints.map(i=>{const r=i.getPosition();return t?r.toObject():r.clone()}):super.serializeOption(e,t)}_optionEquals(e,t){if(e==="controlPoints"){const i=this._options.controlPoints;for(let r=0,o=i.length;r<o;r++)if(!i[r].getPosition().equals(t[r]))return!1;return!0}return super._optionEquals(e,t)}render(e){const{controlPoints:t,size:i}=this._options;if(t.length<2)return;const r=this.getBrush(),o=r&&r.getHardness?r.getHardness():1;F.ensureCanvasDimensions(this._canvas,e),(!this._brush||this._lastBrushSize!==i||!e.equals(this._brushInputDimensions))&&(this._brushInputDimensions=e.clone(),this._lastBrushSize=i);let n,s,a,l;for(let d=0;d<t.length;d++)n=t[d-2],s=t[d-1],a=t[d],l=t[d+1],a.renderToCanvas(this._options.brush.getBrushImage(e),this._canvas,n,s,l,o)}_createBrush(e){let{size:t,hardness:i,color:r}=this._options;const o=F.createCanvas();o.width=o.height=Math.ceil(t*e.min());const n=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{const s=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);s.addColorStop(0,r.toRGBA());const a=r.clone();a.a=0,s.addColorStop(1,a.toRGBA()),n.fillStyle=s,n.fillRect(0,0,o.width,o.height)}return o}addControlPoint(e){const t=new Gk(this,e);this._options.controlPoints.push(t),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(e){this._canvas=e,this._context=e.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach(e=>{e.setDirty()})}forEachControlPoint(e){this._options.controlPoints.forEach(e)}renderToCanvas(e){const t=e.getContext("2d");t.save(),t.globalAlpha=this._options.brush.getColor().a,t.drawImage(this._canvas,0,0),t.restore()}getCanvasDimensions(){return this._canvasDimensions}}jk.prototype.availableOptions={id:{type:f.STRING,default:()=>F.getUUID()},brush:{type:f.OBJECT,required:!0},controlPoints:{type:f.ARRAY,default:[]},closed:{type:f.BOOLEAN,default:!1}};var ip=jk;const{Vector2:ff}=H;class E8 extends _e{constructor(e,t){super(t);this._isDisposed=!1,this._operation=e,this._dirtiness={},this.id=F.getUUID(),this._renderTextures={},this._identitySprite=new A.Sprite,this._sprite=new A.Sprite,this._hitTestSprite=new A.Sprite,this._renderers=[]}applyScale(e){}applyRotation(e){const t=this._operation.getInputDimensions();let i=this.getRotation()*180/Math.PI;i+=e,this.setRotation(i*Math.PI/180);const r=(e+360)%360,o=r*Math.PI/180,n=Math.cos(o),s=Math.sin(o),a=this._options.position.clone().subtract(.5).multiply(t),l=new ff(a.x*n-a.y*s,a.x*s+a.y*n).divide(t.clone().flip());this.setPosition(new ff(.5,.5).add(l))}applyFlip(e){const t=this.getPosition().clone();switch(e){case"horizontal":t.x=1-this._options.position.x;break;case"vertical":t.y=1-this._options.position.y;break}this.setPosition(t)}applyTransform(e){const t={};t.rotation=e.applyToRotation(this.getRotation()),t.position=e.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(t.dimensions=e.applyToDimensions(this.getDimensions())),this.set(t,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(e){if(this._renderTexture)this._renderTexture.clear();else{const t=this._getTexture();this._renderTextureContainer=new A.Container,this._renderTextureSprite=new A.Sprite(t),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(e.getRenderer(),t.getDimensions())}}_rendersToRenderTexture(e){return e.getOptions().smoothDownscaling&&e.getRenderer().isOfType(Ee.WEBGL)}_optionEquals(e,t){return e==="type"?!0:super._optionEquals(e,t)}update(e,t){if(this._isDisposed)return;this._rendersToRenderTexture(e)&&(this._prepareRenderTexture(e),this._renderToRenderTexture(e)),this._updateSprite(t)}_updateSprite(e){const t=[this._sprite,this._hitTestSprite];t.forEach(i=>{if(!i.getTexture())return;i.setAnchor(this._options.anchor),i.setPosition(this._options.position.clone().multiply(e)),typeof this._options.alpha!="undefined"&&i.setAlpha(this._options.alpha);let{dimensions:r}=this._options;r&&(r=r.clone().multiply(this._operation.getSDK().getTextureScale()),i.setWidth(r.x),i.setHeight(r.y)),i.updateTransform();const o=i.getTexture().getFrame(),n=new ff(o.width,o.height);i.setPivot(this._options.pivot.clone().multiply(n)),i.setRotation(this._options.rotation),i.updateTransform()})}_renderToRenderTexture(e){const t=this._getTexture().getDimensions(),i=this._getRenderTexture(e.getRenderer(),t),r=t.clone();if(this._options.smoothDownscaling&&(r.x=F.nextHighestPOT(r.x),r.y=F.nextHighestPOT(r.y)),this._renderTexture.resizeTo(r),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){const o=r.clone().subtract(t.x,t.y).divide(r),n=i.getUVs().getUVs();n[0].x=n[3].x=0,n[1].x=n[2].x=1-o.x,n[0].y=n[1].y=0,n[2].y=n[3].y=1-o.y}this._sprite.setTexture(i)}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._renderers[t.id]=t,this._dirtiness[t.id]=e}setDirty(e){for(let t in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[t])}_getRenderTexture(e,t=new ff(100,100)){return this._renderTextures[e.id]||(this._renderTextures[e.id]=new A.RenderTexture(e,t.x,t.y,1)),this._renderTextures[e.id]}dispose(){this._isDisposed=!0;for(let e in this._renderTextures)this._renderTextures[e].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}}var ln=E8;const{Vector2:D8}=H;class cl extends _e{constructor(...e){super(...e);this._lastOptions={},this._lastInputDimensions=new D8(0,0),this._brush=null}getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;const{image:t,size:i}=this._options;t.width=t.height=Math.ceil(i*e.min());const r=F.createCanvas();r.width=t.width,r.height=t.height;const o=r.getContext("2d");o.drawImage(t,0,0,r.width,r.height);const n=this._tintImageData(o.getImageData(0,0,r.width,r.height),r.width,r.height);return o.putImageData(n,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=r,this._lastInputDimensions=e.clone(),r}_tintImageData(e){const{color:t}=this._options;for(let i=0;i<e.data.length;i+=4)e.data[i]+=(t.r*255-e.data[i])*t.a,e.data[i+1]+=(t.g*255-e.data[i+1])*t.a,e.data[i+2]+=(t.b*255-e.data[i+2])*t.a;return e}clone(){const e=this.constructor;return new e(this._options)}}cl.prototype.availableOptions={identifier:{type:f.STRING},image:{type:f.IMAGE},size:{type:f.NUMBER,default:.05},color:{type:f.COLOR,default:N.RED}};class ac extends cl{getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{size:t,hardness:i,color:r}=this._options;const o=F.createCanvas();o.width=o.height=Math.ceil(t*e.min());const n=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)n.fillStyle=r.toRGBA(),n.fillRect(0,0,1,1);else{const s=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);s.addColorStop(0,r.toRGBA());const a=r.clone();a.a=0,s.addColorStop(1,a.toRGBA()),n.fillStyle=s,n.fillRect(0,0,o.width,o.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=o,this._lastInputDimensions=e.clone(),o}}ac.identifier="imgly_brush_radial";ac.prototype.availableOptions=F.extend(cl.prototype.availableOptions,{hardness:{type:f.NUMBER,default:1}});const{Vector2:gf}=H;class lc extends ln{constructor(...e){super(...e);this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=F.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=F.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=F.createCanvas(),this._texture=A.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();switch(e){case"horizontal":r.x=1-r.x;break;case"vertical":r.y=1-r.y;break}i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyRotation(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();e===90?(r.flip(),r.x=1-r.x):e===-90&&(r.flip(),r.y=1-r.y),i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyTransform(e){let t=null;this._options.paths.forEach(i=>{i.forEachControlPoint(o=>{o.setPosition(e.applyToRelativePoint(o.getPosition()))});const r=i.getBrush();r!==t&&(r.setSize(e.applyToRelativeSize(r.getSize())),t=r),i.setDirty(!0)}),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;const{width:e,height:t}=this._outputCanvas;this._outputContext.clearRect(0,0,e,t)}clearPersistCanvas(){if(!this._persistCanvas)return;const{width:e,height:t}=this._persistCanvas;this._persistContext.clearRect(0,0,e,t)}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="brush"),i}serializeOption(e,t=!1){return e==="paths"?this._options.paths.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createPath(e){const t=new ip(this._operation,{brush:e},this._nextCanvas);return t.on("update",this._onPathUpdate),this._options.paths.push(t),this.setDirty(!0),t}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(e){e.renderToCanvas(this._persistCanvas),this._nextCanvas=e.getCanvas();const t=this._nextCanvas.getContext("2d");t.clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(e)}_getTexture(){return this._texture}setDirtyForRenderer(e,t,i=!1){super.setDirtyForRenderer(e,t,i),e&&i&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach(r=>{r.setDirty(!0)}))}setDirty(e,t=!1){for(let i in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[i],t)}render(e){const t=this._operation.getSDK().getRenderer();if(!this.isDirtyForRenderer(t))return;F.ensureCanvasDimensions(this._outputCanvas,e),F.ensureCanvasDimensions(this._persistCanvas,e),this._options.paths.forEach(i=>{i.render(e),i.getClosed()&&this._persistedPaths.indexOf(i)===-1&&this._onPathPersist(i)}),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach(i=>{i.getClosed()||i.renderToCanvas(this._outputCanvas)}),this.setDirtyForRenderer(!1,t)}update(e,t){t&&(F.ensureCanvasDimensions(this._outputCanvas,t),F.ensureCanvasDimensions(this._persistCanvas,t),this._texture.getBaseTexture().update()),this.render(t);const i=e.getRenderer();i.isOfType(Ee.WEBGL)&&i.updateTexture(this._texture.getBaseTexture()),super.update(e,t)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new ac}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}}lc.prototype.availableOptions={id:{type:f.STRING,default:()=>F.getUUID()},position:{type:f.VECTOR2,default:new gf(0,0)},scale:{type:f.VECTOR2,default:new gf(1,1)},anchor:{type:f.VECTOR2,default:new gf(0,0)},pivot:{type:f.VECTOR2,default:new gf(0,0)},rotation:{type:f.NUMBER,default:0},paths:{type:f.ARRAY,default:[],setter:function(e){return e=e.map(t=>{if(t instanceof ip)return t;const{brush:i,closed:r}=t,o=new ip(this._operation,{brush:i,closed:r},this._nextCanvas);return t.controlPoints.forEach(n=>{o.addControlPoint(n)}),o}),this._reset(),e}}};lc.type="brush";lc.Brush=cl;lc.Path=ip;lc.Brushes={RadialBrush:ac};var hl=lc;var Wk=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filterImage;
uniform sampler2D u_maskImage;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filterImage, v_texCoord);
  vec4 mask = texture2D(u_maskImage, v_texCoord);
  gl_FragColor = mix(color0, color1, mask);
}
`;class Vk extends A.Filter{constructor(){super();this._fragmentSource=Wk}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),n=t.getContext(),s=i.getContext(),{maskCanvas:a,filterCanvas:l}=this._options,d=a.getContext("2d"),c=l.getContext("2d"),p=d.getImageData(0,0,o.width,o.height).data,h=n.getImageData(0,0,o.width,o.height),m=h.data,b=c.getImageData(0,0,o.width,o.height).data;let _;for(let g=0;g<o.width*o.height*4;g+=4)_=p[g]/255,m[g]=_*b[g]+(1-_)*m[g],m[g+1]=_*b[g+1]+(1-_)*m[g+1],m[g+2]=_*b[g+2]+(1-_)*m[g+2];s.putImageData(h,0,0)}}Vk.prototype.availableOptions={maskImage:{type:f.NUMBER,default:1,uniformType:z.INT},maskCanvas:{type:f.OBJECT,default:null},filterImage:{type:f.NUMBER,default:2,uniformType:z.INT},filterCanvas:{type:f.OBJECT,default:null}};var Kk=Vk;const{Vector2:$k}=H;class bf extends Ge{constructor(...e){super(...e);const t=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new A.RenderTexture(t,100,100,1),this._maskRenderTexture=new A.RenderTexture(t,100,100,1),this._brushSprite=new hl(this),this._brushSpriteContainer=new A.Container;const i=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(i),this._outputSprite=new A.Sprite,this._outputContainer=new A.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new Kk,t.isOfType(Ee.WEBGL)){this._horizontalFilter=new dr,this._verticalFilter=new dr,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new $k(1,1)),this._verticalFilter.setDelta(new $k(-1,1));let r=this._maskRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getMaskImage()),t.updateTexture(r,!1),r=this._blurredRenderTexture.getBaseTexture(),r.setGLUnit(this._maskFilter.getFilterImage()),t.updateTexture(r,!1)}else t.isOfType(Ee.CANVAS)&&(this._blurFilter=new dr,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(e){this._brushSprite.applyFlip(e),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(e){this._brushSprite.applyRotation(e),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(e,t){this._brushSprite.applyTransform(e,t),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(e){return this._renderBlur(e),this._renderMask(e),this._outputSprite.setTexture(e),this._renderTexture.render(this._outputContainer),ce.resolve()}_renderMask(e){const t=e.getDimensions(),i=this._maskRenderTexture.getDimensions();i.equals(t)||this._maskRenderTexture.resizeTo(t),this._brushSprite.update(this._sdk,t),this._maskRenderTexture.clear(N.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);const r=this._sdk.getRenderer();r.isOfType(Ee.WEBGL)&&r.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(e){const t=e.getDimensions(),i=this._blurredRenderTexture.getDimensions();i.equals(t)||this._blurredRenderTexture.resizeTo(t);const{blurRadius:r}=this._options;if(this._lastBlurRadius!==r||!i.equals(t)){const n=this._sdk.getRenderer();let s;if(n.isOfType(Ee.WEBGL)){const a=t.min();s={blurRadius:r*a,texSize:t},this._horizontalFilter.set(s),this._verticalFilter.set(s)}else n.isOfType(Ee.CANVAS)&&(s={blurRadius:r},this._blurFilter.set(s));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=r}const o=this._sdk.getRenderer();o.isOfType(Ee.WEBGL)&&o.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(e,t=1){const i=new hl.Brushes.RadialBrush({size:e,hardness:t,color:N.WHITE}),r=this._brushSprite.createPath(i);return this._options.paths.push(r),this.setDirty(!0),r}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._brushSprite.setDirtyForRenderer(e,t,i)}dispose(){super.dispose();const e=this._sdk.getRenderer();e.isOfType(Ee.WEBGL)?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}}bf.identifier="selective-blur";bf.prototype.availableOptions={blurRadius:{type:f.NUMBER,default:.05},paths:{type:f.ARRAY,default:[],setter:function(e){return this._brushSprite&&this._brushSprite.setPaths(e),e}}};ue.Operations.SelectiveBlurOperation=bf;var qk=bf;const{Vector2:pl,ColorMatrix:yf}=H;class Vv extends ln{constructor(...e){super(...e);const{image:t}=this._options,i=t.src||t.filePath||t.toDataUrl&&t.toDataURL();this._isSVG=i&&!!i.match(/\w+\.svg(?=\?|$)/i),this._isSVG&&(this._canvas=F.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),t&&this._onImageUpdate(),this._tintFilter=new A.Filters.TintFilter,this._adjustmentsFilter=new Gm,this._lastRenderedDimensions=pl.NULL,this._lastRenderedInputDimensions=pl.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(e){this.setDimensions(this.getDimensions().multiply(e))}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="sticker"),i}_rendersToRenderTexture(e){const t=this._options.smoothDownscaling&&!this._isSVG&&e.getRenderer().isOfType(Ee.WEBGL);return t||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(e,t){const{dimensions:i,image:r}=this._options;i.equals(pl.NULL)&&i.set(r.width,r.height),this._sprite.setSmoothDownscaling(this._isSVG?!1:this.getSmoothDownscaling());const o=!this._lastRenderedInputDimensions.equals(t)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==r;if(o&&this._isSVG&&e.getRenderer().isOfType(Ee.WEBGL)){r.width=Math.round(i.x),r.height=Math.round(i.y);const s=4096,a=r.width/r.height;r.width>s&&(r.width=s,r.height=Math.round(r.width/a)),r.height>s&&(r.height=s,r.width=Math.round(r.height*a)),this._canvas.width=r.width,this._canvas.height=r.height,this._context.clearRect(0,0,r.width,r.height),this._context.drawImage(r,0,0,r.width,r.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(e)&&this._prepareRenderTexture(e);const n=[];if(this._rendersToRenderTexture(e)){if(this._hasAdjustments()){n.push(this._adjustmentsFilter);const s=this._options.adjustments,a=new yf;a.multiply(yf.createBrightnessMatrix(s.getBrightness())),a.multiply(yf.createSaturationMatrix(s.getSaturation())),a.multiply(yf.createContrastMatrix(s.getContrast())),this._adjustmentsFilter.set({colorMatrix:a})}this._options.tintMode&&this._options.tintMode!=="none"&&(n.push(this._tintFilter),this._tintFilter.set({mode:A.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor})),this._renderTextureSprite.setFilters(n)}this._rendersToRenderTexture(e)?this._renderToRenderTexture(e):this._sprite.setTexture(this._inputTexture),this._updateSprite(t),this._applyFlip(),this._lastRenderedDimensions.copy(i),this._lastRenderedInputDimensions.copy(t),this._lastRenderedImage=r}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}applyFlip(e){super.applyFlip(e);const t={rotation:this._options.rotation},i=t.rotation/Math.PI*180,r=i*-1;t.rotation=r*Math.PI/180;switch(e){case"horizontal":t.flipHorizontally=!this._options.flipHorizontally,this.set(t);break;case"vertical":t.flipVertically=!this._options.flipVertically,this.set(t);break}}_hasAdjustments(){const e=this._options.adjustments;return e.getBrightness()!==0||e.getSaturation()!==1||e.getContrast()!==1}_onImageUpdate(){let e=this._options.image;const t=this._operation.getSDK().getRenderer();this._isSVG&&t.isOfType(Ee.WEBGL)&&(e=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=A.Texture.fromImage(e),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(e,t,i=!0){super.setOption(e,t,i),e==="image"&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){const e=this._dirtiness;for(let t in e)e[t]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}}Vv.prototype.availableOptions={id:{type:f.STRING,default:()=>F.getUUID()},identifier:{type:f.STRING,default:""},image:{type:f.IMAGE,required:!0},position:{type:f.VECTOR2,default:pl.NULL},dimensions:{type:f.VECTOR2,default:pl.NULL},anchor:{type:f.VECTOR2,default:new pl(0,0)},pivot:{type:f.VECTOR2,default:new pl(.5,.5)},rotation:{type:f.NUMBER,default:0},flipHorizontally:{type:f.BOOLEAN,default:!1},flipVertically:{type:f.BOOLEAN,default:!1},smoothDownscaling:{type:f.BOOLEAN,default:!1},tintColor:{type:f.COLOR,default:N.WHITE},tintMode:{type:f.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:f.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:f.NUMBER,default:1},adjustments:{type:f.CONFIGURABLE,structure:{brightness:{type:f.NUMBER,default:0},saturation:{type:f.NUMBER,default:1},contrast:{type:f.NUMBER,default:1}}}};Vv.type="sticker";var vf=Vv;class I8{constructor(e){this._context=e,this._lastFontStyle={}}getLines(){let e=[],t=[];const i=this._lines.length;for(let r=0;r<i;r++){const o=this._lines[r],n=this._buildWords(o),s=n.length;for(let a=0;a<s;a++){const l=n[a];let d=t.concat(l).join("").replace(/\s+$/i,"");const c=this._getWidth(d);if(c>this._maxWidth){t.length>0&&(e.push(t.join("")),t=[l]);const p=l.replace(/\s+$/i,"");if(this._getWidth(p)>this._maxWidth){const h=this._splitWord(l);e=e.concat(h.lines),h.rest&&(t=[h.rest])}}else t.push(l)}e.push(t.join("")),t=[]}return e.map(r=>this._trimLine(r,this._context.textAlign))}_trimLine(e,t){return e}_buildWords(e){let t=[],i="";const r=e.length;for(let o=0;o<r;o++){const n=e[o];i+=n,(n===" "||n==="-"||o===r-1)&&(t.push(i),i="")}return t}_splitWord(e){let t={lines:[],rest:null};const i=e.length;let r=[];for(let o=0;o<i;o++){const n=e[o];this._getWidth(r.concat(n).join(""))>this._maxWidth?(r.length>0&&t.lines.push(r.join("")),r=[n]):r.push(n),o===i-1&&r.length>0&&(t.rest=r.join(""))}return t}_fontStyleChanged(){return this._context.font!==this._lastFontStyle?(this._lastFontStyle=this._context.font,!0):!1}_getWidth(e){return this._context.measureText(e).width}setText(e){this._text=e,this._lines=e.split(`
`)}setMaxWidth(e){this._maxWidth=e}}var _f=I8;const{Vector2:Kv}=H;class O8{constructor(e,t){this._text=e,this._operation=t,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=F.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new _f(this._context),this._finalCanvas=F.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=A.Texture.fromCanvas(this._canvas),this._finalTexture=A.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(e,t){t.font=this._text.getFontStyle()+" "+this._text.getFontWeight()+" "+e.fontSize+'px "'+this._text.getFontFamily()+'"',t.textBaseline="top",t.textAlign=this._text.getAlignment(),t.fillStyle=this._text.getColor().toRGBA(),t.strokeStyle=this._text.getOutlineColor().toRGBA();const i=this._text.getOutlineWidth();i>0&&(t.lineWidth=i)}_buildOutputLines(e){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines().map(t=>t.replace(/\s+$/i,""))}_renderTextLine(e,t){const i=this._text.getAlignment(),r=new Kv(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y);const o=this._text.getOutlineWidth();o>0&&(this._context.miterLimit=2,this._context.strokeText(e,r.x,r.y))}update(e,t){const i=this.calculateFontStyles(e,t);if(i){const{dimensions:r,lines:o}=this._calculateText(e,i,t);this._renderText(e,r,o,i,t),this._updateFinalTexture()}}_updateFinalTexture(){const{width:e,height:t}=this._canvas,i=this.rotation,r=Math.cos(i),o=Math.sin(i),n=new Kv(Math.abs(e*r)+Math.abs(t*o),Math.abs(e*o)+Math.abs(t*r));this._finalCanvas.width=n.x,this._finalCanvas.height=n.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(i),this._finalContext.drawImage(this._canvas,-e/2,-t/2),this._finalContext.restore()}_renderText(e,t,i,r,o){this._canvas.width=t.x,this._canvas.height=t.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*o.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,t.x,t.y),this._applyTextOptions(r,this._context);for(var n=0;n<i.length;n++){const s=i[n];this._renderTextLine(s,r.topPadding+r.lineHeight*n)}}calculateFontStyles(e,t){const i=this._text.getFontFamily(),r=this._text.getFontSize()*t.y,o=this._text.getAbsoluteTextHeight(t),n=o*this._text.getLineHeight(),s=o*(this._text.getLineHeight()-1)/2,a={fontFamily:i,fontSize:r,lineHeight:n,topPadding:s};return(this._textOptions.fontFamily!==i||this._textOptions.fontSize!==r||this._textOptions.lineHeight!==n)&&(this._textOptions=a),a}_calculateText(e,t,i){let r=this._text.getMaxWidth()*i.x;this._applyTextOptions(t,this._context);let o=new Kv,n=this._text.getText().split(`
`);if(typeof r!="undefined")o.x=r,n=this._buildOutputLines(r);else for(let a=0;a<n.length;a++){const l=n[a];o.x=Math.max(o.x,this._context.measureText(l).width)}const{lineHeight:s}=t;return o.y=n.length*s,{dimensions:o,lines:n}}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(e,t){const i=this.calculateFontStyles(e,t),{dimensions:r}=this._calculateText(e,i,t);return r}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}}var Xk=O8;const{Vector2:$v}=H;class qv extends ln{constructor(...e){super(...e);this._textRenderer=new Xk(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="text"),i}getDOMStyle(e,t){const i=this.getFontSize()*t.y;return{fontWeight:this._options.fontWeight,fontSize:i+"px",fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:this.getAbsoluteTextHeight(t)*this.getLineHeight()+"px",color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(e){const t=this.getFontSize()*e.y,i=this.getTextMetrics();if(i){let r=1/i.unitsPerEm*t,o=i.ascender*r,n=i.descender*r;return o+Math.abs(n)}else return t*this.getLineHeight()*1.1}getDimensions(e,t){return this._textRenderer.getDimensions(e,t)}applyFlip(e){super.applyFlip(e);let t=this._options.rotation;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}applyTransform(e){super.applyTransform(e),this.set({fontSize:e.scaleSize(this.getFontSize(),"y"),maxWidth:e.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(e){super.applyRotation(e);const t=(e+360)%360,i=this._operation.getInputDimensions();(t===90||t===270)&&(this.setMaxWidth(this.getMaxWidth()/i.x*i.y),this.setFontSize(this.getFontSize()/i.y*i.x))}setOption(e,t){const{flipHorizontally:i,flipVertically:r}=this._options;if(e==="rotation"){let o=t;i&&(o=Math.PI*2-o),r&&(o=Math.PI*2-o),this._options.rotation=o,this._textRenderer&&(this._textRenderer.rotation=o),this._rotation=o,this.emit("update");return}super.setOption(e,t)}getOption(e){return e==="rotation"?this._rotation:super.getOption(e)}getHitTestDisplayObject(){return this._hitTestSprite}update(e,t){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(e,t);const i=this._textRenderer.getFinalTexture(),r=i.getBaseTexture();r.update();const o=e.getRenderer();o.isOfType(Ee.WEBGL)&&o.updateTexture(i.getBaseTexture()),super.update(e,t),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1,this.setRotation(this._rotation)),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(e)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}}qv.prototype.availableOptions={id:{type:f.STRING,default:()=>F.getUUID()},fontSize:{type:f.NUMBER,default:.1},characterSpacing:{type:f.NUMBER,default:0},lineHeight:{type:f.NUMBER,default:1.1},fontIdentifier:{type:f.STRING},fontFamily:{type:f.STRING,default:"Times New Roman"},fontWeight:{type:f.ALL,default:"normal"},fontStyle:{type:f.STRING,default:"normal"},textMetrics:{type:f.OBJECT,default:null},outlineWidth:{type:f.NUMBER,default:0},outlineColor:{type:f.COLOR,default:N.BLACK},alignment:{type:f.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:f.STRING,default:"top",available:["top","center","bottom"]},color:{type:f.COLOR,default:new N(1,0,0,1)},backgroundColor:{type:f.COLOR,default:N.TRANSPARENT},position:{type:f.VECTOR2,default:new $v(.5,.5)},anchor:{type:f.VECTOR2,default:new $v(0,0)},pivot:{type:f.VECTOR2,default:new $v(.5,.5)},rotation:{type:f.NUMBER,default:0},text:{type:f.STRING,required:!0},maxWidth:{type:f.NUMBER,default:.5},maxHeight:{type:f.NUMBER,default:0},visible:{type:f.BOOLEAN,default:!0},flipHorizontally:{type:f.BOOLEAN,default:!1},flipVertically:{type:f.BOOLEAN,default:!1}};qv.type="text";var xf=qv;class Te{constructor(e){this._seed=e===void 0?Te.TimeSeed():e}seed(e){this._seed=e===void 0?Te.TimeSeed():e}next(){let e=this._seed|0,t=e/Te.SEED_DIVIDER|0,i=e%Te.SEED_DIVIDER|0;return e=Te.SEED_LOW_MULTIPLY*i-Te.SEED_HIGH_MULTIPLY*t,e<=0&&(e+=Te.MAX),e===-1&&(e=Te.MAX-1),this._seed=e,e}nextInRange(e,t){return t===void 0&&(t=e,e=0),e+this.next()%(t-e+1)}nextBool(e=1,t=1){return this.nextInRange(e+t-1)>=e}static TimeSeed(){return Date.now()}pickNext(e){return Array.isArray(e)?e[this.next()%e.length]:null}}Te.MAX=2147483647,Te.SEED_DIVIDER=127773,Te.SEED_LOW_MULTIPLY=16807,Te.SEED_HIGH_MULTIPLY=2836;const{Rectangle:R8}=H;class De{constructor(e=0,t=0,i=0,r=0){this.top=e,this.left=t,this.bottom=i,this.right=r}multiply(e){this.top*=e,this.left*=e,this.bottom*=e,this.right*=e}toObject(){return y({},this)}equals(e,t=0){return Math.abs(e.top-this.top)<=t&&Math.abs(e.left-this.left)<=t&&Math.abs(e.bottom-this.bottom)<=t&&Math.abs(e.right-this.right)<=t}scale(e=1,t){return t===void 0&&(t=e),this.top*=t,this.bottom*=t,this.left*=e,this.right*=e,this}clone(){return new De(this.top,this.left,this.bottom,this.right)}applyToRectangle(e){return new R8(e.x+this.left,e.y+this.top,e.width-this.left-this.right,e.height-this.top-this.bottom)}static get ZERO(){return new De(0,0,0,0)}}class Ki{constructor(e){this.words=[],e&&this.splitIntoWords(e)}splitIntoWords(e){return this.words=e.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(e){return this.words[e]}set(e){return this.words=[...e],this}slice(e,t){return Ki.fromWords(this.words.slice(e,t))}getLowerCase(){return this.words.map(e=>e.toLowerCase())}getUpperCase(){return this.words.map(e=>e.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((e,t)=>e+t.length,0)}joined(e){const t=this.size(),i=Math.floor(t/e),r=t%e;let o=0,n=0;return F.Array.range(0,e).map(s=>{o=n;let a=i+(s<r?1:0);return n=Math.min(o+a,t),F.Array.range(o,n).reduce((l,d)=>l+(d===o?"":" ")+this.words[d],"")})}static fromWords(e){let t=new Ki;return t.words=[...e],t}}const{Rectangle:A8}=H;class Pt{constructor(e=0,t=0){this.width=e,this.height=t}set(e,t){this.width=e,this.height=t}aspect(){return this.width/this.height}rectangle(e,t){return new A8(e,t,this.width,this.height)}clone(){return new Pt(this.width,this.height)}scale(e,t){return t===void 0&&(t=e),this.width*=e,this.height*=t,this}copy(e){return this.width=e.width,this.height=e.height,this}fitInWidthWithOther(e,t=new Pt){return this.copy(Pt.fitTwoInWidth(e,this,t)[0]),this}static fitTwoInWidth(e,t,i){let r=t.width*i.height+t.height*i.width,o=i.height*e/r,n=t.width*o,s=t.height*o;return[new Pt(n,s),new Pt(e-n,s)]}}class Xv extends _e{getSize(){const e=this.getRows(),t=this.getWidth(),i=e.length-1;let r=e.reduce((n,s)=>n+s.getSize().height,0);r+=(i+1)*this.getRelativeLineSpacing()*t;const o=this.getRelativeInsets().clone().scale(t);return r+=o.top+o.bottom,new Pt(t,r)}}Xv.prototype.availableOptions={text:{type:f.STRING,default:""},lines:{type:f.ARRAY,default:[]},relativeInsets:{type:f.OBJECT,default:new De},relativeLineSpacing:{type:f.NUMBER,default:0},rows:{type:f.OBJECT,default:[]},background:{type:f.OBJECT,default:null},width:{type:f.NUMBER,default:0}};class Do extends _e{}Do.prototype.availableOptions={tintColor:{type:f.COLOR,default:N.BLACK},textColor:{type:f.COLOR,default:N.BLACK},alignment:{type:f.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:f.NUMBER,default:1},fontIdentifier:{type:f.STRING,default:"imgly_font_open_sans_bold"}};const{Rectangle:F8}=H;class Rr extends _e{constructor(e){super(e);this.setSize(new Pt(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){const e=this.getSize();return new F8(0,0,e.width,e.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(e){return e.getFrame().clone()}_calculateLayoutElements(){W.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(e){return W.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(e,t){return e.getFrame().clone()}willRender(e){}didRender(e){}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r,font:o}=t.serializeOptions();const n=this.getAttributes();o.draw(e,r.x,r.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})}),e.restore()}}Rr.prototype.availableOptions={words:{type:f.OBJECT,default:null},width:{type:f.NUMBER,default:100},attributes:{type:f.CONFIGURABLE,default:new Do},shearingAngle:{type:f.NUMBER,default:0},elements:{type:f.ARRAY,default:[]},size:{type:f.OBJECT,default:null}};class Yk extends _e{loadImages(e){return Z(this,null,function*(){let t=[];for(let i=0;i<e.length;i++){let r=e[i];yield this.addImage(r.path,r.fullPath,r.image),t.push(r)}return t})}addImage(e,t,i,r="anonymous"){const o=this.getImages();return i?(o[e]={fullPath:t,image:i},Promise.resolve({fullPath:t,image:i})):new Promise((n,s)=>{i=new vi,i.onload=()=>{o[e]={fullPath:t,image:i},n({fullPath:t,image:i})},i.crossOrigin=F.getCrossOriginValue(r),i.onerror=s,i.src=t})}getImage(e){const t=this.getImages(),i=t[e];return i?i.image:null}getVariation(e){return this.getFonts()[e]}addFont(e,t){const i=this.getFonts();return i[e]=t,t}}Yk.prototype.availableOptions={images:{type:f.OBJECT,default:{}},fonts:{type:f.OBJECT,default:{}}};const et=new Yk;class pr extends _e{constructor(e){super(e);let t=et.getVariation(this.getFontIdentifier());t||W.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:t}),this._metrics=null,this._canvas=F.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=et.getVariation(this.getFontIdentifier());return e||W.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}setOptions(e={}){this._options=y(y({},this._options),e),this._isDirty=!0}_applyTextOptions(e=this._context,t={}){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:s}=y(y({},this._options),t),{fontStyle:a,fontWeight:l,fontFamily:d}=r.serializeOptions();e.font=`${a} ${l} ${i}px / ${o} ${d}`,e.fillStyle=n,e.textBaseline="alphabetic",e.textAlign=s||"left"}getTextMetrics(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),y({},this._metrics)}getSizeValue(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),new Pt(this._metrics.width,this._metrics.height)}fitWidth(e){let t=this.getFontVariation();if(!t){W.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});let i=this._context.measureText(this.getText()).width,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(e){let t=this.getFontVariation();if(!t){W.warn("TextDesignFont#fitText: missing font variation");return}let i=this._calculateTextMetrics({fontSize:50}).height,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(e={}){const t=this._canvas,i=this._context,r=y(y({},this._options),e),o=this.getText();this._applyTextOptions(i,r);let n=Math.ceil(i.measureText(o).width),s=Math.floor(n+r.fontSize*2),a=Math.floor(r.fontSize*3);t.width=s,t.height=a;let l=Math.floor(r.fontSize),d=Math.floor(a*(3/5));this._applyTextOptions(i,r),i.fillText(o,l,d);let c=i.getImageData(0,0,t.width,t.height).data,p=B8(c,s,a,d,this._options.excludeAccents),h=P8(c,s,a,d,this._options.excludeAccents),m=n,b=p+h;return this._metrics={width:m,height:b,ascender:p,descender:h},this._isDirty=!1,y({},this._metrics)}draw(e=this._context,t=0,i=0,r,o=!1){e.save(),(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),this._applyTextOptions(e,r),e.fillText(this.getText(),t,i+this._metrics.ascender),o&&(L8(e,t,i,this._metrics.width,this._metrics.height),M8(e,i+this._metrics.ascender,t,t+this._metrics.width)),e.restore()}}const z8=(e,t,i,r)=>{let o=i*(r*4)+t*4,n={r:e[o],g:e[o+1],b:e[o+2],a:e[o+3]};return n},N8=e=>e.a<=254,Jk=(e,t,i)=>{let r=!0;for(let o=0;o<i;o++){let n=z8(e,o,t,i);if(!N8(n)){r=!1;break}}return r},P8=(e,t,i,r,o=!1)=>{let n=0;for(let s=r+1;s<i;s++)if(!Jk(e,s,t))n=s-r+1;else if(o)break;return n},B8=(e,t,i,r,o=!1)=>{let n=0;for(let s=r-1;s>=0;s--)if(!Jk(e,s,t))n=r-s;else if(o)break;return n},U8=(e,t,i,r,o)=>{e.beginPath(),e.moveTo(t,i),e.lineTo(r,o),e.stroke()},M8=(e,t,i,r,o="red")=>{e.save(),e.strokeStyle=o,U8(e,i,t,r,t),e.restore()},L8=(e,t,i,r,o,n="blue")=>{e.save(),e.strokeStyle=n,e.strokeRect(t,i,r,o),e.restore()};pr.prototype.availableOptions={text:{type:f.STRING,default:""},fontIdentifier:{type:f.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:f.OBJECT,default:null},lineHeight:{type:f.NUMBER,default:1},fontSize:{type:f.NUMBER,default:22},textColor:{type:f.STRING,default:"black"},strokeStyle:{type:f.STRING,default:"black"},outlineWidth:{type:f.NUMBER,default:0},textBaseline:{type:f.STRING,default:"alphabetic"},excludeAccents:{type:f.BOOLEAN,default:!1}};class ur extends _e{}ur.prototype.availableOptions={text:{type:f.STRING,default:""},frame:{type:f.OBJECT,default:null},font:{type:f.OBJECT,default:null}};class Bt extends Rr{_calculateLayoutElements(){const{attributes:e,imageInsets:t,size:i,width:r}=this.serializeOptions(),o=this.getWords().joined(1)[0]||"",n=e.fontIdentifier,s=new pr({text:o,fontIdentifier:n});s.fitWidth(this._getTextFrame().width);const a=s.getTextMetrics().height+t.top+t.bottom;i.height=a;const l=this._getTextFrame(),d=new ur({text:o,frame:l,font:s});return[d]}}Bt.prototype.availableOptions=y(y({},Rr.prototype.availableOptions),{imageInsets:{type:f.OBJECT,default:new De}});const H8=10,G8=4,j8=.4;class pi extends _e{constructor(e){super(e);this._relativeInsets=new De,this._background=null,this._fontRandomizer=new Te(0),this._lineNumberRandomizer=new Te(0),this._wordsPerLineRandomizer=new Te(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(e){this._seedPool.forEach(t=>t.seed(e))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return H8}getMinLineCountOfRandom(){return G8}getRandomAdditionalLinePercentage(){return j8}_fontForRow(e,t){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(e){return e.replace(`
`," ").replace("	"," ")}_minimumNumberOfLines(e){return Math.ceil(Math.sqrt(e.size()))}_maximumNumberOfLines(e){return e.size()}_calculatedNumberOfLines(e){let t=this._minimumNumberOfLines(e);if(e.size()>=this.getMinLineCountOfRandom()){let i=Math.floor(Math.max(1,t*this.getRandomAdditionalLinePercentage()));t+=this._lineNumberRandomizer.nextInRange(0,i)}return Math.min(t,this._maximumNumberOfLines(e))}_randomizedNumberOfWordsPerLine(e,t){if(e>t)return W.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),t;let i=F.Array.repeat(1,e);return F.Array.range(e,t).forEach(r=>{let o=this._wordsPerLineRandomizer.nextInRange(0,e-1);i[o]+=1}),i}_textLines(e){let t=new Ki(e),i=this._calculatedNumberOfLines(t),r=this._randomizedNumberOfWordsPerLine(i,t.size());return r.reduce((o,n)=>({index:o.index+n,lines:[...o.lines,t.slice(o.index,Math.min(o.index+n,t.size()))]}),{index:0,lines:[]}).lines}_validTextLines(e){let t=this._textLines(e),i=0;do if(i=F.Array.findIndex(t,r=>r.countNumberOfCharacters()<3),i>=0){let r=t[i-1],o=t[i+1],n=r?r.countNumberOfCharacters():Number.MAX_SAFE_INTEGER,s=o?o.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;n<s&&r?(r.words=[...r.words,...t[i].words],t=[...t.slice(0,i),...t.slice(i+1)]):o&&(o.words=[...t[i].words,...o.words],t=[...t.slice(0,i),...t.slice(i+1)])}while(i>-1&&t.length>1);return t}_modifiedLines(e){return e}_getBackground(){return this._background}generateLayoutData(e,t){const i=this._modifiedText(e),r=this._modifiedLines(this._validTextLines(i)),o=t*(1-this._relativeInsets.left-this._relativeInsets.right),n=this._layoutRows(r,o);return new Xv({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:r,rows:n,width:t})}_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Do({fontIdentifier:this._fontForRow(r,i)})).layout())}_randomLayoutRow(e,t,i,r){return new Bt({words:e,width:i,attributes:r})}}pi.defaultFontIdentifiers=[],pi.identifier="textdesign";pi.prototype.availableOptions={fontIdentifiers:{type:f.ARRAY,default:[]},relativeLineSpacing:{type:f.NUMBER,default:0}};const{Rectangle:W8}=H;class Ar extends Rr{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];const{orientation:e,width:t,size:i,relativeRowOffset:r,attributes:o}=this.serializeOptions(),n=o.fontIdentifier,s=this.getWords().joined(3),a=e===Ar.Orientations.Left?[s[0],s[1],s[2]]:[s[1],s[2],s[0]],l=F.Array.range(0,2).map(de=>new pr({text:a[de],fontIdentifier:n,fontSize:60})),d=l.map(de=>de.getSizeValue()),c=d[0].width>d[1].width?0:1,p=(c+1)%2;l[p].fitWidth(d[c].width),d[p]=l[p].getSizeValue();const h=(d[p].height+d[c].height)/(1-r),m=new pr({text:a[2],fontIdentifier:n});m.fitHeight(h);const b=m.getSizeValue().width,_=d[c].width,g=t/(b+_),S=g*b,x=g*_,C=g*h,R=r*C;i.set(t,C);const T=F.Array.range(0,3).map(de=>new pr({text:a[de],fontIdentifier:n}));T[0].fitWidth(x),T[1].fitWidth(x),T[2].fitWidth(S);const k=e===Ar.Orientations.Left?0:S,M=e===Ar.Orientations.Left?x:0,U=[k,k,M],L=[0,T[0].getSizeValue().height+R,0],ee=T.map((de,ge)=>new W8(U[ge],L[ge],de.getSizeValue().width,de.getSizeValue().height));return T.map((de,ge)=>new ur({text:a[ge],font:T[ge],frame:ee[ge]}))}}Ar.Orientations={Right:"RIGHT",Left:"LEFT"};Ar.prototype.availableOptions=y(y({},Rr.prototype.availableOptions),{orientation:{type:f.STRING,default:Ar.Orientations.Left,available:[Ar.Orientations.Right,Ar.Orientations.Left]},relativeRowOffset:{type:f.NUMBER,default:.05}});class Io extends _e{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}static get Small(){return new Io({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new De(.05,.2,.05,.2)})}static get Rectangle(){return new Io({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new De(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new Io({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new De(.05,.2,.05,.2)})}static get Celebrate2(){return new Io({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new De(.05,.2,.05,.2)})}}Io.prototype.availableOptions={image:{type:f.IMAGE,default:null},imagePath:{type:f.STRING,default:null},relativeInsets:{type:f.OBJECT,default:new De},fontIdentifier:{type:f.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:f.BOOLEAN,default:!1}};const{Rectangle:Wn,Vector2:Ai}=H,Yv=(e,t,i,r)=>{e.drawImage(t,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)},Zr=(e,t,i,r="source-over",o=!1)=>{e.save(),e.fillStyle=i.toRGBA(),e.globalCompositeOperation=r,e.fillRect(t.x,t.y,t.width,t.height),o&&(e.strokeStyle=i.toRGBA(),e.strokeWith=1,e.strokeRect(t.x,t.y,t.width,t.height)),e.restore()},wf=(e,t,i,r,o="source-over",n=!1)=>{e.save(),e.fillStyle=r.toRGBA(),e.globalCompositeOperation=o,i=Math.min(Math.max(i,0),Math.min(t.height,t.width)*.5);const s=t.x,a=t.x+t.width,l=t.y,d=t.y+t.height;e.beginPath(),e.moveTo(s+i,l),e.arcTo(a,l,a,d,i),e.arcTo(a,d,s,d,i),e.arcTo(s,d,s,l,i),e.arcTo(s,l,a,l,i),e.closePath(),e.fill(),n&&e.stroke(),e.restore()},dc=(e,t,i,r=4)=>{e.save(),e.strokeStyle=i.toRGBA(),e.lineWidth=r,e.strokeRect(t.x,t.y,t.width,t.height),e.restore()},Jv=(e,t,i,r="source-over")=>{e.save();let o=t.height/2,n=t.y+o,s=t.x+o,a=t.x+t.width;for(e.fillStyle=i.toRGBA(),e.globalCompositeOperation=r;s<a;)e.beginPath(),e.arc(s,n,o,0,2*Math.PI),e.fill(),s+=o*4;e.restore()},Zk=(e,t)=>{const i=t.applyToRectangle(e),{x:r,y:o,width:n,height:s}=e,a=[Wn.FromDiagonalPoints(new Ai(0,0),new Ai(i.x,i.y)),Wn.FromDiagonalPoints(new Ai(0,i.y+i.height),new Ai(i.x,s)),Wn.FromDiagonalPoints(new Ai(i.x+i.width,i.y+i.height),new Ai(n,s)),Wn.FromDiagonalPoints(new Ai(i.x+i.width,0),new Ai(n,i.y))].map(d=>d.translate(r,o)),l=[Wn.FromDiagonalPoints(new Ai(i.x,0),new Ai(i.x+i.width,i.y)),Wn.FromDiagonalPoints(new Ai(0,i.y),new Ai(i.x,i.y+i.height)),Wn.FromDiagonalPoints(new Ai(i.x,i.y+i.height),new Ai(i.x+i.width,s)),Wn.FromDiagonalPoints(new Ai(i.x+i.width,i.y),new Ai(n,i.y+i.height))].map(d=>d.translate(r,o));return{corners:a,bars:l,center:i}},Qk=(e,t,i,r)=>{const o=t.naturalWidth||t.width,n=t.naturalHeight||t.height,s=Zk(new Wn(0,0,o,n),r),a=Zk(i,r);Yv(e,t,s.center,a.center),F.Array.zip(s.corners,a.corners).forEach(([l,d])=>Yv(e,t,l,d)),F.Array.zip(s.bars,a.bars).forEach(([l,d])=>Yv(e,t,l,d))},Vn=(e,t,i,r,o="source-atop")=>{if(e.save(),r&&(e.globalAlpha=r.a),e.drawImage(t,i.x,i.y,i.width,i.height),r&&(e.globalAlpha=1),r){const n=r.clone();n.a=1,Zr(e,i,n,o)}e.restore()};class Ys extends Bt{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(N.WHITE)?N.BLACK:N.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(e){const t=super._getTextFrameForElement(e),i=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(t.y-=i.top),t}willRender(e){const t=this.getAttributes();t.setTextColor(this._getTextColor());let i=this.getImage();if(i){const r=this.getCapInsets(),o=this._getFrame();r&&!r.equals(De.ZERO)?Qk(e,i,o,r):e.drawImage(i,o.x,o.y,o.width,o.height),Zr(e,o,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&i&&(e.save(),e.globalCompositeOperation="destination-out")}didRender(e){super.didRender(e),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&e.restore()}}Ys.prototype.availableOptions=y(y({},Bt.prototype.availableOptions),{image:{type:f.IMAGE,default:null},capInsets:{type:f.OBJECT,default:new De},backgroundColor:{type:f.COLOR,default:N.WHITE},autoAdjustTextColor:{type:f.BOOLEAN,default:!0},isMasked:{type:f.BOOLEAN,default:!0},isUsedInInvertedLayout:{type:f.BOOLEAN,default:!1}});class xi extends pi{constructor(...e){super(...e);this.getImagePaths=()=>{const e=this.getBanderoles();return e&&e.map(t=>t.getImagePath())||[]};this.onImagesLoaded=()=>{const e=this.getBanderoles();e&&e.forEach(t=>{const i=et.getImage(t.getImagePath());if(!i){W.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})};this._rowTypeLessThan3WordsRandomizer=new Te(0),this._rowTypeMoreThan3WordsRandomizer=new Te(0),this._banderolesRandomizer=new Te(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}generateLayoutData(e,t){return this._options.hasMaskedText=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){if(e.size()<3){let o=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(e,i,r,o)}else{let o=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(o){case 0:return new Ar({words:e,width:i,attributes:r,orientation:Ar.Orientations.Left});case 1:return new Ar({words:e,width:i,attributes:r,orientation:Ar.Orientations.Right});case 2:return this._layoutRow(e,i,r,!0);case 3:return new Bt({words:e,width:i,attributes:r});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${o}.`)}}}_layoutRow(e,t,i,r){if(this.getHasMaskedText()&&(r=!1),r){this.setHasMaskedText(!0);const o=this._banderolesRandomizer.pickNext(this.getBanderoles()),n=new Ys({words:e,width:t,attributes:new Do({alignment:"left",fontIdentifier:o.getFontIdentifier()}),image:o.getImage(),imageInsets:o.insetsForWidth(t),capInsets:null,backgroundColor:N.WHITE});return o.getNeedsImageSmoothingFix()&&(n.serverImageSmoothingFix=!0),n}else return new Bt({words:e,width:t,attributes:i})}}xi.defaultFontIdentifiers=["imgly_font_campton_bold"],xi.identifier="imgly_text_design_blocks",xi.defaultBanderoles=[Io.Rectangle,Io.Small];xi.prototype.availableOptions=y(y({},pi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:xi.defaultFontIdentifiers},relativeLineSpacing:{type:f.NUMBER,default:.025/3},hasMaskedText:{type:f.BOOLEAN,default:!1},banderoles:{type:f.ARRAY,default:xi.defaultBanderoles}});class cc extends xi{constructor(...e){super(...e);this._exclusiveFont=null}generateLayoutData(e,t){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(e,t)}_fontForRow(e,t){return this._exclusiveFont||super._fontForRow(e,t)}_layoutRow(e,t,i,r){return new Bt({words:e,width:t,attributes:i})}}cc.defaultFontIdentifiers=["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"],cc.identifier="imgly_text_design_blocks_condensed";cc.prototype.availableOptions=y(y({},xi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:cc.defaultFontIdentifiers}});const{Rectangle:rp}=H;class ii extends Rr{constructor(...e){super(...e);this.setSize(new Pt(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new ur({frame:this._getTextFrame()})]}render(e){const t=this._getFrame(),i=this.getType(),r=this.getAttributes(),o=r.getTextColor(),n=t.height/3;let s=new rp(t.x,t.y,t.width,n),a=new rp(t.x,t.y+n*2,t.width,n);switch(i){case ii.FormType.Rect:Zr(e,t,o);break;case ii.FormType.DoubleRect:Zr(e,s,o),Zr(e,a,o);break;case ii.FormType.DoubleRectFirstPunctuated:Jv(e,s,o),Zr(e,a,o);break;case ii.FormType.DoubleRectSecondPunctuated:Zr(e,s,o),Jv(e,a,o);break;case ii.FormType.LongLine:const l=t.height/2,d=new rp(t.x,t.y,t.width,l);wf(e,d,d.height*.5,o);break;case ii.FormType.LongAndShortLine:const c=t.height*.2,p=c*.75;s=new rp(t.x,t.y+c,t.width,c);const h=t.x+t.width*.25,m=t.y+t.height-p;a=new rp(h,m,t.width*.5,p),wf(e,s,s.height*.5,o),wf(e,a,a.height*.5,o);break;default:break}}}ii.FormType={Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"};ii.prototype.availableOptions=y(y({},Rr.prototype.availableOptions),{height:{type:f.NUMBER,default:100},type:{type:f.STRING,default:ii.FormType.Rect,available:F.values(ii.FormType)}});class Kn extends xi{_layoutRow(e,t,i,r){return new Bt({words:e,width:t,attributes:i})}_layoutRows(e,t){const i=super._layoutRows(e,t),r=.032*t,o=.08*t,n=new ii({width:t,height:r,type:ii.FormType.LongLine,shearingAngle:0}).layout(),s=new ii({width:t,height:o,type:ii.FormType.LongAndShortLine,shearingAngle:0}).layout();return[n,...i,s]}}Kn.defaultFontIdentifiers=["imgly_font_summer_font_light"],Kn.identifier="imgly_text_design_blocks_light";Kn.prototype.availableOptions=y(y({},xi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:Kn.defaultFontIdentifiers}});class hc extends Kn{_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Do({fontIdentifier:this._fontForRow(r,i)})).layout())}_layoutRow(e,t,i,r){return new Bt({words:e,width:t,attributes:i})}}hc.defaultFontIdentifiers=["imgly_font_summer_font_light"],hc.identifier="imgly_text_design_blocks_light-v3_1_0";hc.prototype.availableOptions=y(y({},Kn.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:hc.defaultFontIdentifiers}});const{Rectangle:V8}=H;class Oo extends Bt{getImageSize(){const e=this.getLeftImage(),t=this.getRightImage(),i=this.getWords(),r=this.getAttributes(),o=r.getFontIdentifier();let n=e?new Pt(e.width,e.height):new Pt;const s=i.joined(1)[0];if(!s)return n;const a=new pr({text:s,fontIdentifier:o,fontSize:50}),l=a.getSizeValue(),d=t?2:1;n.scale(d,1);const c=n.clone().fitInWidthWithOther(this._getFrame().width,l);return c.scale(1/d,1),c}_getTextFrame(){const e=super._getTextFrame().clone(),t=this.getImageSize(),i=this.getRightImage(),r=this.getImagePosition();return i?(e.x+=t.width,e.width-=2*t.width):r===Oo.ImagePosition.Left&&(e.x+=t.width),e}_calculateLayoutElements(){const e=super._calculateLayoutElements(),t=this._getFrame(),i=this.getRightImage(),r=this.getImageSize(),o=this.getImagePosition(),n=this._getTextFrame(),s=this.getAttributes(),a=s.getFontIdentifier(),l=new pr({text:"stickerClock",fontIdentifier:a});l.fitWidth(this._getTextFrame().width);const d=new V8().set(t.x,t.y,r.width,r.height);if(!i&&o===Oo.ImagePosition.Right&&(d.x+=n.width),e.push(new ur({text:"stickerClock",frame:d,font:l})),i){let c=e[0];if(c){const p=d.clone();p.translate(c.getFrame().width+p.width,0),e.push(new ur({text:"stickerClock",frame:p,font:l}))}}return e}render(e){const t=this._getLayoutElements(),i=this.getAttributes(),r=i.getTextColor(),o=this.getLeftImage(),n=this.getRightImage(),s=t[0],a=t[1],{font:l}=s.serializeOptions(),d=this._getTextFrameForElement(s);if(l.draw(e,d.x,d.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()}),o){const c=a.getFrame();e.drawImage(o,c.x,c.y,c.width,c.height),Zr(e,c,r,"source-atop")}if(t.length>2){const c=t[2],p=c.getFrame().clone();e.drawImage(n,p.x,p.y,p.width,p.height),Zr(e,p,r,"source-atop")}}}Oo.ImagePosition={Left:"LEFT",right:"RIGHT"};Oo.prototype.availableOptions=y(y({},Bt.prototype.availableOptions),{leftImage:{type:f.IMAGE,default:null},rightImage:{type:f.IMAGE,default:null},imagePosition:{type:f.STRING,default:Oo.ImagePosition.Left,available:[Oo.ImagePosition.Left,Oo.ImagePosition.Right]}});class $i extends xi{_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%i.length]}_minimumNumberOfLines(e){return Math.max(Math.floor(super._minimumNumberOfLines(e)*.7),1)}_maximumNumberOfLines(e){return Math.max(Math.floor(e.countNumberOfCharacters()/5),1)}_randomLayoutRow(e,t,i,r){return this._createSingleRow($i.RowType.Single,e,i,r)}_createSingleRow(e,t,i,r){const o=r.getFontIdentifier(),n=o==="imgly_font_amberlight"||o==="imgly_font_handycheera_regular"?new Ki().set(t.getLowerCase()):t;switch(e){case $i.RowType.Single:return new Bt({words:n,width:i,attributes:r});case $i.RowType.SingleImage:return new Oo({words:n,width:i,attributes:r});default:return W.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${e}'`),null}}}$i.defaultFontIdentifiers=["imgly_font_handycheera_regular","imgly_font_rasa_regular"],$i.defaultBanderoles=[Io.Celebrate1,Io.Celebrate2],$i.identifier="imgly_text_design_celebrate",$i.RowType={Single:"SINGLE",SingleImage:"SINGLE_IMAGE"};$i.prototype.availableOptions=y(y({},xi.prototype.availableOptions),{relativeLineSpacing:{type:f.NUMBER,default:.01875},fontIdentifiers:{type:f.ARRAY,default:$i.defaultFontIdentifiers},banderoles:{type:f.ARRAY,default:$i.defaultBanderoles}});class ui extends Rr{constructor(...e){super(...e);this.setSize(new Pt(this.getWidth(),this.getHeight()))}_getImageFrame(){const e=this._getTextFrame().clone(),t=this.getImage();if(this.getDrawingModeAspectFit()&&t){let i=Math.min(e.width/t.width,e.height/t.height),r=t.width*i,o=t.height*i;e.x+=(e.width-r)/2,e.y+=(e.height-o)/2,e.width=r,e.height=o}return e}_calculateLayoutElements(){return[new ur({text:"",frame:this._getImageFrame(),font:new pr})]}render(e){const t=this.getImage(),i=this._getImageFrame(),r=this.getAttributes(),o=r.getTextColor();Vn(e,t,i,o)}}ui.RowImages={decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"};ui.prototype.availableOptions=y(y({},Rr.prototype.availableOptions),{words:{type:f.OBJECT,default:new Ki},height:{type:f.NUMBER,default:0},image:{type:f.IMAGE,default:null},imagePath:{type:f.STRING,default:ui.RowImages.decorative1},drawingModeAspectFit:{type:f.BOOLEAN,default:!1},attributes:{type:f.CONFIGURABLE,default:new Do}});class pc extends $i{constructor(...e){super(...e);this.getImagePaths=()=>{const e=this.getBanderoles();return[...e&&e.map(t=>t.getImagePath())||[],...this._celebrateTypes]};this.onImagesLoaded=()=>{const e=this.getBanderoles();e&&e.forEach(t=>{const i=et.getImage(t.getImagePath());if(!i){W.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})};this._celebrateTypes=[ui.RowImages.celebrate1,ui.RowImages.celebrate2,ui.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new Te(0),this._useMaskedRandomizer=new Te(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%(i.length-1)]}_layoutRows(e,t){const i=this._typeRandomizer.pickNext(this._celebrateTypes),r=et.getImage(i);r||W.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`);const o=new ui({width:t,height:t*.5,drawingModeAspectFit:!0,image:r}).layout(),n=super._layoutRows(e,t);return[o,...n]}_randomLayoutRow(e,t,i,r){let o=e.countNumberOfCharacters(),n=13,s=4;o<s&&r.setFontIdentifier("imgly_font_rasa_regular");const a=this._useMaskedRandomizer.nextBool(2,1);return o<n&&a&&!this.getHasMaskedText()?this._layoutRow(e,i,r,!0):super._randomLayoutRow(e,t,i,r)}}pc.identifier="imgly_text_design_celebrate_simple",pc.defaultFontIdentifiers=["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"];pc.prototype.availableOptions=y(y({},$i.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:pc.defaultFontIdentifiers}});class uc extends _e{render(e,t,i,r,o){W.warn("TextDesignBackground#render: Abstract class")}}uc.prototype.availableOptions={};const{Rectangle:Cf}=H;class $n extends uc{getImagePaths(){const{topImagePath:e,bottomImagePath:t,leftImagePath:i,rightImagePath:r}=this._options;return[e,t,i,r].filter(o=>o!=="")}render(e,t,i,r,o){const n=i.clone().scale(t.width),s=t.rectangle(0,0),a=et.getImage(this.getTopImagePath()),l=et.getImage(this.getLeftImagePath()),d=et.getImage(this.getRightImagePath()),c=et.getImage(this.getBottomImagePath());if(a){let p=a.width/a.height,h=n.top*this.getTopImageFillRate(),m=h*p,b=s.width/2,_=b-m/2,g=new Cf(_,0,m,h);Vn(e,a,g,r)}if(c){let p=c.width/c.height,h=n.bottom*this.getBottomImageFillRate(),m=h*p,b=s.width/2,_=b-m/2,g=new Cf(_,s.height-h,m,h);Vn(e,c,g,r)}if(l){let p=l.width/l.height,h=n.left*this.getLeftImageFillRate(),m=h/p,b=s.height/2,_=b-m/2,g=new Cf(0,_,h,m);Vn(e,l,g,r)}if(d){let p=d.width/d.height,h=n.right*this.getRightImageFillRate(),m=h/p,b=s.height/2,_=b-m/2,g=new Cf(s.width-h,_,h,m);Vn(e,d,g,r)}}}$n.prototype.availableOptions={topImagePath:{type:f.STRING,default:""},leftImagePath:{type:f.STRING,default:""},bottomImagePath:{type:f.STRING,default:""},rightImagePath:{type:f.STRING,default:""},topImageFillRate:{type:f.NUMBER,default:1},leftImageFillRate:{type:f.NUMBER,default:1},bottomImageFillRate:{type:f.NUMBER,default:1},rightImageFillRate:{type:f.NUMBER,default:1}};$n.Backgrounds=[new $n({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new $n({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new $n({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new $n({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})];class qn extends pi{constructor(...e){super(...e);this._relativeInsets=new De(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new Te(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return F.Array.flatten($n.Backgrounds.map(e=>e.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext($n.Backgrounds)}generateLayoutData(e,t){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(e,t)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_fontForRow(e,t){let i=super._fontForRow(e,t);return i==="imgly_font_petit_formal_script"&&(this._alreadyContainsARowWithScriptFont&&(i="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),i}_randomLayoutRow(e,t,i,r){let o=r.getFontIdentifier()==="imgly_font_petit_formal_script";return new Bt({words:o?new Ki().set(e.getLowerCase()):e,width:i,attributes:r})}}qn.identifier="imgly_text_design_equal_width",qn.defaultFontIdentifiers=["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"];qn.prototype.availableOptions=y(y({},pi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:qn.defaultFontIdentifiers},relativeLineSpacing:{type:f.NUMBER,default:.025}});class mc extends qn{constructor(...e){super(...e);this._relativeInsets=new De}_getBackground(){return null}}mc.defaultFontIdentifiers=["imgly_font_ultra"],mc.identifier="imgly_text_design_equal_width_fat";mc.prototype.availableOptions=y(y({},qn.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:mc.defaultFontIdentifiers}});class we extends _e{insetsForWidth(e){const t=this.getRelativeInsets().clone();return t.scale(e)}}we.prototype.availableOptions={imagePath:{type:f.STRING,default:""},minimumHeightRatio:{type:f.NUMBER,default:0},sizeToFitContent:{type:f.BOOLEAN,default:!0},capInsets:{type:f.OBJECT,default:new De},relativeInsets:{type:f.OBJECT,default:new De}};we.Box=new we({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new De(.1,.1,.1,.1)});we.Badge1=new we({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new De(.3,.18,.2,.18)});we.Badge2=new we({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new De(.3,.18,.2,.18)});we.Badge3=new we({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new De(.3,.18,.2,.18)});we.Badge4=new we({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new De(.3,.18,.2,.18)});we.SpeechBubble1=new we({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new De(.04,.07,.12,.07),capInsets:new De(19*3,57*3,41*3,17*3)});we.SpeechBubble2=new we({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new De(.04,.07,.12,.07),capInsets:new De(2*3,35*3,29*3,5*3)});we.SpeechBubble3=new we({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new De(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});we.SpeechBubble4=new we({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new De(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});we.SpeechBubble5=new we({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new De(.114892823,.27,.15984926,.27)});we.Watercolor1=new we({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new De(.2,.25,.2,.25)});we.Watercolor2=new we({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new De(.08,.25,.3,.25)});we.Watercolor3=new we({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new De(.1,.2,.15,.2)});const{Vector2:eE}=H;class Sf extends _e{constructor(e){super(e);this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=F.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new _f(this._context),this._finalCanvas=F.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){let e=et.getVariation(this.getFontIdentifier());return e||W.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}_applyTextOptions(e={},t=this._context){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:s}=y(y({},this._options),e),{fontStyle:a,fontWeight:l,fontFamily:d}=r.serializeOptions();t.font=a+" "+l+" "+i+'px "'+d+'"',t.fillStyle=n,t.textBaseline="top",t.textAlign=s||"left"}_buildOutputLines(e){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines()}_renderTextLine(e,t){const i=this.getAlignment(),r=new eE(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y)}update(){const e=this.calculateFontStyles();if(e){const{dimensions:t,lines:i}=this._calculateText(e);this._dimensions=t,this._renderText(t,i,e)}}draw(e,t=0,i=0){this.update(),e.drawImage(this._canvas,t,i,this._dimensions.x,this._dimensions.y)}_renderText(e,t,i){this._canvas.width=e.x,this._canvas.height=e.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(i,this._context);for(var r=0;r<t.length;r++){const o=t[r];this._renderTextLine(o,i.topPadding+i.lineHeight*r)}}getFontFamily(){const e=this.getFontVariation();return e.getFontFamily()}calculateFontStyles(){const e=this.getFontFamily(),t=this.getFontSize(),i=this.getAbsoluteTextHeight(),r=i*this.getLineHeight(),o=i*(this.getLineHeight()-1)/2,n={fontFamily:e,fontSize:t,textHeight:i,lineHeight:r,topPadding:o};return this._textOptions=y({},n),n}getTextMetrics(){const e=this.getFontVariation();return e.getTextMetrics()}getAbsoluteTextHeight(){const e=this.getFontSize(),t=this.getTextMetrics();if(t){let i=1/t.unitsPerEm*e,r=t.ascender*i,o=t.descender*i;return r+Math.abs(o)}else return e*this.getLineHeight()*1.1}_calculateText(e){this._applyTextOptions(e,this._context);let t=new eE,i=this.getText().split(`
`),r;if(typeof r!="undefined")t.x=r,i=this._buildOutputLines(r);else for(let n=0;n<i.length;n++){const s=i[n];t.x=Math.max(t.x,this._context.measureText(s).width)}const{lineHeight:o}=e;return t.y=i.length*o,{dimensions:t,lines:i}}getDimensions(){const e=this.calculateFontStyles(),{dimensions:t}=this._calculateText(e);return t}fitMaxHeight(){this.update();const e=this.getDimensions(),t=this.getText().split(`
`),i=this.getMaxHeight()/e.y}fitMaxWidth(){const e=this.getDimensions().x,t=this.getMaxWidth()/e;this.setFontSize(this.getFontSize()*t),this._textOptions.fontSize=this.getFontSize()}fitInFrame(e){this.setMaxWidth(e.width),this.setMaxHeight(e.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){const e=this.getDimensions();return new Pt(e.x,e.y)}}Sf.prototype.availableOptions={text:{type:f.STRING,default:""},fontIdentifier:{type:f.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:f.OBJECT,default:null},lineHeight:{type:f.NUMBER,default:1},fontSize:{type:f.NUMBER,default:22},textColor:{type:f.STRING,default:"black"},strokeStyle:{type:f.STRING,default:"black"},outlineWidth:{type:f.NUMBER,default:0},textBaseline:{type:f.STRING,default:"alphabetic"},excludeAccents:{type:f.BOOLEAN,default:!0},maxWidth:{type:f.NUMBER,default:100},maxHeight:{type:f.NUMBER,default:0},alignment:{type:f.STRING,default:"left",available:["left","center","right"]}};class ul extends Ys{_calculateLayoutElements(){const e=this.getWords(),t=this._getTextFrame(),i=this.getAttributes(),r=i.getFontIdentifier(),o=this.getImageInsets(),n=new pr({text:e.getWord(0),fontIdentifier:r});n.fitWidth(t.width);const s=new ur({text:e.getWord(0),frame:t,font:n});s.setFrame(this._getTextFrameForElement(s));const a=this.getSize();return(this.getSizeToFitContent()||a.height<=1)&&(a.height=o.top+s.getFrame().height+o.bottom),a.height=Math.max(a.height,this.getMinimumHeight()),[s]}_getTextFrameForElement(e){const t=this.getWords(),i=t.getWord(0),r=this.getAttributes(),o=r.getFontIdentifier(),n=this.getImageInsets(),s=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),a=new Sf({text:i,fontIdentifier:o,alignment:r.getAlignment(),lineHeight:1});a.fitInFrame(s);const l=a.getSize();s.height=l.height;let d=l.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(d+=n.top+n.bottom);const c=this._getFrame(),p=r.getAlignment();if(this.getCenteredVertically())s.y=c.height/2-d/2+n.top;else switch(p){case"left":s.y=c.height-d-n.bottom;break;case"center":s.y=c.height/2-d/2+d*this.getCenterOffset(),s.x=(c.width-s.width)/2;break;case"right":s.x=c.width-s.width-n.right;break;default:break}return s}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r}=t.serializeOptions();const o=this.getAttributes(),n=o.getFontIdentifier(),s=new Sf({text:i,fontIdentifier:n,alignment:o.getAlignment(),lineHeight:1,textColor:o.getTextColor().toRGBA()});r=this._getTextFrameForElement(t),s.fitInFrame(r),s.draw(e,r.x,r.y)}),e.restore()}}ul.prototype.availableOptions=y(y({},Ys.prototype.availableOptions),{centerOffset:{type:f.NUMBER,default:0},sizeToFitContent:{type:f.BOOLEAN,default:!1},textScaleFactor:{type:f.NUMBER,default:.95},rowScaleFactor:{type:f.NUMBER,default:1},minimumHeight:{type:f.NUMBER,default:0},centeredVertically:{type:f.BOOLEAN,default:!1}});class bt extends pi{constructor(...e){super(...e);this._rowType=we.Box,this._alignmentRandomizer=new Te(0),this._isMaskedRandomizer=new Te(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[we.Box.getImagePath()]}_modifiedText(e){return super._modifiedText(e).toLowerCase()}_modifiedLines(e){const t=new Ki;return t.set([e.reduce((i,r)=>`${i}${i===""?"":`
`}${r.joined(1)[0]}`,"")]),[t]}_layoutRows(e,t){const i=super._layoutRows(e,t),r=i[0];if(r&&this.getSquareLayout()){const o=r.getSize();o.height=o.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||bt.ValidAlignments)}_randomLayoutRow(e,t,i,r){const o=this.getAlignment(),n=this._rowType,s=et.getImage(n.getImagePath());r.setAlignment(o);const a=new ul({words:e,width:i,attributes:r,image:s,imageInsets:n.insetsForWidth(i),capInsets:n.getCapInsets(),backgroundColor:N.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===we.Box&&(a.serverImageSmoothingFix=!0);const l=a.getSize();return this.getSquareLayout()?l.height=l.width:l.height=Math.max(l.height,l.width*n.getMinimumHeightRatio()),a}}bt.defaultFontIdentifiers=["imgly_font_galano_grotesque_bold"],bt.Alignment={Left:"left",Center:"center",Right:"right"},bt.ValidAlignments=[bt.Alignment.Left,bt.Alignment.Center,bt.Alignment.Right],bt.identifier="imgly_text_design_masked";bt.prototype.availableOptions=y(y({},pi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:bt.defaultFontIdentifiers},squareLayout:{type:f.BOOLEAN,default:!0}});class ml extends bt{constructor(...e){super(...e);this._possibleRowTypes=[we.Badge1,we.Badge2,we.Badge3,we.Badge4],this._rowTypesRandomizer=new Te(0),this._isMaskedRandomizer=new Te(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:.9}),o}}ml.defaultFontIdentifiers=["imgly_font_campton_bold"],ml.identifier="imgly_text_design_masked_badge",ml.ValidAlignments=[bt.Alignment.Center];ml.prototype.availableOptions=y(y({},bt.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:ml.defaultFontIdentifiers}});class Qr extends bt{constructor(...e){super(...e);this._possibleRowTypes=[we.SpeechBubble1,we.SpeechBubble3],this._rowTypesRandomizer=new Te(0),this._isMaskedRandomizer=new Te(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_rowTypes(e){return this._possibleRowTypes}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(e)),r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),o}}Qr.defaultFontIdentifiers=["imgly_font_panton_black_caps","imgly_font_panton_light_caps","imgly_font_panton_black_italic_caps","imgly_font_panton_light_italic_caps"],Qr.identifier="imgly_text_design_masked_speech_bubble";Qr.prototype.availableOptions=y(y({},bt.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:Qr.defaultFontIdentifiers},squareLayout:{type:f.BOOLEAN,default:!1},alignment:{type:f.STRING,default:"left",available:bt.ValidAlignments}});class fc extends Qr{constructor(...e){super(...e);this._possibleRowTypes=[we.SpeechBubble2,we.SpeechBubble4,we.SpeechBubble2,we.SpeechBubble4,we.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(e){return e.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}}fc.defaultFontIdentifiers=["imgly_font_gagalin_regular"],fc.identifier="imgly_text_design_masked_speech_bubble_comic";fc.prototype.availableOptions=y(y({},Qr.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:fc.defaultFontIdentifiers}});class gc extends bt{_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=this._alignmentRandomizer.pickNext(bt.ValidAlignments);return r.setAlignment(o),new ul({words:e,width:i,attributes:r,image:null,backgroundColor:N.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}}gc.defaultFontIdentifiers=["imgly_font_abril_fatface_regular"],gc.identifier="imgly_text_design_multiline";gc.prototype.availableOptions=y(y({},bt.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:gc.defaultFontIdentifiers}});class bc extends Qr{constructor(...e){super(...e);this._possibleRowTypes=[we.Watercolor1,we.Watercolor2,we.Watercolor3]}}bc.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"],bc.identifier="imgly_text_design_watercolor";bc.prototype.availableOptions=y(y({},Qr.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:bc.defaultFontIdentifiers},alignment:{type:f.STRING,default:bt.Alignment.Center,available:bt.ValidAlignments}});class Wt extends pi{constructor(...e){super(...e);this._relativeInsets=new De(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new Te(0),this._rowTypeRandomizer=new Te(0),this._lineDecorativeTypeRandomizer=new Te(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...Wt.DecoratorImages,...Wt.RowImages]}_fontForRow(e,t){const i=t.countNumberOfCharacters();let r=this.getFontIdentifiers();return i<4?r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(o)<0):i<5&&(r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(o)<0)),r[e%r.length]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_modifiedLines(e){return this._lineCount=e.length,e}generateLayoutData(e,t){return this._decorativeRowCreated=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){const o=r.getFontIdentifier();let n=e;switch(o){case"imgly_font_wolesbro":n=new Ki().set(e.getLowerCase());break;case"imgly_font_permanent_marker":n=new Ki().set(e.getUpperCase());break;default:break}let s=this.getDecorativeRowsInTheMiddleOnly()&&(t===0||t===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||s)return new Bt({words:n,width:i,attributes:r});{this._decorativeRowCreated=!0;const[a,l]=this._randomDecoratorImages();return new Oo({words:e,width:i,attributes:r,leftImage:a,rightImage:l})}}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=.0625*t;const o=new ui({width:t,height:r,image:et.getImage(this._rowTypeRandomizer.pickNext(Wt.RowImages))}).layout(),n=new ui({width:t,height:r,image:et.getImage(this._rowTypeRandomizer.pickNext(Wt.RowImages))}).layout();return[o,...i,n]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?Wt.DecoratorImages.slice(0,2).map(e=>et.getImage(e)):Wt.DecoratorImages.slice(2).map(e=>et.getImage(e))}}Wt.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"],Wt.identifier="imgly_text_design_sunshine",Wt.RowImages=[ui.RowImages.decorative1,ui.RowImages.decorative2,ui.RowImages.decorative3,ui.RowImages.decorative4],Wt.DecoratorImages=["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"];Wt.prototype.availableOptions=y(y({},pi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:Wt.defaultFontIdentifiers},relativeLineSpacing:{type:f.NUMBER,default:.025/3*4},decorationsVisible:{type:f.BOOLEAN,default:!0},decorativeRowsInTheMiddleOnly:{type:f.BOOLEAN,default:!1}});class Zv extends Wt{constructor(...e){super(...e);this._relativeInsets=new De(0,.3,0,.3)}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;let r=25;const o=new ui({width:t,height:r,image:et.getImage(this._rowTypeRandomizer.pickNext(Wt.RowImages))}).layout(),n=new ui({width:t,height:r,image:et.getImage(this._rowTypeRandomizer.pickNext(Wt.RowImages))}).layout();return[o,...i,n]}}Zv.identifier="imgly_text_design_sunshine-v3_1_0";const{Rectangle:K8}=H;class Qv extends _e{getContentFrame(){const e=this.getFrame().clone(),t=e.width*.1;return e.insetBy(t,t)}intersects(e){return this.getFrame().intersects(e.getFrame())}}Qv.prototype.availableOptions={frame:{type:f.OBJECT,default:new K8}};const{Rectangle:tE}=H;class dn extends uc{constructor(...e){super(...e);this._MAX_TRIES=1e3,this._PRECISION=1e3}render(e,t,i,r,o){const{imagePaths:n,relativeParticleSize:s}=this._options;if(n.length<=0)return;let a=t.width/t.height;const l=new tE(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*a),this._PRECISION,this._PRECISION);l.width-=l.x+Math.round(i.right*this._PRECISION),l.height-=l.y+Math.round(i.bottom*this._PRECISION*a);const d=[];let c=0,p=0;for(;c<this.getParticleCount()&&p<this._MAX_TRIES;){let h=s/2,m=Math.round(h*this._PRECISION),b=Math.round(h*this._PRECISION*a),_=Math.floor(this._PRECISION)-m,g=Math.floor(this._PRECISION)-b,S=o.nextInRange(m,_),x=o.nextInRange(b,g);const C=new tE(S-m,x-b,2*m,2*b);!C.intersects(l)&&!this.hasCollision(d,C)&&(d.push(new Qv({frame:C})),c+=1),p+=1}for(let h=0;h<d.length;h++){const m=d[h],b=o.pickNext(n),_=et.getImage(b),g=o.nextInRange(140,230)/255;let S=t.width/this._PRECISION,x=t.height/this._PRECISION;const C=m.getContentFrame();C.x*=S,C.y*=x,C.width*=S,C.height*=x;const R=r.clone();R.a=g,Vn(e,_,C,R,"source-atop")}}hasCollision(e,t){for(let i=0;i<e.length;i++)if(t.intersects(e[i].getFrame()))return!0;return!1}}dn.prototype.availableOptions=y(y({},uc.prototype.availableOptions),{particleCount:{type:f.NUMBER,default:50},relativeParticleSize:{type:f.NUMBER,default:.08},imagePaths:{type:f.ARRAY,default:[]}});class op extends dn{}op.Images=["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"];op.prototype.availableOptions=y(y({},dn.prototype.availableOptions),{imagePaths:{type:f.ARRAY,default:[...op.Images]},relativeParticleSize:{type:f.NUMBER,default:.12}});class np extends dn{}np.Images=["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"];np.prototype.availableOptions=y(y({},dn.prototype.availableOptions),{imagePaths:{type:f.ARRAY,default:[...np.Images]},relativeParticleSize:{type:f.NUMBER,default:.12}});class sp extends dn{}sp.Images=["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"];sp.prototype.availableOptions=y(y({},dn.prototype.availableOptions),{imagePaths:{type:f.ARRAY,default:[...sp.Images]}});class mr extends Wt{constructor(...e){super(...e);this._relativeInsets=new De(.3,.3,.3,.3),this._backgroundRandomizer=new Te(0),this._decoTypeRandomizer=new Te(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...Wt.RowImages,...F.Array.flatten(mr.Backgrounds.map(e=>e.getImagePaths())),...mr.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(mr.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return mr.DecoratorImages.slice(0,2).map(e=>et.getImage(e));case 1:case 2:return mr.DecoratorImages.slice(2).map(e=>et.getImage(e));default:return W.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),mr.DecoratorImages.slice(2).map(e=>et.getImage(e))}}}mr.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"],mr.identifier="imgly_text_design_particles",mr.Backgrounds=[new op,new np,new sp],mr.DecoratorImages=["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"];mr.prototype.availableOptions=y(y({},Wt.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:mr.defaultFontIdentifiers},decorationsVisible:{type:f.BOOLEAN,default:!1},decorativeRowsInTheMiddleOnly:{type:f.BOOLEAN,default:!0}});class yc extends pi{constructor(...e){super(...e);this._relativeInsets=new De(.1,0,0,0),this._rowTypeRandomizer=new Te(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=super._randomLayoutRow(e,t,i,r);return o.setShearingAngle(this.getShearingAngle()),o}_layoutRows(e,t){const i=super._layoutRows(e,t),r=F.values(ii.FormType),o=30,n=new ii({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout(),s=new ii({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();return[n,...i,s]}}yc.defaultFontIdentifiers=["imgly_font_campton_bold"],yc.identifier="imgly_text_design_rotated";yc.prototype.availableOptions=y(y({},pi.prototype.availableOptions),{fontIdentifiers:{type:f.ARRAY,default:yc.defaultFontIdentifiers},relativeLineSpacing:{type:f.NUMBER,default:.025/3},shearingAngle:{type:f.NUMBER,default:-.1}});const{Rectangle:$8}=H,Tf=1e3;class iE{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new Te}createLayout(e,t,i){this._layout=e,this._text=t,this._seed=i,e.seed(i),this._layoutData=e.generateLayoutData(t,Tf)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(W.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(e,t,i,r){const o=this._layoutData;if(this._layoutData){const n=new Pt(Tf,Tf/t.aspect()),s=t.width/Tf,a=o.getRelativeInsets().clone().scale(n.width),l=o.getRelativeLineSpacing()*n.width;let d=a.top;e.save(),this.randomizer.seed(this._seed);const c=o.getBackground();c&&c.render(e,t,o.getRelativeInsets(),r?N.WHITE:i,this.randomizer),e.scale(s,s),o.getRows().forEach(p=>{e.save();const h=p.getAttributes();if(e.transform(1,p.getShearingAngle(),0,1,a.left,d),h.setTextColor(r?N.WHITE:i.clone()),h.setTintColor(r?N.WHITE:i.clone()),(p instanceof Ys||p instanceof ul)&&(p.setBackgroundColor(r?N.WHITE:i.clone()),p.setIsUsedInInvertedLayout(r)),this._debugMode&&(p._debugMode=!0),p.willRender(e),p.render(e),p.didRender(e),this._debugMode){const m=p._getFrame(),b=p._getTextFrame();dc(e,m,N.GREEN),dc(e,b,N.BLUE),p._getLayoutElements().forEach(_=>{const g=_.getFrame(),S=p._getTextFrameForElement(_);dc(e,g,new N(1,1,0)),dc(e,S,new N(0,1,1))})}d+=p.getSize().height+l,e.restore()}),this._debugMode&&dc(e,new $8(0,0,n.width,n.height),N.RED),e.restore()}}}const{Vector2:Js}=H;class ap extends ln{constructor(e,t){super(e,t);this._isDisposed=!1,this._renderer=new iE,this._canvas=F.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=A.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(Te.TimeSeed())}seed(e){this.setSeed(e||Te.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){const e=this.getLayout();return e?(this._renderer.createLayout(e,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(e){super.applyTransform(e);const t={};this._options.dimensions&&(t.width=e.applyToRelativeSize(this.getWidth())),this.set(t,!1)}applyFlip(e){super.applyFlip(e);let t=this._options.rotation;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}update(e,t){let i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout())return;const r=this.getWidth()*t.min()/e.getTextureScale(),o=r/this._aspect,n=new Js(r,o),s=new Js(Math.round(r*2),Math.round(o*2)).clamp(new Js(1,1),new Js(Infinity,Infinity)),a=e.getRenderer(),l=a.getMaxDimensions()||Infinity;s.x>l&&(s.x=l,s.y=Math.round(s.x/this._aspect)),s.y>l&&(s.y=l,s.x=Math.round(s.y*this._aspect));const d=F.ensureCanvasDimensions(this._canvas,s);(i||d)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new Pt(s.x,s.y),this.getColor(),this.getInverted()),this.setDimensions(n),this._texture.getBaseTexture().update(),a.isOfType(Ee.WEBGL)&&a.updateTexture(this._texture.getBaseTexture())),super.update(e,t),this._applyFlip()}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}_optionEquals(e,t){if(e==="layout"){let i=this._options.layout;return!i&&t||!t&&i||(!t.constructor||!i.constructor)?!1:!(i.constructor.identifier!==t.constructor.identifier)}return super._optionEquals(e,t)}serializeOptions(e,t=!1){if(e&&this.getPadding()<0){let r=e.indexOf("padding");r>-1&&e.splice(r,1)}const i=super.serializeOptions(e,t);return e||(i.type="textdesign"),i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}}ap.Layouts={TextDesignBlocks:xi,TextDesignBlocksCondensed:cc,TextDesignBlocksLight:Kn,TextDesignCelebrate:$i,TextDesignCelebrateSimple:pc,TextDesignEqualWidth:qn,TextDesignEqualWidthFat:mc,TextDesignMasked:bt,TextDesignMaskedBadge:ml,TextDesignMaskedSpeechBubble:Qr,TextDesignMaskedSpeechBubbleComic:fc,TextDesignMultiline:gc,TextDesignWatercolor:bc,TextDesignSunshine:Wt,TextDesignParticles:mr,TextDesignRotated:yc};ap.LegacyLayouts={TextDesignBlocksLightV310:hc,TextDesignSunshineV310:Zv};ap.AssetManager=et;ap.prototype.availableOptions={id:{type:f.STRING,default:()=>F.getUUID()},position:{type:f.VECTOR2,default:new Js(.5,.5)},dimensions:{type:f.VECTOR2,default:Js.NULL},anchor:{type:f.VECTOR2,default:new Js(0,0)},pivot:{type:f.VECTOR2,default:new Js(.5,.5)},rotation:{type:f.NUMBER,default:0},flipHorizontally:{type:f.BOOLEAN,default:!1},flipVertically:{type:f.BOOLEAN,default:!1},layout:{type:f.OBJECT,default:null,setter:function(e){return this._isLayoutDirty=!0,e}},text:{type:f.STRING,default:"",setter:function(e){return this._isLayoutDirty=!0,e}},color:{type:f.COLOR,default:N.BLACK,setter:function(e){return this._isLayoutDirty=!0,e}},padding:{type:f.NUMBER,default:.01,minValue:.01},width:{type:f.NUMBER,default:.8},inverted:{type:f.BOOLEAN,default:!1,setter:function(e){return this._isLayoutDirty=!0,e}},seed:{type:f.NUMBER,default:-1}};var kf=ap;const{Vector2:e_}=H;class Zs extends Ge{constructor(...e){super(...e);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=F.createCanvas();const t=this._options.sprites.slice();t.forEach(i=>{this.removeSprite(i),this.addSprite(i)})}getSpritesOfType(e){return this._options.sprites.filter(t=>t instanceof e)}rotate(e){this._options.sprites.forEach(t=>{t.applyRotation(e)})}flip(e){this._options.sprites.forEach(t=>{t.applyFlip(e)})}_onSpriteUpdate(e,t){this.emit("update",this),this.setDirty(!0)}_applyRotation(e,t){this._options.sprites.forEach(i=>i.applyRotation(e,t))}transform(e){this._options.sprites.forEach(t=>t.applyTransform(e))}scale(e){this._options.sprites.forEach(t=>t.applyScale(e))}serializeOption(e,t=!1){return e==="sprites"?this._options.sprites.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createSticker(e){return new vf(this,e)}createText(e){return new xf(this,e)}createBrush(e){return new hl(this,e)}createTextDesign(e){return new kf(this,e)}addSprite(e){this._options.sprites.push(e);let t=this.getSmoothDownscaling();e.setSmoothDownscaling&&e.setSmoothDownscaling(t),this._container.addChild(e.getDisplayObject()),this.setDirty(!0),e.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(e){const t=this._options.sprites,i=t.indexOf(e);return i!==-1?(e.off("update",this._onSpriteUpdate),this._container.removeChild(e.getDisplayObject()),t.splice(i,1),this.setDirty(!0),!0):!1}_getOrientatedStageSize(){const e=this._sdk.getSprite().getTexture().getFrame(),t=this._sdk.getOperationsStack().getByIdentifier("orientation");if(t){const r=t?t.getRotation():0,o=r===270||r===90;return o?new e_(e.height,e.width):new e_(e.width,e.height)}const i=this._sdk.getOperationsStack().getByIdentifier("output");return i?i.getOutputResolution():new e_(e.width,e.height)}_render(e){const t=this._container,i=this._options.sprites,r=e.getDimensions().clone().floor();let o=new A.Container;return o.addChild(this._sprite),ce.all(i.map(n=>n.validateSettings())).then(()=>{i.forEach(n=>n.update(this._sdk,r))}).then(()=>{this._renderTexture.clear(),i.forEach(n=>{n.getInverted&&n.getInverted()?(this._renderTexture.render(o),this._renderTexture.render(this._renderMaskedSprite(n.getDisplayObject(),n.getColor?n.getColor():N.WHITE,n.getPadding?n.getPadding():-1)),o=new A.Container):o.addChild(n.getDisplayObject())}),this._renderTexture.render(o),t.addChild(this._sprite),i.forEach(n=>t.addChild(n.getDisplayObject()))})}_renderMaskedSprite(e,t,i){const r=this._maskCanvas,o=e.getWorldTransform(),n=this._getOrientatedStageSize();F.ensureCanvasDimensions(r,n);const s=r.getContext("2d");if(s.clearRect(0,0,r.width,r.height),s.save(),s.fillStyle=t.toRGBA(),i<0)s.fillRect(0,0,n.x,n.y);else{let d=Math.abs(e.getWidth()/e.getScale().x),c=Math.abs(e.getHeight()/e.getScale().y),p=d*i;s.transform(o.a,o.b,o.c,o.d,o.tx,o.ty),s.fillRect(-p,-p,d+p*2,c+p*2)}s.restore(),s.save(),s.globalCompositeOperation="destination-out",e._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:d=>{const c=e.getWidth(),p=e.getHeight(),h=e.getScale(),m=h.x<0,b=h.y<0;d.translate(c,p),d.scale(m?-1:1,b?-1:1),d.translate(-c,-p)},getContext:()=>s}),s.restore();let a=new A.Container,l=new A.Sprite(A.Texture.fromCanvas(r));return a.addChild(l),a}takeSpriteToFront(e){const{sprites:t}=this._options,i=t.indexOf(e);if(i===-1)return;F.moveArrayItem(t,i,t.length-1);const r=e.getDisplayObject();this._container.removeChild(r),this._container.addChild(r),this.setDirty(!0)}getSpritesAtPosition(e,t){let i=[];this._options.sprites.forEach(d=>d.update(this._sdk,t));const r=this._sdk.getSprite(),o=r.getWorldTransform().applyInverseToVector(e),{width:n,height:s}=r.getTexture().getFrame(),a=r.getAnchor().clone().multiply(-n,-s);o.subtract(a);let l=this._options.sprites.slice(0).reverse();for(let d=0,c=l.length;d<c;d++){const p=l[d];p.getHitTestDisplayObject().isAtPosition(o)&&i.push(p)}return i}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._options.sprites.forEach(r=>{r.setDirtyForRenderer(e,t,i)})}dispose(){super.dispose(),this._options.sprites.forEach(e=>{e.dispose()})}}Zs.StickerSprite=vf;Zs.TextSprite=xf;Zs.BrushSprite=hl;Zs.TextDesignSprite=kf;Zs.identifier="sprite";Zs.prototype.availableOptions={sprites:{type:f.ARRAY,default:[],setter:function(e,t){if(e=e.map((i,r)=>{if(i instanceof ln)return i;const o=y({},i);delete o.type;switch(i.type){case"text":return new xf(this,o);case"sticker":return new vf(this,o);case"brush":return new hl(this,o);case"textdesign":return new kf(this,o);default:W.error(this.constructor.name,"Invalid sprite type: "+i.type)}}),!t){if(this._options.sprites){const i=this._options.sprites.slice();i.forEach(r=>{r.dispose(),this.removeSprite(r)})}e.forEach(i=>{this.addSprite(i)})}return e}},smoothDownscaling:{type:f.BOOLEAN,default:!1}};ue.Operations.SpriteOperation=Zs;var rE=Zs;const{Vector2:oE}=H;class q8{constructor(e,t){this._options=t,this._oldOptions={start:e.getStart().clone(),end:e.getEnd().clone(),rotation:e.getRotation(),textureScale:e.getTextureScale()},this._inputDimensions=e.getInputDimensions(!1),this._rotationDelta=t.rotation-e.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=t.end.clone().subtract(t.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(t.start).multiply(this._inputDimensions),this._scaleRatio=e.calculateScale(t.rotation)/e.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/e.getTextureScale()}applyToRelativePoint(e){const t=this._oldOptions.start,i=this._oldOptions.end,r=t.clone().add(i.clone().subtract(t).divide(2)),o=r.multiply(this._inputDimensions),n=e.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),s=o.clone().add(n),a=s.clone().subtract(this._inputDimensions.clone().divide(2)),l=new oE(a.x*this._deltaCos-a.y*this._deltaSin,a.x*this._deltaSin+a.y*this._deltaCos),d=this._inputDimensions.clone().divide(2).add(l),c=this._options.start.clone().multiply(this._inputDimensions);return d.clone().subtract(c).divide(this._newAbsoluteSize)}applyToRelativeSize(e){return e*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(e){return e=e.clone().multiply(this._scaleRatio),this._options.textureScale&&e.multiply(this._textureScaleFactor),e}scaleSize(e,t="y"){return e/this._sizeFactor[t]}applyToRotation(e){return(e+this._rotationDelta)%(Math.PI*2)}invert(){const e=this._options.start.clone(),t=this._options.end.clone(),i=this._inputDimensions,r=-this._rotationDelta,o=Math.cos(r),n=Math.sin(r),s=this._oldAbsoluteSize,a=this._newAbsoluteSize,l=e.clone().subtract(t).multiply(i),d=1/this._scaleRatio,c=new oE(1/this._sizeFactor.x,1/this._sizeFactor.y),p=1/this._textureScaleFactor,h=this._oldOptions;return this._oldOptions=this._options,this._options=h,this._inputDimensions=i,this._rotationDelta=r,this._deltaCos=o,this._deltaSin=n,this._oldAbsoluteSize=a,this._newAbsoluteSize=s,this._absoluteStartDiff=l,this._scaleRatio=d,this._sizeFactor=c,this._textureScaleFactor=p,this}}var nE=q8;const{Vector2:t_}=H;class lp extends Ge{_render(e){this._sprite.setRotation(0);let t=e.getDimensions();const{start:i,end:r,rotation:o,textureScale:n}=this._options,s=r.clone().subtract(i),a=s.clone().divide(2),l=i.clone().add(a),d=this.calculateScale(),c=d*n,p=t.clone().multiply(c).multiply(a);return this._sprite.setAnchor(l),this._sprite.setRotation(o),this._sprite.setScale(c,c),this._sprite.setPosition(p),this._renderTexture.render(this._container),ce.resolve()}calculateScale(e=this._options.rotation){const t=this.getInputDimensions(!1),i=new t_(Math.abs(t.x*Math.cos(e))+Math.abs(t.y*Math.sin(e)),Math.abs(t.x*Math.sin(e))+Math.abs(t.y*Math.cos(e))),r=t.clone().subtract(i.clone()).divide(2).abs();let o=1;return r.y>r.x?o=r.y*2/t.y+1:o=r.x*2/t.x+1,o}getNewDimensions(e){const{start:t,end:i,textureScale:r}=this._options,o=this.calculateScale(),n=e.clone().multiply(r*o).multiply(i.clone().subtract(t));return n.round()}flip(e){const{start:t,end:i}=this._options,r=t.clone();e==="horizontal"?(t.set(1-i.x,t.y),i.set(1-r.x,i.y)):e==="vertical"&&(t.set(t.x,1-i.y),i.set(i.x,1-r.y))}rotate(e){const{start:t,end:i}=this._options,r=(e+360)%360,o=Math.floor(r/90);for(let n=0;n<o;n++){const s=t.clone();t.set(1-i.y,s.x),i.set(1-s.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}}lp.identifier="transform";lp.prototype.availableOptions={start:{type:f.VECTOR2,default:new t_(0,0)},end:{type:f.VECTOR2,default:new t_(1,1)},textureScale:{type:f.NUMBER,default:1},rotation:{type:f.NUMBER,default:0}};lp.TransformChange=nE;ue.Operations.TransformOperation=lp;var sE=lp;const{Vector2:X8}=H;class Ef extends Ge{constructor(...e){super(...e);this._watermarkSprite=new A.Sprite,this._watermarkSprite.setAnchor(.5,.5),this._container.addChild(this._watermarkSprite)}_render(e){this._watermarkTexture||(this._watermarkTexture=A.Texture.fromImage(this._options.image),this._watermarkSprite.setTexture(this._watermarkTexture));const t=e.getDimensions(),{width:i,height:r}=this._options.image,o=F.resizeVectorToFit(new X8(i,r),t);return this._watermarkSprite.setPosition(t.clone().divide(2)),this._watermarkSprite.setWidth(o.x),this._watermarkSprite.setHeight(o.y),this._renderTexture.render(this._container),ce.resolve()}dispose(){super.dispose(),this._watermarkSprite.dispose()}}Ef.identifier="watermark";Ef.prototype.availableOptions={image:{type:f.OBJECT,required:!0}};ue.Operations.WatermarkOperation=Ef;var aE=Ef;var lE=`varying vec2 v_texCoord;

// Added to the calculated (x,y) texture coordinates, to actually sample the 'center' of a pixel
const vec2 halfCR = vec2(0.5, 0.5);

// A uniform holding the dimensions (height/rows, width/cols) of the texture we're rendering to
uniform vec2 output_texRC;

// A uniform holding the virtual output dimensions when rendering to larger textures. This allows
// making use of the viewport and only two very large textures to perform all tensor rendering.
uniform vec2 output_sizeRC;

bool isNaN(float val) {
    return (val < 0.0 || 0.0 < val || val == 0.0) ? false : true;
}

bool hasNaN(vec4 values) {
    vec4 v1 = values * values;
    vec4 v2 = values * values;
    return any(notEqual(v1, v2));
}

float getNaN(vec4 values) {
    return dot(vec4(1), values);
}

int round(float value) {
    return int(floor(value + 0.5));
}

int imod(int x, int y) {
    return x - y * (x / y);
}

//Based on the work of Dave Hoskins
//https://www.shadertoy.com/view/4djSRW
#define HASHSCALE1 443.8975
float random(float seed){
    vec2 p = v_texCoord * seed;
    vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
    p3 += dot(p3, p3.yzx + 19.19);
    return fract((p3.x + p3.y) * p3.z);
}

vec2 UVfrom1D(vec2 texNumRC, vec2 sizeRC, int index) {
    int logR = index / int(sizeRC.y);
    int logC = index - logR * int(sizeRC.y);
    return (vec2(logC, logR) + halfCR) / texNumRC.yx;
}

vec2 UVfrom2D(vec2 texNumRC, vec2 sizeRC, int numC, int row, int col) {
  // Calculate x & y in logical size
  int index = row * numC + col;
  int logR = index / int(sizeRC.y);
  int logC = index - logR * int(sizeRC.y);

  // Return relative positions of row & col in texture size
  return (vec2(logC, logR) + halfCR) / texNumRC.yx;
}

vec2 UVfrom4D(vec2 texNumRC, vec2 sizeRC, int stride0,
    int stride1, int stride2, int row, int col, int depth,
    int depth2) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * stride0 + col * stride1 + depth * stride2 + depth2;
    int logR = index / int(sizeRC.y);
    int logC = index - logR * int(sizeRC.y);

    return (vec2(logC, logR) + halfCR) / texNumRC.yx;
}

float sampleTexture(sampler2D textureSampler, vec2 uv) {
    return texture2D(textureSampler, uv).r;
}
`;class dE extends A.Filter{constructor(...e){super(...e);this._fragmentSource=null;this._inputTextureSizeMap={},this._inputLogicalSizeMap={},this._inputShapeMap={}}requiresFloatTextures(){return!0}setTargetTextureSize(e){this._targetTextureSize=e}setTargetLogicalSize(e){this._targetSize=e}setTextureSizeForInputWithName(e,t){this._inputTextureSizeMap[t]=e}setLogicalSizeForInputWithName(e,t){this._inputLogicalSizeMap[t]=e}getShaderForRenderer(e){return this._fragmentSource||(this._fragmentSource=this._buildFragmentShader()),super.getShaderForRenderer(e)}outputLogicalShape(){if(!this._options.outputLogicalShape){const e=this._calculateOutputShape();this._options.outputLogicalShape=e}return this._options.outputLogicalShape}_applyWebGL(e,t,i,r=!1,o=null){var n=o;n||(n=this.getShaderForRenderer(e));const s=e.getContext();var a={};const l=e.getCurrentRenderTarget().getProjectionMatrix().toArray();a.u_projMatrix=l,a.output_texRC=this._targetTextureSize,a.output_sizeRC=this._targetSize,a.output_shape=this.outputLogicalShape(),this._options.inputs.forEach(p=>{try{a[`${p.name}_texRC`]=this._inputTextureSizeMap[p.name],a[`${p.name}_sizeRC`]=this._inputLogicalSizeMap[p.name],a[`${p.name}_shape`]=p.logicalShape}catch(h){throw new Error(`Missing texture or logical size for input ${p.name} in filter ${this.constructor.name}.`)}},this),this._updateAdditionalUniforms(n),n.setUniforms(a),n.syncUniforms();const d=t.getBaseTexture(),c=e.getOrCreateGLTexture(d);s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,c),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,d.getGLRepeat(s,"x")),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,d.getGLRepeat(s,"y")),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,d.getGLFilter(s,"min")),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,d.getGLFilter(s,"mag")),s.bindFramebuffer(s.FRAMEBUFFER,i._framebuffer),r&&s.clear(s.COLOR_BUFFER_BIT),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0)}getShaderIdentifier(){const e=this.outputLogicalShape().length,t=this.getInputs().map(i=>`${i.name}_${i.logicalShape.length}`).join("");return this.constructor.name+"_"+e+"_"+t+"_"+this._getTensorOperationSource()}_updateAdditionalUniforms(e){}_calculateOutputShape(){return this.getInputs()[0].logicalShape}prepareUniforms(){this._uniforms.output_texRC={type:z.FLOAT2,value:[0,0]},this._uniforms.output_sizeRC={type:z.FLOAT2,value:[0,0]};const e=this._calculateOutputShape();this._uniforms.output_shape={type:e.length===2?z.INT2:z.INT4,value:e};var t=1,i=[];this.getInputs().forEach(r=>{if(i.indexOf(r.name)!==-1)throw new Error("Input names must be unique.");const o=`${r.name}_texRC`,n=`${r.name}_sizeRC`,s=`${r.name}_shape`;this._uniforms[o]={type:z.FLOAT2,value:[0,0]},this._uniforms[n]={type:z.FLOAT2,value:[0,0]},this._uniforms[s]={type:r.logicalShape.length===2?z.INT2:z.INT4,value:r.logicalShape};switch(r.type){case ke.PREVIOUS:this._uniforms[r.name]={type:z.SAMPLER2D,value:0};break;case ke.DATA:this._uniforms[r.name]={type:z.SAMPLER2D,value:t++};break}}),this.getInputs().forEach(r=>{r.type===ke.INDEX&&(this._uniforms[r.name]={type:z.SAMPLER2D,value:t++})}),delete this._availableUniforms.u_image,delete this._uniforms.u_image}_getTensorOperationSource(){return`
      void main () {
        setOutput(0.0);
      }
    `}_buildFragmentShader(){let e=lE;const t=this.outputLogicalShape();return t.length===2?e+=this._create2DOutputInterfaceSnippet():t.length===4&&(e+=this._create4DOutputInterfaceSnippet()),this._options.inputs.forEach(i=>{e+=this._createInputInterfaceSnippet(i)}),e+=this._createOutputSnippet(),e+=this._getTensorOperationSource(),e}_createOutputSnippet(){return`
      void setOutput(float val) {
        gl_FragColor = vec4(val, 0, 0, 0);
      }
    `}_create2DOutputInterfaceSnippet(){return`
      uniform ivec2 output_shape;
      ivec2 getOutputCoords() {
        vec2 adjustedFragCoord = gl_FragCoord.xy - halfCR;
        int index = int(adjustedFragCoord.y * output_sizeRC.y + adjustedFragCoord.x);
        int r = index / output_shape[1];
        int c = index - r * output_shape[1];

        return ivec2(r, c);
      }
    `}_create4DOutputInterfaceSnippet(){return`
      uniform ivec4 output_shape;
      ivec4 getOutputCoords() {
        vec2 adjustedFragCoord = gl_FragCoord.xy - halfCR;
        int index = int(adjustedFragCoord.y * output_sizeRC.y + adjustedFragCoord.x);

        int stride2 = output_shape[3];
        int stride1 = output_shape[2] * stride2;
        int stride0 = output_shape[1] * stride1;

        int r = index / stride0;
        index -= r * stride0;

        int c = index / stride1;
        index -= c * stride1;

        int d = index / stride2;
        int d2 = index - d * stride2;

        return ivec4(r, c, d, d2);
      }
    `}_createInputInterfaceSnippet(e){let t="";const i=e.name,r=e.logicalShape,o=`${i}_texRC`,n=`${i}_sizeRC`,s=`${i}_shape`,a=r.length===2?"ivec2":"ivec4";t+=`
      uniform sampler2D ${i};
      uniform vec2 ${o};
      uniform vec2 ${n};
      uniform ${a} ${s};
    `;let l=`get${this._capitalize(i)}Flat`;return t+=`
      float ${l}(int index) {
        vec2 uv = UVfrom1D(${o}, ${n}, index);
        return sampleTexture(${i}, uv);
      }
    `,r.length===2?t+=`
        float get${this._capitalize(i)}(int row, int col) {
          vec2 uv = UVfrom2D(${o}, ${n}, ${s}[1], row, col);
          return sampleTexture(${i}, uv);
        }
      `:r.length===4&&(t+=`
      float get${this._capitalize(i)}(int row, int col, int depth, int depth2) {
        int stride2 = ${s}[3];
        int stride1 = ${s}[2] * stride2;
        int stride0 = ${s}[1] * stride1;

        vec2 uv = UVfrom4D(${o}, ${n}, stride0, stride1, stride2, row, col, depth, depth2);
        return sampleTexture(${i}, uv);
      }

      float get${this._capitalize(i)}(ivec4 coords) {
        return get${this._capitalize(i)}(coords.x, coords.y, coords.z, coords.w);
      }
    `),t}_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}_getInputWithName(e){return F.Array.find(this._options.inputs,t=>t.name===e)}}const ke={PREVIOUS:"previous",INDEX:"index",DATA:"data"};dE.prototype.availableOptions={inputs:{type:f.ARRAY},outputLogicalShape:{type:f.ARRAY},outputTextureDimensions:{type:f.ARRAY}};var Be=dE;class Y8 extends Be{_calculateOutputShape(){const e=this._getInputWithName("x"),t=e.logicalShape;if(t.length!==2)throw new Error("UnpackRGBAFilter expects 2D inputs");return[1,t[0],t[1],3]}_getTensorOperationSource(){return`
      void main ()
      {
        //       x, y, z, w
        // e.g. [0, 4, 3, 2] (which is the blue channel of the pixel at x: 3, y: 4)
        ivec4 outputCoords = getOutputCoords();
        
        int row = outputCoords.y;
        int col = outputCoords.z;
        int offset = outputCoords.w;

        int index = row * int(x_sizeRC.y) + col;
        int logR = index / int(x_sizeRC.y);
        int logC = index - logR * int(x_sizeRC.y);
        vec2 uv = (vec2(logC, logR) + halfCR) / x_texRC.yx;
        vec4 color = texture2D(x, uv);

        float component = 0.0;
        if (offset == 0) {
          component = color.r;
        } else if (offset == 1) {
          component = color.g;
        } else if (offset == 2) {
          component = color.b;
        }
        gl_FragColor = vec4(component, 0.0, 0.0, 1.0);
      }
    `}requiresFloatTextures(){return!0}}var Df=Y8;class cE{static getSizeOfLogicalShape(e){let t=e[0];for(let i=1;i<e.length;i++)t*=e[i];return t}static getTextureDimensionsForLogicalShape(e,t=2048){const i=cE.getSizeOfLogicalShape(e);if(e.length<=1&&i<=t)return[i,1];if(e.length===2&&e[0]<=t&&e[1]<=t)return e;if(e.length===3&&e[0]*e[1]<=t&&e[2]<=t)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=t&&e[1]*e[2]<=t)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=t&&e[3]<=t)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=t&&e[1]*e[2]*e[3]<=t)return[e[0],e[1]*e[2]*e[3]];for(let r=Math.floor(Math.sqrt(i));r>1;--r)if(i%r===0)return[r,i/r];return[1,i]}static isSameShape(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}}var qi=cE;class hE extends Be{_calculateOutputShape(){const e=this._getInputWithName("x"),t=e.logicalShape;if(t.length!==4)throw new Error("UnpackRGBAFilter expects 4D inputs");const i=t[0],r=t[3];if(r!==3)throw new Error("Expected RGB values");if(i!==1)throw new Error("PackRGBAFilter does not support batches of images.");const o=this._options.outputSize;if(o.length!==2)throw new Error("Expected outputSize of length 2");if(o[0]*o[1]!==qi.getSizeOfLogicalShape(t)/3)throw new Error(`Input shape ${t} can't be broken up into 3 channels.`);return o}_getTensorOperationSource(){return`
      void main ()
      {
        ivec2 outputCoords = getOutputCoords();
        int row = outputCoords.x;
        int col = outputCoords.y;
        float r = getX(0, row, col, 0);
        float g = getX(0, row, col, 1);
        float b = getX(0, row, col, 2);
        gl_FragColor = vec4(r, g, b, 1.0);
      }
    `}requiresFloatTextures(){return!1}}hE.prototype.availableOptions=Object.assign({outputSize:{type:f.ARRAY}},Be.prototype.availableOptions);var If=hE;class pE extends Be{constructor(...e){super(...e);this._uniforms.blendLeftTopRightBottom={type:z.FLOAT4,value:this.availableOptions.blendLeftTopRightBottom.default},this._uniforms.blendRadius={type:z.FLOAT,value:this.availableOptions.blendRadius.default},this.prepareUniforms()}requiresFloatTextures(){return!1}_calculateOutputShape(){const e=this._getInputWithName("x"),t=this._getInputWithName("y");if(e.logicalShape[0]!==t.logicalShape[0]||e.logicalShape[1]!==t.logicalShape[1])throw new Error(`X and Y inputs of ${this.constructor.name} must have same shape.`);return e.logicalShape}_updateAdditionalUniforms(e){e.setUniform("blendLeftTopRightBottom",this.getBlendLeftTopRightBottom()),e.setUniform("blendRadius",this.getBlendRadius())}_getTensorOperationSource(){return`
      uniform vec4 blendLeftTopRightBottom;
      uniform float blendRadius;

      void main() {
        vec2 coords = vec2(getOutputCoords());

        vec2 blendVertical = vec2(coords.x, x_sizeRC.x - coords.x) / vec2(x_sizeRC.x * blendRadius); // topBlend, bottomBlend
        vec2 blendHorizontal = vec2(coords.y, x_sizeRC.y - coords.y) / vec2(x_sizeRC.y * blendRadius); // leftBlend, rightBlend
        vec4 factorLeftTopRightBottom = clamp(vec4(blendHorizontal.x, blendVertical.x, blendHorizontal.y, blendVertical.y), vec4(0.0), vec4(1.0));
        vec4 maskVector = (vec4(1.0) - blendLeftTopRightBottom) * vec4(2.0); // [0, 1, 1, 1] becomes [2, 0, 0, 0]
        vec4 maskedFactorLeftTopRightBottom = factorLeftTopRightBottom + maskVector; // [0.25, 0.5, 1.0, 1.0] becomes [2.25, 1.0, 1.0]
        float factor = min(min(maskedFactorLeftTopRightBottom.x, maskedFactorLeftTopRightBottom.y), min(maskedFactorLeftTopRightBottom.z, maskedFactorLeftTopRightBottom.w)); // Choose the smallest blending factor
        
        vec2 uv = UVfrom2D(x_texRC, x_sizeRC, int(x_sizeRC.y), int(coords.x), int(coords.y));
        vec4 xColor = texture2D(x, uv);
        vec4 yColor = texture2D(y, uv);

        gl_FragColor = mix(yColor, xColor, factor);
      }
    `}}pE.prototype.availableOptions=Object.assign({blendLeftTopRightBottom:{type:f.ARRAY,default:[1,1,1,1]},blendRadius:{type:f.NUMBER,default:.2}},Be.prototype.availableOptions);var Of=pE;class J8{constructor(e,t){this._targetTextureFormatMap=new Map;this._floatTargetPool=[];this._intTargetPool=[];this._renderer=e,this._internalFloatType=t.renderTextureType,this._internalFloatTextureFormat=t.renderTextureFormat}prebuildRenderTargets(e,t,i){var r=[];for(let o=0;o<e;o++)r.push(new Promise(n=>{const s=this._createRenderTarget(t,i),a=this._uniqueIDForTarget(s);this._targetTextureFormatMap.set(a,i),this.pushRenderTarget(s),n()}));return Promise.all(r)}pushRenderTarget(e){const t=this._uniqueIDForTarget(e),i=this._targetTextureFormatMap.get(t);if(i)switch(i){case Xi.FLOAT:this._floatTargetPool.push(e);break;case Xi.INT:this._intTargetPool.push(e);break}}popRenderTarget(e,t){var i=null;t===Xi.FLOAT?i=this._extractTargetFromPool(this._floatTargetPool,e):t===Xi.INT&&(i=this._extractTargetFromPool(this._intTargetPool,e)),i||(i=this._createRenderTarget(e,t));const r=this._uniqueIDForTarget(i);return this._targetTextureFormatMap.set(r,t),i}getFormatOfRenderTarget(e){return e===null?null:this._targetTextureFormatMap.get(e._baseTexture.id)}dispose(){this._targetTextureFormatMap.clear();var e=0;this._floatTargetPool.forEach(t=>{t.dispose(),e++}),this._floatTargetPool=null,this._intTargetPool.forEach(t=>{t.dispose(),e++}),this._intTargetPool=null}_uniqueIDForTarget(e){return e===null?null:e.getBaseTexture()!==null?e.getBaseTexture().id:null}_extractTargetFromPool(e,t){const i=e.filter(r=>{const o=r.getFrame().getSize();return o.x===t.x&&o.y&&t.y}).shift();if(i){const r=e.indexOf(i);e.splice(r,1)}return i}_createRenderTarget(e,t){let i=new A.WebGLRenderTarget(this._renderer,e.x,e.y,1);i.getBaseTexture().setMinFilter(A.BaseTexture.NearestFilter),i.getBaseTexture().setMagFilter(A.BaseTexture.NearestFilter),i.getBaseTexture().setMipMappingEnabled(!1),i.setFrame(new Qe(0,0,e.x,e.y));const r=this._renderer.getContext();r.bindTexture(r.TEXTURE_2D,i.getBaseTexture().getGLTextureForRenderer(this._renderer));const o=t===Xi.FLOAT?this._internalFloatType:r.UNSIGNED_BYTE,n=t===Xi.FLOAT?this._internalFloatTextureFormat:r.RGBA;return r.texImage2D(r.TEXTURE_2D,0,n,e.x,e.y,0,n,o,null),i}}const Xi={FLOAT:"float",INT:"int"};var uE=J8;class Z8{constructor(e,t){this._filterInputToTextureMap=new Map;this._renderer=e;const i=this._renderer.getContext();this._internalFloatType=t.weightTextureType,this._internalFloatTextureFormat=t.weightTextureFormat,this._numChannels=t.weightTextureFormat===i.RGBA?4:1;const r=this._internalFloatType!==i.FLOAT;r&&this._prepareFloatConversionTables()}createAndLoadTexturesForFilter(e,t){return new Promise(i=>{e.getInputs().forEach((r,o)=>{if(r.type===ke.DATA){const{data:n,logicalShape:s}=r,a=this._createTexture(),l=this._uploadDataToTexture(a,n,s,this._numChannels),d=`${t}_${r.name}`;this._filterInputToTextureMap.set(d,l),this._renderer.getContext().flush(),e.getInputs()[o].data=null}}),i()})}bindTexturesForFilter(e,t,i){const r=this._renderer.getContext();var o=0;return e.getInputs().forEach((n,s)=>{if(n.type!==ke.DATA)return;const{texture:a,size:l}=this._filterInputToTextureMap.get(`${t}_${n.name}`);if(!a)throw new Error(`Missing texture for filter ${s}.`);r.activeTexture(r.TEXTURE0+i+o),r.bindTexture(r.TEXTURE_2D,a),e.setTextureSizeForInputWithName(l,n.name),e.setLogicalSizeForInputWithName(l,n.name),o++}),o}updateTexturesForFilter(e,t){e.getInputs().forEach(i=>{if(i.type===ke.DATA&&i.data!==null){const{texture:r}=this._filterInputToTextureMap.get(`${t}_${i.name}`);this._uploadDataToTexture(r,i.data,i.logicalShape,this._numChannels)}},this)}dispose(){const e=this._renderer,t=e.getContext();var i=0;this._filterInputToTextureMap.forEach(r=>{r!=="undefined"&&(t.deleteTexture(r.texture),i++)}),this._filterInputToTextureMap.clear()}_createTexture(){const e=this._renderer.getContext(),t=e.createTexture();return e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}_uploadDataToTexture(e,t,i,r){const o=qi.getTextureDimensionsForLogicalShape(i),n=qi.getSizeOfLogicalShape(i);if(t.length!==n)throw new Error(`Not enough or too many values (${t.length}) for shape ${i}.`);const s=this._renderer.getContext(),a=this._internalFloatType!==s.FLOAT,l=this._createArrayBufferForUpload(t,o,r,a);return s.bindTexture(s.TEXTURE_2D,e),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r===1&&s.pixelStorei(s.UNPACK_ALIGNMENT,1),s.texImage2D(s.TEXTURE_2D,0,this._internalFloatTextureFormat,o[1],o[0],0,this._internalFloatTextureFormat,this._internalFloatType,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s.pixelStorei(s.UNPACK_ALIGNMENT,4),{texture:e,size:o}}_createArrayBufferForUpload(e,t,i,r){if(i===1&&r===!1)return e;const o=t[0]*t[1]*i,n=r?new Uint16Array(o):new Float32Array(o),s=i===4;let a=0;for(let l=0;l<e.length;l++)n[a]=r?this._toHalfFloat(e[l]):e[l],s&&(n[a+3]=1),a+=i;return n}_prepareFloatConversionTables(){const e=new ArrayBuffer(4);this._floatView=new Float32Array(e),this._uint32View=new Uint32Array(e);const t=new Uint32Array(512),i=new Uint32Array(512);for(let r=0;r<256;++r){const o=r-127;o<-27?(t[r|0]=0,t[r|256]=32768,i[r|0]=24,i[r|256]=24):o<-14?(t[r|0]=1024>>-o-14,t[r|256]=1024>>-o-14|32768,i[r|0]=-o-1,i[r|256]=-o-1):o<=15?(t[r|0]=o+15<<10,t[r|256]=o+15<<10|32768,i[r|0]=13,i[r|256]=13):o<128?(t[r|0]=31744,t[r|256]=64512,i[r|0]=24,i[r|256]=24):(t[r|0]=31744,t[r|256]=64512,i[r|0]=13,i[r|256]=13)}this._baseTable=t,this._shiftTable=i}_toHalfFloat(e){this._floatView[0]=e;const t=this._uint32View[0],i=t>>23&511;return this._baseTable[i]+((t&8388607)>>this._shiftTable[i])}}var mE=Z8;class eo{static determineSupportedConfiguration(e){var t=!1;if(eo._cachedConfigs||(eo._cachedConfigs={},t=!0),eo._cachedConfigs[e.id])return eo._cachedConfigs[e.id];const i=e.getExtension("OES_texture_float"),r=e.FLOAT,o=e.getExtension("OES_texture_half_float"),n=o!==null?o.HALF_FLOAT_OES:null,s=i!==null,a=eo._canCreateTexture(e,r,e.LUMINANCE);let l=o!==null&&eo._canCreateTexture(e,n,e.RGBA);const d=eo._canCreateTexture(e,n,e.LUMINANCE),c=s&&(e.getExtension("WEBGL_color_buffer_float")||eo._canBindBuffer(e,r,e.RGBA)),p=eo._canBindBuffer(e,r,e.LUMINANCE),h=eo._canBindBuffer(e,n,e.LUMINANCE);var m=e.FLOAT,b=e.RGBA,_="?";d?(_="Float16 Luminance",m=n,b=e.LUMINANCE):l?(_="Float16 RGBA",m=n):a?(_="Float32 Luminance",b=e.LUMINANCE):_="Float32 RGBA";var g=r,S=e.RGBA,x="?";h?(x="Float16 Luminance",g=n,S=e.LUMINANCE):p?(x="Float32 Luminance",g=r,S=e.LUMINANCE):x="Float32 RGBA",t&&W.info(`
Art Filter configuration:
Weight Textures: ${_}
Render Textures: ${x}`);const C={environmentSupported:c,weightTextureType:m,weightTextureFormat:b,renderTextureType:g,renderTextureFormat:S};return eo._cachedConfigs[e.id]=C,C}static _canCreateTexture(e,t,i){const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);const o=i===e.RGBA?4:1;var n=new Uint16Array(o);t===e.FLOAT&&(n=new Float32Array(o)),o===1&&e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,i,1,1,0,i,t,n),e.pixelStorei(e.UNPACK_ALIGNMENT,4);const s=e.isTexture(r),a=e.getError()!==e.NO_ERROR;return e.deleteTexture(r),s&&!a}static _canBindBuffer(e,t,i){const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,i,1,1,0,i,t,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const n=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.deleteTexture(r),e.deleteFramebuffer(o),n===e.FRAMEBUFFER_COMPLETE}}var Rf=eo;class Q8{constructor(e,t,i,r){this._measurePerformance=!1;this._filterStack=[];this._intermediateReadDependencies=[];this._intermediateWriteDependencies=[];this._finished=!1;this._renderer=e,this._gl=e.getContext();const o=Rf.determineSupportedConfiguration(this._gl);this._renderTargetManager=new uE(e,o),this._textureManager=new mE(e,o),this._weightMap=t,this._shaderCache=new Map,this._inputTileDimensions=i,this._inferenceEdgeLength=r,this._featheredMaskFilter=new Of({inputs:[{name:"x",type:ke.PREVIOUS,logicalShape:[i.y,i.x]},{name:"y",type:ke.INDEX,logicalShape:[i.y,i.x]}]}),this._setupRGBAUnpackFilter()}addFilter(e,t=!0){if(this._finished)throw new Error("Can't add filters to an already finished graph.");const i=this._filterStack.length,r=i-1,o=this._filterStack[r];return this._filterStack.push(e),this._intermediateReadDependencies.push([]),this._intermediateWriteDependencies.push([]),e.getInputs().forEach((n,s,a)=>{switch(n.type){case ke.PREVIOUS:t&&(n.logicalShape=o.outputLogicalShape());break;case ke.INDEX:if(n.data===r)throw new Error("Accessing the previous filter through indexing is not supported. Use InputType.PREVIOUS instead.");const l=this._filterStack[n.data];if(!l)throw new Error(`Indexed input does not exist: ${n.data} for input ${n.name} in ${e.constructor.name} at ${i}.`);t&&(n.logicalShape=l.outputLogicalShape()),this._intermediateReadDependencies[i].push(n),this._intermediateWriteDependencies[n.data].push(i);break;case ke.DATA:const d=n.data,c=this._weightMap[d];a[s].logicalShape=c.logicalShape,a[s].data=new Float32Array(c.data),a[s].key=d,delete this._weightMap[d];break}},this),e.prepareUniforms(),i}load(e,t=this._measurePerformance){this._renderer=e,this._gl=e.getContext();const i=this._gl,r=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS);this._maxRequiredTextureDimensions=this._calculateMaximumIntermediateTextureDimensions();const o=this;return Promise.resolve().then(()=>o._loadTextures(t)).then(()=>o._compileShaders(e,r,t)).then(()=>o._prepareRenderTargets(t)).then(()=>(o._intermediateResults=o._filterStack.map(()=>null),o._quad=new Dm(e),this._weightMap=null,o._finished=!0,o)).then(()=>{t&&(performance.measure("texture_loading","begin_texture_loading","finish_texture_loading"),performance.measure("shader_compilation","begin_shader_compilation","finish_shader_compilation"),performance.measure("target_preparation","begin_target_preparation","finish_target_preparation"),performance.getEntriesByType("measure").forEach(n=>{console.log(`${n.name}: ${n.duration}ms`),performance.clearMarks(),performance.clearMeasures()}))})}dispose(){if(this._disposed)return;this._textureManager.dispose(),this._renderTargetManager.dispose(),this._shaderCache.forEach(e=>{e.dispose()}),this._textureManager=null,this._renderTargetManager=null,this._shaderCache=null,this._intermediateReadDependencies=null,this._intermediateWriteDependencies=null,this._filterStack=null,this._disposed=!0}_loadTextures(e){e&&performance.mark("begin_texture_loading");const t=[];return this._filterStack.forEach((i,r)=>{t.push(this._textureManager.createAndLoadTexturesForFilter(i,r))},this),Promise.all(t).then(()=>{e&&performance.mark("finish_texture_loading")})}_compileShaders(e,t,i){i&&performance.mark("begin_shader_compilation");const r=[],o=this._filterStack.concat([this._featheredMaskFilter]);return o.forEach((n,s)=>{if(s<this._filterStack.length){const d=1+n.getInputs().filter(c=>c.type===ke.DATA).length+this._intermediateReadDependencies[s].length;if(d>t)throw new Error(`This environment does only offer support for ${t}, but filter ${n.constructor.name} requires ${d}.`)}const a=n.getShaderIdentifier(),l=this;this._shaderCache.has(a)||r.push(new Promise(d=>{const c=n.getShaderForRenderer(e);if(!c)throw new Error(`Could not compile filter: ${n.constructor.name}!`);l._shaderCache.set(a,c),e.getContext().finish(),d(c)}))}),Promise.all(r).then(()=>{i&&performance.mark("finish_shader_compilation")})}_prepareRenderTargets(e){e&&performance.mark("begin_target_preparation");const t=this._maxRequiredTextureDimensions,i=this._inputTileDimensions,r=5,o=3;return Promise.resolve().then(n=>this._renderTargetManager.prebuildRenderTargets(r,t,Xi.FLOAT)).then(n=>this._renderTargetManager.prebuildRenderTargets(o,i,Xi.INT)).then(n=>{e&&performance.mark("finish_target_preparation")})}isFinished(){return this._finished}updateWeights(e){return this._finished?(this._filterStack.forEach((t,i,r)=>{let o=!1;t.getInputs().forEach((n,s)=>{if(n.type===ke.DATA&&n.key){const a=e[n.key];if(!a)return;r[i].getInputs()[s].data=new Float32Array(a.data),o=!0,delete e[n.key]}}),o&&this._textureManager.updateTexturesForFilter(t,i)}),!Object.keys(e).length===0&&Promise.reject(new Error("Not all weights in the given weight map were in use.")),Promise.resolve()):Promise.reject(new Error("Graph hasn't been loaded. Unable to update weights."))}render(a,l,d,c,p,h){return Z(this,arguments,function*(e,t,i,r,o,n,s=this._measurePerformance){if(this._disposed)return Promise.resolve(i);s&&performance.mark("begin_render");const m=this._gl;s&&performance.mark("begin_preparation"),this._featheredMaskFilter.setBlendLeftTopRightBottom(o),this._featheredMaskFilter.setBlendRadius(n*.5);const b=this._maxRequiredTextureDimensions;var _=this._renderTargetManager.popRenderTarget(this._inputTileDimensions,Xi.INT),g=this._renderTargetManager.popRenderTarget(b,Xi.FLOAT),S=this._renderTargetManager.popRenderTarget(this._inputTileDimensions,Xi.INT);this._copyTextureContents(t,_,r,re.NULL),this._copyTextureContents(i,S,r,re.NULL);const x=this._filterStack[0],C=x.getInputs()[0].name,{height:R,width:T}=r;var k=[R,T];x.setTextureSizeForInputWithName(this._inputTileDimensions.asArray(!0),C),x.setLogicalSizeForInputWithName(k,C),s&&performance.mark("finish_preparation");var M=new Qe,U=new Qe;if(this._filterStack.forEach((L,ee)=>{var de=1;s&&performance.mark(`begin_conversion_${ee}`);const ge=L.requiresFloatTextures()?Xi.FLOAT:Xi.INT,xe=ee===this.getLastIndex()?this._inputTileDimensions:this._maxRequiredTextureDimensions,Oe=this._renderTargetManager.getFormatOfRenderTarget(g);g===null?g=this._renderTargetManager.popRenderTarget(xe,ge):Oe!==ge&&(this._renderTargetManager.pushRenderTarget(g),g=this._renderTargetManager.popRenderTarget(xe,ge)),s&&performance.mark(`finish_conversion_${ee}`);var ft=_.getFrame().getSize().asArray(!0),kt=g.getFrame().getSize().asArray(!0);const Ae=F.Array.find(L.getInputs(),st=>st.type===ke.PREVIOUS);Ae!==void 0&&(L.setTextureSizeForInputWithName(ft,Ae.name),L.setLogicalSizeForInputWithName(k,Ae.name)),s&&performance.mark(`begin_suppl_${ee}_prep`);const V=this._textureManager.bindTexturesForFilter(L,ee,de);de+=V,s&&performance.mark(`finish_suppl_${ee}_prep`),s&&performance.mark(`begin_intermediate_${ee}_prep`);const Q=this._intermediateReadDependencies[ee];this._bindIntermediateReadDependencies(L,Q,de),s&&performance.mark(`finish_intermediate_${ee}_prep`);const ne=_.getFrame(),Fe=g.getFrame();(!ne.equals(M)||!Fe.equals(U))&&(this._quad.map(ne,Fe),this._configureVertexAttributesForShader(L.getShaderForRenderer(e)),M=ne,U=Fe),e.setRenderTarget(g);const K=qi.getTextureDimensionsForLogicalShape(L.outputLogicalShape());L.setTargetTextureSize(kt),L.setTargetLogicalSize(K),m.viewport(0,0,K[1],K[0]),s&&performance.mark(`begin_filter_${ee}`);const Y=this._shaderCache.get(L.getShaderIdentifier());m.useProgram(Y.getProgram()),L._applyWebGL(e,_,g,!0,Y),s&&performance.mark(`finish_filter_${ee}`),s&&performance.mark(`begin_postprocess_${ee}`);var ie=this._storeIntermediateResultsIfNeeded(_,ee,k,ft);ie&&(_=null),Q.forEach(st=>{const sr=this._intermediateResults[st.data];sr&&sr.pendingReads===0&&(this._renderTargetManager.pushRenderTarget(sr.target),this._intermediateResults.slice(st.data,1))},this);const rt=g;g=_,_=rt,k=K,s&&performance.mark(`finish_postprocess_${ee}`)},this),s&&performance.mark("begin_masking"),this._renderTargetManager.pushRenderTarget(g),g=this._renderTargetManager.popRenderTarget(this._inputTileDimensions,Xi.INT),this._applyFeatheredMasking(e,_,S,g,[R,T],o),s&&performance.mark("finish_masking"),s&&performance.mark("begin_out_copy"),this._copyTextureContents(g,i,new Qe(0,0,T,R),r.getPosition()),s&&performance.mark("finish_out_copy"),this._renderTargetManager.pushRenderTarget(_),this._renderTargetManager.pushRenderTarget(g),this._renderTargetManager.pushRenderTarget(S),s&&performance.mark("finish_render"),s){performance.measure("total","begin_render","finish_render"),performance.measure("preparation","begin_preparation","finish_preparation"),performance.measure("masking","begin_masking","finish_masking"),performance.measure("out_copy","begin_out_copy","finish_out_copy");for(let L=0;L<this._filterStack.length;L++)performance.measure(`conversion_${L}`,`begin_conversion_${L}`,`finish_conversion_${L}`),performance.measure(`suppl_${L}_prep`,`begin_suppl_${L}_prep`,`finish_suppl_${L}_prep`),performance.measure(`intermediate_${L}_prep`,`begin_intermediate_${L}_prep`,`finish_intermediate_${L}_prep`),performance.measure(`filter_${L}_${this._filterStack[L].constructor.name}`,`begin_filter_${L}`,`finish_filter_${L}`),performance.measure(`postprocess_${L}`,`begin_postprocess_${L}`,`finish_postprocess_${L}`);performance.getEntriesByType("measure").forEach(L=>{L.duration>50&&console.log(`${L.name}: ${L.duration}ms`)}),performance.clearMarks(),performance.clearMeasures()}return Promise.resolve(i)})}_applyFeatheredMasking(e,t,i,r,o){const n=this._gl;n.activeTexture(n.TEXTURE0+1),n.bindTexture(n.TEXTURE_2D,i.getTexture()),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const s=r.getFrame().getSize().asArray(!0);this._featheredMaskFilter.setTargetTextureSize(s),this._featheredMaskFilter.setTargetLogicalSize(o),this._featheredMaskFilter.setTextureSizeForInputWithName(s,"x"),this._featheredMaskFilter.setLogicalSizeForInputWithName(o,"x"),this._featheredMaskFilter.setTextureSizeForInputWithName(s,"y"),this._featheredMaskFilter.setLogicalSizeForInputWithName(o,"y");const a=this._featheredMaskFilter.getShaderIdentifier(),l=this._shaderCache.get(a);n.useProgram(l.getProgram()),this._featheredMaskFilter._applyWebGL(e,t,r,!0,l)}_copyTextureContents(e,t,i,r){const o=this._gl;e.activate(),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.copyTexSubImage2D(o.TEXTURE_2D,0,r.x,r.y,i.x,i.y,i.width,i.height)}_bindIntermediateReadDependencies(e,t,i){const r=this._gl;var o=i;t.forEach(n=>{const s=this._intermediateResults[n.data];r.activeTexture(r.TEXTURE0+o),r.bindTexture(r.TEXTURE_2D,s.target.getTexture()),e.setTextureSizeForInputWithName(s.textureSize,n.name),e.setLogicalSizeForInputWithName(s.logicalSize,n.name),s.pendingReads--,o++})}_configureVertexAttributesForShader(e){const t=this._gl,i=this._quad.getVertexBuffer(),r=this._quad.getIndexBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r);const o=e.getAttributeLocations();t.vertexAttribPointer(o.a_position,2,t.FLOAT,!1,0,0),t.vertexAttribPointer(o.a_texCoord,2,t.FLOAT,!1,0,2*4*4),t.vertexAttribPointer(o.a_color,4,t.FLOAT,!1,0,4*4*4)}_storeIntermediateResultsIfNeeded(e,t,i,r){const o=t-1;return o>=0&&this._intermediateWriteDependencies[o].length>0?(this._intermediateResults[o]={target:e,pendingReads:this._intermediateWriteDependencies[o].length,textureSize:r,logicalSize:i},!0):!1}getInitialInputLogicalShape(){return this._filterStack[0].outputLogicalShape()}getLastFilterLogicalShape(){return this.getLogicalShapeAtIndex(this._filterStack.length-1)}getFilterCount(){return this._filterStack.length}getLastIndex(){return this._filterStack.length-1}getLogicalShapeAtIndex(e){return this._filterStack[e].outputLogicalShape()}getDebugDescription(){var e="",t=0,i=0;return this._filterStack.forEach((r,o)=>{const n=r.constructor.name,s=r._options.inputs.map(c=>`${c.name}: [${c.logicalShape}]`).join(", "),a=`Out: [${r.outputLogicalShape()}]`,l=`[${this._supplementaryTextures[o].map(c=>`${c.loadedTexture.getGLUnit()}: ${c.loadedTexture.id}`).join(", ")}]`,d=`R: [${this._intermediateReadDependencies[o].map(c=>c.data).join(", ")}] | W: [${this._intermediateWriteDependencies[o].join(", ")}]`;e+=`[${o}] - ${n} | ${s} | ${a} | ${l} | ${d}
`,t+=this._intermediateReadDependencies[o].length,i+=this._supplementaryTextures[o].length}),e+=`Max intermediate texture size: ${this._maxRequiredTextureDimensions}
`,e+=`Required render targets: ${t+2}
`,e+=`Required weight textures: ${i}`,e}_setupRGBAUnpackFilter(){const e=this._inputTileDimensions,t=[e.y,e.x],i=new Df({inputs:[{name:"x",logicalShape:t,type:ke.PREVIOUS}]});this.addFilter(i,!1)}_removeLastFilter(){this._filterStack.pop(),this._supplementaryTextures.pop(),this._intermediateReadDependencies.pop(),this._intermediateWriteDependencies.pop()}_calculateMaximumIntermediateTextureDimensions(){var e=new re(this._inputTileDimensions.x,this._inputTileDimensions.y);return this._filterStack.forEach(t=>{const i=qi.getTextureDimensionsForLogicalShape(t.outputLogicalShape());i[1]>e.x&&(e.x=i[1]),i[0]>e.y&&(e.y=i[0])}),e}}var fE=Q8;const{Vector2:e6}=H;class t6{constructor(e,t=256,i=.4){this._renderedTileIndices=[];this._unrenderedTileIndices=[];this._originalInputDimensions=e,this._tilingConfiguration=this._calculateTilingConfiguration(e,t,i),this._unrenderedTileIndices=this._generateSpiralingTileIndices(this._tilingConfiguration),this._maskCache={}}_generateRandomTileIndices(e){const{totalTileCount:t}=e,i=()=>Math.floor(Math.random()*this._tilingConfiguration.totalTileCount);for(var r=[];r.length<t;){for(var o=i();r.indexOf(o)>-1;)o=i();r.push(o)}return r}_generateSpiralingTileIndices(e){const{numHorizontalTiles:t,numVerticalTiles:i}=e,r=this._generateSpiralingIndicies(t,i);return r}_generateSpiralingIndicies(e,t){var i=[],r=0,o=0,n=[0,-1];const s=e%2===0,a=t%2===0,l=Math.floor(e/2)-s,d=Math.floor(t/2)-a;for(var c=Math.pow(Math.max(e,t),2);c>0;c--)-e/2<r&&r<=e/2&&-t/2<o&&o<=t/2&&i.push((d+o)*e+(l+r)),(r===o||r<0&&r===-o||r>0&&r===1-o)&&(n=[-n[1],n[0]]),r+=n[0],o+=n[1];return i.reverse()}calculateMaximumTileDimensions(){const{totalTileCount:e}=this._tilingConfiguration;var t=new e6(0,0);for(let i=0;i<e;i++){const r=this.getOriginalInputCoordinatesForTileAtIndex(i).getSize();t.x=Math.max(r.x,t.x),t.y=Math.max(r.y,t.y)}return t}reset(){const{tileEdgeLength:e,overlappingFactor:t}=this._tilingConfiguration;this._tilingConfiguration=this._calculateTilingConfiguration(this._originalInputDimensions,e,t),this._unrenderedTileIndices=this._generateSpiralingTileIndices(this._tilingConfiguration),this._renderedTileIndices=[],this._nextTileIndex=null}getOriginalInputDimensions(){return this._originalInputDimensions}getNextTileIndex(){return this.hasRenderedAllTiles()?-1:(this._nextTileIndex||(this._nextTileIndex=this._unrenderedTileIndices.pop()),this._nextTileIndex)}getTilingConfiguration(){return this._tilingConfiguration}getRenderedTileCount(){return this._renderedTileIndices.length}getRenderingProgress(){return this.getRenderedTileCount()/this._tilingConfiguration.totalTileCount}getTileCoordinates(e){const t=Math.floor(e/this._tilingConfiguration.numHorizontalTiles),i=Math.floor(e%this._tilingConfiguration.numHorizontalTiles);return{rowIndex:t,columnIndex:i}}getOriginalInputCoordinatesForTileAtIndex(e){const{tileEdgeLength:t,overlappingFactor:i,fittedInputDimensions:r,numHorizontalTiles:o,numVerticalTiles:n}=this._tilingConfiguration,{rowIndex:s,columnIndex:a}=this.getTileCoordinates(e);let l=Math.ceil(s*(t*(1-i))),d=Math.ceil(a*(t*(1-i)));const c=this._originalInputDimensions.x/r.x,p=this._originalInputDimensions.y/r.y;let h=Math.ceil(l*p),m=Math.ceil(d*c);const b=Math.ceil(t*p),_=Math.ceil(t*c);return s===n-1&&h+b<this._originalInputDimensions.y&&(h+=this._originalInputDimensions.y-(h+b)),a===o-1&&m+_<this._originalInputDimensions.x&&(m+=this._originalInputDimensions.x-(m+_)),new H.Rectangle(m,h,_,b)}hasRenderedAllTiles(){return this._tilingConfiguration&&this._renderedTileIndices?this._tilingConfiguration.totalTileCount-this._renderedTileIndices.length===0:!1}markTileAsRendered(){if(this._nextTileIndex===null)return;!this._renderedTileIndices.indexOf(this._nextTileIndex)>-1&&this._renderedTileIndices.push(this._nextTileIndex),this._nextTileIndex=null}_calculateTilingConfiguration(e,t,i){const r=Math.ceil((1-i)*t),o=Math.ceil((e.x-t)/r)*r,n=t+o,s=Math.ceil((e.y-t)/r)*r,a=t+s,l=new H.Vector2(n,a),d=Math.max(1,1+Math.round(s/r)),c=Math.max(1,1+Math.round(o/r)),p=d*c;return{tileEdgeLength:t,overlappingFactor:i,fittedInputDimensions:l,numVerticalTiles:d,numHorizontalTiles:c,totalTileCount:p}}getBlendLeftTopRightBottomForTile(e){const{rowIndex:t,columnIndex:i}=this.getTileCoordinates(e),{numVerticalTiles:r,numHorizontalTiles:o}=this._tilingConfiguration,n=t!==0?1:0,s=i!==o-1?1:0,a=t!==r-1?1:0,l=i!==0?1:0;return[l,n,s,a]}}var i_=t6;class i6 extends Be{_calculateOutputShape(){if(this.getInputs().length!==2)throw Error("AddFilter requires two inputs: x and y.");const e=this._getInputWithName("x"),t=this._getInputWithName("y");if(!qi.isSameShape(e.logicalShape,t.logicalShape))throw Error(`AddFilter inputs must have matching input shapes (${e.logicalShape} vs. ${t.logicalShape}).`);return e.logicalShape}_getTensorOperationSource(){return`
      void main() {
        ivec4 coords = getOutputCoords();
        float xVal = getX(coords.x, coords.y, coords.z, coords.w);
        float yVal = getY(coords.x, coords.y, coords.z, coords.w);
        
        float result = xVal + yVal;
        setOutput(result);
      }
    `}}var Af=i6;class r6 extends Be{_calculateOutputShape(){return this._getInputWithName("x").logicalShape}_getTensorOperationSource(){return`
      void main() {
        ivec4 coords = getOutputCoords();
        float x = getX(coords.x, coords.y, coords.z, coords.w);

        // WebGL doesn't offer tanh, taken from TFJS
        float e2x = exp(-2.0 * abs(x));
        float tanh = sign(x) * (1.0 - e2x) / (1.0 + e2x);

        float rgbValue = (tanh * 150.0) + 127.5;
        float clamped = clamp(rgbValue, 0.0, 255.0);
        setOutput(clamped / 255.0);
      }
    `}}var Ff=r6;class fl{static calculatePadding(e,t,i,r,o,n,s){let a,l,d;if(e==="same"){a=Math.ceil(t/r),l=Math.ceil(i/o);const c=(a-1)*r+n-t,p=(l-1)*o+s-i,h=Math.floor(c/2),m=c-h,b=Math.floor(p/2),_=p-b;d={top:h,bottom:m,left:b,right:_,type:"SAME"}}else if(e==="valid")d={top:0,bottom:0,left:0,right:0,type:"VALID"},a=Math.ceil((t-n+1)/r),l=Math.ceil((i-s+1)/o);else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outHeight:a,outWidth:l}}}class gE extends Be{_calculateOutputShape(){if(this._options.inputs.length!==2)throw Error("Conv2DFilter requires two inputs: x and w.");const e=this._getInputWithName("x"),t=this._getInputWithName("w"),[i,r,o,n]=e.logicalShape,[s,a,,l]=t.logicalShape,d=this._options.stride,c=this._options.stride,{padInfo:p,outHeight:h,outWidth:m}=fl.calculatePadding(this._options.padding,r,o,d,c,s,a);return this._outChannels=l,this._padInfo=p,[i,h,m,this._outChannels]}_getTensorOperationSource(){const e=this._getInputWithName("x"),t=e.logicalShape[3],i=this._padInfo.top,r=this._padInfo.left,o=Math.floor(t/4)*4,n=t%4,s=this._options.stride;return`
    const ivec2 strides = ivec2(${s}, ${s});
    const ivec2 pads = ivec2(${i}, ${r});

    const int max_filter_iterations = 9; // Required to achieve fixed size loop

    void main() {
      ivec4 coords = getOutputCoords();
      int batch = coords[0];
      int d2 = coords[3];

      ivec2 xRCCorner = coords.yz * strides - pads;
      int xRCorner = xRCCorner.x;
      int xCCorner = xRCCorner.y;

      // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
      // ? = to be determined. : = across all values in that axis.
      float dotProd = 0.0;
      for (int wR = 0; wR < max_filter_iterations; wR++) {
        if (wR >= w_shape[0]) { break; }
        int xR = xRCorner + wR;
        if (xR < 0 || xR >= x_shape[1]) {
          continue;
        }

        for (int wC = 0; wC < max_filter_iterations; wC++) {
          if (wC >= w_shape[1]) { break; }
          int xC = xCCorner + wC;

          if (xC < 0 || xC >= x_shape[2]) {
            continue;
          }

          for (int d1 = 0; d1 < ${o}; d1 += 4) {
            vec4 xValues = vec4(
              getX(batch, xR, xC, d1),
              getX(batch, xR, xC, d1 + 1),
              getX(batch, xR, xC, d1 + 2),
              getX(batch, xR, xC, d1 + 3)
            );
            vec4 wValues = vec4(
              getW(wR, wC, d1, d2),
              getW(wR, wC, d1 + 1, d2),
              getW(wR, wC, d1 + 2, d2),
              getW(wR, wC, d1 + 3, d2)
            );

            dotProd += dot(xValues, wValues);
          }

          if (${n===1}) {
            dotProd +=
              getX(batch, xR, xC, ${o}) *
              getW(wR, wC, ${o}, d2);
          } else if (${n===2}) {
            vec2 xValues = vec2(
              getX(batch, xR, xC, ${o}),
              getX(batch, xR, xC, ${o} + 1)
            );
            vec2 wValues = vec2(
              getW(wR, wC, ${o}, d2),
              getW(wR, wC, ${o} + 1, d2)
            );
            dotProd += dot(xValues, wValues);
          } else if (${n===3}) {
            vec3 xValues = vec3(
              getX(batch, xR, xC, ${o}),
              getX(batch, xR, xC, ${o} + 1),
              getX(batch, xR, xC, ${o} + 2)
            );
            vec3 wValues = vec3(
              getW(wR, wC, ${o}, d2),
              getW(wR, wC, ${o} + 1, d2),
              getW(wR, wC, ${o} + 2, d2)
            );
            dotProd += dot(xValues, wValues);
          }
        }
      }
      setOutput(dotProd);
    }`}}gE.prototype.availableOptions=Object.assign({stride:{type:f.NUMBER,default:1},padding:{type:f.STRING,default:"same"}},Be.prototype.availableOptions);var Pf=gE;class bE extends Be{_calculateOutputShape(){if(this.getInputs().length!==2)throw Error("DepthwiseConv2DFilter requires two inputs: x and w.");const e=this._getInputWithName("x"),t=this._getInputWithName("w"),[i,r,o,n]=e.logicalShape,[s,a,,l]=t.logicalShape;if(s>9||a>9)throw new Error("Filter heights are limited to 9. Change shader source if larger ones are required.");const d=this._options.stride,c=this._options.stride,{padInfo:p,outHeight:h,outWidth:m}=fl.calculatePadding(this._options.padding,r,o,d,c,s,a);return this._outChannels=l*n,this._padInfo=p,[i,h,m,this._outChannels]}_getTensorOperationSource(){const e=this._padInfo.top,t=this._padInfo.left,{stride:i,padMethod:r}=this._options;var o;switch(r){case"zero":o="return coords;";break;case"edge":o="return ivec4(clamp(vec4(coords), vec4(0.0), vec4(x_shape - 1)));";break}const n=`
    ivec4 convertCoordinatesForPadding(ivec4 coords) {
      ${o}
    }
    `,s=r==="zero"?"if (xR < 0 || xR >= x_shape[1]) { continue; }":"",a=r==="zero"?"if (xC < 0 || xC >= x_shape[2]) { continue; }":"";return`
      const ivec2 strides = ivec2(${i}, ${i});
      const ivec2 pads = ivec2(${e}, ${t});
      const int max_filter_iterations = 9; // Required to achieve fixed size loop

      ${n}

      void main() {
        ivec4 coords = getOutputCoords();

        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads; // current coordinates in x
        int d2 = coords.w; // current channel index
        int outChannels = w_shape[3] * x_shape[3];
        int d1 = d2; // currently probed channel
        int q = d2 - d1; // current filter index

        int xRCorner = xRCCorner.x; // row index
        int xCCorner = xRCCorner.y; // column index

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < max_filter_iterations; wR++) {
          if (wR >= w_shape[0]) { break; }

          int xR = xRCorner + wR; // x row index = current index + offset * y dilation
          ${s}

          for (int wC = 0; wC < max_filter_iterations; wC++) {
            if (wC >= w_shape[1]) { break; }

            int xC = xCCorner + wC; // x column index = current index + offset * x dilation
            ${a}

            float xVal = getX(convertCoordinatesForPadding(ivec4(batch, xR, xC, d1))); // Get value at current [batch, y, x, channel]
            float wVal = getW(wR, wC, d1, q); // Get kernel value at current 
            dotProd += xVal * wVal;
          }
        }
        setOutput(dotProd);
      }
    `}}bE.prototype.availableOptions=Object.assign({stride:{type:f.NUMBER},padding:{type:f.STRING,default:"same"},padMethod:{type:f.STRING,default:"zero"}},Be.prototype.availableOptions);var Bf=bE;class gl extends Be{static addFiltersForReduceSumOperationToGraph(e,t,i=[1,2]){const r=e.getLogicalShapeAtIndex(t),[o,n]=gl._computeOutAndReduceShape(r,i),s=qi.getSizeOfLogicalShape(n),a=qi.getSizeOfLogicalShape(r)/s,l=[s,a],d=t===e.getLastIndex(),c={name:"x",logicalShape:l,type:d?ke.PREVIOUS:ke.INDEX};d||(c.data=t);let p=gl._buildReduceFilter(c);e.addFilter(p,!1);for(var h=p.outputLogicalShape();h[0]!==1;){const m={name:"x",type:ke.PREVIOUS,logicalShape:p.outputLogicalShape()};p=gl._buildReduceFilter(m),h=p.outputLogicalShape(),e.addFilter(p)}return e.getLastIndex()}static _buildReduceFilter(e){const[t,i]=e.logicalShape,r=gl._computeWindowSize(t);return new gl({inputs:[e],windowSize:r,batchSize:i})}static _computeWindowSize(e){if(e<=30)return e;const t=Math.floor(Math.sqrt(e));for(let i=t;i<e;++i)if(e%i===0)return i;return e}static _computeOutAndReduceShape(e,t){const i=[],r=e.length;for(let n=0;n<r;n++)t.indexOf(n)===-1&&i.push(e[n]);const o=t.map(n=>e[n]);return[i,o]}_calculateOutputShape(){const e=this._getInputWithName("x").logicalShape[0],{batchSize:t,windowSize:i}=this._options,r=Math.ceil(e/i);return[r,t]}_getTensorOperationSource(){const{windowSize:e}=this._options,t=this._getInputWithName("x").logicalShape[0],i=Math.floor(e/4)*4,r=e%4;let o="";return t%e>0&&(o=`
      if (inIdx < 0 || inIdx >= x_shape[0]) {
        return initalizationValue;
      }
      `),`
      const float initializationValue = 0.0;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${o}
        return getX(batch, inIdx);
      }

      void main() {
        // row, col
        ivec2 coords = getOutputCoords();
        int batch = coords[1];
        int outIdx = coords[0];
        int inOffset = outIdx * ${e};
        float sumValue = 0.0;

        for (int i = 0; i < ${i}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            // row, col
            getValue(inIdx, batch),
            getValue(inIdx + 1, batch),
            getValue(inIdx + 2, batch),
            getValue(inIdx + 3, batch)
          );

          sumValue += dot(values, ones);
        }

        int inIdx = inOffset + ${i};
        if (${r===1}) {
          vec4 values = vec4(
            getValue(inIdx, batch),
            initializationValue,
            initializationValue,
            initializationValue
          );

          sumValue += dot(values, ones);
        } else if (${r===2}) {
          vec4 values = vec4(
            getValue(inIdx, batch),
            getValue(inIdx + 1, batch),
            initializationValue,
            initializationValue
          );

          sumValue += dot(values, ones);
        } else if (${r===3}) {
          vec4 values = vec4(
            getValue(inIdx, batch),
            getValue(inIdx + 1, batch),
            getValue(inIdx + 2, batch),
            initializationValue
          );

          sumValue += dot(values, ones);
        }
        setOutput(sumValue);
      }
    `}}gl.prototype.availableOptions=Object.assign({axes:{type:f.ARRAY,default:[1,2]},windowSize:{type:f.NUMBER},batchSize:{type:f.NUMBER}},Be.prototype.availableOptions);var dp=gl;class o6 extends Be{_calculateOutputShape(){const e=this._getInputWithName("x");return e.logicalShape}_getTensorOperationSource(){return`
      void main ()
      {
        ivec4 coords = getOutputCoords();
        float numValuesPerChannel = float(x_shape[1] * x_shape[2]);

        // 'Sum' input consists of a single value which holds the sum of all elements in x
        float xSum = getSumFlat(coords.w);

        // 'X' is a 4D tensor holding arbitrary float values
        float x = getX(coords.x, coords.y, coords.z, coords.w);

        // Calculate the mean
        float mean = xSum / numValuesPerChannel;

        // Calculate a single variance component (x_i - mean)^2
        float result = pow((x - mean), 2.0);
        setOutput(result);
      }
    `}}var Mf=o6;class yE extends Be{_calculateOutputShape(){const e=this._getInputWithName("x"),t=this._getInputWithName("variance"),i=this._getInputWithName("sum"),r=e.logicalShape[3];if(!(t.logicalShape[1]===r)||!(i.logicalShape[1]===r))throw new Error("Variance and sum input depth must match x inputs channels for InstanceNormReluFilter.");return e.logicalShape}_getTensorOperationSource(){const e=this.getAddRelu()?`
      if (isNaN(result)) {
        setOutput(result);
      } else {
        float relu = (result < 0.0) ? 0.0 : result;
        setOutput(relu);
      }
    `:"setOutput(result);";return`
      void main ()
      {
        float numValuesPerChannel = float(x_shape[1] * x_shape[2]);
        ivec4 coords = getOutputCoords();
        float x = getX(coords.x, coords.y, coords.z, coords.w);

        // 'variance' input consists of a single value per channel which holds the sum of all values in x reduced by it's mean and squared afterwards
        float nonMeanedVariance = getVarianceFlat(coords.w);
        float variance = nonMeanedVariance / numValuesPerChannel;

        // 'sum' input consists of a single value per channel which holds the sum of all elements in x
        float xSum = getSumFlat(coords.w);
        float mean = xSum / numValuesPerChannel;

        float netmu = x - mean;
        float sigmaEpsilonSqrt = sqrt(variance + 0.001);

        float normalized = netmu / sigmaEpsilonSqrt;
        
        // Calculate the instance normalized value of x
        float shift = getShiftFlat(coords.w);
        float scale = getScaleFlat(coords.w);
        float result = (scale * normalized) + shift;

        // If it's not NaN, calculate relu
        ${e}
      }
    `}}yE.prototype.availableOptions=Object.assign({shift:{type:f.NUMBER},scale:{type:f.NUMBER},addRelu:{type:f.BOOLEAN,default:!0}},Be.prototype.availableOptions);var Lf=yE;class vE extends Be{constructor(...e){super(...e);this._uniforms.sourceSizeRC={type:z.FLOAT2,value:[0,0]},this._uniforms.targetSizeRC={type:z.FLOAT2,value:[0,0]}}_calculateOutputShape(){const e=this._getInputWithName("x"),[t,,,i]=e.logicalShape,[r,o]=this._options.size;return[t,r,o,i]}_updateAdditionalUniforms(e){const[t,i,r]=this._getInputWithName("x").logicalShape,o={targetSizeRC:this.getSize(),sourceSizeRC:[i,r]};e.setUniforms(o)}_getTensorOperationSource(){const e=`
      uniform vec2 sourceSizeRC;
      uniform vec2 targetSizeRC;

      void main() {
        vec2 effectiveInSize = sourceSizeRC - vec2(1.0, 1.0);
        vec2 effectiveOutSize = targetSizeRC - vec2(1.0, 1.0);
        vec2 effectiveInputOverOutputRatioRC = effectiveInSize / effectiveOutSize;

        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(min(sourceSizeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getX(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getX(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getX(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getX(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `;return e}}vE.prototype.availableOptions=Object.assign({size:{type:f.ARRAY,required:!0},alignCorners:{type:f.BOOLEAN,default:!0}},Be.prototype.availableOptions);var vc=vE;class _E extends Be{_calculateOutputShape(){const{paddings:e}=this._options;if(!this.getInputs().length===1||this.getInputs().length===0)throw new Error("ReflectionPadFilter requires single input.");const t=this.getInputs()[0].logicalShape;if(e.length!==t.length)throw new Error(`Not enough or too many paddings for input shape ${t}`);return e.map((i,r)=>i[0]+t[r]+i[1])}_getTensorOperationSource(){const e=this.getInputs()[0].logicalShape,t=e.length,i=this._options.paddings.map(n=>n[0]).join(","),r=`vec${t}`,o=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,t).join(",");return`
      i${r} start = i${r}(${i});

      void main () {
        i${r} outC = getOutputCoords();
        ${r} coordsInInput = ${r}(outC - start);
        i${r} coords = i${r}(clamp(coordsInInput, ${r}(0.0), ${r}(x_shape - 1)));
        setOutput(getX(${o}));
      }
    `}}_E.prototype.availableOptions=Object.assign({paddings:{type:f.ARRAY,required:!0}},Be.prototype.availableOptions);var zf=_E;class n6 extends Be{_calculateOutputShape(){const e=this._getInputWithName("x");return e.logicalShape}_getTensorOperationSource(){return`
      float kernel[9];
      vec2 offset[9];
      float factor = 0.1;
    
      void main ()
      {
        kernel[0] = 0.;
        kernel[1] = -1. * factor;
        kernel[2] = 0.;
        kernel[3] = -1. * factor;
        kernel[4] = 1. + 4. * factor;
        kernel[5] = -1. * factor;
        kernel[6] = 0.;
        kernel[7] = -1. * factor;
        kernel[8] = 0.;

        float step_w = 1.0 / float(x_sizeRC.y);
        float step_h = 1.0 / float(x_sizeRC.x);

        offset[0] = vec2(-step_w, -step_h);
        offset[1] = vec2(0.0, -step_h);
        offset[2] = vec2(step_w, -step_h);
        offset[3] = vec2(-step_w, 0.0);
        offset[4] = vec2(0.0, 0.0);
        offset[5] = vec2(step_w, 0.0);
        offset[6] = vec2(-step_w, step_h);
        offset[7] = vec2(0.0, step_h);
        offset[8] = vec2(step_w, step_h);

        vec2 uv = (gl_FragCoord.xy + halfCR) / x_texRC.yx;
        vec4 sum = vec4(0.0);
        for (int i = 0; i < 9; i++) {
          vec4 color = texture2D(x, uv.xy + offset[i]);
          sum += color * kernel[i];
        }

        gl_FragColor = sum;
      }
    `}requiresFloatTextures(){return!1}}var Nf=n6;class bl extends _e{constructor(e={},t){super(e);this._onWeightsUpdatedCallback=null;this._finalConvIndex=-1;this._tilingController=t,this._disposed=!1}isDirty(){return this._tilingController?!this._tilingController.hasRenderedAllTiles():!0}isDisposed(){return this._graph===null}isReady(){return!this.isDisposed()&&this._graph.isFinished()}getTilingController(){return this._tilingController}onWeightsUpdated(e){this._onWeightsUpdatedCallback=e}static createWithOptions(e,t,i){const r=e.tileEdgeLength||bl.prototype.availableOptions.tileEdgeLength.default,o=e.overlappingFactor||bl.prototype.availableOptions.overlappingFactor.default,n=new i_(t,r,o),s=new bl(e,n);return s.initGraph(i).then(()=>s)}updateInputDimensions(e){const t=this._options.tileEdgeLength||bl.prototype.availableOptions.tileEdgeLength.default,i=this._options.overlappingFactor||bl.prototype.availableOptions.overlappingFactor.default;this._tilingController=new i_(e,t,i)}updateWithWeightsFromURL(e){return Z(this,null,function*(){const t=new lr(e),i=yield t.load();if(!i)return Promise.reject(new Error(`Could not load weight map from ${e}`));for(var r=0;i[`transform/residual/res_${r+1}/conv1/depthwise_weights`];)r++;const o=i["transform/expand/final_conv/depthwise_weights"].logicalShape,n=this._graph._filterStack[this._finalConvIndex]._getInputWithName("w").logicalShape,s=qi.isSameShape(n,o),a=this._residualBlockCount===r,l=this;return s&&a?this._graph.updateWeights(i).then(()=>{l._onWeightsUpdatedCallback&&l._onWeightsUpdatedCallback(),l.getTilingController().reset()}):Promise.reject(new Error("Model architectures differ."))})}execute(e,t,i){const r=this._tilingController,o=this._graph,n=r.getNextTileIndex();if(!o.isFinished())throw new Error("Can't execute an unfinished graph.");const{x:s,y:a,height:l,width:d}=this._tilingController.getOriginalInputCoordinatesForTileAtIndex(n),c=new Qe(s,a,d,l),p=this._tilingController.getBlendLeftTopRightBottomForTile(n),{overlappingFactor:h}=this._tilingController.getTilingConfiguration();return o.render(e,t,i,c,p,h).then(()=>{r.markTileAsRendered(n)})}initGraph(e){return Z(this,null,function*(){const{weightURL:t,tileEdgeLength:i}=this._options,r=this.getTilingController(),o=r.calculateMaximumTileDimensions(),n=r.getOriginalInputCoordinatesForTileAtIndex(0).getSize(),s=new lr(t),a=yield s.load();for(var l=0;a[`transform/residual/res_${l+1}/conv1/depthwise_weights`];)l++;return this._residualBlockCount=l,this._graph=new fE(e,a,o,i),this._graph.addFilter(new vc({inputs:[{name:"x",type:ke.PREVIOUS}],size:[i,i]})),this._addStyleTransferOperationsToGraph(this._graph,a,n),this._graph.load(e).then(()=>{this._tilingController.reset()})})}_addStyleTransferOperationsToGraph(e,t,i){this._weightMap=t;const r=this._addDepthwiseSeparableConvolution("transform/contract/conv1",e,1,1,"same"),o=this._addDepthwiseSeparableConvolution("transform/contract/conv2",e,r,2,"same"),n=this._addDepthwiseSeparableConvolution("transform/contract/conv3",e,o,2,"same");let s=n;for(var a=1;a<=this._residualBlockCount;a++){const m=`transform/residual/res_${a}`;s=this._addResidualBlock(m,e,s)}const l=this._addUpsampling("transform/expand/up_1",e,s),d=this._addUpsampling("transform/expand/up_2",e,l);this._addDepthwiseSeparableConvolution("transform/expand/final_conv",e,d,1,"same",!1),e.addFilter(new Ff({inputs:[{name:"x",type:ke.PREVIOUS}]}));const c=e.addFilter(new vc({inputs:[{name:"x",type:ke.PREVIOUS}],size:[i.y,i.x]})),p=this._addEdgePadding(e,c,3,1),h=this._addPackFilterToStack(e,p);this._addSharpening(e,h),this._weightMap=null}_addDepthwiseSeparableConvolution(e,t,i,r,o,n=!0){const s=e+"/depthwise_weights",a=e+"/pointwise_weights",l=t.getLastIndex()===i,d=t.addFilter(new Bf({inputs:[{name:"x",type:l?ke.PREVIOUS:ke.DATA,data:i},{name:"w",type:ke.DATA,data:s}],stride:r,padding:"same",padMethod:"edge"}));s.indexOf("final_conv")>=0&&(this._finalConvIndex=d);const c=t.addFilter(new Pf({inputs:[{name:"x",type:ke.PREVIOUS},{name:"w",type:ke.DATA,data:a}],stride:1,padding:"valid"})),p=dp.addFiltersForReduceSumOperationToGraph(t,c,[1,2]),h=t.addFilter(new Mf({inputs:[{name:"sum",type:ke.PREVIOUS},{name:"x",type:ke.INDEX,data:c}]}));dp.addFiltersForReduceSumOperationToGraph(t,h,[1,2]);const m=e+"/instance_norm/shift",b=e+"/instance_norm/scale";return t.addFilter(new Lf({inputs:[{name:"variance",type:ke.PREVIOUS},{name:"sum",type:ke.INDEX,data:p},{name:"x",type:ke.INDEX,data:c},{name:"shift",type:ke.DATA,data:m},{name:"scale",type:ke.DATA,data:b}],addRelu:n})),t.getLastIndex()}_addResidualBlock(e,t,i){const r=this._addDepthwiseSeparableConvolution(e+"/conv1",t,i,1,"same"),o=this._addDepthwiseSeparableConvolution(e+"/conv2",t,r,1,"same",!1),n=t.getLastIndex()===o;return t.addFilter(new Af({inputs:[{name:"x",type:ke.INDEX,data:i},{name:"y",type:n?ke.PREVIOUS:ke.INDEX,data:o}]})),t.getLastIndex()}_addUpsampling(e,t,i){const[r,o,n]=t.getLogicalShapeAtIndex(i),s=t.getLastIndex()===i,a=t.addFilter(new vc({inputs:[{name:"x",type:s?ke.PREVIOUS:ke.INDEX,data:i}],size:[o*2,n*2]}));return this._addDepthwiseSeparableConvolution(e+"/conv",t,a,1,"same")}_addEdgePadding(e,t,i,r){const[,o,n,s]=e.getLogicalShapeAtIndex(t),a=e.getLastIndex()===t,l=fl.calculatePadding("same",o,n,r,r,i,i).padInfo,d=[[0,0],[l.top,l.bottom],[l.left,l.right],[0,0]];return e.addFilter(new zf({inputs:[{name:"x",type:a?ke.PREVIOUS:ke.INDEX,data:t}],paddings:d}))}_addPackFilterToStack(e,t){const i=e.getLogicalShapeAtIndex(t),r=e.getLastIndex()===t,o=new If({inputs:[{name:"x",type:r?ke.PREVIOUS:ke.INDEX,data:t}],outputSize:i.slice(1,3)});if(i[3]===3)return e.addFilter(o);throw new Error("Couldn't add pack filter due to channel count mismatch (expected RGB output).")}_addSharpening(e,t){var i=e.getLastIndex()===t;e.addFilter(new Nf({inputs:[{name:"x",type:i?ke.PREVIOUS:ke.INDEX,data:t}]}))}dispose(){this._graph&&this._graph.dispose(),this._graph=null}}bl.prototype.availableOptions={weightURL:{type:f.STRING,required:!0},tileEdgeLength:{type:f.NUMBER,default:256},overlappingFactor:{type:f.NUMBER,default:.4}};var xE=bl;class s6 extends Be{_calculateOutputShape(){return this._options.inputs[0].logicalShape}_getTensorOperationSource(){let e=`
const float FLOAT_MAX = 1.70141184e38;
const float FLOAT_MIN = 1.17549435e-38;

lowp vec4 encode_float(highp float v) {
  if (isNaN(v)) {
    return vec4(255, 255, 255, 255);
  }

  highp float av = abs(v);

  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
  }

  highp vec4 c = vec4(0,0,0,0);

  highp float e = floor(log2(av));
  highp float m = exp2(fract(log2(av))) - 1.0;

  c[2] = floor(128.0 * m);
  m -= c[2] / 128.0;
  c[1] = floor(32768.0 * m);
  m -= c[1] / 32768.0;
  c[0] = floor(8388608.0 * m);

  highp float ebias = e + 127.0;
  c[3] = floor(ebias / 2.0);
  ebias -= c[3] * 2.0;
  c[2] += floor(ebias) * 128.0;

  c[3] += 128.0 * step(0.0, -v);

  return c / 255.0;
}
    `;return this._options.inputs[0].logicalShape.length===4?e+=`
void main ()
{
  ivec4 coords = getOutputCoords();
  float xVal = getX(coords.x, coords.y, coords.z, coords.w);
  gl_FragColor = encode_float(xVal);
}
    `:e+=`
void main ()
{
  ivec2 coords = getOutputCoords();
  float xVal = getX(coords.x, coords.y);
  gl_FragColor = encode_float(xVal);
}
    `,e}}var wE=s6;class CE extends Be{_calculateOutputShape(){const{paddings:e}=this._options;if(!this.getInputs().length===1||this.getInputs().length===0)throw new Error("ReflectionPadFilter requires single input.");const t=this.getInputs()[0].logicalShape;if(e.length!==t.length)throw new Error(`Not enough or too many paddings for input shape ${t}`);return e.map((i,r)=>i[0]+t[r]+i[1])}_getTensorOperationSource(){const e=this.getInputs()[0].logicalShape,t=e.length,i=this._options.paddings.map(a=>a[0]).join(","),r=this._options.paddings.map(a=>a[1]).join(","),o=`
      int reflectedIndexInInputForPadBefore(int coord, int start) {
        return int(abs(float(start - coord)));
      }

      int reflectedIndexInInputForPadAfter(int coord, int start,
        int length, int afterPad) {
        int indexInPad = coord - start - length;
        int index = length - indexInPad - 2;
        return index;
      }
    `,n=`
      ivec2 get2DCoordinates(
        ivec2 outC,
        ivec2 coords,
        ivec2 start,
        ivec2 end,
        ivec2 afterPad,
        int height,
        int width) {

        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          // Select non-padding rows
          if (outC.x >= start.x && outC.x < start.x + height) {
            // Select before pad columns
            if (outC.y < start.y) {
              int yIndex =
                reflectedIndexInInputForPadBefore(outC.y, start.y);
              return ivec2(coords.x, yIndex);
            // Select after pad columns
            } else if (outC.y >= start.y + width) {
              int yIndex =
                reflectedIndexInInputForPadAfter(outC.y, start.y,
                  width, afterPad.y);
              return ivec2(coords.x, yIndex);
            }

          // Select top and bottom rows, but only non-padding columns
          } else if (outC.y >= start.y && outC.y < start.y + height) {
            // Select top padding rows
            if (outC.x < start.x) {
              int xIndex =
                reflectedIndexInInputForPadBefore(outC.x, start.x);
              return ivec2(xIndex, coords.y);
            // Select bottom padding rows
            } else {
              int xIndex =
                reflectedIndexInInputForPadAfter(outC.x, start.x, height,
                  afterPad.x);
              return ivec2(xIndex, coords.y);
            }

          // Handle diagonal corner cases
          } else if (outC.x < start.x && outC.y < end.y) { // Top Left
            ivec2 index = outC - start;
            vec2 absIndex = vec2(abs(float(index.x)), abs(float(index.y)));
            return ivec2(int(absIndex.x), int(absIndex.y));
          } else if (outC.x < start.x && outC.y >= end.y) { // Top Right
            int targetCol =
              reflectedIndexInInputForPadAfter(outC.y, start.y, width,
                afterPad.y);
            int targetRow =
              reflectedIndexInInputForPadBefore(outC.x, start.x);
            return ivec2(targetRow, targetCol);
          } else if (outC.x >= end.x && outC.y < end.y) { // Bottom Left
            int targetRow =
              reflectedIndexInInputForPadAfter(outC.x, start.x, height,
                afterPad.x);
            int targetCol =
              reflectedIndexInInputForPadBefore(outC.y, start.y);
            return ivec2(targetRow, targetCol);
          } else if (outC.x >= end.x && outC.y >= end.y) { // Bottom Right
            int targetRow =
              reflectedIndexInInputForPadAfter(outC.x, start.x, height,
                afterPad.x);
            int targetCol =
              reflectedIndexInInputForPadAfter(outC.y, start.y, width,
                afterPad.y);
            return ivec2(targetRow, targetCol);
          }
        } else {
          return coords;
        }
      }
    `,s=`
      ivec3 get3DCoordinates(
        ivec3 outC,
        ivec3 coords,
        ivec3 start,
        ivec3 end,
        ivec3 afterPad,
        int length,
        int height,
        int width) {
        if (any(lessThan(outC, start))
          || any(greaterThanEqual(outC, end))) {

          // Calculate the current positions inner indices in the original
          // input tensor
          ivec2 innerIndices = get2DCoordinates(
            ivec2(outC.y, outC.z),
            ivec2(coords.y, coords.z),
            ivec2(start.y, start.z),
            ivec2(end.y, end.z),
            ivec2(afterPad.y, afterPad.z),
            height,
            width
          );

          if (outC.x < start.x) {
            int outerIndex =
              reflectedIndexInInputForPadBefore(outC.x, start.x);
            return ivec3(outerIndex, innerIndices.x, innerIndices.y);
          } else if (outC.x >= end.x) {
            int outerIndex = reflectedIndexInInputForPadAfter(
              outC.x, start.x, length, afterPad.x);
            return ivec3(outerIndex, innerIndices.x, innerIndices.y);
          } else {
            return ivec3(coords.x, innerIndices.x, innerIndices.y);
          }
        } else {
          return coords;
        }
      }
    `;if(t===1)return`
        int start = ${i};
        int end = start + x_shape;
        int width = x_shape[0];
        int afterPad = ${r};

        ${o}

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            int index = reflectedIndexInInputForPadBefore(outC, start);
            setOutput(getX(index));
          } else if (outC >= end) {
            int index =
            reflectedIndexInInputForPadAfter(outC, start, width, afterPad);
            setOutput(getX(index));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;if(t===2)return`
        ivec2 start = ivec2(${i});
        ivec2 end = start + x_shape;
        ivec2 afterPad = ivec2(${r});
        int height = x_shape[0];
        int width = x_shape[1];

        ${o}
        ${n}

        void main() {
          ivec2 outC = getOutputCoords();
          ivec2 coords = outC - start;
          ivec2 coordsInSrcVec = get2DCoordinates(
            outC,
            coords,
            start,
            end,
            afterPad,
            height,
            width
          );
          setOutput(getX(coordsInSrcVec.x, coordsInSrcVec.y));
        }
      `;if(t===4)return`
        ivec4 start = ivec4(${i});
        ivec4 end = start + x_shape;
        ivec4 afterPad = ivec4(${r});
        int length = x_shape[0];

        ${o}
        ${n}
        ${s}

        void main() {
          ivec4 outC = getOutputCoords();
          ivec4 coords = outC - start; // Coords in input

          if (any(lessThan(outC, start))
              || any(greaterThanEqual(outC, end))) {

            ivec3 innerIndices = get3DCoordinates(
              ivec3(outC.y, outC.z, outC.w),
              ivec3(coords.y, coords.z, coords.w),
              ivec3(start.y, start.z, start.w),
              ivec3(end.y, end.z, end.w),
              ivec3(afterPad.y, afterPad.z, afterPad.w),
              x_shape[1],
              x_shape[2],
              x_shape[3]
            );

            if (outC.x < start.x) {
              int outerIndex =
                reflectedIndexInInputForPadBefore(outC.x, start.x);
              setOutput(getX(
                  outerIndex,
                  innerIndices.x,
                  innerIndices.y,
                  innerIndices.z
                ));
            } else if (outC.x >= end.x) {
              int outerIndex = reflectedIndexInInputForPadAfter(
                outC.x, start.x, length, afterPad.x);
              setOutput(getX(
                outerIndex,
                innerIndices.x,
                innerIndices.y,
                innerIndices.z
              ));
            } else {
              setOutput(getX(
                coords.x,
                innerIndices.x,
                innerIndices.y,
                innerIndices.z));
            }
          } else {
            setOutput(getX(coords.x, coords.y, coords.z, coords.w));
          }
        }
      `}}CE.prototype.availableOptions=Object.assign({paddings:{type:f.ARRAY,required:!0}},Be.prototype.availableOptions);var SE=CE;const a6={AddFilter:Af,Conv2DDepthwiseFilter:Bf,Conv2DFilter:Pf,EdgePadFilter:zf,EncodeFloatFilter:wE,FeatheredMaskingFilter:Of,FinalizeStyleFilter:Ff,InstanceNormReluFilter:Lf,PackRGBAFilter:If,ReduceSumFilter:dp,ReflectionPadFilter:SE,ResizeBilinearFilter:vc,SharpenFilter:Nf,TensorFilter:Be,UnpackRGBAFilter:Df,VariancePreparationFilter:Mf};var TE=a6;const{OverlayFilter:Uf}=A.Filters,l6=5;class _c extends Ge{constructor(...e){super(...e);this._renderStart=null;this._renderedOverlaySprite=new A.Sprite,this._renderedOverlayContainer=new A.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayFilter=new Uf,this._overlayFilter.getShaderForRenderer(this._sdk.getRenderer()),this._sdk.on("new-image",this._onNewImage.bind(this)),this._prepareRenderTargets()}static isSupported(e){if(e.getRenderer().isOfType(Ee.WEBGL)){const t=e.getRenderer().getContext(),{environmentSupported:i}=Rf.determineSupportedConfiguration(t),r=!F.isMobile();return i&&r}return!1}setOption(e,t){if(e==="styleTransferModel"){const i=this._options.styleTransferModel;i&&i!==t&&this._renderInputImageIntoOverlayTarget()}if(super.setOption(e,t),e==="identifier"||e==="styleTransferModel"){const i=this._options.styleTransferModel;i&&i.onWeightsUpdated(()=>{this._renderInputImageIntoOverlayTarget()})}}_onNewImage(){this.dispose(),this._prepareRenderTargets();const e=this.getStyleTransferModel();e&&e.updateInputDimensions(this._exifAdjustedInputDimensions)}_prepareRenderTargets(){const e=this._sdk.getRenderer(),t=e.getContext(),i=this._sdk.getInputTexture();var r=i.getDimensions();const o=this._sdk.getOperationsStack().getByIdentifier("exif-orientation");if(o){r=o.getNewDimensions(r);const s=new A.WebGLRenderTarget(e,r.x,r.y,1);s.setFrame(new H.Rectangle(0,0,r.x,r.y));const a=e.getOrCreateGLTexture(s.getBaseTexture()),l=o.applyTo(this._sdk.getImage());t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,l),this._modelInputTarget=s}else{const s=new A.WebGLRenderTarget(e,r.x,r.y,1);s.setFrame(new H.Rectangle(0,0,r.x,r.y)),s._baseTexture=i.getBaseTexture();let a=s._baseTexture.getGLTextureForRenderer(e);a||(a=t.createTexture(),s._baseTexture.setGLTextureForRenderer(a,e)),s._texture=a,t.bindTexture(t.TEXTURE_2D,a),t.bindFramebuffer(t.FRAMEBUFFER,s._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),this._modelInputTarget=s}this._overlayRenderTexture=new A.RenderTexture(e,r.x,r.y);const n=this._overlayRenderTexture.getBaseTexture();n.setGLUnit(l6),this._sdk.getRenderer().updateTexture(n,!1),this._overlayRenderTarget=this._overlayRenderTexture.getRenderTarget(),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture),this._exifAdjustedInputDimensions=r,this._renderInputImageIntoOverlayTarget()}_renderInputImageIntoOverlayTarget(){const e=this._sdk.getRenderer(),t=e.getContext(),i=this._modelInputTarget.getFrame().getSize();this._modelInputTarget.activate(),t.bindTexture(t.TEXTURE_2D,this._overlayRenderTarget.getTexture()),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,i.x,i.y,0)}_render(e){return Z(this,null,function*(){const{intensity:t,blendMode:i}=this._options;let r=this.getStyleTransferModel();return r?(r.isDisposed()&&(yield r.initGraph(this._sdk.getRenderer())),r.isDirty()&&(yield r.execute(this._sdk.getRenderer(),this._modelInputTarget,this._overlayRenderTarget)),this._overlayFilter.set({blendMode:i,overlayImage:this._overlayRenderTarget.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:t}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),ce.resolve(r.isDirty())):(this._sprite.setFilters([]),this._renderTexture.render(this._container),ce.resolve())})}dispose(){if(super.dispose(),this._renderedOverlaySprite.dispose(),this._overlayFilter.dispose(),this._overlayRenderTarget.dispose(),this._modelInputTarget){const t=this._modelInputTarget._framebuffer,i=this._sdk.getRenderer().getContext();i.deleteFramebuffer(t),this._modelInputTarget=null}const{styleTransferModel:e}=this._options;e&&e.dispose()}}_c.identifier="artfilter";_c.prototype.availableOptions={identifier:{type:f.STRING,default:""},styleTransferModel:{type:f.OBJECT,default:null},intensity:{type:f.NUMBER,default:1},blendMode:{type:f.NUMBER,default:Uf.BLEND_MODES.NORMAL,available:Object.keys(Uf.BLEND_MODES).map(e=>Uf.BLEND_MODES[e])}};_c.StyleTransferModel=xE;_c.TensorFilters=TE;ue.Operations.ArtFilterOperation=_c;var kE=_c;const{Vector2:Hf}=H;class Gf extends Ge{constructor(...e){super(...e);this._flipContainer=new A.Container}_render(e){const{position:t,rotation:i,scale:r,pivot:o,outputResolution:n}=this._options,s=this._sdk.getTextureScale(),a=n.clone().multiply(s).ceil();return this._renderTexture.resizeTo(a),this._sprite.setRotation(i),this._sprite.setPosition(t),this._sprite.setPivot(o),this._sprite.setScale(r),this._renderTexture.render(this._container),ce.resolve()}getNewDimensions(e){const t=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(t).ceil()}}Gf.identifier="output";Gf.prototype.availableOptions={position:{type:f.VECTOR2,default:new Hf(0,0)},rotation:{type:f.NUMBER,default:0},scale:{type:f.VECTOR2,default:new Hf(1,1)},pivot:{type:f.VECTOR2,default:new Hf(0,0)},outputResolution:{type:f.VECTOR2,default:new Hf(100,100)}};ue.Operations.OutputOperation=Gf;var EE=Gf;const{Vector2:kbe}=H;class jf extends Ge{constructor(...e){super(...e);this._flipContainer=new A.Container}_render(e){const{outputResolution:t,flipHorizontally:i,flipVertically:r}=this._options;if(i||r){const o=e.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(o):(this._flipRenderTexture=new A.RenderTexture(this._sdk.getRenderer(),o.x,o.y),this._flipSprite=new A.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));const n=i?-1:1,s=r?-1:1;this._flipSprite.setScale(n,s),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(o.x*(1-n)*.5,o.y*(1-s)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return ce.resolve()}}jf.identifier="flip";jf.prototype.availableOptions={flipHorizontally:{type:f.BOOLEAN,default:!1},flipVertically:{type:f.BOOLEAN,default:!1}};ue.Operations.FlipOperation=jf;var DE=jf;const d6=[IT,FT,Ck,Sk,Ik,Ak,Bk,Mk,zk,Hk,qk,rE,sE,aE,kE,EE,DE];ue.AllOperations=d6;function c6(){const{userAgent:e,appVersion:t}=navigator;return t.indexOf("MSIE")!==-1?t.match(/MSIE\s+?([0-9]+)/i)[1]:e.indexOf("Trident")!==-1?e.match(/rv:([0-9]+)/i)[1]:!1}var IE={getIEVersion:c6};const h6=ue.Utils,Wf=ue.Math.Vector2,p6={getInnerDimensionsForElement(e){let t=new Wf(e.offsetWidth,e.offsetHeight);const i=window.getComputedStyle(e,null);return t.x-=parseInt(i.getPropertyValue("padding-left"),10),t.x-=parseInt(i.getPropertyValue("padding-right"),10),t.y-=parseInt(i.getPropertyValue("padding-top"),10),t.y-=parseInt(i.getPropertyValue("padding-bottom"),10),t},getEventPosition(e){let t=e.clientX,i=e.clientY;if(e.type.indexOf("touch")!==-1){if(!e.touches.length)return;t=e.touches[0].clientX,i=e.touches[0].clientY}return new Wf(t,i)},createTransparentPatternCanvas(){const e=document.createElement("canvas"),t=e.getContext("2d");return e.width=10,e.height=10,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#cccccc",t.fillRect(0,0,e.width/2,e.height/2),t.fillRect(e.width/2,e.height/2,e.width,e.height),e},supportsMSBlob(){let e=document.createElement("canvas");return typeof e.msToBlob!="undefined"},translate(e,t,i={}){let r=this.fetch(e,t);if(!r)return W.info("Utils#translate",`Unable to translate \`${t}\``),null;for(let o in i)r=r.replace(`\${${o}}`,i[o]);return r},fetch(e,t,i){t=t.replace(/\[(\w+)]/g,".$1"),t=t.replace(/^\./,"");const r=t.split(".");for(let o=0;o<r.length;o++){const n=r[o];if(e=e[n],!e)break}return typeof e=="undefined"?!1:e},isMobile(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},select(e,t,i=null){i||(i=o=>o);const r=[];return t.forEach(o=>{e.forEach(n=>{const s=i(n);s===o&&r.push(n)})}),r},getJSONP(e){const t=new lr(e);return t.load()},cloneCategories(e,t){return e.map(i=>(i=h6.clone(i),i[t]=i[t].slice(0),i))},mergeCategories(e,t,i){e=this.cloneCategories(e,i);let r=null;return t.forEach(o=>{e.forEach(n=>{o.identifier===n.identifier&&(r=n)}),r?r[i]=r[i].concat(o[i]):e.push(o)}),e},wrapFiltersInCategories(e,t){return e.map(i=>{let r=i;return t in r||(r={identifier:`imgly_filters_wrapped-${i.identifier}`,displayFlat:!0,[t]:[i]}),r})},getStyleObject(e){const t=window.getComputedStyle(e);let i={};for(let r in t){const o=t.getPropertyValue(r),n=r.replace(/-([a-z])/g,(s,a)=>a.toUpperCase());o!==""&&(i[n]=o)}return i},styleElement(e,t){for(let i in t)e.style[i]=t[i]},debounce(e,t,i){var r;return function(){const o=arguments;var n=()=>{r=null,i||e.apply(this,o)},s=i&&!r;clearTimeout(r),r=setTimeout(n,t),s&&e.apply(this,o)}},getScrollbarWidth(){const e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);const t=e.offsetWidth;e.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",e.appendChild(i);const r=i.offsetWidth;return e.parentNode.removeChild(e),t-r},findIntegerFraction(e,t=100){let i=Number.MAX_VALUE,r=0,o=0,n=1,s=1;for(let a=0;a<t;a++){let l=n/s-e;if(l<0)n++;else if(l>0)s++;else return new Wf(n,s);let d=Math.abs(n/s-e);d<i&&(i=d,r=n,o=s)}return new Wf(r,o)},toFixed(e,t=2){const i=e.toFixed(t);return parseFloat(i)},capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},flipObject(e){const t={};for(let i in e)t[e[i]]=i;return t},Browser:IE};var wi=p6;const u6=y(y({},Yd),{LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"});var OE=u6;var RE=[{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:2048,ascender:1919,descender:-409}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:2048,ascender:2332,descender:-583}}]},{fontFamily:"Bernier",variations:[{identifier:"imgly_font_bernier_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_bernier_regular.woff",textMetrics:{unitsPerEm:2048,ascender:2007,descender:-552}}]},{fontFamily:"Cheque",variations:[{identifier:"imgly_font_cheque_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_cheque_regular.woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-495}}]},{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-640}}]},{fontFamily:"Gagalin",variations:[{identifier:"imgly_font_gagalin_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_gagalin_regular.woff",textMetrics:{unitsPerEm:2048,ascender:1987,descender:-628}}]},{fontFamily:"Hagin",variations:[{identifier:"imgly_font_hagin_caps_thin",fontWeight:200,provider:"file",filePath:"fonts/imgly_font_hagin_caps_thin.woff",textMetrics:{unitsPerEm:2048,ascender:1964,descender:-482}}]},{fontFamily:"Intro",variations:[{identifier:"imgly_font_intro_inline",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_intro_inline.woff",textMetrics:{unitsPerEm:2048,ascender:1944,descender:-548}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:2048,ascender:2048,descender:-552}}]},{fontFamily:"Nexa",variations:[{identifier:"imgly_font_nexa_script",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_nexa_script.woff",textMetrics:{unitsPerEm:2048,ascender:1835,descender:-663}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}}]},{fontFamily:"Panton",variations:[{identifier:"imgly_font_panton_black_italic_caps",fontWeight:800,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_blackitalic_caps.woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-572}},{identifier:"imgly_font_panton_light_italic_caps",fontWeight:200,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_lightitalic_caps.woff",textMetrics:{unitsPerEm:2048,ascender:1961,descender:-556}}]},{fontFamily:"Perfograma",variations:[{identifier:"imgly_font_perfograma",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_perfograma.woff",textMetrics:{unitsPerEm:2048,ascender:1982,descender:-842}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:2048,ascender:1554,descender:-663}}]}];var AE=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-640}}]},{fontFamily:"Gagalin",variations:[{identifier:"imgly_font_gagalin_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_gagalin_regular.woff",textMetrics:{unitsPerEm:2048,ascender:1987,descender:-628}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:2048,ascender:1849,descender:-1123}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:2048,ascender:2272,descender:-686}}]},{fontFamily:"Panton Caps",variations:[{identifier:"imgly_font_panton_light_italic_caps",fontWeight:"lighter",fontStyle:"italic",provider:"file",filePath:"text-design/fonts/imgly_font_panton_light_italic_caps.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_black_italic_caps",fontWeight:800,fontStyle:"italic",provider:"file",filePath:"text-design/fonts/imgly_font_panton_black_italic_caps.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_light_caps",fontWeight:"lighter",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_panton_light_caps.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}},{identifier:"imgly_font_panton_black_caps",fontWeight:800,fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_panton_black_caps.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:940,descender:-260}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Summer Font",variations:[{identifier:"imgly_font_summer_font_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_summer_font_light.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"text-design/fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"text-design/fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:2048,ascender:1513,descender:-235}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"text-design/fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]}];var FE=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}];const PE=[];typeof ue.Operations.SpriteOperation!="undefined"&&PE.push(ue.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);var BE={TRANSFORM_RATIO_CATEGORIES:FE,FONTS:RE,TEXT_DESIGN_FONTS:AE,BRUSHES:PE};var wt={EVENTS:OE,DEFAULTS:BE};const Vf=ue.Base64,qe=ue.Color,wye=ue.Math.ColorMatrix,cp=ue.EventEmitter,Cye=ue.EXIF,Sye=ue.OptionType,xc=ue.Promise,Ue=ue.Utils,Qs=ue.RenderType,r_=ue.ImageFormat,oe=ue,Tye=ue.UniformType,Me=ue.Math.Vector2,kye=ue.Math.Rectangle,Eye=ue.Math.Range,Dye=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Sh();class wc{static downloadDataURL(e,t="photoeditorsdk-export"){const i=this.createBlobURLFromDataURL(e),r=this.getExtensionFromDataURL(e);let o=document.createElement("a");o.download=`${t}.${r}`,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o)}static downloadMSBlob(e,t="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(e,`${t}.png`)}static getExtensionFromDataURL(e){const t=e.split(",")[0].split(":")[1].split(";")[0];return t.split("/").pop()}static createBlobURLFromDataURL(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return e;const t=Vf.decode(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let s=0;s<t.length;s++)o[s]=t[s];const n=new window.Blob([r],{type:i});return window.URL.createObjectURL(n)}}class o_{constructor(e,t,i){this._sdk=e,this._options=t,this._download=i}export(){let e=this._getRenderType();return this._sdk.export(e,this._options.format,this._options.quality).then(t=>(this._download&&this._downloadData(e,t),t))}_downloadData(e,t){switch(e){case Qs.DATAURL:wc.downloadDataURL(t,this._options.fileBasename);break;case Qs.MSBLOB:wc.downloadMSBlob(t,this._options.fileBasename);break}}_getRenderType(){const e=this._options;return e.type!==Qs.IMAGE||!this._download?e.type:wi.supportsMSBlob()?Qs.MSBLOB:Qs.DATAURL}}class Kf extends _e{}Kf.prototype.availableOptions={fontFamily:{type:f.STRING,required:!0},variations:{type:f.ARRAY,required:!0}};const m6={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"};class Cc extends _e{getLabel(){let e=m6[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic";break}return e}}Cc.prototype.availableOptions={identifier:{type:f.STRING,required:!0},fontFamily:{type:f.STRING,required:!0},fontWeight:{type:f.ALL,default:400},fontStyle:{type:f.STRING,default:"normal"},textMetrics:{type:f.OBJECT,default:null},provider:{type:f.STRING,available:["google","file"]},filePath:{type:f.STRING},default:{type:f.BOOLEAN,default:!1},font:{type:f.OBJECT}};class Yi{constructor(e,t){this._ui=e,this._options=t,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){let{fonts:e,replaceFonts:t,availableVariations:i,isTextDesign:r}=this._options,o=!0;o=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();let n=r?wt.DEFAULTS.TEXT_DESIGN_FONTS:wt.DEFAULTS.FONTS;o&&(t?n=e:n=n.concat(e||[]));let s;n=n.map(a=>{const{fontFamily:l}=a;let d=a.variations;if(o&&i&&(d=d.filter(p=>i.indexOf(p.identifier)!==-1)),d.length===0)return null;const c=new Kf({fontFamily:l});return d=d.map(p=>{const h=new Cc(p);return h.setFontFamily(l),h.setFont(c),p.default&&!s&&(s=h),h.getTextMetrics()==null&&W.warn(`Missing font metrics for ${h.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[h.getIdentifier()]=h,h}),c.setVariations(d),this._fontsByFontFamily[l]=c,c}).filter(a=>a),s||(s=n[0].getVariations()[0]),this._defaultVariation=s,this._fonts=n}getFonts(){return this._fonts}getFontByFontFamily(e){return this._fontsByFontFamily[e]}getVariationByIdentifier(e){return this._variationsByIdentifier[e]}getVariationsByIdentifier(){return y({},this._variationsByIdentifier)}getDefaultVariation(){return this._defaultVariation}}class n_{constructor(e,t,i){this._image=e,this._maxPixels=t,this._maxDimensions=i}needsResize(){const e=new Me(this._image.width,this._image.height),t=e.x*e.y,i=t>this._maxPixels,r=this._maxDimensions!==null&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return i||r}resize(){let e=null,t=null;const i=this._maxDimensions;return new xc((r,o)=>{window.setTimeout(()=>{const n=new Me(this._image.width,this._image.height),s=n.clone();if(s.x*s.y>this._maxPixels&&(s.copy(this._getDimensionsByMaxPixels()),e="maxMegaPixels"),i!==null&&(s.x>i||s.y>i)){let a=Math.min(i/s.x,i/s.y);s.multiply(a),e="maxDimensions"}s.floor(),t=this._createResizedImageCanvas(s),r({canvas:t,dimensions:s,reason:e})},1e3)})}_createResizedImageCanvas(e,t=e){const i=this._image,r=document.createElement("canvas");r.width=e.x,r.height=e.y;const o=e.clone().subtract(t).divide(2),n=r.getContext("2d");return n.drawImage(i,0,0,i.width,i.height,o.x,o.y,t.x,t.y),r}_getDimensionsByMaxPixels(){const e=this._image,t=this._maxPixels,i=e.width/e.height,r=e.height/e.width;return new Me(Math.sqrt(t*i),Math.sqrt(t*r)).floor()}}class s_{constructor(e,t,i){this._editor=e,this._sdk=t,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(e){return!!this._map[e]}add(e){const t=e.constructor.identifier;e.on("update",()=>{this._mediator.emit(wt.EVENTS.OPERATION_UPDATED,e)});const i=this._preferredOrder.indexOf(t);if(i===-1)throw new Error(`EditorOperations#add: \`${t}\` does not appear in \`operationsOrder\``);this._stack.set(i,e),this._map[t]=e,this._mediator.emit(wt.EVENTS.OPERATION_CREATED,e)}remove(e,t=!0){const i=typeof e=="object"?e.constructor.identifier:e,r=this._stack.getStack();e=this.get(i),delete this._map[i];const o=r.map(n=>n.constructor.identifier).indexOf(i);if(o!==-1){this._stack.removeAt(o);for(let n=o+1;n<r.length;n++){const s=r[n];if(!s)continue;s.setDirty(!0)}t&&this._mediator.emit(wt.EVENTS.OPERATION_REMOVED,e)}}get(e){return this._map[e]}getOrCreate(e,t={}){if(this._map[e]){const i=this._map[e];return i.set(t,!1),i}else{const i=this._available[e],r=new i(this._sdk,t);return this.add(r),r}}getStack(){return this._stack}reset(){this._map={}}_fixStack(){const e=this._stack.getStack().slice();this._stack.clear(),e.forEach(t=>{this.add(t)})}}const Sc=Math.PI*2;class ld{constructor(e){this._editor=e,this._serializeOperations=this._serializeOperations.bind(this)}serialize(e={}){this._options=Ue.defaults(e,{image:!0});const t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}_serializeInputImage(e){const t=this._editor.getImage(),{width:i,height:r}=t;if(!this._options.image)return e.inputImage={width:i,height:r},Promise.resolve(e);const o=Ue.createCanvas();o.width=t.width,o.height=t.height;const n=o.getContext("2d");n.drawImage(t,0,0);const s=o.toDataURL(r_.PNG);return e.inputImage={type:r_.PNG,data:s.replace(/^data:image\/(.*?);base64,/,""),width:i,height:r},Promise.resolve(e)}_serializeOperations(e){const t=[],i=this._editor.operations.getStack();return i.forEach(r=>{const o=this._serializeOperation(r,t);o&&t.push(o)}),e.operations=t.filter(r=>r),Promise.resolve(e)}_serializeOperation(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:W.warn(`Unable to serialize operation of type ${e.constructor.identifier}`)}}_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+Sc)%Sc,{type:"crop",options:t}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(e){return e.getIdentifier()==="identity"?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}_serializeAdjustmentsOperation(e){const{availableOptions:t}=e,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],r={};return i.forEach(o=>{const n=t[o],s=e.getOption(o),{minValue:a,midValue:l,maxValue:d}=n;r[o]=s<=l?(s-a)/(l-a)-1:(s-l)/(d-l)}),{type:"adjustments",options:r}}_serializeSpriteOperation(e,t){const i=t.filter(n=>n.type==="sprite");let r,o=!0;if(i.length?(r=i.pop(),o=!1):r={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(n=>{let s=null;n instanceof e.constructor.StickerSprite?s=this._serializeSticker(e,n):n instanceof e.constructor.TextSprite?s=this._serializeText(e,n):n instanceof e.constructor.BrushSprite?s=this._serializeBrush(e,n):n instanceof e.constructor.TextDesignSprite&&(s=this._serializeTextDesign&&this._serializeTextDesign(e,n)),s&&r.options.sprites.push(s)}),o)return r}_serializeSticker(e,t){const i=t.getAdjustments(),r=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);r.name=r.identifier,delete r.identifier,r.rotation=(r.rotation+Sc)%Sc;const o=i.availableOptions;return r.adjustments={brightness:i.getBrightness()-o.brightness.default,saturation:i.getSaturation()-o.saturation.default,contrast:i.getContrast()-o.contrast.default},{type:"sticker",options:r}}_serializeText(e,t){const i=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return i.rotation=(i.rotation+Sc)%Sc,{type:"text",options:i}}_serializeBrush(e,t){return{type:"brush",options:{paths:t.getPaths().map(i=>this._serializePath(i))}}}_serializePath(e){const t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(i=>i.getPosition().toObject()),t}_serializeRadialFocusOperation(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{if(r===e&&(t=!0),t)return;i=r.getNewDimensions(i)}),i}}ld.version="1.0.0";class cn{constructor(e,t,i=!1){this._ui=e,this._options=t,this._categoriesById={},this._filtersByIdentifier={identity:oe.Operations.FilterOperation.Filters.IdentityFilter},this._categories=wi.wrapFiltersInCategories(ko.DEFAULTS.FILTERS.slice(0),cn.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=i||e.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=wi.wrapFiltersInCategories(this._options.categories,cn.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(e){const t={value:this._ui._options.crossOrigin,cors:!0},i=this.getFilterByIdentifier(e);if(!i)return Promise.reject(new Error(`Unknown filter with identifier \`${e}\`!`));if(i.prototype instanceof oe.Operations.FilterOperation.Filter)return Promise.resolve(new i);{const{lutImage:r,resolution:o,horizontalTileCount:n,verticalTileCount:s}=i;let{lightColor:a,darkColor:l}=i;if(a&&l)return a=qe.fromHex(a),l=qe.fromHex(l),Promise.resolve(new oe.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:a,darkColor:l}));{let d;this._ui.getPreloader&&(d=this._ui.getPreloader().getAsset(r));let c;return d?c=Promise.resolve(d):c=Or.loadImage(this._ui.getAssetPath(r),t),c.then(()=>Or.loadImage(this._ui.getAssetPath(r),t).then(p=>new oe.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:p,resolution:o,horizontalTileCount:n,verticalTileCount:s})))}}}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=wi.wrapFiltersInCategories(this._options.categories,cn.CATEGORY_ITEMS_PROPERTY):this._categories=wi.mergeCategories(this._categories,this._options.categories,cn.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){const t=[];this._categories.forEach(i=>{const r=i.filters.filter(o=>this._options.availableFilters.indexOf(o.identifier)!==-1);r.length>0&&t.push({identifier:i.identifier,defaultName:i.defaultName,filters:r})}),this._categories=t}const e={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map(t=>t.filters).reduce((t,i)=>t.concat(i))};this._categories.unshift(e),this._categoriesById.all=e,this._categories.forEach(t=>{this._categoriesById[t.identifier]=t}),e.filters.forEach(t=>{this._filtersByIdentifier[t.identifier]=t})}getFiltersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown filter category '${e}'`);return this._categoriesById[e].filters}getItemsByCategory(e){return this.getFiltersForCategory(e)}getFilterByIdentifier(e){return this._filtersByIdentifier[e]}getCategories(){return this._categories}getCategoryByIdentifier(e){return this._categoriesById[e]}}cn.CATEGORY_ITEMS_PROPERTY="filters";class f6{constructor(){this._assetsByGroupId={}}addAsset(e,t,i=!1){this._assetsByGroupId[e]?i?this._assetsByGroupId[e].unshift(t):this._assetsByGroupId[e].push(t):this._assetsByGroupId[e]=[t]}setAssets(e,t){this._assetsByGroupId[e]=t}getAssets(e){return this._assetsByGroupId[e]=this._assetsByGroupId[e]||[],this._assetsByGroupId[e]}}var ME=f6;const a_="imgly_sticker_custom";class yl{constructor(e,t,i){this._ui=e,this._options=t,this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new ME,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=F.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};const e=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(ko.DEFAULTS.STICKER_CATEGORIES);const{categories:t,replaceCategories:i}=this._options;if(e&&this._options.categories?this._addCategories(t,i):(this._updateCategoriesMap(),this._updateAllCategory()),e){const r=this._dynamicAssetsLibrary.getAssets("sticker");if(r.length>0){let o=this._createCustomStickerCategory(r);this._addCategories([o],!1,!0)}}}loadExternal(e){const t=new lr(e);return t.load().then(i=>{this._addCategories(i.categories,this._options.replaceCategories)})}_addCategories(e,t=!1,i=!1){t?this._categories=e.slice(0):i?this._categories=this._mergeCategories(e,this._categories):this._categories=this._mergeCategories(this._categories,e),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(e,t){e=wi.cloneCategories(e,"stickers");for(const i of t){let r=!1;for(const o of e)if(i.identifier===o.identifier){for(const n of i.stickers){let s=!1;for(const a of o.stickers)if(n.identifier===a.identifier){Object.assign(a,n),s=!0;break}s||o.stickers.push(n)}r=!0;break}r||e.push(i)}return e}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach(e=>{this._categoriesById[e.identifier]=e}),this._categories.forEach(e=>{e.stickers.forEach(t=>{this._stickersById[t.identifier]=t})}),typeof this._options.availableStickers!="undefined"&&this._options.availableStickers!==null&&(this._categories.forEach(e=>{e.identifier!==a_&&(e.stickers=e.stickers.filter(t=>this._options.availableStickers.indexOf(t.identifier)!==-1))}),this._categories=this._categories.filter(e=>e.stickers.length>0)),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(e=>e.stickers).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(e){const t=this._customStickerCanvas,i=t.getContext("2d");i.save();let r=62,o=r/e.width,n=o*e.height;t.width=r,t.height=r,i.clearRect(0,0,e.width,e.height),i.translate(0,.5*(t.height-n)),i.scale(o,o),i.drawImage(e,0,0);let s=t.toDataURL("image/png");return i.restore(),{data:s,width:r,height:n}}addCustomStickerFromImage(e,t,i="none"){const r=g=>{const S=this._ui.getEditor().getSDK(),x=S.getRenderer(),C=new Me(g.width,g.height),R=this._ui.getEditor().getMaxMegapixels()*1e6;let T=x.getMaxDimensions();const k=C.x*C.y>R,M=T!==null&&(C.x>T||C.y>T);if(k){const L=g.width/g.height,ee=g.height/g.width;T=new Me(Math.sqrt(R*L),Math.sqrt(R*ee)).floor().max()}let U=C.clone();return(k||M)&&(C.x/C.y>1?(U.x=T,U.y=T/C.x*C.y):(U.x=T/C.y*C.x,U.y=T)),U},o=(g,S)=>{const x=g.x/g.y;return x>1?new Me(S,S/x):new Me(S*x,S)},n=e.src.substring(0,14)==="data:image/svg",s=this._ui.getEditor().getSDK();e=s.correctExifOrientation(e);const a=o(new Me(e.width,e.height),2048),l=n?a:r(e);let d=this._customStickerCanvas,c=d.getContext("2d");c.save();const p=this.renderStickerThumbnailFromImage(e);n?(e.width>e.height?(d.width=2048,d.height=2048/e.width*e.height):(d.height=2048,d.width=2048/e.height*e.width),e.width=d.width,e.height=d.height):(d.width=l.x,d.height=l.y,c.scale(l.x/e.width,l.y/e.height)),c.drawImage(e,0,0,e.width,e.height);let h=d.toDataURL();c.restore();let m={identifier:F.generateUUID(),defaultName:t||"",tintMode:i,images:{mediaThumb:{uris:[p.data],rawData:!0,width:p.width,height:p.height},mediaBase:{uris:n?[h,e.src]:[h],rawData:!0,isSVG:n,width:l.x,height:l.y}}};const b=this._dynamicAssetsLibrary;b.addAsset("sticker",m,!0);const _=b.getAssets("sticker");if(_.length===1){let g=this._createCustomStickerCategory(_);this._addCategories([g],!1,!0)}else this.getCategory(a_).stickers=_,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(e){return{identifier:a_,defaultName:"Custom",metaData:{backgroundImage:e[e.length-1].images.mediaBase.uris[0],rawData:!0},stickers:e}}getStickersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown sticker category '${e}'`);return this._categoriesById[e].stickers}getStickerByIdentifier(e){return this._stickersById[e]}getCategories(e=!1){return e?[this._allCategory].concat(this._categories):this._categories}getCategory(e){return this._categoriesById[e]}static getURLForSticker(e,t="base"){const{images:i}=e,r=t==="base"&&i.mediaBase||i.mediaThumb,o=r.uris||[r.uri];if(!wi.Browser.getIEVersion()){const s=o.filter(a=>/\.svg$/i.test(a));return s.length?s[0]:o[0]}const n=o.filter(s=>!/\.svg$/i.test(s));return n.length?n[0]:o[0]}}class l_{constructor(e,t){this._ui=e,this._options=t,this._brushes=[],this._brushesById={},this._addBrushes(wt.DEFAULTS.BRUSHES);const{brushes:i,replaceBrushes:r,availableBrushes:o}=this._options;this._options.brushes&&this._addBrushes(i,r),o&&(this._brushes=this._brushes.filter(n=>o.indexOf(n.identifier)!==-1))}_addBrushes(e,t){t&&(this._brushes=[],this._brushesById={}),e.forEach(i=>{this._brushes.push(i),this._brushesById[i.identifier]=i})}getBrushByIdentifier(e){return this._brushesById[e]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}const g6=30,b6="abcdefghijklmnopqrstuvwxzy";class $f{constructor(e){this._fontVariation=e||new Cc({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText=b6,document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${g6}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(e){this._fontVariation=e,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}const LE=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Sh(),y6=50,v6=5e3;class d_{constructor(e){this._fontVariation=e,this._defaultFontRuler=new $f,this._customFontRuler=new $f(this._fontVariation)}observe(){const e=LE();return new Promise((t,i)=>{const r=window.setInterval(()=>{const o=this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth();if(o)return window.clearInterval(r),t();if(LE()-e>=v6){const n=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return n.font=this._fontVariation,i(n)}},y6)})}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}class hp{constructor(e){this._ui=e,this._fonts=[],this._observers=[]}add(e){this._fonts.push(e)}load(){return this._fonts.length===0?Promise.resolve():(this._observers=[],this._fonts.forEach(e=>{this._observers.push(new d_(e))}),F.executePromises(this._observers.map(e=>e.observe())))}dispose(){this._observers.forEach(e=>e.dispose())}}const _6={italic:"i"};class c_ extends hp{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){const e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href=`https://fonts.googleapis.com/css?family=${e}`;const i=document.getElementsByTagName("head")[0];i.appendChild(t)}_getFamiliesString(){const e={};this._fonts.forEach(i=>{const r=i.getFontFamily(),o=i.getFontStyle(),n=i.getFontWeight();e[r]=e[r]||[],typeof n!="undefined"?e[r].push(`${n}${_6[o]||""}`):e[r].push(400)});const t=[];for(let i in e){const r=e[i],o=r.length?`:${r.join(",")}`:"",n=i.replace(" ","+")+o;t.push(n)}return t.join("|")}}class h_ extends hp{load(){return Promise.resolve()}}class vl{constructor(e,t){this._ui=e,this._fonts=t,this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;if(this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()}),!t)continue;return!0}}fontLoaded(e){const t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){const t=e.getFontFamily();this._loadedFonts.push(t)}}load(){const e=this._fonts,t={google:new c_(this._ui),file:new h_(this._ui)},i=()=>{for(let o in t){const n=t[o];n.dispose()}};e.filter(o=>!this.fontLoaded(o)).forEach(o=>{o.getVariations().forEach(n=>{const s=n.getProvider();if(!s)return;const a=t[s];a.add(n)})});const r=[];for(let o in t)r.push(t[o].load());return Promise.all(r).then(()=>{i(),e.forEach(o=>{this.setFontLoaded(o)})}).catch(o=>{throw i(),o})}}let p_;typeof oe.Operations.SpriteOperation!="undefined"&&(p_=oe.Operations.SpriteOperation.BrushSprite);class dd{constructor(e,t){this._editor=e,this._ui=this._editor.getUI(),this._data=t,this._filterManager=new cn(this._ui,this._getOptions("filter")),this._stickerManager=new yl(this._ui,this._getOptions("sticker")),this._brushManager=new l_(this._ui,this._getOptions("brush")),this._fontManager=new Yi(this._ui,this._getOptions("text"))}_getOptions(e){const{controls:t}=this._editor;let i={};t&&t.get(e)&&(i=t.get(e).defaultOptions);const r=this._editor.getOptions();return Ue.deepDefaults({},r.editor.controlsOptions[e]||{},i)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise((e,t)=>{const{data:i,type:r}=this._data.inputImage;if(i&&r){const o=new window.Image;o.addEventListener("load",()=>{this._editor.setImage(o),e()}),o.src=`data:${r};base64,${i}`}else e()})}_deserializeOperations(){return Z(this,null,function*(){const e=this._data.operations,t=[];for(let i=0;i<e.length;i++){const r=e[i],o=yield this._deserializeOperation(r);t.push(o)}return t})}_deserializeOperation(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=Me.fromObject(t.start),o=Me.fromObject(t.end);i>Math.PI&&(i-=Math.PI*2);const n={start:r,end:o};typeof i!="undefined"&&(n.rotation=i);const s=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(s,n),s.set(n),Promise.resolve(s)}_deserializeOrientationOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}_deserializeFilterOperation(e){const{options:t}=e;return this._filterManager.getFilterByIdentifier(t.name)?this._filterManager.instantiateFilterWithIdentifier(t.name).then(i=>{const r=this._editor.operations.getOrCreate("filter");return r.set({identifier:t.name,filter:i,intensity:t.intensity}),r}):(W.warn("Deserializer",`Unknown filter \`${t.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=oe.Operations,{options:i}=e,r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],o={};return r.forEach(n=>{if(typeof i[n]=="undefined")return;const{minValue:s,midValue:a,maxValue:l}=t.prototype.availableOptions[n];let d=i[n];d=d<0?a+(a-s)*d:a+(l-a)*d,o[n]=d}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",o))}_deserializeSpriteOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();const r=t.sprites.map(o=>this._deserializeSprite(i,o)).filter(o=>o);return Promise.all(r).then(o=>(i.setSprites(o.filter(n=>n)),i))}_deserializeSprite(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(e,t)}}_deserializeSticker(e,t){const{SpriteOperation:i}=oe.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.name),n=this._stickerManager.getURLForSticker(o);return o?new Promise((s,a)=>{const l=new window.Image;l.addEventListener("load",()=>{const d=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:c,flipHorizontally:p,flipVertically:h}=r,m={identifier:r.name,image:l,position:Me.fromObject(r.position),dimensions:Me.fromObject(r.dimensions),rotation:c,flipHorizontally:p,flipVertically:h,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(b=>{typeof r.adjustments[b]!="undefined"&&(m.adjustments[b]=r.adjustments[b]+d[b].default)}),s(e.createSticker(m))}),l.crossOrigin=this._editor.getCrossOrigin(),l.src=this._editor.getUI().getAssetPath(n)}):(W.warn("Deserializer",`Unknown sticker '${r.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontFamily:n,fontWeight:s,alignment:a,rotation:l,maxWidth:d,color:c,backgroundColor:p}=i,h=new vl(this._ui);let m=this._fontManager.getFontByFontFamily(n);return m||(m=this._fontManager.getDefaultFont()),h.setFonts([m]),h.load().then(()=>{const b=e.createText({fontSize:r,lineHeight:o,fontFamily:n,fontWeight:s,alignment:a,rotation:l,maxWidth:d,text:i.text,color:qe.fromArray(c),backgroundColor:qe.fromArray(p),position:Me.fromObject(i.position)});return b._edited=!0,b})}_deserializeBrush(e,t){const{options:i}=t,{paths:r}=i,o=e.createBrush();return r.forEach(n=>{this._deserializeBrushPath(o,n)}),Promise.resolve(o)}_deserializeBrushPath(e,t){const{points:i}=t,r=this._createBrushForPath(t),o=e.createPath(r);o.setClosed(!0),i.forEach(n=>{o.addControlPoint(Me.fromObject(n))})}_createBrushForPath(e){const{color:t,size:i}=e,r=qe.fromArray(t),o={color:r,size:i},n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof p_){const s=n;return new s(o)}else{const s=Ue.extend({},n);delete s.image;class a extends p_{}return a.identifier=n.identifier,new a(Ue.extend({},s,o))}}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":{const{position:i,radius:r,gradientRadius:o,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:Me.fromObject(i),radius:r,gradientRadius:o,blurRadius:n}))}case"linear":{const{start:i,end:r,size:o,gradientSize:n,blurRadius:s}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:Me.fromObject(i),end:Me.fromObject(r),size:o,gradientSize:n,blurRadius:s}))}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{if(r===e&&(t=!0),t)return;i=r.getNewDimensions(i)}),i}}dd.version="1.0.0";const zE=Math.PI*2;class cd extends ld{_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+zE)%zE,t.textureScale!==1&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}}}cd.version="1.0.1";class hd extends dd{_deserializeOperation(e){return e.type==="selective-blur"?this._deserializeSelectiveBlurOperation(e):super._deserializeOperation(e)}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=Me.fromObject(t.start),o=Me.fromObject(t.end),n=t.dimensions?Me.fromObject(t.dimensions):null;if(o.x-r.x<=0||o.y-r.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${r} - end: ${o}`);i>Math.PI&&(i-=Math.PI*2);const s={start:r,end:o};typeof i!="undefined"&&(s.rotation=i);const a=this._editor.operations.getOrCreate("transform");if(!a)return Promise.resolve();if(this._editor.broadcastTransform(a,s),a.set(s),n){const l=o.clone().subtract(r),d=a.getInputDimensions(!1).multiply(l);a.setTextureScale(n.x/d.x)}return Promise.resolve(a)}}hd.version="1.0.1";const{OverlayFilter:Xn}=oe.Engine.Filters;var ea={[Xn.BLEND_MODES.NORMAL]:"normal",[Xn.BLEND_MODES.OVERLAY]:"overlay",[Xn.BLEND_MODES.HARD_LIGHT]:"hard light",[Xn.BLEND_MODES.SOFT_LIGHT]:"soft light",[Xn.BLEND_MODES.MULTIPLY]:"multiply",[Xn.BLEND_MODES.DARKEN]:"darken",[Xn.BLEND_MODES.LIGHTEN]:"lighten",[Xn.BLEND_MODES.SCREEN]:"screen",[Xn.BLEND_MODES.COLOR_BURN]:"color burn"};class pd extends cd{_serializeSticker(e,t){const i=e.getInputDimensions(!1),r=super._serializeSticker(e,t);return t.getTintMode()!=="none"&&(r.options.tintColor=t.serializeOption("tintColor",!0)),r.options.dimensions=t.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r}_serializePath(e){const t=super._serializePath(e),i=e.getBrush();return i.hasOption("hardness")&&(t.hardness=i.getOption("hardness")),t}_serializeOperation(e,t){return e.constructor.identifier==="frame"?(this._serializeFrameOperation(e,t),null):e.constructor.identifier==="overlay"?(this._serializeOverlayOperation(e,t),null):super._serializeOperation(e,t)}_serializeFrameOperation(e,t){const i=t.filter(o=>o.type==="sprite");let r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}_serializeOverlayOperation(e,t){if(!e.getIdentifier())return;const i=t.filter(o=>o.type==="sprite");let r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:ea[e.getBlendMode()]}})}_getFrameOptions(e){return{identifier:e.getFrame().identifier}}_serializeOrientationOperation(e){const t=super._serializeOrientationOperation(e);return(t.options.rotation===90||t.options.rotation===270)&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),t}_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const r=t.get("orientation");e.rotate(-r.getRotation()),r.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),r.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1))}const i=super._serializeTransformOperation(e);return i.type="transform",i}_serializeText(e,t){const i=super._serializeText(e,t),r=e.getInputDimensions(!1);return i.options.fontIdentifier=t.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i}_serializeFilterOperation(e){const t=super._serializeFilterOperation(e);return t?(t.options.identifier=t.options.name,delete t.options.name,t):null}_serializeRadialFocusOperation(e){const t=super._serializeRadialFocusOperation(e),i=t.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,t}}pd.version="2.0.0";class u_{constructor(e,t){this._ui=e,this._options=t,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(ko.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=e.getEditor().getSDK()._l.areCustomAssetsAllowed();const{categories:i,replaceCategories:r}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(i,r):this._updateAllCategory()}_addCategories(e,t=!1){t?this._categories=e.slice(0):this._categories=wi.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(r=>{this._categoriesById[r.identifier]=r});const{availableFrames:i}=this._options;this._customAssetsAllowed&&i&&this._categories.forEach(r=>{r.frames=r.frames.filter(o=>i.indexOf(o.identifier)!==-1)}),this._categories.forEach(r=>{r.frames.forEach(o=>{this._framesById[o.identifier]=o})}),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(e=>e.frames).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown frame category '${e}'`);return this._categoriesById[e].frames}getFrameByIdentifier(e){return this._framesById[e]}getCategories(){return this._categories}getCategory(e){return this._categoriesById[e]}}class m_{constructor(e,t){this._ui=e,this._options=t,this._overlays=ko.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};const i=e.getEditor().getSDK()._l.areCustomAssetsAllowed();i&&t.overlays&&(t.replaceOverlays?this._overlays=t.overlays:this._overlays=this._overlays.concat(t.overlays)),i&&t.availableOverlays&&(this._overlays=this._overlays.filter(r=>t.availableOverlays.indexOf(r.identifier)!==-1)),this._overlays.forEach(r=>{this._overlaysByIdentifier[r.identifier]=r})}getOverlays(){return this._overlays}getOverlayByIdentifier(e){return this._overlaysByIdentifier[e]}}const{OptionType:Tc}=oe;class qf extends oe.Configurable{constructor(e,t={}){super(t);this._loaded=!1,this._loading=!1,this._ui=e,this._frame=oe.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;const{imageGroups:e}=this._frame,t=[];return["top","left","right","bottom"].forEach(i=>{if(!(i in e))return;const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r))return;t.push(this._loadPart(i,o))})}),Promise.all(t).then(()=>{this._loaded=!0,this._loading=!1}).catch(i=>{this._loaded=!1,this._loading=!1})}_loadPart(e,t){const{imageGroups:i}=this._frame;let r=i[e][t],o=r;return typeof r!="string"&&"image"in r&&(o=r.image),Or.load(this._ui.getAssetPath(o)).then(n=>(typeof r!="string"?this._frame.imageGroups[e][t].image=n:this._frame.imageGroups[e][t]=n,n))}getFrame(){return this._frame}}qf.prototype.availableOptions={identifier:{type:Tc.STRING,required:!0},defaultName:{type:Tc.STRING},thumbnail:{type:Tc.STRING},tintable:{type:Tc.BOOLEAN,default:!1},layoutMode:{type:Tc.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:Tc.OBJECT,required:!0}};const x6=Ue.flipObject(ea);class ud extends hd{constructor(...e){super(...e);this._frameManager=new u_(this._ui,this._getOptions("frame"));const t=this._getOptions("overlay");t&&(this._overlayManager=new m_(this._ui,t))}_deserializeSprite(e,t){return t.type==="frame"?this._deserializeFrame(e,t):t.type==="overlay"?this._deserializeOverlay(e,t):super._deserializeSprite(e,t)}_deserializeOperation(e){return e.type==="transform"?this._deserializeTransformOperation(e):super._deserializeOperation(e)}_deserializeOrientationOperation(e){if(this._data.meta&&this._data.meta.platform!=="html5")return super._deserializeOrientationOperation(e);let{rotation:t,flipHorizontally:i,flipVertically:r}=e.options,o=t===90&&!i&&!r;return o|=t===90&&i&&r,o|=t===270&&!i&&!r,o|=t===270&&i&&r,o&&(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),super._deserializeOrientationOperation(e)}_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=Ue.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;let{rotation:o,flipHorizontally:n,flipVertically:s}=r;(o===90||o===270)&&((!n&&s||n&&!s)&&(n=!n,s=!s)),t.rotate(r.rotation),n&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),s&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t})}_deserializeFrame(e,t){const{identifier:i}=t.options,r=this._frameManager.getFrameByIdentifier(i);if(!r)return W.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`),Promise.resolve();const o=new qf(this._ui,r);return o.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:o.getFrame()})})}_deserializeOverlay(e,t){const{blendMode:i,intensity:r,identifier:o}=t.options,n=this._overlayManager.getOverlayByIdentifier(o);if(!n)return W.warn("Deserializer",`Unknown overlay \`${o}\`. Skipping overlay.`),Promise.resolve();const s=this._editor.getUI().getAssetPath(n.image);return Or.load(s).then(a=>{this._editor.operations.getOrCreate("overlay",{alpha:r,identifier:o,blendMode:parseInt(x6[i||n.blendMode],10),image:a})})}_createBrushForPath(e){const t=super._createBrushForPath(e);return typeof e.hardness!="undefined"&&t.hasOption("hardness")&&t.setHardness(e.hardness),t}_deserializeSticker(e,t){const{SpriteOperation:i}=oe.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier),n=yl.getURLForSticker(o,"base");if(!o)return W.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();const s=e.getInputDimensions(!1);return new Promise((a,l)=>{const d=new window.Image;d.addEventListener("load",()=>{const c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:p,flipHorizontally:h,flipVertically:m}=r,b={identifier:r.identifier,image:d,position:Me.fromObject(r.position),dimensions:Me.fromObject(r.dimensions).multiply(s.min()),rotation:p,flipHorizontally:h,flipVertically:m,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(_=>{typeof r.adjustments[_]!="undefined"&&(b.adjustments[_]=r.adjustments[_]+c[_].default)}),typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(b.tintColor=qe.fromArray(r.tintColor),b.tintMode=o.tintMode),a(e.createSticker(b))}),d.crossOrigin=this._editor.getCrossOrigin(),d.src=this._editor.getUI().getAssetPath(n)})}_deserializeFilterOperation(e){const{options:t}=e;return this._filterManager.getFilterByIdentifier(t.identifier)?this._filterManager.instantiateFilterWithIdentifier(t.identifier).then(i=>{const r=this._editor.operations.getOrCreate("filter");return r?(r.set({identifier:t.identifier,filter:i,intensity:t.intensity}),r):void 0}):(W.warn("Deserializer",`Unknown filter \`${t.identifier}\``),Promise.resolve())}_deserializeFocusOperation(e){const{options:t,type:i}=e.options;if(i!=="radial")return super._deserializeFocusOperation(e);const r=this._editor.getImage(),o=r.width/r.height,{start:n,end:s,gradientRadius:a,blurRadius:l}=t,d=Me.fromObject(s).subtract(Me.fromObject(n)).multiply(o,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:Me.fromObject(n),radius:d,gradientRadius:a,blurRadius:l}))}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:s,rotation:a,maxWidth:l,color:d,backgroundColor:c}=i,p=new vl(this._ui);let h=this._fontManager.getVariationByIdentifier(n);return h?p.setFonts([h.getFont()]):h=this._fontManager.getDefaultFont(),p.load().then(()=>{const m=e.getInputDimensions(!1),b=l*m.min()/m.x,_=e.createText({fontSize:r,lineHeight:o,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),alignment:s,rotation:a,maxWidth:b,text:i.text,color:qe.fromArray(d),backgroundColor:qe.fromArray(c),position:Me.fromObject(i.position)});return _._edited=!0,_})}}ud.version="2.0.0";class kc extends _e{}kc.prototype.availableOptions={identifier:{type:f.STRING,required:!0},defaultName:{type:f.STRING,required:!0},ratio:{type:f.ALL,required:!1,default:null},selected:{type:f.BOOLEAN,required:!1},dimensions:{type:f.VECTOR2,required:!1},lockDimensions:{type:f.BOOLEAN,required:!1,default:null},forceDimensions:{type:f.BOOLEAN,required:!1,default:null}};class md extends pd{serialize(e={}){return super.serialize(e).then(t=>(t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:Ue.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t))}_serializeSticker(e,t){const i=super._serializeSticker(e,t);return i.options.alpha=t.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}_serializeText(e,t){const i=super._serializeText(e,t);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}_serializePath(e){const t=super._serializePath(e);delete t.hardness,delete t.size,delete t.color;const i=e.getBrush();t.brush=i.serializeOptions(["identifier","size","color"],!0),typeof t.brush.identifier=="undefined"&&delete t.brush.identifier,t.brush.color={rgba:t.brush.color};const r=i.getOption("hardness");return r!=="undefined"&&(t.brush.hardness=r),t}_serializeFrameOperation(e,t){super._serializeFrameOperation(e,t);const i=t.filter(o=>o.type==="sprite");let r;if(i.length){r=i.pop();const o=r.options.sprites.filter(a=>a.type==="frame")[0],n=e.getTintColor();n.equals(new qe(1,1,1,0))||(o.options.tintColor={rgba:e.serializeOption("tintColor",!0)});const s=e.serializeOptions(["scale","alpha"],!0);o.options=Ue.extend(o.options,s),o.options.size=o.options.scale,delete o.options.scale}}_serializeTransformOperation(e){const t=super._serializeTransformOperation(e);if(e._ratio){let i;e._ratio instanceof kc?i=e._ratio.getIdentifier():i=e._ratio.identifier,t.options.meta={identifier:i}}return delete t.options.scale,t}_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e),i=["gamma","whites","blacks","temperature"],{availableOptions:r}=e,o={};return i.forEach(n=>{const s=r[n],a=e.getOption(n),{minValue:l,midValue:d,maxValue:c}=s;o[n]=a<=d?(a-l)/(d-l)-1:(a-d)/(c-d)}),t.options=y(y({},t.options),o),t}_serializeOperation(e,t){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return super._serializeOperation(e,t)}}_serializeMirroredFocusOperation(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(e){const t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}}_serializeBlurOperation(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}}}md.version="3.0.0";class Ro{constructor(e,t={}){this._ui=e,this._options=t,this._defaultLayouts=oe.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){let{availableLayouts:e}=this._options;const t=y(y({},this._defaultLayouts),this._legacyLayouts);this._layouts=Object.keys(t).map(i=>({identifier:t[i].identifier,layout:t[i]})),e&&(e.push(...Object.values(this._legacyLayouts).map(i=>i.identifier)),this._layouts=this._layouts.filter(i=>e.indexOf(i.identifier)>=0))}getLayoutByIdentifier(e){let t=Ue.Array.find(this._layouts,i=>i.identifier===e);return t&&t.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}let f_;typeof oe.Operations.SpriteOperation!="undefined"&&(f_=oe.Operations.SpriteOperation.BrushSprite.Brush);class fd extends ud{_deserializeSticker(e,t){const{SpriteOperation:i}=oe.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier);if(!o)return W.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();const{mediaBase:n}=o.images,s=yl.getURLForSticker(o,"base"),a=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(s),l=e.getInputDimensions(!1);return Or.load(a).then(d=>{const c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:p,flipHorizontally:h,flipVertically:m}=r,b={identifier:r.identifier,image:d,position:Me.fromObject(r.position),dimensions:Me.fromObject(r.dimensions).multiply(l.min()),rotation:p||0,flipHorizontally:h,flipVertically:m,resizeMode:o.resizeMode||"keepAspect",adjustments:{}};return typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(_=>{typeof r.adjustments[_]!="undefined"&&(b.adjustments[_]=r.adjustments[_]+c[_].default)}),typeof r.tintMode!="undefined"&&typeof r.tintColor!="undefined"?(b.tintColor=qe.fromArray(r.tintColor.rgba),b.tintMode=r.tintMode):typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(b.tintColor=qe.fromArray(r.tintColor.rgba),b.tintMode=o.tintMode),typeof r.alpha!="undefined"&&(b.alpha=r.alpha),e.createSticker(b)})}_deserializeTransformOperation(e){return super._deserializeTransformOperation(e).then(t=>t?(t._ratio=null,t):void 0)}_deserializeInputImage(){let{data:e,type:t,uri:i}=this._data.image;return e&&t&&(i=`data:${t};base64,${e}`),i?Or.load(i).then(r=>{this._editor.setImage(r)}):Promise.resolve()}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=oe.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e,o=["gamma","whites","blacks","temperature"],n={};return o.forEach(s=>{if(typeof r[s]=="undefined")return;const{minValue:a,midValue:l,maxValue:d}=t.prototype.availableOptions[s];let c=r[s];c=c<0?l+(l-a)*c:l+(d-l)*c,n[s]=c}),i.set(n),i})}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":return super._deserializeFocusOperation(e);case"linear":{const{start:i,end:r,blurRadius:o}=t;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:Me.fromObject(i),controlPoint2:Me.fromObject(r),blurRadius:o}))}case"mirrored":{const{start:i,end:r,size:o,gradientSize:n,blurRadius:s}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:Me.fromObject(i),end:Me.fromObject(r),size:o,gradientSize:n,blurRadius:s}))}case"gaussian":{const{blurRadius:i}=t;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:i}))}}}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:s,rotation:a,maxWidth:l,color:d,backgroundColor:c}=i,p=this._ui.getFontLoader();let h=this._fontManager.getVariationByIdentifier(n);return h?p.setFonts([h.getFont()]):h=this._fontManager.getDefaultVariation(),p.load().then(()=>{const m=e.getInputDimensions(!1),b=l*m.min()/m.x,_=e.createText({fontSize:r,lineHeight:o,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),textMetrics:h.getTextMetrics(),alignment:s,rotation:a,maxWidth:b,text:i.text,color:qe.fromArray(d.rgba),backgroundColor:qe.fromArray(c.rgba),position:Me.fromObject(i.position)});return _._edited=!0,_})}_createBrushForPath(e){const{identifier:t,color:i,size:r,hardness:o}=e.brush,n=qe.fromArray(i.rgba),s={color:n,size:r};typeof o!="undefined"&&(s.hardness=o);let a=this._brushManager.getBrushByIdentifier(t);if(a||(a=this._brushManager.getFirstBrush()),a.prototype&&a.prototype instanceof f_){const l=a;return new l(s)}else{const l=Ue.extend({},a);delete l.image;class d extends f_{}return d.identifier=a.identifier,new d(Ue.extend({},l,s))}}_deserializeFrame(e,t){return super._deserializeFrame(e,t).then(()=>{const i=this._editor.operations.get("frame"),{size:r,alpha:o,tintColor:n}=t.options,s={};typeof r!="undefined"&&(s.scale=r),typeof o!="undefined"&&(s.alpha=o),typeof n!="undefined"&&(s.tintColor=qe.fromArray(n.rgba)),i.set(s)})}_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:l,width:d,seed:c,inverted:p}=i;let{identifier:h}=i;h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m=new Ro(this._ui,this._getOptions("textdesign")),b=new Yi(this._ui,{fonts:wt.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),_=e.constructor.TextDesignSprite.AssetManager,g=this._ui.getFontLoader(),S=m.getLayoutByIdentifier(h),x=new S;return g.setFonts(b.getFonts()),_.setFonts(y(y({},_.getFonts()),b.getVariationsByIdentifier())),g.load().then(()=>{const C=x.getImagePaths().map(R=>({path:R,fullPath:this._ui.getAssetPath(R),image:null}));return _.loadImages(C).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:qe.fromArray(l.rgba),width:d,seed:c,inverted:p,layout:x})))})}}fd.version="3.0.0";class gd extends md{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);i.color={rgba:i.color};const r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),{type:"textdesign",options:i}}}gd.version="3.1.0";class bd extends fd{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:l,width:d,seed:c,inverted:p}=i;let{identifier:h}=i;h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m=new Ro(this._ui,this._getOptions("textdesign")),b=new Yi(this._ui,{fonts:wt.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),_=e.constructor.TextDesignSprite.AssetManager,g=this._ui.getFontLoader(),S=m.getLayoutByIdentifier(h),x=new S;return g.setFonts(b.getFonts()),_.setFonts(y(y({},_.getFonts()),b.getVariationsByIdentifier())),g.load().then(()=>{const C=x.getImagePaths().map(R=>({path:R,fullPath:this._ui.getAssetPath(R),image:null}));return _.loadImages(C).then(()=>(x.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:qe.fromArray(l.rgba),width:d,seed:c,inverted:p,layout:x})))})}}bd.version="3.1.0";class yd extends gd{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);i.color={rgba:i.color};const r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),i.padding*=i.width,{type:"textdesign",options:i}}}yd.version="3.2.0";class vd extends bd{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:l,width:d,seed:c,inverted:p}=i;let{identifier:h}=i;h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:h===oe.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(h=oe.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m="padding"in i?i.padding/d:-1,b=new Ro(this._ui,this._getOptions("textdesign")),_=new Yi(this._ui,{fonts:wt.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),g=e.constructor.TextDesignSprite.AssetManager,S=this._ui.getFontLoader(),x=b.getLayoutByIdentifier(h),C=new x;return S.setFonts(_.getFonts()),g.setFonts(y(y({},g.getFonts()),_.getVariationsByIdentifier())),S.load().then(()=>{const R=C.getImagePaths().map(T=>({path:T,fullPath:this._ui.getAssetPath(T),image:null}));return g.loadImages(R).then(()=>(C.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:qe.fromArray(l.rgba),width:d,seed:c,inverted:p,layout:C,padding:m})))})}}vd.version="3.2.0";class _d extends yd{_serializeOperation(e,t){switch(e.constructor.identifier){case"artfilter":return this._serializeStyle(e);default:return super._serializeOperation(e,t)}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(e){const{identifier:t,intensity:i,blendMode:r}=e.getOptions(),{tileEdgeLength:o,overlappingFactor:n}=e.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:t,intensity:i,blendMode:ea[r],tileEdgeLength:o,overlappingFactor:n}}}}_d.version="3.4.0";class g_{constructor(e,t){this._ui=e,this._options=t,this._categoriesByIdentifier={},this._categories=[],this._artFiltersByIdentifier={},this._initCategories()}_initCategories(){const e=ko.DEFAULTS.ART_FILTERS||[],t={identifier:"standard",defaultName:"Standard",artFilters:e};if(this._categories=[t],this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=wi.mergeCategories(this._categories,this._options.categories,"artFilters")),this._options.availableArtFilters){const r=[];this._categories.forEach(o=>{const n=o.artFilters.filter(s=>this._options.availableArtFilters.indexOf(s.identifier)!==-1);n.length>0&&r.push({identifier:o.identifier,defaultName:o.defaultName,artFilters:n})}),this._categories=r}const i={identifier:"all",defaultName:"All",artFilters:this._categories.length<=0?[]:this._categories.map(r=>r.artFilters).reduce((r,o)=>r.concat(o))};this._categories.unshift(i),this._categoriesByIdentifier.all=i,this._categories.forEach(r=>{this._categoriesByIdentifier[r.identifier]=r}),i.artFilters.forEach(r=>{this._artFiltersByIdentifier[r.identifier]=r})}instantiateStyleTransferModelForArtFilterWithIdentifier(e,t={}){const i=this.getArtFilterByIdentifier(e);if(!i)return Promise.reject(new Error(`Unknown style with identifier \`${e}\`!`));const{rootPath:r}=i,o=this._ui.getEditor().getSDK(),n=o.getRenderer();t.weightURL=this._ui.getAssetPath(r+"/weights.json");var s=o.getInputTexture().getDimensions();const a=o.getOperationsStack().getByIdentifier("exif-orientation");return a&&(s=a.getNewDimensions(s)),oe.Operations.ArtFilterOperation.StyleTransferModel.createWithOptions(t,s,n)}updateLoadedModelWithWeightsForIdentifier(e,t){const i=this.getArtFilterByIdentifier(t);if(!i)return Promise.reject(new Error(`Unknown style with identifier \`${t}\`!`));const{rootPath:r}=i,o=this._ui.getAssetPath(r+"/weights.json");return e.updateWithWeightsFromURL(o)}getArtFiltersForCategory(e){if(!this._categoriesByIdentifier[e])throw new Error(`Unknown art filter category '${e}'`);return this._categoriesByIdentifier[e].artFilters}getArtFilterByIdentifier(e){return this._artFiltersByIdentifier[e]}getCategories(){return this._categories}getArtFilters(){let e=[];return this._categories.map(t=>{e.push(...this.getArtFiltersForCategory(t.identifier))}),e}getCategoryByIdentifier(e){return this._categoriesByIdentifier[e]}}const w6=Ue.flipObject(ea),C6=oe.Operations.ArtFilterOperation;class xd extends vd{_deserializeOperation(e){return e.type==="artFilter"?this._deserializeStyle(e):super._deserializeOperation(e)}_deserializeOrientationOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}_deserializeStyle(e){const{identifier:t,intensity:i,blendMode:r,tileEdgeLength:o,overlappingFactor:n}=e.options;if(!t)return W.warn("Found invalid Art Filter serialization."),Promise.resolve();if(!C6.isSupported(this._editor.getSDK()))return W.warn("Can't restore Art Filters, as they're not supported on this platform."),Promise.resolve();const s=new g_(this._ui,this._getOptions("artfilter"));return s.instantiateStyleTransferModelForArtFilterWithIdentifier(t,{tileEdgeLength:o,overlappingFactor:n}).catch(a=>{W.warn(`Could not deserialize art filter: ${a}`)}).then(a=>{this._editor.operations.getOrCreate("artfilter",{identifier:t,styleTransferModel:a,intensity:i,blendMode:parseInt(w6[r||r],10)})})}}xd.version="3.4.0";class wd extends _d{}wd.version="3.5.0";class Cd extends xd{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:l,width:d,seed:c,inverted:p,identifier:h}=i,m="padding"in i?i.padding/d:-1,b=new Ro(this._ui,this._getOptions("textdesign")),_=new Yi(this._ui,{fonts:wt.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),g=e.constructor.TextDesignSprite.AssetManager,S=this._ui.getFontLoader(),x=b.getLayoutByIdentifier(h),C=new x;return S.setFonts(_.getFonts()),g.setFonts(y(y({},g.getFonts()),_.getVariationsByIdentifier())),S.load().then(()=>{const R=C.getImagePaths().map(T=>({path:T,fullPath:this._ui.getAssetPath(T),image:null}));return g.loadImages(R).then(()=>(C.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:s,text:a,color:qe.fromArray(l.rgba),width:d,seed:c,inverted:p,layout:C,padding:m})))})}}Cd.version="3.5.0";class Sd extends wd{_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e),i="sharpness",{availableOptions:r}=e,o={},n=r[i],s=e.getOption(i),{minValue:a,midValue:l,maxValue:d}=n;return o[i]=s<=l?(s-a)/(l-a)-1:(s-l)/(d-l),t.options=y(y({},t.options),o),t}}Sd.version="3.6.0";class Td extends Cd{_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=oe.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e,o="sharpness",n={};if(typeof r[o]=="undefined")return;const{minValue:s,midValue:a,maxValue:l}=t.prototype.availableOptions[o];let d=r[o];return d=d<0?a+(a-s)*d:a+(l-a)*d,n[o]=d,i.set(n),i})}}Td.version="3.6.0";class kd extends Sd{serialize(e={}){return super.serialize(e).then(t=>this._serializeAssetLibrary(t).then(i=>i))}_serializeAssetLibrary(e){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(e);const t=this._editor.getDynamicAssetsLibrary(),i=this._serializeCustomStickerAssets(e,t);return i.length===0||(e.assetLibrary={assets:{stickers:i}}),Promise.resolve(e)}_serializeCustomStickerAssets(e,t){const i=t.getAssets("sticker");if(i.length===0)return[];const r=e.operations.filter(s=>s.type==="sprite").flatMap(s=>s.options.sprites).filter(s=>s.type==="sticker").map(s=>s.options.identifier),o={};r.forEach(s=>{o[s]=!0});const n=i.filter(s=>o[s.identifier]);return n.map(s=>{const{identifier:a,defaultName:l,images:d}=s,c=d.mediaBase.uris[0],p=d.mediaBase.isSVG,h=/^data:(image\/(jpeg|png));base64,(.*)$/g,m=h.exec(c),b=m[1],_=m[3],g={identifier:a,name:l,raster:{type:b,data:_}};return l&&(g.name=l),p&&(g.svg={data:d.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),g})}}kd.version="3.7.0";class Ed extends Td{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((e,t)=>{const i=this._data;if(!i.assetLibrary){e();return}const r=i.assetLibrary.assets,o=[];for(let n in r)o.push(this._deserializeCustomAssets(n,r[n]));return Promise.all(o).then(()=>{e()}).catch(n=>{console.error(n),t(n)})})}_deserializeCustomAssets(e,t){switch(e){case"stickers":return this._deserializeCustomStickerAssets(t);default:return Promise.reject(new Error(`Unknown asset type: ${e}`))}}_deserializeCustomStickerAssets(e){let t="none";const i=this._editor.getOptions().editor;i&&i.controlsOptions&&i.controlsOptions.sticker&&(t=i.controlsOptions.sticker.customStickerTintMode||"none");const r=e.map(o=>new Promise((n,s)=>{const{identifier:a,raster:l}=o,d=o.svg!==void 0;let c=`data:${l.type};base64,${l.data}`,p=new vi;p.onload=()=>{const h=this._editor.getSDK();p=h.correctExifOrientation(p),p.toDataURL&&(c=p.toDataURL());let m={data:"",width:1,height:1};m=this._stickerManager.renderStickerThumbnailFromImage(p);const b={identifier:a,defaultName:o.name||"",tintMode:t,images:{mediaBase:{uris:[c],rawData:!0,isSVG:d,width:p.width,height:p.height},mediaThumb:{uris:[m.data],rawData:!0,width:m.width,height:m.height}}};if(d){const _=`data:image/svg+xml;base64,${o.svg.data}`;b.images.mediaBase.uris.push(_)}n(b)},p.onerror=()=>{s(new Error(`Invalid base64 data: ${c}`))},p.src=c}));return Promise.all(r).then(o=>{const n=this._editor.getDynamicAssetsLibrary();n.setAssets("sticker",o),this._stickerManager.reload()})}}Ed.version="3.7.0";class Dd extends kd{_serializeSticker(e,t){const i=super._serializeSticker(e,t);return i.options.tintMode=t.getTintMode(),i}}Dd.version="3.8.0";class Id extends Ed{}Id.version="3.8.0";const NE=Math.PI*2;class Ru extends Dd{_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const o=t.get("orientation");o.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),o.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),e.rotate(-o.getRotation())}const i=e.serializeOptions(["start","end","rotation","textureScale"],!0);i.rotation=(i.rotation+NE)%NE,i.textureScale!==1&&(i.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete i.textureScale;let r={type:"transform",options:i};if(e._ratio){let o;e._ratio instanceof kc?o=e._ratio.getIdentifier():o=e._ratio.identifier,r.options.meta={identifier:o}}return delete r.options.scale,r}_serializeText(e,t){const i=e.getInputDimensions(!1),r=super._serializeText(e,t);return r.options.fontSize=r.options.fontSize*i.y/i.min(),r}}Ru.version="3.9.0";class Au extends Id{_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;let i=Ue.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;t.rotate(r.rotation),r.flipHorizontally&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),r.flipVertically&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t._ratio=null,t})}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:s,rotation:a,maxWidth:l,color:d,backgroundColor:c}=i,p=this._ui.getFontLoader();let h=this._fontManager.getVariationByIdentifier(n);return h?p.setFonts([h.getFont()]):h=this._fontManager.getDefaultVariation(),p.load().then(()=>{const m=e.getInputDimensions(!1),b=m.min(),_=m.x,g=m.y,S=l*b/_,x=r*b/g,C=e.createText({fontSize:x,lineHeight:o,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),textMetrics:h.getTextMetrics(),alignment:s,rotation:a,maxWidth:S,text:i.text,color:qe.fromArray(d.rgba),backgroundColor:qe.fromArray(c.rgba),position:Me.fromObject(i.position)});return C._edited=!0,C})}}Au.version="3.9.0";class S6 extends cp{constructor(e,t,i,r=!1){super();this._ui=e,this._options=t,this._mediator=i,this._shallow=r,r||(this._initSDK(),this.operations=new s_(this,this._sdk,this._mediator))}_initFonts(){const e=Ue.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new Yi(this._ui,e);const t=this._fontManager.getFonts(),i=this._ui.getFontLoader();i.setFonts(t),i.load()}setImage(e=this._options.editor.image,t=!0){t&&this.reset();let i=null;i=this._sdk.parseExif(e),this._setImage(e,i),this._initWatermark()}_initWatermark(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))}_initSDK(){const{logLevel:e,displayWelcomeMessage:t,debug:i,license:r,crossOrigin:o}=this._options,{smoothDownscaling:n,smoothUpscaling:s,preferredRenderer:a,pixelRatio:l,transparent:d,clearColor:c}=this._options.editor;let p;Array.isArray(c)?p=qe.fromArray(c):typeof c=="string"?p=qe.fromHex(c):c instanceof qe&&(p=c.clone());const h={logLevel:e,debug:i,displayWelcomeMessage:t,pixelRatio:l,smoothDownscaling:n,smoothUpscaling:s,transparent:d,crossOrigin:o,clearColor:p,license:r};this._sdk=new oe(a,h)}getMaxMegapixels(){const{maxMegaPixels:e}=this._options.editor;return e}getCrossOrigin(){return Ue.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(e=!1){return this._sdk.getOutputDimensions(e)}getOutputTextureDimensions(e=!1){return this._sdk.getOutputTextureDimensions(e)}getFinalDimensions(e=!1){return this._sdk.getFinalDimensions(e)}_setImage(e=this._options.editor.image,t=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t)}_ensureImageIsResized(){const e=this._sdk.getImage(),t=this._sdk.getRenderer(),i=this.getMaxMegapixels(),r=i?i*1e6:null,o=t.getMaxDimensions(),n=new n_(e,r,o);return!this._resizedImage&&n.needsResize()?n.resize().then(({canvas:s,dimensions:a,reason:l})=>(this._resizedImage=s,this._sdk.setImage(s),s)):xc.resolve(e)}export(e=!1){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then(t=>{const i=this._options.editor.export,r=new o_(this._sdk,i,e);return r.export().then(o=>(this.emit("export",o),this._mediator.emit(wt.EVENTS.EXPORT,o,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),o))})}broadcastTransform(e,t){const i=new oe.Operations.TransformOperation.TransformChange(e,t),r=["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"];r.forEach(o=>{const n=this.operations.get(o);if(!n)return;n.transform(i)})}broadcastFlip(e){const t=["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r)return;r.flip(e)})}broadcastRotate(e){const t=["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r)return;r.rotate(e)})}_initSerializers(){this._serializers={"1.0.0":Yw().default,"1.0.1":Jw().default,"2.0.0":Zw().default,"3.0.0":Qw().default,"3.1.0":e0().default,"3.2.0":t0().default,"3.4.0":i0().default,"3.5.0":r0().default,"3.6.0":o0().default,"3.7.0":n0().default,"3.8.0":s0().default,"3.9.0":a0().default}}serialize(e={},t="3.9.0"){const i=this._serializers[t];if(!i)return xc.reject(new Error(`No serializer for version ${t} found.`));const r=new i(this);return r.serialize(e)}deserialize(e){const t=this._serializers[e.version];if(!t)return xc.reject(new Error(`No serializer for version ${e.version} found.`));const i=new t(this);return i.deserialize(e)}save(e=!1,t=!1){const i=this._options.editor.save;return this.serialize({image:t}).then(r=>{const o=JSON.stringify(r,null,2);if(e){var n="data:text/json;charset=utf-8;base64,"+window.encodeURI(window.btoa(o));wc.downloadDataURL(n,i.fileBasename)}return o})}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}}var UE=S6;const Ec=e=>Ue.byteArrayToString(Vf.decode(e));class ta extends cp{constructor(e={}){super();this._mediator=new cp,this._fontLoader=new vl(this),this._options=e,this._initOptions(),this._initEvents(),this._disposed=!1,this._isReady=!1,this._editor=new UE(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),this._mediator.once(wt.EVENTS.EDITOR_READY,()=>{this._isReady=!0}),W.setLevel(this._options.logLevel),this._v()}export(...e){return this._editor.export(...e)}serialize(...e){return this._editor.serialize(...e)}deserialize(e){return this._editor.deserialize(e)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(e){this._isReady?e():this._mediator.once(wt.EVENTS.EDITOR_READY,e)}createFilter(e){const t=new cn(this,this._getOptions("filter"));return t.instantiateFilterWithIdentifier(e)}getTextDesignLayoutByID(e){const t=new Ro(this,this._getOptions("textDesign"));return new(t.getLayoutByIdentifier(e))}getTextDesignAssetManager(){return oe.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){const e=new Yi(this,{fonts:wt.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0,isTextDesign:!0});return e}_getOptions(e){const t=this.getEditor(),{controls:i}=t;let r={};i&&i.get(e)&&(r=i.get(e).defaultOptions);const o=t.getOptions();return Ue.deepDefaults({},o.editor.controlsOptions[e]||{},r)}_initOptions(){if(this._options=Ue.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:!1,preloader:!0,autoRun:!0}),this._options.editor=Ue.defaults(this._options.editor||{},{enableZoom:!0,enableDrag:!0,enableExport:!0,enableKeyboardControls:!0,enablePositionSnapping:!0,enableRotationSnapping:!0,enableSave:!1,enableLoad:!1,pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1,preferredRenderer:"webgl",transparent:!0,clearColor:[0,0,0,0],displayResizeMessage:!0,maxMegaPixels:{},displayCloseButton:!1,undoMode:"global",defaultControl:"filter",forceCrop:!1,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame","watermark"],controlsOptions:{focus:{highQualityCanvasBlur:!1}}}),this._options.editor.snappingOptions=Ue.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}}),this._options.editor.snappingOptions.position=Ue.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20}),this._options.editor.snappingOptions.position.padding=Ue.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1}),this._options.editor.snappingOptions.rotation=Ue.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20}),this._options.editor.controlsOptions.focus=Ue.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:!1}),this._options.editor.maxMegaPixels=Ue.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=Ue.defaults(this._options.editor.export||{},{format:"image/png",type:Qs.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.editor.save=Ue.defaults(this._options.editor.save||{},{format:"text/json",download:!0,fileBasename:"photoeditorsdk-save"}),this._options.extensions=Ue.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=Ue.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null}),!(this._options.editor.image instanceof window.Image)){let e=new window.Image;this._options.editor.image&&(e.src=this._options.editor.image,this._options.editor.image=e)}}_v(){return this[Ec("X29wdGlvbnM=")][Ec("bGljZW5zZQ==")]?!0:(W.error(Ec("TGljZW5zaW5n"),Ec("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg==")),W.error(Ec("TGljZW5zaW5n"),Ec("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(e){this._editor.setImage(e)}getAssetPath(e,t=!1,i=!1){let{baseUrl:r,resolver:o}=this._options.assets,n=`${r}/${e}`;o=o||(d=>d),e.match(/(ftp|http|https):\/\//)&&(n=e);const s=e.replace(/assets\//,"").split("/"),a=s[0];let l={};switch(a){case"art-filters":return l={identifier:s[1],type:s[2].split(".")[0]},o("art-filter",l);case"filters":return l={identifier:s[1].replace(/\.png$/g,"")},o("filter",l);case"fonts":return l={identifier:s[1].replace(/\.(woff|otf|ttf)$/g,"")},o("font",l);case"frames":return l={identifier:s[1],filename:s[2]},o("frame",l);case"overlays":return l={identifier:s[1].replace(/\.(png|jpg|jpeg)$/g,"")},o("overlay",l);case"stickers":const d=s[3].endsWith(".svg"),c=s[3]==="thumbs";return l={category:s[1],identifier:(d?s[3]:s[4]).replace(/\.(png|svg)$/g,""),variant:d?"svg":c?"thumb":"base"},o("sticker",l);case"text-design":return l={type:s[1]==="fonts"?"font":"image",identifier:s[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")},o("text-design",l)}return typeof o!="undefined"&&o!==null&&(n=o(n)),n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(e){return this.deserialize(e).then(()=>this.export())}}ta.prototype.identifier="engine-wrapper";ta.Constants=wt;ta.Events=wt.EVENTS;ta.Utils=wi;ta.JSONLoader=lr;ta.SDK=oe;const se={};ut(se,{absoluteToRelativePoint:()=>A6,absoluteToRelativeSize:()=>O6,getBaseLocalToWorldMatrix:()=>Xf,getLocalToParentMatrix:()=>GE,getLocalToWorldMatrix:()=>Dc,getPointInWorldSpace:()=>v_,getRotationBetweenCoordinateSpaces:()=>F6,getScalarInWorldSpace:()=>E6,getSizeInOutputSpace:()=>D6,getSizeInWorldSpace:()=>jE,pointFromSpaceToSpace:()=>pp,rectTransformToAffineTransform:()=>b_,relativeToAbsolutePoint:()=>R6,relativeToAbsoluteSize:()=>I6,scalarFromSpaceToSpace:()=>y_,sizeFromSpaceToSpace:()=>k6});function HE(e){return e.x!==void 0}function b_(e){return ve.fromTRS(e.position.x,e.position.y,e.rotation,e.scale.x,e.scale.y)}function T6(e){return e.getBaseLocalToParentMatrix?e.getBaseLocalToParentMatrix():b_(e.getTransform())}function Xf(e){const t=e.getParent(),i=T6(e);if(t===void 0)return i;const r=Xf(t);return ve.multiply(r,i)}function GE(e){return e.getLocalToParentMatrix?e.getLocalToParentMatrix():b_(e.getTransform())}function Dc(e){const t=e.getParent(),i=GE(e);if(t===void 0)return i;const r=Dc(t);return ve.multiply(r,i)}function pp(e,t,i,r=!1){const o=t.type==="output"&&r?Xf(t):Dc(t),n=i.type==="output"&&r?Xf(i):Dc(i),s=ve.getInverted(n);return ve.transformPoint(s,ve.transformPoint(o,e))}function y_(e,t,i){const r=new E(e,0),o=new E(pp(r,t,i)),n=new E(pp(E.ZERO,t,i));return E.distance(n,o)}function k6(e,t,i){const r=HE(e)?e.x:e.width,o=HE(e)?e.y:e.height,n=y_(r,t,i),s=y_(o,t,i);return{width:n,height:s}}function v_(e,t){const i=Dc(t);return ve.transformPoint(i,e)}function E6(e,t){const i=new E(e,0),r=new E(v_(i,t)),o=new E(v_(E.ZERO,t));return E.distance(r,o)}function jE(e){const t=Dc(e),i=e.getBounds(),r={x:i.width,y:0},o={x:0,y:i.height},n=new E(ve.transformPoint(t,E.ZERO)),s=new E(ve.transformPoint(t,r)),a=new E(ve.transformPoint(t,o)),l=E.distance(n,s),d=E.distance(n,a);return{width:l,height:d}}function D6(e,t){const i=jE(e),r=t.getTransform().scale,o={x:1/r.x,y:1/r.y},n={width:i.width*o.x,height:i.height*o.y};return n}function I6(e,t){const i=t.getBounds();return{width:e.width*i.width,height:e.height*i.height}}function O6(e,t){const i=t.getBounds();return{width:e.width/i.width,height:e.height/i.height}}function R6(e,t,i=!0){const r=t.getBounds();return{x:e.x*r.width+(i?0:r.minX),y:e.y*r.height+(i?0:r.minY)}}function A6(e,t,i=!0){const r=t.getBounds();return{x:(e.x-(i?0:r.minX))/r.width,y:(e.y-(i?0:r.minY))/r.height}}function F6(e,t){const i={x:1,y:0},r=pp(i,e,t,!0),o=pp(E.ZERO,e,t,!0);return Math.atan2(r.y-o.y,r.x-o.x)}function Yf(e){return typeof e!="string"&&!Array.isArray(e)&&e.a===void 0}function Jf(e){return typeof e!="string"&&Array.isArray(e)&&e.length===3}function Zf(e){return typeof e!="string"&&!Array.isArray(e)&&e.a!==void 0}function Qf(e){return typeof e!="string"&&Array.isArray(e)&&e.length===4}function WE(e){return typeof e=="string"}var ia;(function(e){e.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",e.IMAGE_DOWNSCALED="imageDownscaled"})(ia||(ia={}));class VE{constructor(e,t){this.engine=t;this.transform=mt.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=e}get quality(){return this.previewQuality}setQuality(e){this.previewQuality=Math.min(Math.max(e,.01),1)}getTransform(){return this.transform}setTransform(e){this.transform=e}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;const{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new mt(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};const{position:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new mt(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t}=this.transform,{scale:i}=this.transform;this.setTransform(new mt(t,i,e))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(e,t){typeof e=="number"?this.canvasPivot={x:e,y:typeof t===void 0?e:t}:this.canvasPivot=e}getCanvasBounds(){const e=this.canvasPivot,{width:t,height:i}=this.canvas;return new qt(-e.x*t,-e.y*i,t,i)}}function eg(e){return e.getTransform!==void 0}function KE(e){return e.getContainer!==void 0}class $E extends Tr{constructor(e){super();this.config=e}getOutputDimensions(){const e=this.getOutputContainer();return e?e.getResolution():{width:0,height:0}}getSmallerOutputSide(){const e=this.getOutputContainer();if(!e)return 0;const t=e.getResolution();return Math.min(t.width,t.height)}convertPointFromPreviewIntoOutputSpace(e,t){const i=ve.getInverted(se.rectTransformToAffineTransform(t));return ve.transformPoint(i,e)}convertPointFromPreviewIntoWorldSpace(e,t,i){const r=ve.getInverted(se.rectTransformToAffineTransform(t)),o=i?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),n=ve.multiply(o,r);return ve.transformPoint(n,e)}convertPointFromPreviewIntoFlippedPreviewSpace(e){const t=this.getOutputContainer().getFlipTransformMatrix();return ve.transformPoint(t,e)}convertPointFromWorldIntoPreviewSpace(e,t){const i=se.rectTransformToAffineTransform(t),r=ve.getInverted(this.getOutputContainer().getLocalToParentMatrix()),o=ve.multiply(i,r);return ve.transformPoint(o,e)}convertPointFromOutputIntoPreviewSpace(e,t){const i=se.rectTransformToAffineTransform(t);return ve.transformPoint(i,e)}getContainersAtPreviewPoint(e,t){const i=new Array,r=this.convertPointFromPreviewIntoWorldSpace(e,t),o=this.getRootContainers();for(const n of o)this.accumulateContainersAtWorldPointInHierarchy(r,n,i);return i}isPreviewPointInContainer(e,t,i){const r=this.convertPointFromPreviewIntoWorldSpace(e,i);return this.isWorldPointInContainer(r,t)}isWorldPointInContainer(e,t){const i=se.getLocalToWorldMatrix(t),r=ve.getInverted(i),o=ve.transformPoint(r,e);return qt.contains(t.getBounds(),o)}accumulateContainersAtWorldPointInHierarchy(e,t,i){this.isWorldPointInContainer(e,t)&&i.push(t);const r=t.getChildren();for(const o of r)eg(o)&&this.accumulateContainersAtWorldPointInHierarchy(e,o,i)}}class mi{constructor(e){this.engine=e;this.id=So()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}isValid(){return this.getIndexInParent()!==-1}}class qE extends mi{constructor(e,t,i){super(t);this.operation=i;this.type="adjustments";this.setProperties(e)}getProperties(){const e=this.operation.getOptions(),t=e.gamma-1;return{brightness:e.brightness||0,saturation:e.saturation||0,contrast:e.contrast||0,gamma:(t<0?2*t:t)||0,clarity:e.clarity||0,exposure:e.exposure||0,shadows:e.shadows*.5||0,highlights:e.highlights||0,whites:e.whites||0,blacks:e.blacks||0,temperature:e.temperature||0,sharpness:e.sharpness||0}}setProperties(e){e.gamma!==void 0&&(e.gamma=1+(e.gamma<0?.5*e.gamma:e.gamma)),e.shadows&&(e.shadows=e.shadows*2),this.operation.set(e)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}}const fr=e=>{if(Zf(e))return new oe.Color(e.r,e.g,e.b,e.a);if(Qf(e))return new oe.Color(e[0],e[1],e[2],e[3]);if(Yf(e))return new oe.Color(e.r,e.g,e.b,1);if(Jf(e))return new oe.Color(e[0],e[1],e[2],1);if(WE(e)){const[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new oe.Color(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}throw new Error("Invalid color type")};class it{get x(){return this._x}get y(){return this._y}constructor(e=0,t=0){this._x=e,this._y=t}set(e,t){return this._x=e,this._y=t,this}clone(){return new it(this._x,this._y)}copy(e){return this._x=e.x,this._y=e.y,this}clamped(e=this,t=this){let i=typeof e=="number"?{x:e,y:e}:e,r=typeof t=="number"?{x:t,y:t}:t;return this._x=Math.max(i.x,this._x),this._y=Math.max(i.y,this._y),this._x=Math.min(r.x,this._x),this._y=Math.min(r.y,this._y),this}divide(e,t){return typeof e=="number"||e===null?(this._x/=e,this._y/=typeof t=="undefined"?e:t):(this._x/=e.x,this._y/=e.y),this}subtract(e,t){return typeof e=="number"||e===null?(this._x-=e,this._y-=typeof t=="undefined"?e:t):(this._x-=e.x,this._y-=e.y),this}multiply(e,t){return typeof e=="number"||e===null?(this._x*=e,this._y*=typeof t=="undefined"?e:t):(this._x*=e.x,this._y*=e.y),this}add(e,t){return typeof e=="number"||e===null?(this._x+=e,this._y+=typeof t=="undefined"?e:t):(this._x+=e.x,this._y+=e.y),this}dot(e,t){return typeof e=="number"||e===null?this._x*e+this._y*(typeof t=="undefined"?e:t):this._x*e.x+this._y*e.y}equals(e,t){return typeof e=="number"||e===null?e===this._x&&t===this._y:e.x===this._x&&e.y===this._y}flip(){let e=this._x;return this._x=this._y,this._y=e,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=this._x|0,this._y=this._y|0,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(e){return this._x=parseFloat(this._x.toFixed(e)),this._y=parseFloat(this._y.toFixed(e)),this}asArray(e=!1){return e?[this._y,this._x]:[this._x,this._y]}static fromObject(e){return new it(e.x,e.y)}static fromSize(e){return new it(e.width,e.height)}static get NULL(){return new it(0,0)}}class to{constructor(e){this.engine=e;this.id=So(),this.transform=mt.IDENTITY,this.bounds=qt.ZERO}getID(){return this.id}getParent(){const e=this.engine.getRootContainers();return e.length===0||this.id===e[0].id?void 0:e[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}getChildren(){const e=this.engine.getRootContainers();return e.length>0&&(this.id===e[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(e,t,i){typeof t=="number"?(this.setPivotInternal(t,i),e.setPivot(new it(t,i))):(this.setPivotInternal(t),e.setPivot(it.fromObject(t)))}setPivot(e,t){this.setPivotInternal(e,t)}getPivot(){const e=this.getBounds();return{x:-e.minX/e.width,y:-e.minY/e.height}}getTransform(){return this.transform}setTransform(e){this.transform=e}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;const{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new mt(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};const{position:r,rotation:o}=this.transform;this.setTransform(new mt(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t,scale:i}=this.transform;this.setTransform(new mt(t,i,e))}getSizeInWorldSpace(){return se.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return se.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(e){const t=this.getBounds();this.setScale(e.width/t.width,e.height/t.height)}setSizeInOutputSpace(e){const t=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:e.width/t.x,height:e.height/t.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(e,t){const i=this.getBounds();typeof e=="number"?this.setBoundsFromSize(i.width,i.height,{x:e,y:t}):this.setBoundsFromSize(i.width,i.height,e)}setBoundsFromSize(e,t,i=this.getPivot()){this.bounds=new qt(-i.x*e,-i.y*t,e,t)}}class XE extends to{constructor(e,t){super(t);this.type="drawing";this.drawing=e,this.operation=t.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();const i=t.getRootContainers()[0],r=i.getBounds();this.bounds=new qt(0,0,r.width,r.height),this.setTransform(mt.IDENTITY),this.operation.setDirty(!0),this.setData(e)}beginStroke(e){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if(e.id!=="imgly_brush_radial")throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=e,this.currentStroke={brush:e,path:{controlPoints:[]}},this.radialBrush.setColor(fr(e.color)),this.radialBrush.setHardness(e.hardness),this.radialBrush.setSize(e.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(e,t=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){const a=this.currentStroke.path.controlPoints,l=a[a.length-1],d=this.currentBrush.size/10,c=Math.sqrt(e.x-l.x**2+(e.y-l.y**2));if(c<d)return}const i=this.engine.getOutputContainer(),r=this.engine.getRootContainers()[0],o=se.pointFromSpaceToSpace(e,r,i,!0),n=se.absoluteToRelativePoint(o,i,!1),s=i.getBounds();this.currentPath.addControlPoint(it.fromObject(n)),this.currentStroke.path.controlPoints.push(e),t&&this.sprite.render(it.fromObject({x:s.width,y:s.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);const e=this.engine.getOutputContainer().getBounds();this.sprite.render(it.fromObject({x:e.width,y:e.height})),this.currentPath=void 0}setData(e){this.drawing=y(y({},this.drawing),e),this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(e.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(e){e.forEach(t=>{this.beginStroke(t.brush),t.path.controlPoints.forEach(i=>{this.addPointToCurrentStroke(i,!0)}),this.endStroke()})}}class YE extends mi{constructor(e,t,i,r){super(r);this.filterOperation=t;this.type="duotone-filter";t.set({intensity:i.colorIntensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{colorIntensity:e.intensity}}setProperties(e){const t=this.filterOperation.getOptions();let i=t.intensity;e.colorIntensity!==void 0&&(i=Math.min(Math.max(e.colorIntensity,0),1)),this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}}class JE{constructor(e,t){this.engine=t;this.loaded=!1;this.loading=!1;this.asset=y({},e)}load(){return Z(this,null,function*(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;const{imageGroups:e}=this.asset,t=[];return["top","left","right","bottom"].forEach(i=>{if(!e[i])return;const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r))return;t.push(this.loadPart(i,o))})}),Promise.all(t).then(()=>{this.loaded=!0,this.loading=!1}).catch(()=>{this.loaded=!1,this.loading=!1})})}getFrame(){return y(y({},this.asset),{defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI})}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}loadPart(e,t){return Z(this,null,function*(){return new Promise((i,r)=>{const{imageGroups:o}=this.asset,n=o[e][t];let s=n;typeof n!="string"&&"image"in n&&(s=n.image);const a=new Image;a.addEventListener("load",()=>{typeof n!="string"?this.asset.imageGroups[e][t].image=a:this.asset.imageGroups[e][t]=a,i(a)}),a.addEventListener("error",()=>{r(new Error(`Failed to load image at ${a.src}`))}),a.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",a.src=this.engine.assetProvider.getAssetSource("frame",s)})})}}class ZE extends mi{constructor(e,t,i){super(i);this.frameOperation=e;this.type="frame";this.setProperties(t),i.pesdk.setAllOperationsToDirty()}setProperties(e){if(this.props=y(y({},this.props),e),typeof e.opacity=="number"&&this.frameOperation.set({alpha:e.opacity}),e.tintColor&&this.frameOperation.set({tintColor:fr(e.tintColor)}),e.width){const t=this.engine.getOutputContainer().getBounds(),i=Math.min(t.width,t.height),r=e.width/i;this.frameOperation.set({scale:r})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}}class QE extends mi{constructor(e,t,i){super(t);this.blurOperation=i;this.type="gaussian-blur";this.setProperties(e)}getProperties(){const e=this.engine.getOutputContainer(),t=e.getBounds(),i=Math.min(t.size.width,t.size.height),r=se.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*i,e,this.getContainer());return{blurRadius:r}}setProperties(e){if(e.blurRadius!==void 0){const t=this.engine.pesdk.getOutputDimensions(),i=Math.min(t.x,t.y),r=this.getContainer(),o=this.engine.getOutputContainer(),n=se.scalarFromSpaceToSpace(e.blurRadius,r,o),s=n/i;this.blurOperation.set({blurRadius:s})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}}class __ extends to{constructor(e,t){super(t);this.data=e;this.type="image";const i=t.configuration.downscaleOptions;if(!i)this.downscaleOptions={maxDimensions:{width:t.maxTextureDimension,height:t.maxTextureDimension}};else{const{maxDimensions:o}=i;this.downscaleOptions={maxMegaPixels:i.maxMegaPixels,maxDimensions:{width:Math.min(t.maxTextureDimension,o?o.width:Number.MAX_VALUE),height:Math.min(t.maxTextureDimension,o?o.height:Number.MAX_VALUE)}}}this.setData(e);const{image:r}=this.data;this.bounds=new qt(E.ZERO,{width:r.width,height:r.height})}setData(e){if(this.data=y(y({},this.data),e),e.image){let{image:t}=e,i;if(t instanceof HTMLImageElement&&(i=this.engine.pesdk.parseExif(t),i)){const o=i.getTags();if(o&&o.Orientation){const n=o.Orientation!==1&&o.Orientation!==2,s=[2,4,5,7].indexOf(o.Orientation)!==-1;if(n||s){if(ti()||tl()||!CSS.supports("image-orientation","from-image")){const a=this.engine.pesdk.createOperation("exif-orientation",{},!1);a.setTags(o),t=a.applyTo(t)}i.setOrientation(1),o.Orientation=1}}}const r=new _m(t,this.downscaleOptions);r.on(Ln.IMAGE_DOWNSCALED,()=>{this.engine.emit(ia.IMAGE_DOWNSCALED)}),r.on(Ln.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(ia.BEGAN_IMAGE_DOWNSCALING)}),t=r.downscaleIfNecessary(),this.data.image=t,this.engine.pesdk.setImage(t,i),this.setBoundsFromSize(t.width,t.height)}}getData(){return this.data}setPivot(e,t){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}}class eD extends mi{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="linear-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=y(y({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),s=se.getBaseLocalToWorldMatrix(o),a=ve.multiply(ve.getInverted(n),s),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const d=se.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=d/l}if(e.start!==void 0){const d=ve.transformPoint(a,e.start),c=se.absoluteToRelativePoint(d,i,!1);t.controlPoint1=c}if(e.end!==void 0){const d=ve.transformPoint(a,e.end),c=se.absoluteToRelativePoint(d,i,!1);t.controlPoint2=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}}class tD extends mi{constructor(e,t,i,r){super(r);this.filter=e;this.filterOperation=t;this.props=i;this.type="lut-filter";t.set({intensity:i.intensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{intensity:e.intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(e){const t=this.filterOperation.getOptions(),i=typeof e.intensity=="number"?e.intensity:t.intensity;this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}}class iD extends mi{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="mirrored-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=y(y({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),s=se.getBaseLocalToWorldMatrix(o),a=ve.multiply(ve.getInverted(n),s),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const d=se.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=d/l}if(e.gradientSize!==void 0){const d=se.scalarFromSpaceToSpace(e.gradientSize,o,i),c=d/l;t.gradientSize=c}if(e.clearAreaWidth!==void 0){const d=se.scalarFromSpaceToSpace(e.clearAreaWidth,o,i),c=d/l;t.size=c*.5}if(e.mirrorAxisOrigin!==void 0){const d=ve.transformPoint(a,e.mirrorAxisOrigin),c=se.absoluteToRelativePoint(d,i,!1);t.start=c}if(e.mirrorAxisDirection!==void 0){const d=ve.transformPoint(a,e.mirrorAxisDirection),c=se.absoluteToRelativePoint(d,i,!1);t.end=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}}class x_ extends to{constructor(e,t,i,r){super(r);this.settings=e;this.operation=t;this.flipOperation=i;this.type="output";this.flipTransform=ve.IDENTITY;this.blockTransformUpdate=!1;this.transformUpdateWhileBlock=!1;this.bounds=new qt({x:0,y:0},this.settings.resolution),this.setData(e)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(e){if(this.settings=y(y({},this.settings),e),e.resolution&&(this.setBoundsFromSize(e.resolution.width,e.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new it(e.resolution.width,e.resolution.height)})),e.flipHorizontally!==void 0){const t=e.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:t})}if(e.flipVertically!==void 0){const t=e.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:t})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(e){this.setData({resolution:e})}getResolution(){return this.getData().resolution}setTransform(e){if(this.transform.rotation!==e.rotation||this.transform.position!==e.position||this.transform.scale!==e.scale){this.transform=e;const t=this.flipTransform;this.flipTransform=ve.IDENTITY;const i=this.engine.getRootContainers()[0],r=se.pointFromSpaceToSpace({x:0,y:0},i,this),o=-e.rotation,n=it.fromObject(r).clone().subtract(it.fromObject(this.getBounds().origin));this.operation.set({pivot:new it(0,0),position:n,scale:new it(1/e.scale.x,1/e.scale.y),rotation:o}),this.flipTransform=t,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate90(e=!1){const t=e?-Math.PI*.5:Math.PI*.5,i=this.getResolution(),r=this.getPivot(),o=this.getBounds(),n={x:o.midX,y:o.midY},s=se.getPointInWorldSpace(n,this);this.setPivot(.5,.5),this.setPosition(s),this.setRotation(this.getRotation()-t);const a={width:i.height,height:i.width};this.setResolution(a);const l={x:-a.width*(.5-r.x),y:-a.height*(.5-r.y)},d=se.getPointInWorldSpace(l,this);this.setPivot(r),this.setPosition(d),this.updateChildrenContainers()}setPivot(e,t){super.setPivotInternal(e,t),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return se.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){const e=se.rectTransformToAffineTransform(this.getTransform());return ve.multiply(e,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){const{flipHorizontally:e,flipVertically:t}=this.settings;if(!e&&!t)this.flipTransform=ve.IDENTITY;else{const i=this.getPivot(),r=this.getBounds(),o=e?-1:1,n=e?-2*(i.x-.5)*r.width:0,s=t?-1:1,a=t?-2*(i.y-.5)*r.height:0;this.flipTransform=new ve(o,0,0,s,n,a)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=!0;return}this.engine.rootOperations.forEach(e=>{eg(e)?(e.updateTransform(),"updateData"in e&&e.updateData()):"updateProperties"in e&&e.updateProperties()})}}class w_ extends mi{constructor(e,t,i){super(i);this.overlayOperation=e;this.type="overlay";const r=t.blendMode||i.mapBlendMode(e.getBlendMode());e.set({blendMode:i.reverseMapBlendMode(r)}),e.set({image:t.image}),i.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.overlayOperation.getOptions();return{image:e.image,blendMode:this.engine.mapBlendMode(e.blendMode),opacity:e.alpha}}setProperties(e){const t=this.overlayOperation.getOptions();typeof e.opacity=="number"&&(t.alpha=e.opacity),e.blendMode!==void 0&&(t.blendMode=this.engine.reverseMapBlendMode(e.blendMode)),this.overlayOperation.set(t),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(e){this.overlayOperation.setFlipHorizontally(e)}setFlipVertically(e){this.overlayOperation.setFlipVertically(e)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}}class rD extends mi{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="radial-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=y(y({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),n=i.getBaseLocalToParentMatrix(),s=se.getBaseLocalToWorldMatrix(o),a=ve.multiply(ve.getInverted(n),s),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const d=se.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=d/l}if(e.center!==void 0){const d=ve.transformPoint(a,e.center),c=se.absoluteToRelativePoint(d,i,!1);t.position=c}if(e.radius!==void 0){const d=se.scalarFromSpaceToSpace(e.radius,o,i),c=d/l;t.radius=c}if(e.gradientSize!==void 0){const d=se.scalarFromSpaceToSpace(e.gradientSize,o,i),c=d/l;t.gradientRadius=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}}class C_ extends to{constructor(e,t){super(t);this.data=e;this.type="sticker";let i=e.image;const r=this.engine.pesdk.parseExif(e.image);if(r){const n=r.getTags();if(n&&n.Orientation){const s=n.Orientation!==1&&n.Orientation!==2,a=[2,4,5,7].indexOf(n.Orientation)!==-1;if(s||a){const l=this.engine.pesdk.createOperation("exif-orientation",{},!1);l.setTags(n),i=l.applyTo(e.image),r.setOrientation(1),n.Orientation=1}}}const o=new _m(i,{maxMegaPixels:{desktop:10,mobile:5}});i=o.downscaleImageIfNecessary(),this.operation=t.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:i,position:new it(0,0),dimensions:new it(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new qt({x:0,y:0},{width:i.width,height:i.height}),this.setTransform(mt.IDENTITY),this.sprite.setPivot(new it(0,0)),this.operation.setDirty(!0),this.setData(e)}setData(e){this.data=y(y({},this.data),e),e.id&&(this.id=e.id),e.opacity&&this.sprite.setAlpha(e.opacity),e.tintColor&&this.sprite.setTintColor(fr(e.tintColor)),e.tintMode&&this.sprite.setTintMode(e.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent(),r={width:this.bounds.width*e.scale.x,height:this.bounds.height*e.scale.y},o=se.sizeFromSpaceToSpace(r,i,t);this.sprite.setDimensions(it.fromSize(o));const n=se.pointFromSpaceToSpace(e.position,i,t,!0),s=se.absoluteToRelativePoint(n,t,!1);this.sprite.setPosition(new it(s.x,s.y));const a=se.getRotationBetweenCoordinateSpaces(i,t),l=e.rotation+a;this.sprite.setRotation(l),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}}function P6(e,t){const i=1/t.unitsPerEm*e,r=t.ascender*i,o=t.descender*i;return r+Math.abs(o)}class oD{constructor(e){this.context=e;this.sourceLines=[];this.maxWidth=100}static buildWords(e){const t=[];let i="";const r=e.length;for(let o=0;o<r;o+=1){const n=e[o];i+=n,(n===" "||n==="-"||o===r-1)&&(t.push(i),i="")}return t}getLines(){let e=[],t=[];const i=this.sourceLines.length;for(let r=0;r<i;r+=1){const o=this.sourceLines[r],n=oD.buildWords(o),s=n.length;for(let a=0;a<s;a+=1){const l=n[a],d=t.concat(l).join("").replace(/\s+$/i,""),c=this.getWidth(d);if(c>this.maxWidth){t.length>0&&(e.push(t.join("")),t=[l]);const p=l.replace(/\s+$/i,"");if(this.getWidth(p)>this.maxWidth){const h=this.splitWord(l);e=e.concat(h.lines),h.rest&&(t=[h.rest])}}else t.push(l)}e.push(t.join("")),t=[]}return e}splitWord(e){const t={lines:[],rest:null},i=e.length;let r=[];for(let o=0;o<i;o+=1){const n=e[o];this.getWidth(r.concat(n).join(""))>this.maxWidth?(r.length>0&&t.lines.push(r.join("")),r=[n]):r.push(n),o===i-1&&r.length>0&&(t.rest=r.join(""))}return t}getWidth(e){return this.context.measureText(e).width}setText(e){this.sourceLines=e.split(`
`)}setMaxWidth(e){this.maxWidth=e}}function _l(e,t,i,r,o,n,s){e.font=`${i.fontStyle||"normal"} ${i.fontWeight||"normal"} ${r}px "${i.fontFamily}"`;const a=new oD(e);a.setText(t),a.setMaxWidth(n);const l=a.getLines().map(p=>p.replace(/\s+$/i,"")),d=P6(r,s),c=d*o;return{width:n,height:l.length*c}}const Ic=e=>2*Math.PI-e,B6=e=>-e,up=({rotation:e,flipHorizontally:t,flipVertically:i})=>{let r=e;return t&&(r=Ic(r)),i&&(r=B6(r)),r};class xl extends to{constructor(e,t){super(t);this.text=e;this.type="text";if(!xl.measureContext){const a=document.createElement("canvas");xl.measureContext=a.getContext("2d")}this.operation=t.createSpriteOperation();const i=this.engine.getOutputContainer(),r=this.getParent(),o=i.getBounds();this.sprite=this.operation.createText({text:e.text,position:new it(0,0),rotation:0,fontSize:se.scalarFromSpaceToSpace(e.fontSize/o.height,r,i),lineHeight:e.lineHeight,fontIdentifier:e.fontIdentifier,alignment:e.alignment,color:fr(e.textColor),backgroundColor:fr(e.backgroundColor),maxWidth:se.scalarFromSpaceToSpace(e.width/o.width,r,i)});const n=t.assetProvider.getFontManager().getFontWithId(e.fontIdentifier);this.sprite.setFontFamily(n.fontFamily),this.sprite.setFontWeight(n.fontWeight||"normal"),this.sprite.setFontStyle(n.fontStyle||"normal"),this.sprite.setFontIdentifier(n.identifier),this.sprite.setTextMetrics(n.textMetrics),this.sprite.setPivot(new it(0,0)),this.operation.addSprite(this.sprite);const s=_l(xl.measureContext,e.text,n,e.fontSize,e.lineHeight,e.width,n.textMetrics);this.bounds=new qt(0,0,s.width,s.height),this.setTransform(mt.IDENTITY),this.operation.setDirty(!0)}setData(e){this.text=y(y({},this.text),e);const t=this.engine.assetProvider.getFontManager().getFontWithId(e.fontIdentifier||this.text.fontIdentifier);if(e.fontIdentifier&&(this.sprite.setFontFamily(t.fontFamily),this.sprite.setFontWeight(t.fontWeight||"normal"),this.sprite.setFontStyle(t.fontStyle||"normal"),this.sprite.setFontIdentifier(t.identifier),this.sprite.setTextMetrics(t.textMetrics)),e.id&&(this.id=e.id),e.text&&this.sprite.setText(e.text),e.fontSize){const r=this.engine.getOutputContainer(),o=this.getParent(),n=se.scalarFromSpaceToSpace(e.fontSize,o,r),s=r.getBounds();this.sprite.setFontSize(n/s.height)}if(e.alignment&&this.sprite.setAlignment(e.alignment),e.lineHeight&&this.sprite.setLineHeight(e.lineHeight),e.textColor&&this.sprite.setColor(fr(e.textColor)),e.backgroundColor&&this.sprite.setBackgroundColor(fr(e.backgroundColor)),e.width){const r=this.engine.getOutputContainer(),o=this.getParent(),n=se.scalarFromSpaceToSpace(e.width,o,r),s=r.getBounds();this.sprite.setMaxWidth(n/s.width)}const i=_l(xl.measureContext,this.text.text,t,this.text.fontSize,this.text.lineHeight,this.text.width,t.textMetrics);this.setBoundsFromSize(i.width,i.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent(),r=se.pointFromSpaceToSpace(e.position,i,t,!0),o=se.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new it(o.x,o.y));const n=se.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:e})),this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setRotation(this.getFlippedRotation({flipVertically:e})),this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:e,flipHorizontally:t}){const i=e||this.getFlipVertically(),r=t||this.getFlipHorizontally();let o=this.getRotation();return(i||r)&&(o=Ic(o)),o}}const S_=1e3;class mp extends to{constructor(e,t,i){super(i);this.textDesign=e;this.layout=t;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=t.identifier,this.operation=i.createSpriteOperation();const r=this.engine.getOutputContainer(),o=this.getParent(),n=r.getBounds(),s=Math.min(n.width,n.height);t.seed(e.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);const a=e.width;this.sprite=this.operation.createTextDesign({text:e.text,layout:t,inverted:e.inverted,color:fr(e.color),width:se.scalarFromSpaceToSpace(e.width/s,o,r),padding:e.padding/a,seed:e.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(mt.IDENTITY),this.operation.setDirty(!0)}static stringify(e){return JSON.stringify(e,mp.serializer())}static serializer(){const e=[],t=[],i=(r,o)=>e[0]===o?"[Circular ~]":`[Circular ~.${t.slice(0,e.indexOf(o)).join(".")}]`;return function(o,n){const s=this;if(e.length>0){const a=e.indexOf(s);~a?(e.splice(a+1),t.splice(a,Infinity,o)):(e.push(s),t.push(o)),~e.indexOf(n)&&(n=i.call(s,o,n))}else e.push(n);return n}}calculateBounds(e,t,i=!0){const r=e.inverted&&i?Math.max(0,2*e.padding):0,o=e.width/S_;if(this.currentLayoutSize===void 0){t.seed(e.seed);const n=t.generateLayoutData(e.text,S_);this.currentLayoutData=n,this.currentLayoutSize=n.getSize()}return new qt(0,0,this.currentLayoutSize.width*o+r,this.currentLayoutSize.height*o+r)}findNextUniqueSeed(e,t,i){let r=i;const o=this.currentLayoutData?mp.stringify(this.currentLayoutData.getRows()):"";let n;for(let s=0;s<20&&(t.seed(r),n=t.generateLayoutData(e.text,S_),o===mp.stringify(n.getRows()));s+=1)r+=1;return t.seed(r),this.currentLayoutData=n,r}setData(e){if(this.textDesign=y(y({},this.textDesign),e),e.id&&(this.id=e.id),e.padding!==void 0){const t=this.textDesign.width;this.sprite.setPadding(e.padding/t)}else e.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(e.seed!==void 0&&(e.seed<0&&(e.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=e.seed),this.currentLayoutSize=void 0,this.layout.seed(e.seed),this.sprite.setSeed(e.seed),this.sprite.setLayout(this.layout)),e.color&&this.sprite.setColor(fr(e.color)),e.inverted!==void 0&&this.sprite.setInverted(e.inverted),e.text&&(this.currentLayoutSize=void 0,this.sprite.setText(e.text)),e.width){const t=this.engine.getOutputContainer(),i=this.getParent(),r=t.getBounds(),o=Math.min(r.width,r.height),n=se.scalarFromSpaceToSpace(e.width/o,i,t);this.sprite.setWidth(n)}if(e.padding!==void 0||e.seed!==void 0||e.inverted!==void 0||e.text||e.width){const t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent();if(e.scale.x!==1||e.scale.y!==1)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");const r=se.pointFromSpaceToSpace(e.position,i,t,!0),o=se.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new it(o.x,o.y));const n=se.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n),this.operation.setDirty(!0)}setPivot(e,t){typeof e=="number"?super.setPivot(e,t):super.setPivot(e),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){const e=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,t=new E(this.bounds.width-2*e,this.bounds.height-2*e),i=this.getPivot(),r=new E(i.x*this.bounds.width,i.y*this.bounds.height),o=new E(e,e),n=r.subtract(o),s=n.divide(t);this.sprite.setPivot(new it(s.x,s.y))}}const{BLEND_MODES:ri}=oe.Operations.OverlayOperation,tg="imgly_font_open_sans_bold";class fp extends $E{constructor(e){super(e);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()};if(this.assetProvider=e.assetProvider||new wm,this.wrapper=new ta({license:e.license,crossOrigin:e.crossOrigin,assets:{resolver:(t,i)=>this.resolveAssetForSDK(t,i)},editor:{preferredRenderer:e.preferredRenderer,pixelRatio:1}}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),e.preferredRenderer==="webgl"){const t=document.createElement("canvas"),i=t.getContext("webgl")||t.getContext("experimental-webgl");this.maxTextureDimension=i.getParameter(i.MAX_TEXTURE_SIZE)}else this.maxTextureDimension=Infinity}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){this.pesdk.dispose(),this.wrapper.dispose()}render(e){return new Promise(t=>{const i=()=>new Promise(r=>{const{canvas:o}=e,n=e.getTransform(),s=this.outputContainer.getPivot(),a=e.getCanvasBounds(),l=e.quality,{tempCanvas:d}=this;this.sdk.setTextureQuality(l);const c=this.sdk.getOutputDimensions();return d.width=c.x,d.height=c.y,this.sdk.getRenderer().resizeTo(new it(d.width,d.height)),this.sdk.render(!0).then(()=>{const p=o.getContext("2d");p.clearRect(0,0,o.width,o.height),p.save(),p.translate(-a.minX,-a.minY),p.translate(n.position.x,n.position.y),p.rotate(n.rotation),p.scale(n.scale.x,n.scale.y),p.translate(-s.x*d.width,-s.y*d.height),p.scale(1/e.quality,1/e.quality),p.drawImage(d,0,0),p.restore(),t(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(r))):r()})});this.deferredRenderQueue.push(i),this.deferredRenderQueue.length===1&&i()})}createPreview(e){const t=new VE(e,this);return this.previews.push(t),t}export(){return Z(this,arguments,function*(e=ci.IMAGE,t=Ut.PNG,i=1){return new Promise(r=>{const o=()=>new Promise(n=>this.sdk.export(this.mapToRenderType(e),this.mapToImageFormat(t),i).then(s=>{r(s),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(n)):n()}));this.deferredRenderQueue.push(o),this.deferredRenderQueue.length===1&&o()})})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(e){return e===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find(t=>t.getID()===e)}findEffectByID(e){return this.rootOperationStack.find(t=>t.getID()===e)}addImage(e,t,i){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");const r=new __(e,this);if(this.rootContainer=r,!this.outputContainer){const{width:o,height:n}=r.getBounds(),s={resolution:{width:o,height:n},flipHorizontally:!1,flipVertically:!1},a=this.sdk.createOperation("output",{},!1),l=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(a,this.operationStackOffset-1),this.insertIntoOperationsStack(l,this.operationStackOffset),this.outputContainer=new x_(s,a,l,this)}return r}addSticker(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(t);const r=new C_(e,this);return this.addToStackAtIndex(r,i),r}addStickerFromAssets(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(t),new Promise((r,o)=>{const n=new Image;n.onload=()=>{const s={image:n,opacity:1},a=new C_(s,this);this.addToStackAtIndex(a,i),r(a)},n.onerror=s=>{o(s)},n.crossOrigin=this.config.crossOrigin||null,n.src=this.assetProvider.getAssetSource("sticker",e)})}addText(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");const r=this.assetProvider.getFontManager();if(!r.isFontLoaded(e.fontIdentifier||tg))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(t);const o=y({text:"",fontIdentifier:tg,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),n=new xl(o,this);return this.addToStackAtIndex(n,i),n}addTextWithFontLoading(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");const r=this.assetProvider.getFontManager(),o=e.fontIdentifier||tg;return new Promise((n,s)=>{r.loadFontWithIdentifier(o).then(()=>{this.ensureContainerIsRoot(t);const a=y({text:"",fontIdentifier:tg,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),l=new xl(a,this);this.addToStackAtIndex(l,i),n(l)}).catch(s)})}addTextDesignAsync(e="imgly_text_design_blocks",t,i,r){return Z(this,null,function*(){if(!i)throw new Error("This engine does not support adding TextDesign as a root element.");const o=y({seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100},t),n=this.wrapper.getTextDesignLayoutByID(e);if(!n)throw new Error(`The layout could not be loaded for the given id: ${e}`);const s=n.getImagePaths().map(h=>{const m=h.split("/").pop()||"";return{path:h,fullPath:this.assetProvider.getAssetSource("textdesign",m)}}),a=this.wrapper.getTextDesignAssetManager(),l=this.wrapper.getTextDesignFontManager(),d=l.getVariationsByIdentifier();a.setFonts(d),yield a.loadImages(s),n.onImagesLoaded();const c=Object.keys(d),p=this.assetProvider.getFontManager();return p.loadFontsWithIdentifiers(c).then(()=>{this.ensureContainerIsRoot(i);const h=new mp(o,n,this);return this.addToStackAtIndex(h,r),Promise.resolve(h)})})}addDrawing(e,t,i){if(!t)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(t);const r=new XE(e,this);return this.addToStackAtIndex(r,i),r}addGaussianBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new QE(e,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(r,i),r}addRadialBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new rD(e,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(r,i),r}addMirroredBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new iD(e,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(r,i),r}addLinearBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new eD(e,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(r,i),r}addDuoToneFilter(e,t,i){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack(),o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types of filter operations at once!");const n=o||this.sdk.createOperation("filter",{},!1);return new Promise((s,a)=>{try{const l=this.assetProvider.getDuotoneFilterAsset(e),d={colorIntensity:l.defaultIntensity||0},c=new oe.Operations.FilterOperation.Filters.DuoToneFilter({intensity:d.colorIntensity,lightColor:oe.Color.fromHex(l.lightColor),darkColor:oe.Color.fromHex(l.darkColor)}),p=new YE(c,n,d,this);this.addToStackAtIndex(p,i),s(p)}catch(l){l&&a(l)}})}addLUTFilter(e,t,i){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack(),o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types filter operations at once!");const n=o||this.sdk.createOperation("filter",{},!1);return new Promise((s,a)=>{const l=new Image;l.addEventListener("load",()=>{const d=this.assetProvider.getLUTFilterAsset(e),c={horizontalTileCount:d.horizontalTileCount||5,verticalTileCount:d.verticalTileCount||5,intensity:d.defaultIntensity||1},p=new oe.Operations.FilterOperation.Filters.ThreeDLUTFilter(y(y({},c),{image:l})),h=y(y({},c),{lutImage:new Image}),m=new tD(p,n,h,this);this.addToStackAtIndex(m,i),s(m)}),l.addEventListener("error",d=>{a(d)}),l.crossOrigin=this.config.crossOrigin||null,l.src=this.assetProvider.getAssetSource("filter",e)})}addAdjustments(e,t,i){this.ensureContainerIsRoot(t);const r=new qE(e,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(r,i),r}addOverlay(e,t,i){this.ensureContainerIsRoot(t);const r=new w_(this.sdk.createOperation("overlay",{},!1),e,this);return this.addToStackAtIndex(r,i),r}addOverlayFromAssets(e,t,i){return this.ensureContainerIsRoot(t),new Promise((r,o)=>{const n=this.sdk.getOperationsStack(),s=n.getByIdentifier("overlay");s&&s.getIdentifier()!==e&&n.remove(s);const a=s||this.sdk.createOperation("overlay",{},!1),l=new Image;l.onload=()=>{const d={image:l,opacity:1,blendMode:ye.NORMAL},c=new w_(a,d,this);this.addToStackAtIndex(c,i),r(c)},l.onerror=d=>{o(d)},l.crossOrigin=this.config.crossOrigin||null,l.src=this.assetProvider.getAssetSource("overlay",e)})}addFrame(e,t,i){throw new Error("Not supported!")}addFrameFromAssets(e,t,i){return Z(this,null,function*(){this.ensureContainerIsRoot(t);const r=this.assetProvider.getFrameAsset(e);if(!r)throw new Error(`The requested asset does not exist! ${e}`);const o=new JE(r,this);yield o.load();const n=this.getOutputContainer().getBounds(),s=Math.min(n.width,n.height),a=this.sdk.createOperation("frame",{},!1);a.setFrame(o.getFrame());const l={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*s),imageGroups:o.getFrame().imageGroups},d=new ZE(a,l,this);return this.addToStackAtIndex(d,i),Promise.resolve(d)})}removeEffect(e){if(!e.isValid())return;const t=e,i=t.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}removeContainer(e){if(!e.isValid()||e.type==="output")return;const t=e,i=t.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}refreshOutputIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(e,this.operationStackOffset-1)}refreshFlipIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),t=this.sdk.getOperationsStack().getStack().length-1;e!==t&&this.moveInOperationsStack(e,t)}refreshFrameIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),t=this.sdk.getOperationsStack().getStack().length-1;e!==-1&&e!==t&&this.moveInOperationsStack(e,t)}mapToRenderType(e){switch(e){case ci.IMAGE:return oe.RenderType.IMAGE;case ci.DATA_URL:return oe.RenderType.DATAURL;case ci.BLOB:return oe.RenderType.BLOB;case ci.MSBLOB:return oe.RenderType.MSBLOB;default:return oe.RenderType.IMAGE}}mapToImageFormat(e){switch(e){case Ut.PNG:return oe.ImageFormat.PNG;case Ut.JPEG:return oe.ImageFormat.JPEG;default:return null}}mapBlendMode(e){switch(e){case ri.NORMAL:return ye.NORMAL;case ri.OVERLAY:return ye.OVERLAY;case ri.HARD_LIGHT:return ye.HARD_LIGHT;case ri.SOFT_LIGHT:return ye.SOFT_LIGHT;case ri.MULTIPLY:return ye.MULTIPLY;case ri.DARKEN:return ye.DARKEN;case ri.LIGHTEN:return ye.LIGHTEN;case ri.SCREEN:return ye.SCREEN;case ri.COLOR_BURN:return ye.COLOR_BURN;default:return ye.NORMAL}}reverseMapBlendMode(e){switch(e){case ye.NORMAL:return ri.NORMAL;case ye.OVERLAY:return ri.OVERLAY;case ye.HARD_LIGHT:return ri.HARD_LIGHT;case ye.SOFT_LIGHT:return ri.SOFT_LIGHT;case ye.MULTIPLY:return ri.MULTIPLY;case ye.DARKEN:return ri.DARKEN;case ye.LIGHTEN:return ri.LIGHTEN;case ye.SCREEN:return ri.SCREEN;case ye.COLOR_BURN:return ri.COLOR_BURN;default:return ri.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(e,t){const i=this.getSiblingIndex(e);if(i===-1)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,i,t);const r=this.operationStackOffset;this.moveInOperationsStack(i+r,t+r),this.enforceOperationOrder()}ensureContainerIsRoot(e){const t=e.getID();if(t!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(e,t){if(t&&t<0)throw new Error(`The given index may not be negative: ${t}`);t===void 0?this.rootOperationStack.push(e):this.rootOperationStack.splice(t,0,e);const i=this.rootOperationStack.length-1;let r=t!==void 0?t:i;r+=this.operationStackOffset,KE(e)?this.insertIntoOperationsStack(e.getOperation(),r):this.insertIntoOperationsStack(e.getOperation(),r),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.max(Math.min(t,r),0);for(let n=r-1;n>=o;n-=1){const s=i[n];i[n+1]=s}i[o]=e,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(e,t,i){const r=e.length,o=Math.max(Math.min(t,r-1),0),n=Math.max(Math.min(i,r-1),0);if(o===n)return;const s=e[o];if(o<n)for(let a=o+1;a<=n;a+=1)e[a-1]=e[a];else for(let a=o-1;a>=n;a-=1)e[a+1]=e[a];e[n]=s}moveInOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.min(Math.max(0,e),r-1),n=Math.min(Math.max(0,t),r-1);if(o===n)return;const s=i[o];if(o<n)for(let a=o+1;a<=n;a+=1)i[a-1]=i[a];else for(let a=o-1;a>=n;a-=1)i[a+1]=i[a];i[n]=s,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(e){return e.getIndexInParent()}resolveAssetForSDK(e,t){t=t;switch(e){case"filter":return this.assetProvider.getAssetSource("filter",t.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",t.identifier);case"font":return this.assetProvider.getAssetSource("font",t.identifier)}return""}}class T_{constructor(e){this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isValid&&this.licenseChecker.areCustomAssetsAllowed();e&&e.length!==0&&(this.licenseChecker=new oe.LicenseChecker(e),this.isValid=this.licenseChecker.validate())}isToolAllowed(e){return this.licenseChecker&&this.isValid?this.licenseChecker.isToolAllowed(e):!0}}const k_=e=>{let t=Number(e).toString(16);return t.length<2&&(t=`0${t}`),t},nD=(e,t,i)=>{const r=k_(e*255),o=k_(t*255),n=k_(i*255);return`#${r}${o}${n}`},Yn=e=>{if(Qf(e)){const[t,i,r,o]=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Zf(e)){const{r:t,g:i,b:r,a:o}=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Jf(e)){const[t,i,r]=e;return nD(t,i,r)}if(Yf(e)){const{r:t,g:i,b:r}=e;return nD(t,i,r)}return e},Ao=e=>e.map(t=>({identifier:t.name,color:t.color,colorString:Yn(t.color)})),gr={black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],gray:[191/255,191/255,191/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]},E_={transparent:[0/255,0/255,0/255,0],black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]};const ig=[w.LIBRARY,[w.TRANSFORM,w.FILTER,w.ADJUSTMENT],[w.FOCUS,w.FRAME,w.OVERLAY],[w.TEXT,w.TEXT_DESIGN,w.STICKER,w.BRUSH]];const Gd={license:"",order:"default",language:"en",theme:"dark",layout:"advanced",mainCanvasActions:[he.UNDO,he.REDO,he.EXPORT,he.CLOSE],displayResizeWarning:!0,displayCloseWarning:!0,displayCanvasRendererWarning:!0,displayToolControlBarTitle:!0,engine:{crossOrigin:"anonymous",downscaleOptions:{maxMegaPixels:{desktop:10,mobile:5}},preferredRenderer:dS()?"webgl":"canvas"},enableZoom:!0,forceCrop:!1,assetBaseUrl:"assets/",defaultTool:w.FILTER,tools:ig,snapping:new hm,filter:new am,focus:new sm,adjustment:new cm,library:new om,overlay:new rm,sticker:new im,text:new Qu,textdesign:new Zu,frame:new nm,brush:new dm,transform:new Ju,export:{image:{exportType:ci.IMAGE,format:Ut.PNG,quality:.9,enableDownload:!0},filename:"photoeditorsdk-export"},custom:{}};const rg={[Re.BRIGHTNESS]:0,[Re.SATURATION]:0,[Re.CONTRAST]:0,[Re.GAMMA]:0,[Re.CLARITY]:0,[Re.EXPOSURE]:0,[Re.SHADOWS]:0,[Re.HIGHLIGHTS]:0,[Re.WHITES]:0,[Re.BLACKS]:0,[Re.TEMPERATURE]:0,[Re.SHARPNESS]:0};class ra{constructor(e,t){this.from=e,this.to=t}contains(e){return this.from<=e&&e<=this.to}clamp(e){return Math.min(Math.max(this.from,e),this.to)}}const wl=v(Ve()),M6=new ra(-1,1);class gp{constructor(e){this.engineMediator=e,this.state=rg}editAdjustments({type:e,value:t}){const i=M6.clamp(t);this.state[e]=i}reset(){wl.runInAction(()=>{this.indexInContainer===-1&&(Object.keys(rg).forEach(e=>{this.state[e]=rg[e]}),this.orderHelper.removeIndex(w.ADJUSTMENT))})}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get orderHelper(){return this.engineMediator.orderHelper}setAdjustmentEffect(e){const t=this.orderHelper.addIndex(w.ADJUSTMENT);return this.effect?this.effect.setProperties(e):this.effect=this.engineMediator.engine.addAdjustments(e,this.engineMediator.image.container,t),this.effect.getProperties()}removeAdjustmentEffect(){this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))}}u([wl.observable],gp.prototype,"state",2),u([wl.action],gp.prototype,"editAdjustments",1),u([wl.action],gp.prototype,"reset",1);class Ht{constructor(e,t){this.assets=[];this.withoutItems=e=>{const{items:t}=e,i=Jt(e,["items"]);return i};this.entityMapper=(e,t)=>Ht.isCategory(e)?this.categoryMapper(e,t):this.itemMapper(e,t);this.categoryMapper=(e,t)=>e?y(y({},e),{thumbnailURI:this.getCategoryURI(e),type:pe.LARGE,delay:t*.08,name:this.config.locale[e.identifier]||e.name,items:e.items.map(this.itemMapper)}):null;this.itemMapper=(e,t)=>e?y(y({},e),{thumbnailURI:this.getItemURI(e),type:pe.MEDIUM,delay:t*.08,name:this.config.locale[e.identifier]||e.name}):null;this.getCategoryURI=e=>jd(e)&&this.config.categoryDynamicKey?e[this.config.categoryDynamicKey]:e.thumbnailURI&&zs(e.thumbnailURI)?e.thumbnailURI:this.config.getAssetPath(e[this.config.categoryKey]||"");this.getItemURI=e=>Ls(e)&&this.config.itemDynamicKey?e[this.config.itemDynamicKey]:e.thumbnailURI&&zs(e.thumbnailURI)?e.thumbnailURI:this.config.getAssetPath(e[this.config.itemKey]||"");this.config=t,this.assets=e.map(this.entityMapper).filter(Boolean)}static isCategory(e){return Object.prototype.hasOwnProperty.call(e,"items")}get categories(){return this.assets.reduce((e,t)=>Ht.isCategory(t)?[...e,t]:void 0,[]).filter(Boolean)}getCategories(e){const t=this.assets.findIndex(i=>i.identifier===e);return this.categories}get items(){return this.assets.reduce((e,t)=>Ht.isCategory(t)?[...e,...t.items]:[...e,t],[]).filter(Boolean)}itemsOfCategory(e){const t=this.assets.findIndex(i=>i.identifier===e);if(t!==-1){const{items:i}=this.categories[t];return i}return[]}getEntities(e){if(this.config.flattenCategories)return this.items;if(e){const t=this.assets.findIndex(i=>i.identifier===e);if(t!==-1){const{items:i}=this.categories[t];return[...this.categories.slice(0,t+1),...i,...this.categories.slice(t+1)].map(this.withoutItems)}}return this.categories.map(this.withoutItems)}}const Oc=v(Ve());class bp{constructor(){this.snapshots=[];this.observeIndex=Oc.observable.box(-1)}addSnapshot(e){this.index===this.snapshots.length-1?this.snapshots=this.snapshots.concat(JSON.stringify(e)):this.snapshots=[...this.snapshots.slice(0,this.index+1),JSON.stringify(e)],this.observeIndex.set(this.snapshots.length-1)}getCurrentState(){return this.snapshots[this.index]}reset(){this.snapshots=[],this.observeIndex.set(-1)}undo(){return this.canUndo?(this.observeIndex.set(this.index-1),JSON.parse(this.getCurrentState())):null}redo(){return this.canRedo?(this.observeIndex.set(this.index+1),JSON.parse(this.getCurrentState())):null}discardSnapshotsfromIndex(e){e>0&&e<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,e),this.observeIndex.set(this.snapshots.length-1))}get index(){return this.observeIndex.get()}get canUndo(){return this.index>0}get canRedo(){return this.snapshots.length-1>this.index}}u([Oc.computed],bp.prototype,"index",1),u([Oc.computed],bp.prototype,"canUndo",1),u([Oc.computed],bp.prototype,"canRedo",1);const Fo=v(Ve());var be;(function(e){e.ADD="add",e.EDIT="edit",e.DELETE="delete"})(be||(be={}));class Rc{constructor(e){this.localTransformStartIndex=null;this.awaitHistoryChange=!1;this.isDirtySinceSave=!1;this.undo=()=>Z(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.undo();yield this.applyState(e),this.awaitHistoryChange=!1,this.canUndo||(this.isDirtySinceSave=!1)}});this.redo=()=>Z(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.redo();yield this.applyState(e),this.awaitHistoryChange=!1}});this.editor=e,this.appHistoryManager=new bp}get canUndo(){return this.appHistoryManager.canUndo}get canRedo(){return this.appHistoryManager.canRedo}getHistoryState(){const e=Fo.toJS(this.editor.adjustmentsToolStore.state),t=Fo.toJS(this.editor.filterToolStore.state),i=this.editor.focusToolStore.getFocusStateForHistory(),r=Fo.toJS(this.editor.overlayToolStore.state),o=Fo.toJS(this.editor.frameToolStore.state),n=this.editor.brushToolStore.strokes||{strokes:[]},s=this.editor.spriteStore.getSpriteHistoryState(),a=this.editor.transformToolStore.serializableState;return{[w.ADJUSTMENT]:e,[w.FILTER]:t,[w.FOCUS]:i,[w.OVERLAY]:r,[w.FRAME]:o,[w.BRUSH]:n,sprite:s,[w.TRANSFORM]:a}}addInitialSnapshot(){const e=this.getHistoryState();this.appHistoryManager.addSnapshot({state:e,type:be.ADD,description:"Initial State"})}addSnapshot(e=this.getHistoryState(),t,i){e&&((e.sprite||e.transform)&&(e=y(y({},this.getHistoryState()),e)),this.appHistoryManager.addSnapshot({state:e,type:t,description:i}),this.editor.configStore.events.onHistoryChange(),this.isDirtySinceSave||(this.isDirtySinceSave=!0))}saveTransformLocalSnapshotIndex(){this.localTransformStartIndex===null&&(this.localTransformStartIndex=this.appHistoryManager.snapshots.length)}removeTransformLocalSnapshots(){this.localTransformStartIndex!==null&&(this.appHistoryManager.discardSnapshotsfromIndex(this.localTransformStartIndex-1),this.localTransformStartIndex=null)}applyState(t){return Z(this,arguments,function*({state:e}){try{if(e){const i=Object.keys(e);for(const r of i)switch(r){case w.FILTER:yield this.editor.filterToolStore.updateStateFromHistory(e[r]);break;case w.ADJUSTMENT:yield this.editor.adjustmentsToolStore.updateStateFromHistory(e[r]);break;case w.OVERLAY:yield this.editor.overlayToolStore.updateStateFromHistory(e[r]);break;case w.FRAME:yield this.editor.frameToolStore.updateStateFromHistory(e[r]);break;case w.FOCUS:yield this.editor.focusToolStore.updateStateFromHistory(e[r],this.editor.canvasStore.sizeVector);break;case w.BRUSH:yield this.editor.brushToolStore.updateStateFromHistory(e[r]);break;case"sprite":yield this.editor.spriteStore.updateStateFromHistory(e[r]);break;case"localTransform":yield this.editor.transformToolStore.updateLocalStateFromHistory(e.localTransform);break;case w.TRANSFORM:this.editor.outputContainer.pauseChildrenUpdates(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e[r],!1),this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.onLeave(),this.editor.outputContainer.resumeChildrenUpdates(),yield this.editor.wait();break}yield this.editor.renderPromise()}}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:ot.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}isDirty(){return this.appHistoryManager.snapshots.length>1}reset(){this.appHistoryManager.reset(),this.isDirtySinceSave=!1}}u([Fo.action],Rc.prototype,"undo",2),u([Fo.action],Rc.prototype,"redo",2),u([Fo.computed],Rc.prototype,"canUndo",1),u([Fo.computed],Rc.prototype,"canRedo",1);const Xe=v(Ve());class nt{constructor(e){this.dirty=Xe.observable.box(!1);this.reset=()=>{this.pureReset(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.adjustmentsStore=new gp(this.editor.engineMediator),this.selectedOption="";const t=this.editor.assetProvider.getAssets("adjustment");this.entityManager=new Ht(t,y(y({},this.config),{categoryKey:"",itemKey:"thumbnailURI",locale:y(y({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("adjustment")}))}editAdjustments({type:e,value:t}){this.pureSetAdjustment({type:e,value:t}),this.editor.render()}toolSnapshot(){this.dirty.set(!0),this.addSnapshot(be.EDIT,w.ADJUSTMENT)}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}toggleOptionSelection(e){this.selectedOption=e}pureSetAdjustment({type:e,value:t}){const i=this.adjustmentsStore.setAdjustmentEffect({[e]:t});this.adjustmentsStore.editAdjustments({type:e,value:i[e]})}pureReset(){this.dirty.set(!1),this.adjustmentsStore.removeAdjustmentEffect(),this.adjustmentsStore.reset(),this.selectedOption=""}updateStateFromHistory(e){Xe.runInAction(()=>{Object.keys(e).forEach(t=>{this.pureSetAdjustment({type:t,value:e[t]})})})}updateStateFromSerialization(e){this.updateStateFromHistory(e)}get selectedAdjustmentType(){return this.selectedOption}get isDirty(){return this.dirty.get()}get state(){return this.adjustmentsStore.state}get selectedOptionLabel(){const e=this.items.find(t=>t?t.identifier===this.selectedOption:!1);return e?e.name:""}get brightness(){return this.state.brightness}get saturation(){return this.state.saturation}get contrast(){return this.state.contrast}get gamma(){return this.state.gamma}get clarity(){return this.state.clarity}get exposure(){return this.state.exposure}get shadows(){return this.state.shadows}get highlights(){return this.state.highlights}get whites(){return this.state.whites}get blacks(){return this.state.blacks}get temperature(){return this.state.temperature}get sharpness(){return this.state.sharpness}get categories(){return this.entityManager.categories}get items(){return this.entityManager.categories.reduce((e,t)=>{const i=Ht.isCategory(t)?t.items:[t];return[...e,...i]},[])}get config(){return this.editor.configStore.config[w.ADJUSTMENT]}get locale(){return this.editor.configStore.locale[w.ADJUSTMENT]}}u([Xe.observable],nt.prototype,"selectedOption",2),u([Xe.observable],nt.prototype,"dirty",2),u([Xe.action],nt.prototype,"editAdjustments",1),u([Xe.action],nt.prototype,"toggleOptionSelection",1),u([Xe.action],nt.prototype,"pureSetAdjustment",1),u([Xe.action],nt.prototype,"pureReset",1),u([Xe.action],nt.prototype,"reset",2),u([Xe.action],nt.prototype,"updateStateFromHistory",1),u([Xe.action],nt.prototype,"updateStateFromSerialization",1),u([Xe.computed],nt.prototype,"selectedAdjustmentType",1),u([Xe.computed],nt.prototype,"isDirty",1),u([Xe.computed],nt.prototype,"state",1),u([Xe.computed],nt.prototype,"selectedOptionLabel",1),u([Xe.computed],nt.prototype,"brightness",1),u([Xe.computed],nt.prototype,"saturation",1),u([Xe.computed],nt.prototype,"contrast",1),u([Xe.computed],nt.prototype,"gamma",1),u([Xe.computed],nt.prototype,"clarity",1),u([Xe.computed],nt.prototype,"exposure",1),u([Xe.computed],nt.prototype,"shadows",1),u([Xe.computed],nt.prototype,"highlights",1),u([Xe.computed],nt.prototype,"whites",1),u([Xe.computed],nt.prototype,"blacks",1),u([Xe.computed],nt.prototype,"temperature",1),u([Xe.computed],nt.prototype,"sharpness",1),u([Xe.computed],nt.prototype,"categories",1),u([Xe.computed],nt.prototype,"items",1),u([Xe.computed],nt.prototype,"config",1),u([Xe.computed],nt.prototype,"locale",1);const og={identifier:"identity",intensity:1,isDuotone:!1};const Cl=v(Ve()),L6=new ra(0,1);class Sl{constructor(e){this.setEffectProperties=({intensity:e})=>this.effect?(this.state.isDuotone?this.effect.setProperties({colorIntensity:e}):this.effect.setProperties({intensity:e}),this.effect.getProperties()):null;this.engineMediator=e,this.state=og}changeIdentifier(e){this.state.identifier=e}changeIfDuotone(e){this.state.isDuotone=e}changeIntensity(e){const t=L6.clamp(e);this.state.intensity=t}reset(){this.indexInContainer===-1&&(this.state.identifier=og.identifier,this.state.intensity=og.intensity,this.removeIndex())}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}setFilterEffect({identifier:e,intensity:t,isDuotone:i}){const r=this.state;this.changeIdentifier(e),this.changeIntensity(t),this.changeIfDuotone(i),this.removeFilterEffect();const o=this.engineMediator.orderHelper.addIndex(w.FILTER);return i?new Promise((n,s)=>{this.engineMediator.engine.addDuoToneFilterFromAssets(e,this.engineMediator.image.container,o).then(a=>{this.effect=a,this.effect.setProperties({colorIntensity:t}),n()}).catch(a=>{this.fallbackOnError(r),s(a)})}):new Promise((n,s)=>{this.engineMediator.engine.addLUTFilterFromAssets(e,this.engineMediator.image.container,o).then(a=>{this.effect=a,this.effect.setProperties({intensity:t}),n()}).catch(a=>{this.fallbackOnError(r),s(a)})})}removeFilterEffect(){this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))}removeIndex(){this.engineMediator.orderHelper.removeIndex(w.FILTER)}fallbackOnError(e){this.changeIdentifier(e.identifier),this.changeIntensity(e.intensity),e.identifier==="identity"&&this.removeIndex()}}u([Cl.observable],Sl.prototype,"state",2),u([Cl.action],Sl.prototype,"changeIdentifier",1),u([Cl.action],Sl.prototype,"changeIfDuotone",1),u([Cl.action],Sl.prototype,"changeIntensity",1),u([Cl.action],Sl.prototype,"reset",1);const Vt=v(Ve()),D_="identity";class Xt{constructor(e){this.changeIntensity=e=>{const t=this.isOptionDuoTone(this.identifier),i=this.filterStore.setEffectProperties({intensity:e});if(i){const r=t?i.colorIntensity:i.intensity;this.filterStore.changeIntensity(r),this.editor.render()}};this.reset=()=>{this.pureReset(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.selectedCategory=D_,this.filterStore=new Sl(this.editor.engineMediator);const{config:t}=this,i=this.editor.configStore.assetProvider.getAssets("filter");this.entityManager=new Ht(i,y(y({},t),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))}selectFilter(e,t=1){return Z(this,null,function*(){e!==this.identifier&&(yield this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:this.isOptionDuoTone(e)}),this.editor.render(),this.addSnapshot(be.ADD,w.FILTER))})}setImageAndGetPreviews(){return Z(this,null,function*(){const{image:e}=this.editor.activeStore.state;yield this.editor.previewThumbnails.addImageToContainer(e),yield this.getAllFilterPreview()})}getAllFilterPreview(){return Z(this,null,function*(){const e=this.entityManager.items.map(o=>({identifier:o.identifier,isDuotone:this.isOptionDuoTone(o.identifier)})),t=yield this.editor.previewThumbnails.getAllFilterPreviewThumbnails(e);yield this.editor.wait();const{config:i}=this,r=this.editor.configStore.assetProvider.getAssets("filter").map(o=>y(y({},o),{items:o.items.map(n=>y(y({},n),{thumbnail:t[n.identifier]}))}));this.entityManager=new Ht(r,y(y({},i),{categoryKey:"thumbnailURI",itemDynamicKey:"thumbnail",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))})}toolSnapshot(){this.addSnapshot(be.EDIT,this.locale.controls.sliderIntensity)}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}pureReset(){this.selectedCategory=D_,this.filterStore.removeFilterEffect(),this.filterStore.reset()}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?D_:e}updateStateFromSerialization({identifier:e,intensity:t}){const i=this.doesFilterAssetExist(e);if(i){const r=el(i);return this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:r})}return new Promise((r,o)=>{o(new Error(`Filter Asset ${e} doesn't exist`))})}updateStateFromHistory(e){return Z(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.filterStore.setFilterEffect(e)})}get state(){return this.filterStore.state}get identifier(){return this.state.identifier}get intensity(){return this.state.intensity}get isDuotone(){return this.state.isDuotone}get selectedCategoryIdentifier(){return this.selectedCategory}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[w.FILTER]}get locale(){return this.editor.configStore.locale[w.FILTER]}get categories(){return this.entityManager.getCategories(this.selectedCategoryIdentifier)}get entities(){return this.entityManager.getEntities(this.selectedCategoryIdentifier)}doesFilterAssetExist(e){return this.entityManager.items.find(t=>e===t.identifier)}isOptionDuoTone(e){const t=this.doesFilterAssetExist(e);return t?el(t):!1}}u([Vt.observable],Xt.prototype,"selectedCategory",2),u([Vt.observable],Xt.prototype,"entityManager",2),u([Vt.action],Xt.prototype,"selectFilter",1),u([Vt.action],Xt.prototype,"changeIntensity",2),u([Vt.action],Xt.prototype,"pureReset",1),u([Vt.action],Xt.prototype,"reset",2),u([Vt.action],Xt.prototype,"toggleCategorySelection",1),u([Vt.action],Xt.prototype,"updateStateFromSerialization",1),u([Vt.action],Xt.prototype,"updateStateFromHistory",1),u([Vt.computed],Xt.prototype,"state",1),u([Vt.computed],Xt.prototype,"identifier",1),u([Vt.computed],Xt.prototype,"intensity",1),u([Vt.computed],Xt.prototype,"isDuotone",1),u([Vt.computed],Xt.prototype,"selectedCategoryIdentifier",1),u([Vt.computed],Xt.prototype,"isOptionSelected",1),u([Vt.computed],Xt.prototype,"config",1),u([Vt.computed],Xt.prototype,"locale",1),u([Vt.computed],Xt.prototype,"categories",1),u([Vt.computed],Xt.prototype,"entities",1);const ng={blurRadius:40,gradientSize:.2},z6=y({start:{x:0,y:0},end:{x:0,y:0}},ng),N6=y({center:{x:0,y:0},radius:0},ng),U6=y({origin:{x:0,y:0},rotation:0,size:0},ng),H6=ng,Tl={identifier:"identity",linear:z6,radial:N6,mirrored:U6,gaussian:H6};const Ci=v(Ve());class Ji{constructor(e){this.editor=e,this.engineMediator=this.editor.engineMediator,this.state=Tl}selectFocus(e,t){Ci.runInAction(()=>{this.state.identifier=e,t&&(this.state[e].blurRadius=t)})}changeBlurRadius(e,t){e!=="identity"&&(this.state[e].blurRadius=t)}reset(){this.indexInContainer===-1&&(this.state.identifier=Tl.identifier,this.state.identifier!=="identity"&&(this.state[this.state.identifier].blurRadius=Tl[this.state.identifier].blurRadius))}setLinear({start:e,end:t}){this.state.linear.start.x=e.x,this.state.linear.start.y=e.y,this.state.linear.end.x=t.x,this.state.linear.end.y=t.y}setLinearStart(e){this.state.linear.start.x=e.x,this.state.linear.start.y=e.y}setLinearEnd(e){this.state.linear.end.x=e.x,this.state.linear.end.y=e.y}setRadialCenter(e){this.state.radial.center.x=e.x,this.state.radial.center.y=e.y}setRadialRadius(e){this.state.radial.radius=e}setMirroredOrigin(e){this.state.mirrored.origin.x=e.x,this.state.mirrored.origin.y=e.y}setMirroredRotation(e){this.state.mirrored.rotation=e}setMirroredSize(e){this.state.mirrored.size=e}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get order(){return this.engineMediator.orderHelper.addIndex(w.FOCUS)}getEffectProperties(){return this.effect?this.effect.getProperties():null}setLinearFocus(e){this.effect=this.engineMediator.engine.addLinearBlur(e,this.imageContainer,this.order),this.updateLinearState(this.effect.getProperties())}setGaussianFocus(e){this.effect=this.engineMediator.engine.addGaussianBlur(e,this.imageContainer,this.order),this.updateGaussianState(this.effect.getProperties())}setRadialFocus(e){this.effect=this.engineMediator.engine.addRadialBlur(e,this.imageContainer,this.order),this.updateRadialState(this.effect.getProperties())}setMirroredFocus(e){this.effect=this.engineMediator.engine.addMirroredBlur(e,this.imageContainer,this.order),this.updateMirroredState(this.effect.getProperties())}updateFromEngineState(e){const t=this.getEffectProperties();if(t&&e!=="identity")switch(e){case Ce.LINEAR:this.updateLinearState(t);break;case Ce.RADIAL:this.updateRadialState(t);break;case Ce.MIRRORED:this.updateMirroredState(t);break}}updateGaussianState(e){this.changeBlurRadius(Ce.GAUSSIAN,e.blurRadius)}updateMirroredState(e){const t=this.editor.worldToPreview(e.mirrorAxisOrigin),i=new E(this.editor.worldToPreview(e.mirrorAxisDirection)),r=i.subtract(t),o=Math.atan2(r.y,r.x);this.setMirroredOrigin(this.editor.worldToPreview(e.mirrorAxisOrigin)),this.setMirroredRotation(o),this.setMirroredSize(this.editor.worldToPreview(e.clearAreaWidth)),this.changeBlurRadius(Ce.MIRRORED,e.blurRadius)}updateRadialState(e){this.setRadialCenter(this.editor.worldToPreview(e.center)),this.setRadialRadius(this.editor.worldToPreview(e.radius)),this.changeBlurRadius(Ce.RADIAL,e.blurRadius)}updateLinearState(e){this.setLinearStart(this.editor.worldToPreview(e.start)),this.setLinearEnd(this.editor.worldToPreview(e.end)),this.changeBlurRadius(Ce.LINEAR,e.blurRadius)}setEffectProperties(e){return this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null}removeFocus(){this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.engineMediator.orderHelper.removeIndex(w.FOCUS))}get imageContainer(){return this.engineMediator.image.container}}u([Ci.observable],Ji.prototype,"state",2),u([Ci.action],Ji.prototype,"selectFocus",1),u([Ci.action],Ji.prototype,"changeBlurRadius",1),u([Ci.action],Ji.prototype,"reset",1),u([Ci.action],Ji.prototype,"setLinear",1),u([Ci.action],Ji.prototype,"setLinearStart",1),u([Ci.action],Ji.prototype,"setLinearEnd",1),u([Ci.action],Ji.prototype,"setRadialCenter",1),u([Ci.action],Ji.prototype,"setRadialRadius",1),u([Ci.action],Ji.prototype,"setMirroredOrigin",1),u([Ci.action],Ji.prototype,"setMirroredRotation",1),u([Ci.action],Ji.prototype,"setMirroredSize",1),u([Ci.action],Ji.prototype,"updateFromEngineState",1);function I_(e){const t=e&&typeof e=="object";return t&&Object.prototype.toString.call(e)!=="[object RegExp]"&&Object.prototype.toString.call(e)!=="[object Date]"}function G6(e){return Array.isArray(e)?[]:{}}function R_(e,t){const i=t&&t.clone===!0;return i&&I_(e)?O_(G6(e),e,t):e}function j6(e,t,i){const r={};return I_(e)&&Object.keys(e).forEach(o=>{r[o]=R_(e[o],i)}),Object.keys(t).forEach(o=>{const n=I_(t[o])&&e[o];r[o]=n?O_(e[o],t[o],i):R_(t[o],i)}),r}function O_(e,t,i){const r=Array.isArray(t);return r?Array.isArray(e)?t:R_(t,i):j6(e,t,i)}function Sr(e,t=null){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((i,r)=>O_(i,r,t))}class sD extends Tr{onExport(e){this.emit(Ie.EXPORT,e)}onClose(){this.emit(Ie.CLOSE)}onHistoryChange(){this.emit(Ie.HISTORY_CHANGE)}onEditorReady(){this.emit(Ie.EDITOR_READY)}onErrorImageLoading(e){this.emit(Ie.ERROR_IMAGE_LOADING,e)}}const kl={common:{error:"Error",warning:"Warning",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Color",sliderOpacity:"Color Opacity"}}},mainCanvasActions:{buttonExport:"Export Image",buttonUndo:"Undo",buttonRedo:"Redo",buttonClose:"Close"},infoModals:{exporting:{heading:"Exporting...",body:"Just a few seconds..."},saving:{heading:"Saving...",body:"Just a few seconds..."},loading:{heading:"Loading...",body:"Just a few seconds..."},resizing:{heading:"Resizing...",body:"Just a few seconds..."},loadingFonts:{heading:"Loading Fonts...",body:"Just a few seconds..."},stickerLoading:{heading:"Loading Sticker...",body:"Just a few seconds..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Failed to load image. This can have multiple reasons, e.g. the file is corrupted or the file type is not supported",buttonYes:"Reload"},rendering:{headingDelimiter:":",body:"An error has occurred while rendering the image",buttonYes:"Reload"},fontLoading:{headingDelimiter:":",heading:"Failed to load font",body:"The following fonts could not be loaded: ${error}",buttonNo:"Close"},webcamUnavailable:{headingDelimiter:":",body:"Unable to display webcam image (Error: ${error})",buttonYes:"Close"},stickerLoading:{headingDelimiter:":",body:"Unable to load the sticker",buttonNo:"Close"},unexpectedError:{headingDelimiter:":",body:"An unexpected error has occured ${error}",buttonYes:"Reload"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Image resized",body:"Your image has been resized to ${width}x${height} pixels"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Your data was restored from a legacy data format and might look different",buttonYes:"Apply changes",buttonNo:"Cancel"},discardChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to discard the changes?",buttonYes:"Discard changes",buttonNo:"Keep Changes"},unsavedChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to exit?",buttonYes:"Exit without saving",buttonNo:"Cancel"},unsupportedWebGLRenderer:{body:"A problem has been detected in the browser that could cause long loading times. Please try a different browser.",buttonYes:"Continue"}},library:{title:"Library",controls:{buttonUpload:"Upload Image",buttonWebcamOpen:"Open Webcam",buttonWebcamClose:"Close Webcam",placeholderSearch:"Search Library",noResults:"No Results"}},filter:{title:"Filters",controls:{buttonReset:"Remove Filter",sliderIntensity:"Filter Intensity"},categories:{imgly_filter_category_duotone:"DuoTone",imgly_filter_category_bw:"B & W",imgly_filter_category_vintage:"Vintage",imgly_filter_category_smooth:"Smooth",imgly_filter_category_cold:"Cold",imgly_filter_category_warm:"Warm",imgly_filter_category_legacy:"Legacy"},items:{imgly_lut_celsius:"Inferno",imgly_lut_chest:"Chestnut",imgly_lut_fixie:"Fixie",imgly_lut_fridge:"Fridge",imgly_lut_front:"Sunny 70s",imgly_lut_k2:"Flat Black",imgly_lut_mellow:"Mellow",imgly_lut_sin:"Hard Stuff",imgly_lut_texas:"Oldtimer",imgly_lut_ad1920:"1920 A.D.",imgly_lut_ancient:"Ancient",imgly_lut_bleached:"Kalmen",imgly_lut_bleachedblue:"Joran",imgly_lut_blues:"Polaroid",imgly_lut_blueshadows:"Zephyr",imgly_lut_breeze:"Levante",imgly_lut_bw:"Greyed",imgly_lut_classic:"Classic",imgly_lut_colorful:"Colorful",imgly_lut_cool:"Snappy",imgly_lut_cottoncandy:"Candy",imgly_lut_creamy:"Creamy",imgly_lut_eighties:"Low Fire",imgly_lut_elder:"Colla",imgly_lut_evening:"Sunrise",imgly_lut_fall:"Moss",imgly_lut_food:"Food",imgly_lut_glam:"Glam",imgly_lut_gobblin:"Gobblin",imgly_lut_highcarb:"High Carb",imgly_lut_highcontrast:"Hicon",imgly_lut_k1:"K1",imgly_lut_k6:"K6",imgly_lut_kdynamic:"Pebble",imgly_lut_keen:"Keen",imgly_lut_lenin:"Lemon",imgly_lut_litho:"Litho",imgly_lut_lomo:"Lomo",imgly_lut_lomo100:"Lomo 100",imgly_lut_lucid:"Lucid",imgly_lut_neat:"Neat",imgly_lut_nogreen:"Pumpkin",imgly_lut_orchid:"Solanus",imgly_lut_pale:"Pale",imgly_lut_pitched:"Pitched",imgly_lut_plate:"Weathered",imgly_lut_pola669:"Green Gap",imgly_lut_polasx:"Pola SX",imgly_lut_pro400:"Pro 400",imgly_lut_quozi:"Quozi",imgly_lut_sepiahigh:"Sepia",imgly_lut_settled:"Settled",imgly_lut_seventies:"Seventies",imgly_lut_soft:"Soft",imgly_lut_steel:"Steel",imgly_lut_summer:"Summer",imgly_lut_sunset:"Golden",imgly_lut_tender:"Tender",imgly_lut_twilight:"Twilight",imgly_lut_winter:"Softy",imgly_lut_x400:"Dusty",imgly_duotone_desert:"Desert",imgly_duotone_peach:"Peach",imgly_duotone_clash:"Clash",imgly_duotone_plum:"Plum",imgly_duotone_breezy:"Breezy",imgly_duotone_deepblue:"Deep Blue",imgly_duotone_frog:"Frog",imgly_duotone_sunset:"Sunset"}},adjustment:{title:"Adjust",controls:{buttonReset:"Reset Adjustment"},categories:{basics:"Basic",refinements:"Refinements"},items:{brightness:"Brightness",saturation:"Saturation",contrast:"Contrast",gamma:"Gamma",sharpness:"Sharpness",clarity:"Clarity",exposure:"Exposure",shadows:"Shadows",highlights:"Highlights",whites:"Whites",blacks:"Blacks",temperature:"Temperature"}},focus:{title:"Focus",controls:{buttonReset:"Remove Focus",sliderIntensity:"Focus Intensity"},items:{radial:"Radial",mirrored:"Mirrored",linear:"Linear",gaussian:"Gaussian"},history:{focusPosition:"Focus Position",focusSize:"Focus Size"}},overlay:{title:"Overlays",controls:{buttonReset:"Remove Overlay",sliderOpacity:"Overlay Opacity",carouselBlendMode:"Overlay Blend mode",blendModeNormal:"Normal",blendModeOverlay:"Overlay",blendModeHardLight:"Hard Light",blendModeSoftLight:"Soft Light",blendModeMultiply:"Multiply",blendModeDarken:"Darken",blendModeLighten:"Lighten",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Opacity",tabBlendMode:"Blend Mode"},items:{imgly_overlay_bokeh:"Bokeh",imgly_overlay_chop:"Chop",imgly_overlay_clouds:"Clouds",imgly_overlay_golden:"Golden",imgly_overlay_grain:"Grain",imgly_overlay_hearts:"Hearts",imgly_overlay_lightleak1:"Light Leak 1",imgly_overlay_lightleak2:"Light Leak 2",imgly_overlay_metal:"Metal",imgly_overlay_mosaic:"Mosaic",imgly_overlay_painting:"Painting",imgly_overlay_paper:"Paper",imgly_overlay_rain:"Rain",imgly_overlay_vintage:"Vintage",imgly_overlay_wall1:"Wall",imgly_overlay_wall2:"Wall 2",imgly_overlay_wood:"Wood"}},sticker:{title:"Stickers",controls:{buttonUpload:"Upload Sticker",sliderOpacity:"Sticker Opacity",selectColor:"Sticker Color",tabColor:"Color",tabOpacity:"Opacity"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate",buttonFlipHorizontal:"Flip",buttonFlipVertical:"Flip"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"New Text",dropdownFontFamily:"Font Family",textFontSize:"Font Size",selectAlignment:"Alignment",selectFontColor:"Font Color",selectBackgroundColor:"Background Color",sliderLineSpacing:"Line Spacing",tabColor:"Color",tabBgColor:"Bg Color",tabAlignment:"Alignment",tabLineHeight:"Line Height",tabFontSize:"Font Size"},canvasControls:{placeholderText:"Write Something",buttonSave:"Done",buttonClose:"Cancel",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"New Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Text Color",tabColor:"Color",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Write Something With Style",buttonSave:"Done",buttonClose:"Schlieen",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonInvert:"Invert",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Frames",controls:{buttonReset:"Remove Frame",sliderOpacity:"Frame Opacity",sliderSize:"Frame Size",selectColor:"Frame Color",tabColor:"Color",tabOpacity:"Opacity",tabSize:"Size"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Brush",controls:{buttonReset:"Remove Brush",sliderSize:"Brush Size",sliderHardness:"Brush Hardness",selectColor:"Brush Color",tabSize:"Size",tabHardness:"Hardness",tabColor:"Color"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Transform",controls:{buttonReset:"Reset to default",checkboxKeepResolution:"Keep Resolution",inputCropSize:"Crop Size",inputHeight:"h",inputWidth:"w",tabFlipAndRotate:"Flip & Rotate",tabResolution:"Resolution",tabCropSize:"Crop Size"},categories:{imgly_transforms_common:"Common",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Custom",imgly_transform_common_square:"Square",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Title",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Flip Horizontal",buttonFlipVertical:"Flip Vertical",buttonRotateClockwise:"Rotate Clockwise",buttonRotateAntiClockwise:"Rotate Counterclockwise"}}};const A_={common:{error:"Fehler",warning:"Warnung",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Farbe",sliderOpacity:"Farbe Transparenz"}}},mainCanvasActions:{buttonExport:"Bild Exportieren",buttonUndo:"Rckgngig machen",buttonRedo:"Wiederholen",buttonClose:"Schlieen"},infoModals:{exporting:{heading:"Exportieren...",body:"Einen Moment bitte..."},saving:{heading:"Speichere...",body:"Einen Moment bitte..."},loading:{heading:"Lade...",body:"Einen Moment bitte..."},resizing:{heading:"Bild wird bearbeitet...",body:"Einen Moment bitte..."},loadingFonts:{heading:"Lade Schriftarten...",body:"Einen Moment bitte..."},stickerLoading:{heading:"Lade Sticker...",body:"Einen Moment bitte..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Laden des Bildes fehlgeschlagen. Dies kann verschiedene Grnde haben, beispielsweise kann die Datei defekt sein oder der Dateityp wird nicht untersttzt",buttonYes:"Neu Laden"},rendering:{headingDelimiter:":",body:"Beim Rendern des Bildes ist ein Fehler aufgetreten",buttonYes:"Neu Laden"},fontLoading:{headingDelimiter:":",heading:"Laden von Schriftarten ist fehlgeschlagen",body:"Die folgenden Schriftarten konnten nicht geladen werden: ${error}",buttonNo:"Schlieen"},webcamUnavailable:{headingDelimiter:":",body:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})",buttonYes:"Schlieen"},stickerLoading:{headingDelimiter:":",body:"Laden des Stickers fehlgeschlagen.",buttonNo:"Schlieen"},unexpectedError:{headingDelimiter:":",body:"Ein unerwarteter Fehler ist aufgetreten, ${error}",buttonYes:"Neu Laden"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Bild verkleinert",body:"Das Bild wurde es auf ${width}x${height} Pixel verkleinert"},discardChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die nderungen verwerfen wollen?",buttonYes:"nderungen verwerfen",buttonNo:"nderungen beibehalten"},unsavedChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die nderungen verwerfen wollen?",buttonYes:"Beenden ohne zu speichern",buttonNo:"Schlieen"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Ihre Daten wurden von einem veralteten Format geladen und knnten anders aussehen",buttonYes:"nderungen anwenden",buttonNo:"Abbrechen"},unsupportedWebGLRenderer:{body:"Es wurde ein Problem im Browser festgestellt, welches zu langen Ladezeiten fhren kann. Bitte probieren sie einen anderen Browser.",buttonYes:"Weiter"}},library:{title:"Bibliothek",controls:{buttonUpload:"Bild Hochladen",buttonWebcamOpen:"Webcam ffnen",buttonWebcamClose:"Webcam Schlieen",placeholderSearch:"Bibliothek durchsuchen",noResults:"Keine Ergebnisse"}},filter:{title:"Filter",controls:{buttonReset:"Zurcksetzen",sliderIntensity:"Filter Intensitt"},categories:{imgly_filter_category_duotone:"DuoTone",imgly_filter_category_bw:"B & W",imgly_filter_category_vintage:"Vintage",imgly_filter_category_smooth:"Smooth",imgly_filter_category_cold:"Cold",imgly_filter_category_warm:"Warm",imgly_filter_category_legacy:"Legacy"},items:{imgly_lut_celsius:"Inferno",imgly_lut_chest:"Chestnut",imgly_lut_fixie:"Fixie",imgly_lut_fridge:"Fridge",imgly_lut_front:"Sunny 70s",imgly_lut_k2:"Flat Black",imgly_lut_mellow:"Mellow",imgly_lut_sin:"Hard Stuff",imgly_lut_texas:"Oldtimer",imgly_lut_ad1920:"1920 A.D.",imgly_lut_ancient:"Ancient",imgly_lut_bleached:"Kalmen",imgly_lut_bleachedblue:"Joran",imgly_lut_blues:"Polaroid",imgly_lut_blueshadows:"Zephyr",imgly_lut_breeze:"Levante",imgly_lut_bw:"Greyed",imgly_lut_classic:"Classic",imgly_lut_colorful:"Colorful",imgly_lut_cool:"Snappy",imgly_lut_cottoncandy:"Candy",imgly_lut_creamy:"Creamy",imgly_lut_eighties:"Low Fire",imgly_lut_elder:"Colla",imgly_lut_evening:"Sunrise",imgly_lut_fall:"Moss",imgly_lut_food:"Food",imgly_lut_glam:"Glam",imgly_lut_gobblin:"Gobblin",imgly_lut_highcarb:"High Carb",imgly_lut_highcontrast:"Hicon",imgly_lut_k1:"K1",imgly_lut_k6:"K6",imgly_lut_kdynamic:"Pebble",imgly_lut_keen:"Keen",imgly_lut_lenin:"Lemon",imgly_lut_litho:"Litho",imgly_lut_lomo:"Lomo",imgly_lut_lomo100:"Lomo 100",imgly_lut_lucid:"Lucid",imgly_lut_neat:"Neat",imgly_lut_nogreen:"Pumpkin",imgly_lut_orchid:"Solanus",imgly_lut_pale:"Pale",imgly_lut_pitched:"Pitched",imgly_lut_plate:"Weathered",imgly_lut_pola669:"Green Gap",imgly_lut_polasx:"Pola SX",imgly_lut_pro400:"Pro 400",imgly_lut_quozi:"Quozi",imgly_lut_sepiahigh:"Sepia",imgly_lut_settled:"Settled",imgly_lut_seventies:"Seventies",imgly_lut_soft:"Soft",imgly_lut_steel:"Steel",imgly_lut_summer:"Summer",imgly_lut_sunset:"Golden",imgly_lut_tender:"Tender",imgly_lut_twilight:"Twilight",imgly_lut_winter:"Softy",imgly_lut_x400:"Dusty",imgly_duotone_desert:"Desert",imgly_duotone_peach:"Peach",imgly_duotone_clash:"Clash",imgly_duotone_plum:"Plum",imgly_duotone_breezy:"Breezy",imgly_duotone_deepblue:"Deep Blue",imgly_duotone_frog:"Frog",imgly_duotone_sunset:"Sunset"}},adjustment:{title:"Korrekturen",controls:{buttonReset:"Zurcksetzen"},categories:{basics:"Grundlagen",refinements:"Feinheiten"},items:{brightness:"Helligkeit",saturation:"Sttigung",contrast:"Kontrast",gamma:"Gamma",sharpness:"Schrfe",clarity:"Klarheit",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",whites:"Wei",blacks:"Schwarz",temperature:"Temperatur"}},focus:{title:"Weichzeichnen",controls:{buttonReset:"Zurcksetzen",sliderIntensity:"Focus Intensitt"},items:{radial:"Kreisfrmig",mirrored:"Gespiegelt",linear:"Linear",gaussian:"Gausch"},history:{focusPosition:"Focus Position",focusSize:"Focus Gre"}},overlay:{title:"Overlays",controls:{buttonReset:"Zurcksetzen",sliderOpacity:"Overlay Transparenz",carouselBlendMode:"Overlay Mischmodus",blendModeNormal:"Normal",blendModeOverlay:"berblenden",blendModeHardLight:"Hartes Licht",blendModeSoftLight:"Weiches Licht",blendModeMultiply:"Multiplizieren",blendModeDarken:"Abdunkeln",blendModeLighten:"Aufhellen",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Transparenz",tabBlendMode:"Mischmodus"},items:{imgly_overlay_bokeh:"Bokeh",imgly_overlay_chop:"Chop",imgly_overlay_clouds:"Clouds",imgly_overlay_golden:"Golden",imgly_overlay_grain:"Grain",imgly_overlay_hearts:"Hearts",imgly_overlay_lightleak1:"Light Leak 1",imgly_overlay_lightleak2:"Light Leak 2",imgly_overlay_metal:"Metal",imgly_overlay_mosaic:"Mosaic",imgly_overlay_painting:"Painting",imgly_overlay_paper:"Paper",imgly_overlay_rain:"Rain",imgly_overlay_vintage:"Vintage",imgly_overlay_wall1:"Wall",imgly_overlay_wall2:"Wall 2",imgly_overlay_wood:"Wood"}},sticker:{title:"Sticker",controls:{buttonUpload:"Sticker Hochladen",sliderOpacity:"Sticker Transparenz",selectColor:"Stickerfarbe",tabColor:"Farbe",tabOpacity:"Transparenz"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren",buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"Neuer Text",dropdownFontFamily:"Schriftart",textFontSize:"Schriftgre",selectAlignment:"Ausrichtung",selectFontColor:"Schriftfarbe",selectBackgroundColor:"Hintergrundfarbe",sliderLineSpacing:"Zeilenabstand",tabColor:"Farbe",tabBgColor:"Hintergrund",tabAlignment:"Ausrichtung",tabLineHeight:"Zeilenhhe",tabFontSize:"Schriftgre"},canvasControls:{placeholderText:"Etwas aufschreiben",buttonSave:"Fertig",buttonClose:"Abbrechen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"Neues Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Textfarbe",tabColor:"Farbe",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Etwas aufschreiben mit Style",buttonSave:"Done",buttonClose:"Schlieen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonInvert:"Invertieren",buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Rahmen",controls:{buttonReset:"Zurcksetzen",sliderOpacity:"Rahmen Transparenz",sliderSize:"Rahmen Dicke",selectColor:"Rahmen Farbe",tabColor:"Farbe",tabOpacity:"Transparenz",tabSize:"Dicke"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Malen",controls:{buttonReset:"Zurcksetzen",sliderSize:"Dicke",sliderHardness:"Hrte",selectColor:"Farbe",tabSize:"Dicke",tabHardness:"Hrte",tabColor:"Farbe"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Zuschneiden",controls:{buttonReset:"Zurcksetzen",checkboxKeepResolution:"Fixiere Auflsung",inputCropSize:"Bildgre",inputHeight:"h",inputWidth:"b",tabFlipAndRotate:"Spiegeln & Drehen",tabResolution:"Auflsung",tabCropSize:"Bildgre"},categories:{imgly_transforms_common:"Standard",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Frei",imgly_transform_common_square:"Quadratisch",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Titel",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln",buttonRotateClockwise:"Drehe im Uhrzeigersinn",buttonRotateAntiClockwise:"Drehe gegen Uhrzeigersinn"}}};const aD=e=>e==="de"?A_:kl,lD=(e,t)=>t&&t[e]?Sr([aD(e),t[e]]):aD(e)||kl;class sg{static addScrollStyles(e="rgba(255, 255, 255, 0.2)"){const t=sg.styles(e),i=`
    /* Injected by PhotoEditorSDK */
    ${t}
  `,r=document.createElement("style");r.innerHTML=i,document.head.appendChild(r)}}sg.styles=e=>`
    [data-simplebar] {
      position: relative;
      flex-direction: column;
      flex-wrap: wrap;
      justify-content: flex-start;
      align-content: flex-start;
      align-items: flex-start;
    }

    .photoeditorsdk-simplebar-wrapper {
      overflow: hidden;
      width: inherit;
      height: inherit;
      max-width: inherit;
      max-height: inherit;
    }

    .photoeditorsdk-simplebar-mask {
      direction: inherit;
      position: absolute;
      padding: 0;
      margin: 0;
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
      width: auto !important;
      height: auto !important;
      z-index: 0;
    }

    .photoeditorsdk-simplebar-offset {
      direction: inherit !important;
      box-sizing: inherit !important;
      resize: none !important;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      padding: 0;
      margin: 0;
      -webkit-overflow-scrolling: touch;
    }

    .photoeditorsdk-simplebar-content-wrapper {
      direction: inherit;
      box-sizing: border-box !important;
      position: relative;
      display: block;
      height: 100%; /* Required for horizontal native scrollbar to not appear if parent is taller than natural height */
      width: auto;
      visibility: visible;
      overflow: auto; /* Scroll on this element otherwise element can't have a padding applied properly */
      max-width: 100%; /* Not required for horizontal scroll to trigger */
      max-height: 100%; /* Needed for vertical scroll to trigger */
    }

    .photoeditorsdk-simplebar-content:before,
    .photoeditorsdk-simplebar-content:after {
      content: ' ';
      display: table;
    }

    .photoeditorsdk-simplebar-placeholder {
      max-height: 100%;
      max-width: 100%;
      width: 100%;
      pointer-events: none;
    }

    .photoeditorsdk-simplebar-height-auto-observer-wrapper {
      box-sizing: inherit !important;
      height: 100%;
      width: 100%;
      max-width: 1px;
      position: relative;
      float: left;
      max-height: 1px;
      overflow: hidden;
      z-index: -1;
      padding: 0;
      margin: 0;
      pointer-events: none;
      flex-grow: inherit;
      flex-shrink: 0;
      flex-basis: 0;
    }

    .photoeditorsdk-simplebar-height-auto-observer {
      box-sizing: inherit;
      display: block;
      opacity: 0;
      position: absolute;
      top: 0;
      left: 0;
      height: 1000%;
      width: 1000%;
      min-height: 1px;
      min-width: 1px;
      overflow: hidden;
      pointer-events: none;
      z-index: -1;
    }

    .photoeditorsdk-simplebar-track {
      z-index: 1;
      position: absolute;
      right: 0;
      bottom: 0;
      pointer-events: none;
      overflow: hidden;
    }

    [data-simplebar].photoeditorsdk-simplebar-dragging .photoeditorsdk-simplebar-track {
      pointer-events: all;
    }

    .photoeditorsdk-simplebar-scrollbar {
      position: absolute;
      right: 2px;
      width: 7px;
      min-height: 10px;
    }

    .photoeditorsdk-simplebar-scrollbar:before {
      position: absolute;
      content: '';
      background: ${e};
      border-radius: 7px;
      left: 0;
      right: 0;
      opacity: 0;
      transition: opacity 0.2s linear;
    }

    .photoeditorsdk-simplebar-track .photoeditorsdk-simplebar-scrollbar.photoeditorsdk-simplebar-visible:before {
      /* When hovered, remove all transitions from drag handle */
      opacity: 0.5;
      transition: opacity 0s linear;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical {
      top: 0;
      width: 11px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical .photoeditorsdk-simplebar-scrollbar:before {
      top: 2px;
      bottom: 2px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical .photoeditorsdk-simplebar-scrollbar {
      right: 0px;
      width: 4px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal {
      left: 0;
      height: 11px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal .photoeditorsdk-simplebar-scrollbar:before {
      height: 100%;
      left: 2px;
      right: 2px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal .photoeditorsdk-simplebar-scrollbar {
      right: auto;
      left: 0;
      min-height: 0;
      min-width: 10px;
      width: auto;
      top: 7px;
      height: 4px;
    }

    /* Rtl support */
    [data-simplebar-direction='rtl'] .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical {
      right: auto;
      left: 0;
    }

    .photoeditorsdk-hs-dummy-scrollbar-size {
      direction: rtl;
      position: fixed;
      opacity: 0;
      visibility: hidden;
      height: 500px;
      width: 500px;
      overflow-y: hidden;
      overflow-x: scroll;
    }
  `;const W6=({primary:e="#365afc",background:t="#0B0B0B",foreground:i="#FFFFFF"}={primary:"#365afc",background:"#0B0B0B",foreground:"#FFFFFF"})=>{const r="rgba(255, 255, 255, 0.90)",o="rgba(255, 255, 255, 0.60)",n="rgba(255, 255, 255, 0.38)",s="#424242",a="#333333",l="#242424",d="#171717",c="#0B0B0B",p="rgba(255, 255, 255, 0.08)",h="rgba(0, 0, 0, 0.3)",m="rgba(89, 121, 252, 0.20)",b="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffba5c",error:"#c2393a",success:"#39c26c",focusOutlineColor:"rgba(255, 255, 255, 0.12)",scrollbar:{handleColor:"rgba(255, 255, 255, 0.2)"},button:{outlinedBorderColor:a,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:r,outlinedPrimaryBackground:l,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:h,textInactiveOpacity:"0.5",hoverOverlayColor:p},checkbox:{background:a,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:b,hoverOpacity:"0.8"},modal:{background:l,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:a,foreground:r,activeBorderColor:e,activeOverlayColor:m,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:r,inactiveOverlayColor:h,hoverOverlayColor:p},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:a,caretColor:n,listBackground:a,listBorderColor:a,listItemHoverBackground:s,listForeground:o,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,inactiveOpacity:b},textInput:{foreground:r,hoverBorderColor:"rgba(255, 255, 255, 0.40)",background:"transparent",borderColor:a,inactiveOpacity:b},slider:{trackColor:"rgba(255, 255, 255, 0.4)",activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:b,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:b},toolbar:{foreground:r,background:l,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:s,foreground:r},toolControlBar:{background:"rgba(23, 23, 23, 0.9)",borderColor:"transparent",shadow:"none",separatorColor:a,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:b},mainCanvasActionBar:{background:"linear-gradient(0deg, transparent 0%,  rgba(0, 0, 0, 0.6) 98%)",foreground:r,borderColor:"none"},canvasActionBar:{background:s,foreground:r,separatorColor:n},canvas:{background:c,controlsOutline:"rgba(255, 255, 255, 0.5)",controlsColor:"#ffffff",cropBackdrop:"rgba(0, 0, 0, 0.5)"},colorPicker:{listBackground:a,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:s},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:c},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#424242",highlight:"#565656",shadow:"#333333"}}}};var ag=W6;const V6=({primary:e="#1e47fb",background:t="#FBFBFB",foreground:i="#000000"}={primary:"#1e47fb",background:"#FBFBFB",foreground:"#000000"})=>{const r="rgba(0, 0, 0, 0.90)",o="rgba(0, 0, 0, 0.60)",n="rgba(0, 0, 0, 0.38)",s="#CCCCCC",a="#D4D4D4",l="#E6E6E6",d="#EEEEEE",c="#FBFBFB",p="rgba(125, 125, 125, 0.12)",h="rgba(30, 71, 251, 0.2)",m="rgba(0, 0, 0, 0.3)",b="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffb045",error:"#c01a1b",success:"#17c658",focusOutlineColor:"rgba(125, 125, 125, 0.12)",scrollbar:{handleColor:"rgba(0, 0, 0, 0.2)"},button:{outlinedBorderColor:a,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:"rgba(255, 255, 255, 0.9)",outlinedPrimaryBackground:l,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:m,textInactiveOpacity:"0.5",hoverOverlayColor:p},checkbox:{background:a,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:b,hoverOpacity:"0.8"},modal:{background:l,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:a,foreground:r,activeBorderColor:e,activeOverlayColor:h,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:"rgba(255, 255, 255, 0.87)",inactiveOverlayColor:m,hoverOverlayColor:p},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:a,listBackground:a,caretColor:n,listForeground:o,listBorderColor:a,listItemHoverBackground:s,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,inactiveOpacity:b},textInput:{foreground:r,hoverBorderColor:r,background:"transparent",borderColor:a,inactiveOpacity:b},slider:{trackColor:s,activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:b,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:b},toolbar:{foreground:r,background:a,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:s,foreground:r},toolControlBar:{background:"rgba(238, 238, 238, 0.9)",borderColor:d,shadow:"none",separatorColor:a,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:b},mainCanvasActionBar:{background:"transparent",foreground:r,borderColor:"none"},canvasActionBar:{background:s,foreground:r,separatorColor:n},canvas:{background:c,controlsOutline:"rgba(255, 255, 255, 0.6)",controlsColor:"#ffffff",cropBackdrop:"rgba(255, 255, 255, 0.3)"},colorPicker:{listBackground:a,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:s},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:c},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#B8B8B8",highlight:"#E6E6E6",shadow:"#D4D4D4"}}}};var F_=V6;const K6={headline1:{size:16,letterSpacing:1.5,case:"uppercase"},headline2:{size:14,letterSpacing:.8,case:"uppercase"},body:{size:13,letterSpacing:0,case:"none"},label:{size:13,letterSpacing:0,case:"capitalize"},basicUICardLabel:{size:12,letterSpacing:0,case:"capitalize"},button1:{size:12,letterSpacing:1.2,case:"uppercase"},button2:{size:14,letterSpacing:0,case:"capitalize"},basicUITabLabel:{size:14,letterSpacing:.8,case:"uppercase"}},$6={toast:2,controlsBar:5,buttonGroup:5,toolControlBar:6,toolbar:7,label:10,disable:11,canvas:{knob:4,bar:5,controls:5,snappingGuide:1,crop:{grid:2,dragImage:3,backdrop:4},webcam:{backdrop:7}},input:{list:6},button:{float:5},dialog:{base:100,backdrop:1,container:2},colorItem:{overlay:2,background:1,tiledBackground:0}},lg=()=>{const e=8,t=230,i=3*e,r=t-2*i,o=(r-2*e)/3,n=(r-e)/2;return{advancedUIToolbar:{width:55,itemHeight:48,seperatorHeight:20,marginBottom:0},advancedUIToolControlBar:{width:t,padding:`${2*e}px ${i}px`,marginBottom:0},advancedCard:{small:{height:o,width:o},medium:{height:n,width:n},large:{height:86,width:r}},advancedSpacer:8,basicCanvasOffset:35+76-88,basicUIToolbar:{openHeight:88,closeHeight:35},basicToolControlBar:{itemsBarHeight:72,controlsBarHeight:80,maxHeight:72+35+4,maxWidth:300},basicCard:{medium:{height:56,width:90},large:{height:60,width:110}},basicSpacer:8,mainCanvasActionBar:{height:50},crop:{minSize:50},canvas:{marginTop:0,transform:{minSliderWidth:435,minValueWidth:235,minFlipWidth:160}},canvasControls:{sprite:{controlOffset:16,rotateHandle:{height:16},minSize:30,controlPadding:16},knob:{size:16,touchable:{desktop:24}},corner:{size:14,touchable:{desktop:24,mobile:48},borderWidth:4},width:{size:14}},buttons:{float:{size:56}},colorItem:{size:20},color:{colorPicker:{width:214,saturationSlider:{height:150},thumb:{size:14},arrow:{width:36}}},fontSystem:K6,zIndex:$6}};const yp=ag(),P_=lg(),X=y(y({},yp),{measurements:P_});const q6=e=>e==="light"?F_:ag,dD=(e,t)=>{const i=q6(e);if(t&&t[e]){const{primary:r,background:o,foreground:n}=t[e],s={primary:r,background:o,foreground:n},a=Object.keys(s).reduce((l,d)=>s[d]?y(y({},l),{[d]:s[d]}):l,{});return Sr([i(a),t[e]])}return i()||yp};const X6=["canvas","advancedUIToolbar","advancedUIToolControlBar","basicUIToolbar","mainCanvasActionBar","colorItem","fontSystem"],cD=e=>{const t=lg();if(e){const i={};return Object.keys(e).forEach(r=>{X6.indexOf(r)!==-1&&(i[r]=e[r])}),Sr([t,i])}return t};const Fi=v(Ve()),Y6={config:Gd,locale:kl,theme:yp,measurements:P_};class io{constructor(){this.checkDefaultToolAvailability=(e,t)=>t.indexOf(e)!==-1;this.state=Fi.observable(Y6),this.events=new sD,this.licenseChecker=null}saveConfig(e){e.mainCanvasActions&&e.mainCanvasActions.length!==4&&(e.mainCanvasActions.length=4);const t=Sr([Gd,e]),i=t;this.licenseChecker=new T_(i.license),this.licenseChecker.areCustomAssetsAllowed()||(i.sticker.enableCustomUpload=!1);const r=lD(i.language,i.custom.languages),o=dD(i.theme,i.custom.themes),n=cD(i.custom.measurements),{provider:s}=i.library;delete i.language,delete i.custom.languages,delete i.custom.themes,delete i.library.provider;let a=i.tools.reduce((c,p)=>typeof p=="object"?[...c,...p]:[...c,p],[]);a.length||(console.error("Empty list input for tools"),a=ig.reduce((c,p)=>typeof p=="object"?[...c,...p]:[...c,p],[])),a=a.filter(c=>this.licenseChecker.isToolAllowed(c));const l=this.checkDefaultToolAvailability(i.defaultTool,a);l||(this.licenseChecker.isToolAllowed(i.defaultTool)&&console.warn(`Configured default tool ${i.defaultTool} is not a part of configured list of tools: [${a.join(" ")}]`),[i.defaultTool]=a),i.tools=a,this.state.config=i,this.state.locale=r,this.state.theme=o,this.state.measurements=n,sg.addScrollStyles(this.state.theme.scrollbar.handleColor);const d=this.buildCustomAssetsConfig();return this.assetProvider=new wm(d,this.licenseChecker.areCustomAssetsAllowed()),this.loadThemeFont(),s}get config(){return this.state.config}get locale(){return this.state.locale}get theme(){return this.state.theme}get measurements(){return this.state.measurements}get tools(){return this.config.tools.reduce((e,t)=>typeof t=="string"?[...e,t]:[...e,"",...t],[])}get defaultTool(){return this.config.defaultTool}get isOrderDefault(){return this.config.order==="default"}get isLayoutAdvanced(){return this.config.layout==="advanced"}get displayCloseButton(){return this.config.mainCanvasActions.indexOf(he.CLOSE)!==-1}loadThemeFont(){const{typography:e}=this.theme;e.skipLoading||this.assetProvider.getFontManager().injectFonts([e])}buildCustomAssetsConfig(){const e=this.tools,t=Fi.toJS(this.state.config),i=this.state.config.assetBaseUrl,{theme:r}=this.state,o=e.indexOf(w.FILTER)!==-1?t[w.FILTER]:void 0,n=e.indexOf(w.FOCUS)!==-1?t[w.FOCUS]:void 0,s=e.indexOf(w.ADJUSTMENT)!==-1?t[w.ADJUSTMENT]:void 0,a=e.indexOf(w.STICKER)!==-1?t[w.STICKER]:void 0,l=e.indexOf(w.FRAME)!==-1?t[w.FRAME]:void 0,d=e.indexOf(w.OVERLAY)!==-1?t[w.OVERLAY]:void 0,c=e.indexOf(w.TRANSFORM)!==-1?t[w.TRANSFORM]:void 0,p=e.indexOf(w.TEXT)!==-1?t[w.TEXT]:void 0,h=e.indexOf(w.TEXT_DESIGN)!==-1?t[w.TEXT_DESIGN]:void 0;return{basePath:i,theme:r,filter:o,focus:n,sticker:a,frame:l,overlay:d,transform:c,text:p,adjustment:s,textdesign:h}}}u([Fi.action],io.prototype,"saveConfig",1),u([Fi.computed],io.prototype,"config",1),u([Fi.computed],io.prototype,"locale",1),u([Fi.computed],io.prototype,"theme",1),u([Fi.computed],io.prototype,"measurements",1),u([Fi.computed],io.prototype,"tools",1),u([Fi.computed],io.prototype,"defaultTool",1),u([Fi.computed],io.prototype,"isOrderDefault",1),u([Fi.computed],io.prototype,"isLayoutAdvanced",1),u([Fi.computed],io.prototype,"displayCloseButton",1);const hD=e=>e instanceof HTMLImageElement;class pD{constructor(e){this.editor=e}setBackgroundImage(e){this.container?this.container.setData({image:e,originalImage:e}):this.container=this.engine.addImage({image:e,originalImage:e,blendMode:ye.NORMAL,opacity:1})}getchildren(){return this.container.getChildren()}addImageToContainer(){return new Promise((e,t)=>{const{image:i}=this.editor.activeStore;if(hD(i))this.setBackgroundImage(i),e();else{const r=this.editor.libraryStore.getRawUrl(i);this.getImageElement(r).then(o=>{this.setBackgroundImage(o),e()}).catch(o=>{t({identifier:"imageLoading",message:o.message})})}})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.editor.configStore.config.engine.crossOrigin,r.src=e})}getImgageContainerId(){return this.container?this.container.getID():""}get engine(){return this.editor.engine}}class uD{constructor(e){this.applyNewImageTransform=()=>{const{size:e,width:t,height:i}=this.editor.engineMediator.image.container.getBounds(),r=this.container;r.setTransform(mt.IDENTITY),r.setResolution(e),r.setPivot(.5,.5),r.setPosition({x:t/2,y:i/2})};this.editor=e}get engine(){return this.editor.engine}get container(){return this.engine.getOutputContainer()}}var ro=[];var mD=function(){return ro.some(function(e){return e.activeTargets.length>0})};var fD=function(){return ro.some(function(e){return e.skippedTargets.length>0})};var gD="ResizeObserver loop completed with undelivered notifications.",bD=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:gD}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=gD),window.dispatchEvent(e)};var El;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(El||(El={}));var B_=function(){function e(t,i,r,o){return this.x=t,this.y=i,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return e.prototype.toJSON=function(){var t=this,i=t.x,r=t.y,o=t.top,n=t.right,s=t.bottom,a=t.left,l=t.width,d=t.height;return{x:i,y:r,top:o,right:n,bottom:s,left:a,width:l,height:d}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}();var vp=function(e){return e instanceof SVGElement&&"getBBox"in e},dg=function(e){if(vp(e)){var t=e.getBBox(),i=t.width,r=t.height;return!i&&!r}var o=e,n=o.offsetWidth,s=o.offsetHeight;return!(n||s||e.getClientRects().length)},Ac=function(e){var t,i,r=(i=(t=e)===null||t===void 0?void 0:t.ownerDocument)===null||i===void 0?void 0:i.defaultView;return!!(r&&e instanceof r.Element)},yD=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1};var Dl=typeof window!="undefined"?window:{};var Fc=new Map,vD=/auto|scroll/,J6=/^tb|vertical/,Z6=/msie|trident/i.test(Dl.navigator&&Dl.navigator.userAgent),hn=function(e){return parseFloat(e||"0")},Pc=function(e,t,i){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=!1),Object.freeze({inlineSize:(i?t:e)||0,blockSize:(i?e:t)||0})},_D=Object.freeze({devicePixelContentBoxSize:Pc(),borderBoxSize:Pc(),contentBoxSize:Pc(),contentRect:new B_(0,0,0,0)}),M_=function(e){if(Fc.has(e))return Fc.get(e);if(dg(e))return Fc.set(e,_D),_D;var t=getComputedStyle(e),i=vp(e)&&e.ownerSVGElement&&e.getBBox(),r=!Z6&&t.boxSizing==="border-box",o=J6.test(t.writingMode||""),n=!i&&vD.test(t.overflowY||""),s=!i&&vD.test(t.overflowX||""),a=i?0:hn(t.paddingTop),l=i?0:hn(t.paddingRight),d=i?0:hn(t.paddingBottom),c=i?0:hn(t.paddingLeft),p=i?0:hn(t.borderTopWidth),h=i?0:hn(t.borderRightWidth),m=i?0:hn(t.borderBottomWidth),b=i?0:hn(t.borderLeftWidth),_=c+l,g=a+d,S=b+h,x=p+m,C=s?e.offsetHeight-x-e.clientHeight:0,R=n?e.offsetWidth-S-e.clientWidth:0,T=r?_+S:0,k=r?g+x:0,M=i?i.width:hn(t.width)-T-R,U=i?i.height:hn(t.height)-k-C,L=M+_+R+S,ee=U+g+C+x,de=Object.freeze({devicePixelContentBoxSize:Pc(Math.round(M*devicePixelRatio),Math.round(U*devicePixelRatio),o),borderBoxSize:Pc(L,ee,o),contentBoxSize:Pc(M,U,o),contentRect:new B_(c,a,M,U)});return Fc.set(e,de),de},cg=function(e,t){var i=M_(e),r=i.borderBoxSize,o=i.contentBoxSize,n=i.devicePixelContentBoxSize;switch(t){case El.DEVICE_PIXEL_CONTENT_BOX:return n;case El.BORDER_BOX:return r;default:return o}};var L_=function(){function e(t){var i=M_(t);this.target=t,this.contentRect=i.contentRect,this.borderBoxSize=[i.borderBoxSize],this.contentBoxSize=[i.contentBoxSize],this.devicePixelContentBoxSize=[i.devicePixelContentBoxSize]}return e}();var hg=function(e){if(dg(e))return Infinity;for(var t=0,i=e.parentNode;i;)t+=1,i=i.parentNode;return t};var xD=function(){var e=Infinity,t=[];ro.forEach(function(s){if(s.activeTargets.length===0)return;var a=[];s.activeTargets.forEach(function(d){var c=new L_(d.target),p=hg(d.target);a.push(c),d.lastReportedSize=cg(d.target,d.observedBox),p<e&&(e=p)}),t.push(function(){s.callback.call(s.observer,a,s.observer)}),s.activeTargets.splice(0,s.activeTargets.length)});for(var i=0,r=t;i<r.length;i++){var o=r[i];o()}return e};var z_=function(e){Fc.clear(),ro.forEach(function(i){i.activeTargets.splice(0,i.activeTargets.length),i.skippedTargets.splice(0,i.skippedTargets.length),i.observationTargets.forEach(function(o){o.isActive()&&(hg(o.target)>e?i.activeTargets.push(o):i.skippedTargets.push(o))})})};var wD=function(){var e=0;for(z_(e);mD();)e=xD(),z_(e);return fD()&&bD(),e>0};var N_,CD=[],Q6=function(){return CD.splice(0).forEach(function(e){return e()})},SD=function(e){if(!N_){var t=0,i=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return Q6()}).observe(i,r),N_=function(){i.textContent=""+(t?t--:t++)}}CD.push(e),N_()};var TD=function(e){SD(function(){requestAnimationFrame(e)})};var pg=0,eU=function(){return!!pg},tU=60/5,iU={attributes:!0,characterData:!0,childList:!0,subtree:!0},kD=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],U_=!1,rU=function(){function e(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return e.prototype.run=function(t){var i=this;if(U_)return;U_=!0,TD(function(){var r=!1;try{r=wD()}finally{if(U_=!1,!eU())return;r?i.run(60):t?i.run(t-1):i.start()}})},e.prototype.schedule=function(){this.stop(),this.run(tU)},e.prototype.observe=function(){var t=this,i=function(){return t.observer&&t.observer.observe(document.body,iU)};document.body?i():Dl.addEventListener("DOMContentLoaded",i)},e.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),kD.forEach(function(i){return Dl.addEventListener(i,t.listener,!0)}))},e.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),kD.forEach(function(i){return Dl.removeEventListener(i,t.listener,!0)}),this.stopped=!0)},e}(),ug=new rU,mg=function(e){!pg&&e>0&&ug.start(),pg+=e,!pg&&ug.stop()};var oU=function(e){return!vp(e)&&!yD(e)&&getComputedStyle(e).display==="inline"},ED=function(){function e(t,i){this.target=t,this.observedBox=i||El.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var t=cg(this.target,this.observedBox);return oU(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}();var DD=function(){function e(t,i){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=i}return e}();var oa=new Map,ID=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return-1},_p=function(){function e(){}return e.connect=function(t,i){var r=new DD(t,i);ro.push(r),oa.set(t,r)},e.observe=function(t,i,r){if(oa.has(t)){var o=oa.get(t);ID(o.observationTargets,i)<0&&(o.observationTargets.push(new ED(i,r&&r.box)),mg(1),ug.schedule())}},e.unobserve=function(t,i){if(oa.has(t)){var r=oa.get(t),o=ID(r.observationTargets,i);o>=0&&(r.observationTargets.splice(o,1),mg(-1))}},e.disconnect=function(t){if(oa.has(t)){var i=oa.get(t);ro.splice(ro.indexOf(i),1),oa.delete(t),mg(-i.observationTargets.length)}},e}();var xp=function(){function e(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");_p.connect(this,t)}return e.prototype.observe=function(t,i){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ac(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");_p.observe(this,t,i)},e.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Ac(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");_p.unobserve(this,t)},e.prototype.disconnect=function(){_p.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();const H_=v(Ly()),G_=v(Uy()),OD=v(SC()),j_=v(kC());const RD=()=>{if(typeof document=="undefined")return 0;if(ti())return window.innerWidth-document.documentElement.clientWidth;const{body:e}=document,t=document.createElement("div"),i=t.style;i.position="fixed",i.left="0",i.visibility="hidden",i.overflowY="scroll",e.appendChild(t);const r=t.getBoundingClientRect().right;return e.removeChild(t),r},Zi="photoeditorsdk-simplebar";class yt{constructor(e,t){this.minScrollbarWidth=20;this.initDOM=()=>{if(Array.prototype.filter.call(this.el.children,e=>e.classList.contains(this.classNames.wrapper)).length)this.wrapperEl=this.el.querySelector(`.${this.classNames.wrapper}`),this.contentWrapperEl=this.el.querySelector(`.${this.classNames.contentWrapper}`),this.offsetEl=this.el.querySelector(`.${this.classNames.offset}`),this.maskEl=this.el.querySelector(`.${this.classNames.mask}`),this.contentEl=this.el.querySelector(`.${this.classNames.contentEl}`),this.placeholderEl=this.el.querySelector(`.${this.classNames.placeholder}`),this.heightAutoObserverWrapperEl=this.el.querySelector(`.${this.classNames.heightAutoObserverWrapperEl}`),this.heightAutoObserverEl=this.el.querySelector(`.${this.classNames.heightAutoObserverEl}`),this.axis.x.track.el=this.el.querySelector(`.${this.classNames.track}.${this.classNames.horizontal}`),this.axis.y.track.el=this.el.querySelector(`.${this.classNames.track}.${this.classNames.vertical}`);else{for(this.wrapperEl=document.createElement("div"),this.contentWrapperEl=document.createElement("div"),this.offsetEl=document.createElement("div"),this.maskEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.placeholderEl=document.createElement("div"),this.heightAutoObserverWrapperEl=document.createElement("div"),this.heightAutoObserverEl=document.createElement("div"),this.wrapperEl.classList.add(this.classNames.wrapper),this.contentWrapperEl.classList.add(this.classNames.contentWrapper),this.offsetEl.classList.add(this.classNames.offset),this.maskEl.classList.add(this.classNames.mask),this.contentEl.classList.add(this.classNames.contentEl),this.placeholderEl.classList.add(this.classNames.placeholder),this.heightAutoObserverWrapperEl.classList.add(this.classNames.heightAutoObserverWrapperEl),this.heightAutoObserverEl.classList.add(this.classNames.heightAutoObserverEl);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.contentWrapperEl.appendChild(this.contentEl),this.offsetEl.appendChild(this.contentWrapperEl),this.maskEl.appendChild(this.offsetEl),this.heightAutoObserverWrapperEl.appendChild(this.heightAutoObserverEl),this.wrapperEl.appendChild(this.heightAutoObserverWrapperEl),this.wrapperEl.appendChild(this.maskEl),this.wrapperEl.appendChild(this.placeholderEl),this.el.appendChild(this.wrapperEl)}if(!this.axis.x.track.el||!this.axis.y.track.el){const e=document.createElement("div"),t=document.createElement("div");e.classList.add(this.classNames.track),t.classList.add(this.classNames.scrollbar),e.appendChild(t),this.axis.x.track.el=e.cloneNode(!0),this.axis.x.track.el.classList.add(this.classNames.horizontal),this.axis.y.track.el=e.cloneNode(!0),this.axis.y.track.el.classList.add(this.classNames.vertical),this.el.appendChild(this.axis.x.track.el),this.el.appendChild(this.axis.y.track.el)}this.axis.x.scrollbar.el=this.axis.x.track.el.querySelector(`.${this.classNames.scrollbar}`),this.axis.y.scrollbar.el=this.axis.y.track.el.querySelector(`.${this.classNames.scrollbar}`),this.options.autoHide||(this.axis.x.scrollbar.el.classList.add(this.classNames.visible),this.axis.y.scrollbar.el.classList.add(this.classNames.visible)),this.el.setAttribute("data-simplebar","init")};this.initListeners=()=>{this.options.autoHide&&this.el.addEventListener("mouseenter",this.onMouseEnter),["mousedown","click","dblclick","touchstart","touchend","touchmove"].forEach(e=>{this.el.addEventListener(e,this.onPointerEvent,{capture:!0,passive:!0})}),this.el.addEventListener("mousemove",this.onMouseMove),this.el.addEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onWindowResize),this.resizeObserver=new xp(this.recalculate),yS?(Ac(this.el)&&this.resizeObserver.observe(this.el),Ac(this.contentEl)&&this.resizeObserver.observe(this.contentEl)):(this.resizeObserver.observe(this.el),this.resizeObserver.observe(this.contentEl))};this.recalculate=()=>{const e=this.heightAutoObserverEl.offsetHeight<=1,t=this.heightAutoObserverEl.offsetWidth<=1;this.elStyles=window.getComputedStyle(this.el),this.isRtl=this.elStyles.direction==="rtl",this.contentEl.style.padding=`${this.elStyles.paddingTop} ${this.elStyles.paddingRight} ${this.elStyles.paddingBottom} ${this.elStyles.paddingLeft}`,this.wrapperEl.style.margin=`-${this.elStyles.paddingTop} -${this.elStyles.paddingRight} -${this.elStyles.paddingBottom} -${this.elStyles.paddingLeft}`,this.contentWrapperEl.style.height=e?"auto":"100%",this.placeholderEl.style.width=t?`${this.contentEl.offsetWidth}px`:"auto",this.placeholderEl.style.height=`${this.contentEl.scrollHeight}px`,this.axis.x.isOverflowing=this.contentWrapperEl.scrollWidth>this.contentWrapperEl.offsetWidth,this.axis.y.isOverflowing=this.contentWrapperEl.scrollHeight>this.contentWrapperEl.offsetHeight,this.axis.x.isOverflowing=this.elStyles.overflowX==="hidden"?!1:this.axis.x.isOverflowing,this.axis.y.isOverflowing=this.elStyles.overflowY==="hidden"?!1:this.axis.y.isOverflowing,this.axis.x.forceVisible=this.options.forceVisible==="x"||this.options.forceVisible===!0,this.axis.y.forceVisible=this.options.forceVisible==="y"||this.options.forceVisible===!0,this.hideNativeScrollbar(),this.axis.x.track.rect=this.axis.x.track.el.getBoundingClientRect(),this.axis.y.track.rect=this.axis.y.track.el.getBoundingClientRect(),this.axis.x.scrollbar.size=this.getScrollbarSize("x"),this.axis.y.scrollbar.size=this.getScrollbarSize("y"),this.axis.x.scrollbar.el.style.width=`${this.axis.x.scrollbar.size}px`,this.axis.y.scrollbar.el.style.height=`${this.axis.y.scrollbar.size}px`,this.positionScrollbar("x"),this.positionScrollbar("y"),this.toggleTrackVisibility("x"),this.toggleTrackVisibility("y")};this.getScrollbarSize=(e="y")=>{const t=this.scrollbarWidth?this.contentWrapperEl[this.axis[e].scrollSizeAttr]:this.contentWrapperEl[this.axis[e].scrollSizeAttr]-this.minScrollbarWidth,i=this.axis[e].track.rect[this.axis[e].sizeAttr];let r;if(!this.axis[e].isOverflowing)return;const o=i/t;return r=Math.max(~~(o*i),this.options.scrollbarMinSize),this.options.scrollbarMaxSize&&(r=Math.min(r,this.options.scrollbarMaxSize)),r};this.positionScrollbar=(e="y")=>{const t=this.contentWrapperEl[this.axis[e].scrollSizeAttr],i=this.axis[e].track.rect[this.axis[e].sizeAttr],r=parseInt(this.elStyles[this.axis[e].sizeAttr],10),{scrollbar:o}=this.axis[e];let n=this.contentWrapperEl[this.axis[e].scrollOffsetAttr];n=e==="x"&&this.isRtl&&yt.getRtlHelpers().isRtlScrollingInverted?-n:n;const s=n/(t-r);let a=~~((i-o.size)*s);a=e==="x"&&this.isRtl&&yt.getRtlHelpers().isRtlScrollbarInverted?a+(i-o.size):a,o.el.style.transform=e==="x"?`translate3d(${a}px, 0, 0)`:`translate3d(0, ${a}px, 0)`};this.toggleTrackVisibility=(e="y")=>{const t=this.axis[e].track.el,i=this.axis[e].scrollbar.el;this.axis[e].isOverflowing||this.axis[e].forceVisible?(t.style.visibility="visible",this.contentWrapperEl.style[this.axis[e].overflowAttr]="scroll"):(t.style.visibility="hidden",this.contentWrapperEl.style[this.axis[e].overflowAttr]="hidden"),i.style.display=this.axis[e].isOverflowing?"block":"none"};this.onScroll=()=>{this.scrollXTicking||(window.requestAnimationFrame(this.scrollX),this.scrollXTicking=!0),this.scrollYTicking||(window.requestAnimationFrame(this.scrollY),this.scrollYTicking=!0)};this.scrollX=()=>{this.axis.x.isOverflowing&&(this.showScrollbar("x"),this.positionScrollbar("x")),this.scrollXTicking=!1};this.scrollY=()=>{this.axis.y.isOverflowing&&(this.showScrollbar("y"),this.positionScrollbar("y")),this.scrollYTicking=!1};this.onMouseEnter=()=>{this.showScrollbar("x"),this.showScrollbar("y")};this.onMouseMove=e=>{this.mouseX=e.clientX,this.mouseY=e.clientY,(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&this.onMouseMoveForAxis("x"),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&this.onMouseMoveForAxis("y")};this.onMouseMoveForAxis=(e="y")=>{this.axis[e].track.rect=this.axis[e].track.el.getBoundingClientRect(),this.axis[e].scrollbar.rect=this.axis[e].scrollbar.el.getBoundingClientRect();const t=this.isWithinBounds(this.axis[e].scrollbar.rect);t?this.axis[e].scrollbar.el.classList.add(this.classNames.hover):this.axis[e].scrollbar.el.classList.remove(this.classNames.hover),this.isWithinBounds(this.axis[e].track.rect)?(this.showScrollbar(e),this.axis[e].track.el.classList.add(this.classNames.hover)):this.axis[e].track.el.classList.remove(this.classNames.hover)};this.onMouseLeave=()=>{this.onMouseMove.cancel(),(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&this.onMouseLeaveForAxis("x"),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&this.onMouseLeaveForAxis("y"),this.mouseX=-1,this.mouseY=-1};this.onWindowResize=()=>{this.scrollbarWidth=RD(),this.hideNativeScrollbar()};this.hideScrollbars=()=>{this.axis.x.track.rect=this.axis.x.track.el.getBoundingClientRect(),this.axis.y.track.rect=this.axis.y.track.el.getBoundingClientRect(),this.isWithinBounds(this.axis.y.track.rect)||(this.axis.y.scrollbar.el.classList.remove(this.classNames.visible),this.axis.y.isVisible=!1),this.isWithinBounds(this.axis.x.track.rect)||(this.axis.x.scrollbar.el.classList.remove(this.classNames.visible),this.axis.x.isVisible=!1)};this.onPointerEvent=e=>{let t,i;this.axis.x.scrollbar.rect=this.axis.x.scrollbar.el.getBoundingClientRect(),this.axis.y.scrollbar.rect=this.axis.y.scrollbar.el.getBoundingClientRect(),(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&(i=this.isWithinBounds(this.axis.x.scrollbar.rect)),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&(t=this.isWithinBounds(this.axis.y.scrollbar.rect)),(t||i)&&(e.preventDefault(),e.stopPropagation(),e.type==="mousedown"&&(t&&this.onDragStart(e,"y"),i&&this.onDragStart(e,"x")))};this.drag=e=>{let t;const{track:i,scrollbar:r}=this.axis[this.draggedAxis],o=i.rect[this.axis[this.draggedAxis].sizeAttr];e.preventDefault(),e.stopPropagation(),t=this.draggedAxis==="y"?e.pageY:e.pageX;const n=t-i.rect[this.axis[this.draggedAxis].offsetAttr]-this.axis[this.draggedAxis].dragOffset,s=n/i.rect[this.axis[this.draggedAxis].sizeAttr];let a=s*this.contentWrapperEl[this.axis[this.draggedAxis].scrollSizeAttr];this.draggedAxis==="x"&&(a=this.isRtl&&yt.getRtlHelpers().isRtlScrollbarInverted?a-(o+r.size):a,a=this.isRtl&&yt.getRtlHelpers().isRtlScrollingInverted?-a:a),this.contentWrapperEl[this.axis[this.draggedAxis].scrollOffsetAttr]=a};this.onEndDrag=e=>{e.preventDefault(),e.stopPropagation(),this.el.classList.remove(this.classNames.dragging),document.removeEventListener("mousemove",this.drag,!0),document.removeEventListener("mouseup",this.onEndDrag,!0),this.removePreventClickId=window.setTimeout(()=>{document.removeEventListener("click",this.preventClick,!0),document.removeEventListener("dblclick",this.preventClick,!0),this.removePreventClickId=null})};this.preventClick=e=>{e.preventDefault(),e.stopPropagation()};if(this.el=e,this.options=y(y({},yt.defaultOptions),t),this.classNames=y(y({},yt.defaultOptions.classNames),this.options.classNames),this.axis={x:{scrollOffsetAttr:"scrollLeft",sizeAttr:"width",scrollSizeAttr:"scrollWidth",offsetAttr:"left",overflowAttr:"overflowX",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}},y:{scrollOffsetAttr:"scrollTop",sizeAttr:"height",scrollSizeAttr:"scrollHeight",offsetAttr:"top",overflowAttr:"overflowY",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}}},this.removePreventClickId=null,this.el.SimpleBar)return;this.recalculate=H_.default(this.recalculate,64),this.onMouseMove=H_.default(this.onMouseMove,64),this.hideScrollbars=G_.default(this.hideScrollbars,this.options.timeout),this.onWindowResize=G_.default(this.onWindowResize,64,{leading:!0}),yt.getRtlHelpers=OD.default(yt.getRtlHelpers),this.init()}static getRtlHelpers(){const e=document.createElement("div");e.innerHTML='<div class="photoeditorsdk-hs-dummy-scrollbar-size"><div style="height: 200% width: 200% margin: 10px 0"></div></div>';const t=e.firstElementChild;document.body.appendChild(t);const i=t.firstElementChild;t.scrollLeft=0;const r=yt.getOffset(t),o=yt.getOffset(i);t.scrollLeft=999;const n=yt.getOffset(i);return{isRtlScrollingInverted:r.left!==o.left&&o.left-n.left!==0,isRtlScrollbarInverted:r.left!==o.left}}static initHtmlApi(){this.initDOMLoadedElements=this.initDOMLoadedElements.bind(this),typeof MutationObserver!="undefined"&&(this.globalObserver=new MutationObserver(e=>{e.forEach(t=>{Array.prototype.forEach.call(t.addedNodes,i=>{i.nodeType===1&&(i.hasAttribute("data-simplebar")&&!i.SimpleBar?new yt(i,yt.getElOptions(i)):Array.prototype.forEach.call(i.querySelectorAll("[data-simplebar]"),r=>{r.SimpleBar||new yt(r,yt.getElOptions(r))}))}),Array.prototype.forEach.call(t.removedNodes,i=>{i.nodeType===1&&(i.hasAttribute("data-simplebar")&&i.SimpleBar?i.SimpleBar.unMount():Array.prototype.forEach.call(i.querySelectorAll("[data-simplebar]"),r=>{r.SimpleBar&&r.SimpleBar.unMount()}))})})}),this.globalObserver.observe(document,{childList:!0,subtree:!0})),document.readyState==="complete"||document.readyState!=="loading"&&!document.documentElement.scroll?window.setTimeout(this.initDOMLoadedElements):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.addEventListener("load",this.initDOMLoadedElements))}static getElOptions(e){const t=Array.prototype.reduce.call(e.attributes,(i,r)=>{const o=r.name.match(/data-simplebar-(.+)/);if(o){const n=o[1].replace(/\W+(.)/g,(s,a)=>a.toUpperCase());switch(r.value){case"true":i[n]=!0;break;case"false":i[n]=!1;break;case void 0:i[n]=!0;break;default:i[n]=r.value}}return i},{});return t}static removeObserver(){this.globalObserver.disconnect()}static initDOMLoadedElements(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.removeEventListener("load",this.initDOMLoadedElements),Array.prototype.forEach.call(document.querySelectorAll("[data-simplebar]"),e=>{e.SimpleBar||new yt(e,yt.getElOptions(e))})}static getOffset(e){const t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft)}}init(){this.el.SimpleBar=this,j_.default&&(this.initDOM(),this.scrollbarWidth=RD(),this.recalculate(),this.initListeners())}hideNativeScrollbar(){if(this.offsetEl.style[this.isRtl?"left":"right"]=this.axis.y.isOverflowing||this.axis.y.forceVisible?`-${this.scrollbarWidth||this.minScrollbarWidth}px`:0,this.offsetEl.style.bottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?`-${this.scrollbarWidth||this.minScrollbarWidth}px`:0,!this.scrollbarWidth){const e=this.isRtl?"paddingLeft":"paddingRight";this.contentWrapperEl.style[e]=this.axis.y.isOverflowing||this.axis.y.forceVisible?`${this.minScrollbarWidth}px`:0,this.contentWrapperEl.style.paddingBottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?`${this.minScrollbarWidth}px`:0}}onMouseLeaveForAxis(e="y"){this.axis[e].track.el.classList.remove(this.classNames.hover),this.axis[e].scrollbar.el.classList.remove(this.classNames.hover)}showScrollbar(e="y"){const t=this.axis[e].scrollbar.el;this.axis[e].isVisible||(t.classList.add(this.classNames.visible),this.axis[e].isVisible=!0),this.options.autoHide&&this.hideScrollbars()}onDragStart(e,t="y"){const i=this.axis[t].scrollbar.el,r=t==="y"?e.pageY:e.pageX;this.axis[t].dragOffset=r-i.getBoundingClientRect()[this.axis[t].offsetAttr],this.draggedAxis=t,this.el.classList.add(this.classNames.dragging),document.addEventListener("mousemove",this.drag,!0),document.addEventListener("mouseup",this.onEndDrag,!0),this.removePreventClickId===null?(document.addEventListener("click",this.preventClick,!0),document.addEventListener("dblclick",this.preventClick,!0)):(window.clearTimeout(this.removePreventClickId),this.removePreventClickId=null)}getContentElement(){return this.contentEl}getScrollElement(){return this.contentWrapperEl}removeListeners(){this.options.autoHide&&this.el.removeEventListener("mouseenter",this.onMouseEnter),["mousedown","click","dblclick","touchstart","touchend","touchmove"].forEach(e=>{this.el.removeEventListener(e,this.onPointerEvent,{capture:!0,passive:!0})}),this.el.removeEventListener("mousemove",this.onMouseMove),this.el.removeEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onWindowResize),this.mutationObserver&&this.mutationObserver.disconnect(),this.resizeObserver.disconnect(),this.recalculate.cancel(),this.onMouseMove.cancel(),this.hideScrollbars.cancel(),this.onWindowResize.cancel()}unMount(){this.removeListeners(),this.el.SimpleBar=null}isChildNode(e){return e===null?!1:e===this.el?!0:this.isChildNode(e.parentNode)}isWithinBounds(e){return this.mouseX>=e.left&&this.mouseX<=e.left+e.width&&this.mouseY>=e.top&&this.mouseY<=e.top+e.height}}yt.defaultOptions={autoHide:!0,forceVisible:!1,classNames:{contentEl:`${Zi}-content`,contentWrapper:`${Zi}-content-wrapper`,offset:`${Zi}-offset`,mask:`${Zi}-mask`,wrapper:`${Zi}-wrapper`,placeholder:`${Zi}-placeholder`,scrollbar:`${Zi}-scrollbar`,track:`${Zi}-track`,heightAutoObserverWrapperEl:`${Zi}-height-auto-observer-wrapper`,heightAutoObserverEl:`${Zi}-height-auto-observer`,visible:`${Zi}-visible`,horizontal:`${Zi}-horizontal`,vertical:`${Zi}-vertical`,hover:`${Zi}-hover`,dragging:`${Zi}-dragging`},scrollbarMinSize:25,scrollbarMaxSize:0,timeout:1e3};j_.default&&yt.initHtmlApi();class W_{static isImageElement(e){return e instanceof HTMLImageElement}constructor({license:e,assetProvider:t,crossOrigin:i}){this.crossOrigin=i,this.engine=new fp({license:e,crossOrigin:i,assetProvider:t,downscaleOptions:{maxDimensions:{width:100,height:100}}})}getAllFilterPreviewThumbnails(e){return new Promise((t,i)=>{const r={};e.reduce((o,n)=>Z(this,null,function*(){const s=yield o;return s.identifier&&(r[s.identifier]=s.imageData),this.getFilterPreviewThumbnail(n)}),Promise.resolve({identifier:"",imageData:""})).then(o=>{r[o.identifier]=o.imageData,t(r)}).catch(o=>{i(o)})})}getFilterPreviewThumbnail({identifier:e,isDuotone:t}){return e!==""?(this.effect&&(this.engine.removeEffect(this.effect),this.effect.getIndexInParent()||(this.effect=void 0)),t?new Promise((i,r)=>{this.engine.addDuoToneFilterFromAssets(e,this.container).then(o=>{o.setProperties({colorIntensity:.5}),this.effect=o,this.engine.export(ci.DATA_URL,Ut.PNG,.2).then(n=>{i({identifier:e,imageData:n})}).catch(n=>{r(n)})}).catch(o=>{r(o)})}):new Promise((i,r)=>{this.engine.addLUTFilterFromAssets(e,this.container).then(o=>{o.setProperties({intensity:1}),this.effect=o,this.engine.export(ci.DATA_URL,Ut.PNG,.2).then(n=>{i({identifier:e,imageData:n})}).catch(n=>{r(n)})}).catch(o=>{r(o)})})):new Promise(i=>i({identifier:"",imageData:""}))}addImageToContainer(e){return new Promise((t,i)=>{let r;W_.isImageElement(e)?(r=e,this.setBackgroundImage(r),t()):this.getImageElement(e).then(o=>{r=o,this.setBackgroundImage(r),t()}).catch(o=>{i({identifier:"imageLoading",message:o.message})})})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.crossOrigin,r.src=e})}setBackgroundImage(e){this.container?this.container.setData({image:e}):this.container=this.engine.addImage({image:e,blendMode:ye.NORMAL,opacity:1});const{size:t}=this.container.getBounds(),i=this.engine.getOutputContainer();i.setResolution(t)}}const nU=(e,t)=>new Promise((i,r)=>{const o=new XMLHttpRequest;o.onload=()=>{const n=new FileReader;n.onloadend=()=>{typeof n.result=="string"&&n.result.substr(0,10)==="data:image"?i(n.result):r(new Error(`The image could not be loaded from ${e}`))},n.onerror=s=>{r(s)},n.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.withCredentials=t==="use-credentials",o.send()}),AD=(e,t)=>(console.log("src",e),new Promise((i,r)=>{const o=new Image;o.onload=()=>{console.log(o),i(o)},o.onerror=function(){console.log(this),r(new Error(`Failed to load image with src:${e}`))},o.crossOrigin=t,o.src=e})),sU=(e,t)=>new Promise((i,r)=>{nU(e,t).then(o=>{const n=new Image;n.addEventListener("load",()=>{i(n)}),n.src=o}).catch(()=>{AD(e,t).then(o=>i(o)).catch(o=>{r(o)})})}),V_=r=>Z(void 0,[r],function*({url:e,image:t,crossOrigin:i="anonymous"}){try{return t&&t.src&&t.src.substr(0,5)==="data:"||t&&t.src&&t.src.includes(".svg")?t:typeof e=="string"&&e.substr(0,5)==="data:"||typeof e=="string"&&e.includes(".svg")?AD(e,i):sU(e||t.src,i)}catch(o){throw new Error(o)}});const oo=v(Ve()),aU={tool:null,isWebcam:!1,image:""};class pn{constructor(e){this.setImage=e=>Z(this,null,function*(){const{crossOrigin:t}=this.editor.configStore.config.engine;typeof e=="string"&&(this.state.image=yield V_({url:zs(e)?e:this.editor.assetProvider.getPath(e),crossOrigin:t})),e instanceof HTMLImageElement&&(this.state.image=yield V_({image:e,crossOrigin:t})),this.isWebcam&&(this.state.isWebcam=!1)});this.newImage=e=>{this.editor.init(e)};this.editor=e,this.state=oo.observable(aU)}selectTool(e,t=!1){const{licenseChecker:i}=this.editor.configStore;if(e=this.state.tool===e&&t?null:e,i&&i.isToolAllowed(e)){this.editor.onToolChange(this.state.tool,e),this.state.tool=e;switch(e){case w.TEXT:this.editor.spriteStore.textToolStore.addOrselect();break;case w.TEXT_DESIGN:this.editor.spriteStore.textDesignToolStore.addOrselect();break;case w.BRUSH:{this.editor.brushToolStore.initSize();break}case w.TRANSFORM:this.editor.transformToolStore.applyDefaultCrop();break}}}selectWebcam(e){this.state.isWebcam=e}get webcamLabel(){return this.editor.libraryStore.locale.controls.buttonWebcamClose}get tool(){return this.state.tool}get isWebcam(){return this.state.isWebcam}get image(){return this.state.image}}u([oo.action],pn.prototype,"selectTool",1),u([oo.action],pn.prototype,"selectWebcam",1),u([oo.action],pn.prototype,"setImage",2),u([oo.action],pn.prototype,"newImage",2),u([oo.computed],pn.prototype,"webcamLabel",1),u([oo.computed],pn.prototype,"tool",1),u([oo.computed],pn.prototype,"isWebcam",1),u([oo.computed],pn.prototype,"image",1);const br=v(Ve()),K_={height:150,width:150};class Fr{constructor(e){this.canvasClickDisabled=br.observable.box(!1);this.editor=e,this.state=br.observable(Fr.initialState)}setCanvasElement(e){this.canvas=e,this.editor.engineMediator.preview.createPreview(e),this.updateCanvasDimensions(),this.editor.init(this.editor.configStore.config.image)}updateCanvasDimensions(){const e=It.devicePixelRatio;this.canvas.width=this.canvasSize.width*e,this.canvas.height=this.canvasSize.height*e,this.canvas.style.width=`${this.canvasSize.width}px`,this.canvas.style.height=`${this.canvasSize.height}px`}saveDimensions({height:e,width:t,render:i}){const r=this.editor.configStore.isLayoutAdvanced?0:this.editor.configStore.measurements.basicCanvasOffset;e-r>K_.height&&t>K_.width&&(this.state.canvasSize.height=e-r,this.state.canvasSize.width=t,i&&this.editor.resize())}disableCanvasClick(){this.canvasClickDisabled.set(!0)}enableCanvasClick(){this.canvasClickDisabled.set(!1)}get isCanvasClickable(){return!this.canvasClickDisabled.get()}get canvasSize(){return this.state.canvasSize}get sizeVector(){return E.fromSize(this.state.canvasSize)}get sizeVectorMagnitude(){return this.sizeVector.magnitude}getContainersAtPreviewPoint(e){const t=this.editor.engine.getContainersAtPreviewPoint(e,this.editor.engineMediator.preview.previewTransformWithoutDpr).map(i=>i.getID()).filter(i=>i!==this.editor.engineMediator.image.getImgageContainerId());this.editor.spriteStore.onCanvasClick(t)}}Fr.initialState={canvasSize:K_},u([br.action],Fr.prototype,"setCanvasElement",1),u([br.action],Fr.prototype,"updateCanvasDimensions",1),u([br.action],Fr.prototype,"saveDimensions",1),u([br.action],Fr.prototype,"disableCanvasClick",1),u([br.action],Fr.prototype,"enableCanvasClick",1),u([br.computed],Fr.prototype,"isCanvasClickable",1),u([br.computed],Fr.prototype,"canvasSize",1),u([br.computed],Fr.prototype,"sizeVector",1),u([br.computed],Fr.prototype,"sizeVectorMagnitude",1);const Pr=v(Ve()),lU={type:null,identifier:null,isVisible:!1,error:""};class Po{constructor(e){this.showActionModal=({type:e,identifier:t,error:i,handleConfirm:r,handleDismiss:o})=>{this.resetHandlers(),this.state.isVisible=!0,this.state.identifier=t,this.state.type=e,this.state.error=i||"",this.handleConfirm=r,this.handleDismiss=o};this.hideModal=()=>{this.state.isVisible=!1,this.state.type=null,this.state.error="",this.state.identifier=null,this.resetHandlers()};this.resetHandlers=()=>{this.handleConfirm=null,this.handleDismiss=null};this.configStore=e.configStore,this.state=Pr.observable(lU)}showInfoModal(e){this.resetHandlers(),this.state.isVisible=!0,this.state.type=ot.INFO,this.state.identifier=e,this.state.error=""}showTextEditModal(){this.resetHandlers(),this.state.isVisible=!0,this.state.type=ot.TEXT_EDIT,this.state.identifier="inputText",this.state.error=""}get modalProps(){const{isVisible:e}=this.state,t=this.getModalLocale();if(t){const{bodyLabel:i,headerLabel:r,buttonYes:o,buttonNo:n}=t;return{headerLabel:r,bodyLabel:i,confirmLabel:o,dismissLabel:n,isVisible:e,handleClose:this.hideModal,handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss}}return{isVisible:!1}}get isVisible(){return this.state.isVisible}get type(){return this.state.type}get identifier(){return this.state.identifier}get positionOffset(){const{isLayoutAdvanced:e,measurements:{basicCanvasOffset:t,advancedUIToolControlBar:i,advancedUIToolbar:r},isOrderDefault:o}=this.configStore,n=(i.width+r.width)*(o?1:-1),s=t;return e?{x:n/2,y:0}:{x:0,y:-s}}getModalLocale(){const{identifier:e,error:t,type:i}=this.state,{locale:r}=this.configStore;if(!i||!e||i===ot.TEXT_EDIT)return null;if(i&&e&&r[`${i}Modals`]&&r[`${i}Modals`][e]){const o=r[`${i}Modals`][e];let{body:n}=o;n&&(n=n.replace("${error}",t));let s=o.heading;if(i===ot.ERROR||i===ot.WARNING){const a={error:r.common.error,warning:r.common.warning},l=i==="error"?a.error:a.warning;s=`${l}${o.headingDelimiter} ${o.header||""}`}return{bodyLabel:n,headerLabel:s,buttonYes:o.buttonYes,buttonNo:o.buttonNo}}return null}}u([Pr.action],Po.prototype,"showActionModal",2),u([Pr.action],Po.prototype,"showInfoModal",1),u([Pr.action],Po.prototype,"showTextEditModal",1),u([Pr.action],Po.prototype,"hideModal",2),u([Pr.computed],Po.prototype,"modalProps",1),u([Pr.computed],Po.prototype,"isVisible",1),u([Pr.computed],Po.prototype,"type",1),u([Pr.computed],Po.prototype,"identifier",1),u([Pr.computed],Po.prototype,"positionOffset",1);const Kt=v(Ve());class oi{constructor(e){this.defaultScale=1;this.SCALE_LEVELS=[8.33,12.5,16.66,25,33.33,50,66.66,100,125,150,200,300,400,500,600].map(e=>e/100);this.state={position:{x:0,y:0},scaleIndex:-1};this.offset={x:0,y:0};this.in=()=>{this.canZoomIn&&(this.state.scaleIndex+=1,this.scaleRender())};this.out=()=>{if(this.canZoomOut){this.state.scaleIndex-=1;const{canDragX:e,canDragY:t,maxOffsetX:i,maxOffsetY:r}=this.checkOffset({x:0,y:0});t||(this.offset.y=r),e||(this.offset.x=i),this.savePosition(),this.scaleRender()}};this.setOffset=e=>{const{canDragX:t,canDragY:i}=this.checkOffset(e);t&&(this.offset.x=e.x),i&&(this.offset.y=e.y),this.scaleRender()};this.editor=e}setInitialTransform(e=0){const{transform:t}=this.editor.engineMediator.preview;Kt.runInAction(()=>{this.setDefaultScale(Math.abs(e||t.scale.x)),this.setPosition(t.position)})}resetScale(){this.state.scaleIndex=-1}resetPosition(){const{width:e,height:t}=this.editor.canvasStore.canvas;this.setPosition({x:e/2,y:t/2})}resetOffset(){this.offset={x:0,y:0}}setPosition(e){this.state.position.x=e.x,this.state.position.y=e.y}savePosition(){this.setPosition(this.getPositionWithOffset()),this.offset={x:0,y:0}}setDefaultScale(e){if(this.defaultScale!==1){const i=this.SCALE_LEVELS.findIndex(r=>r===this.defaultScale);i!==-1&&(this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,i),...this.SCALE_LEVELS.slice(i+1)])}const t=this.SCALE_LEVELS.findIndex((i,r)=>r===0?e<i:r===this.SCALE_LEVELS.length-1?i<e:this.SCALE_LEVELS[r-1]<e&&e<i);if(t!==-1)this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,t),e,...this.SCALE_LEVELS.slice(t)],t===this.state.scaleIndex&&this.resetScale(),this.state.scaleIndex=t,this.defaultScale=e;else{const i=this.SCALE_LEVELS.findIndex(r=>r===e);i===this.state.scaleIndex&&this.resetScale(),i!==-1&&(this.state.scaleIndex=i,this.defaultScale=e)}}setScaleToDefault(){this.state.scaleIndex=this.defaultIndex}checkOffset(e){const t=window.devicePixelRatio||1,{scaledSize:i}=this,{previewSize:r}=this,o=this.editor.engineMediator.preview.initialTransform.position,n=this.getPositionWithOffset(e),s=(i.width-r.width)*t/2,a=(i.height-r.height)*t/2,l=o.x-n.x,d=o.y-n.y,c=Math.abs(l),p=Math.abs(d),h=l>0,m=d>0,b=c-s,_=p-a;return{canDragX:b<0,canDragY:_<0,maxOffsetX:h?-b:b,maxOffsetY:m?-_:_}}calculateScale(e=0,t=this.previewSize,i=this.defaultScale){const{width:r,height:o}=t,n=new E({x:r,y:o}),s=new E(Math.abs(n.x*Math.cos(e))+Math.abs(n.y*Math.sin(e)),Math.abs(n.x*Math.sin(e))+Math.abs(n.y*Math.cos(e))),a=n.subtract(s).divide(2).multiply(i).abs;return a.y>a.x?a.y*2/n.y+i:a.x*2/n.x+i}get defaultIndex(){return this.SCALE_LEVELS.findIndex(e=>e===this.defaultScale)}getPositionWithOffset(e=this.offset){const{position:t}=this;return{x:t.x-e.x,y:t.y-e.y}}scaleRender(e=!1){const t=this.editor.scale.getPositionWithOffset(),i=e?this.defaultScale:this.scale,r={x:i,y:i};this.editor.engineMediator.preview.container.setScale(r),this.editor.engineMediator.preview.container.setPosition(t),this.editor.engineMediator.preview.savePreviewTransform({scale:r,position:t,rotation:0}),e||this.editor.render()}get scale(){const e=this.state.scaleIndex;return e!==-1?this.SCALE_LEVELS[e]:this.defaultScale}get zoomLevel(){const e=window.devicePixelRatio||1;return(this.scale/e*100).toFixed(1)}get canDrag(){return this.defaultScale<this.scale}get canZoomOut(){return this.state.scaleIndex>this.defaultIndex}get canZoomIn(){return this.SCALE_LEVELS.length-1>this.state.scaleIndex}get position(){return this.state.position}get scaledSize(){const e=this.state.scaleIndex,t=e!==-1?this.SCALE_LEVELS[e]:this.defaultScale,{previewSize:i}=this;return{width:i.width*t/this.defaultScale,height:i.height*t/this.defaultScale}}get previewSize(){return this.editor.getPreviewSize()}}u([Kt.observable],oi.prototype,"state",2),u([Kt.action],oi.prototype,"in",2),u([Kt.action],oi.prototype,"out",2),u([Kt.action],oi.prototype,"setInitialTransform",1),u([Kt.action],oi.prototype,"resetScale",1),u([Kt.action],oi.prototype,"resetPosition",1),u([Kt.action],oi.prototype,"setPosition",1),u([Kt.action],oi.prototype,"savePosition",1),u([Kt.action],oi.prototype,"setDefaultScale",1),u([Kt.action],oi.prototype,"setScaleToDefault",1),u([Kt.computed],oi.prototype,"scale",1),u([Kt.computed],oi.prototype,"zoomLevel",1),u([Kt.computed],oi.prototype,"canDrag",1),u([Kt.computed],oi.prototype,"canZoomOut",1),u([Kt.computed],oi.prototype,"canZoomIn",1),u([Kt.computed],oi.prototype,"position",1),u([Kt.computed],oi.prototype,"scaledSize",1);var dU="@photoeditorsdk/root",cU="5.6.0",hU="The most comprehensive photo editor SDK for HTML5",pU="http://github.com/imgly/pesdk-html5",uU="PhotoEditorSDK (img.ly GmbH) <contact@img.ly>",mU="SEE LICENSE IN LICENSE.md",fU=!0,gU={},bU={start:"yarn workspace example run start",build:"yarn sdk-script build","build:rollup":"yarn sdk-script build rollup","package:release":"cd dist/photoeditorsdk && npm publish","package:pre-release":"cd dist/photoeditorsdk && npm publish --tag next","lint:css":"stylelint './packages/**/*.tsx'","lint:ts":"eslint --ext .tsx,.ts  packages",lint:"npm run lint:ts && npm run lint:css","lint-ts:fix":"eslint --fix --ext .tsx,.ts  packages",test:"$(npm bin)/jest",deploy:"yarn workspace examp run deploy:pages",docs:"rm -rf ./docs && typedoc"},yU={"@testing-library/react":"^8.0.4","@types/jest":"^24.0.11","@types/react":"^16.8.13","@types/react-dom":"^16.8.4","@types/styled-components":"4.4.0","@typescript-eslint/eslint-plugin":"2.22.0","@typescript-eslint/parser":"2.22.0",autoprefixer:"^9.7.4","cross-env":"^7.0.2",eslint:"6.8.0","eslint-config-airbnb":"18.0.1","eslint-config-prettier":"6.10.0","eslint-plugin-import":"2.20.1","eslint-plugin-jsx-a11y":"6.2.3","eslint-plugin-prettier":"3.1.2","eslint-plugin-react":"7.18.3",husky:"1.3.1",jest:"^24.7.1","jest-axe":"^3.2.0","jest-dom":"^3.1.3",jsdoc:"^3.6.3","json-loader":"^0.5.7","lint-staged":"10.4.0","local-web-server":"^4.2.1","lodash.defaults":"^4.2.0","mobx-react-devtools":"^6.1.1","node-sass":"^4.14.1","node-static":"^0.7.10","npm-run-all":"^4.1.5","optimize-css-assets-webpack-plugin":"^3.2.0",prettier:"^2.0.5",react:"^16.3.2","react-dom":"^16.3.3","styled-components":"4.4.1",stylelint:"^13.2.0","stylelint-config-recommended":"^3.0.0","stylelint-config-standard":"^20.0.0","stylelint-config-styled-components":"^0.1.1","stylelint-processor-styled-components":"^1.10.0","ts-jest":"^24.0.2",typedoc:"^0.17.8",typescript:"3.8.3"},vU={"@juggle/resize-observer":"3.1.3","can-use-dom":"0.1.0","lodash.debounce":"4.0.8","lodash.memoize":"4.1.2","lodash.throttle":"4.1.1",mobx:"4.14.1","mobx-react":"5.4.4",photoeditorsdk:"1.0.0","react-app-polyfill":"1.0.6"},_U={node:"8.x || 9.x || 10.x || 11.x || 12.x"},xU={react:"^16.3.0","react-dom":"^16.3.0","styled-components":"^4.4.0"},wU={packages:["example","examples/*","packages/**/","engine/*","test/*","scripts"]},CU={"packages/*.{ts,tsx}":["npm run lint-ts:fix","npm run lint:css","git add"],"example/package.json":["yarn sdk-script unlink -P example"],"example-server/package.json":["yarn sdk-script unlink -P example-server","yarn sdk-script unlink -P example-server -S"],"scripts/**/*.ts":["yarn workspace @photoeditorsdk/scripts run build"]},SU={hooks:{"pre-commit":"lint-staged","pre-push":"true"}},FD={name:dU,version:cU,description:hU,repository:pU,author:uU,license:mU,private:fU,bin:gU,scripts:bU,devDependencies:yU,dependencies:vU,devEngines:_U,peerDependencies:xU,workspaces:wU,"lint-staged":CU,husky:SU};const TU=(e=Ut.PNG)=>`data:${e};base64,`;class Qa{constructor(e,t,i,r,o,n){this.mapImagePointToRelativeCropPoint=e=>{const t=se.pointFromSpaceToSpace(e,this.imageSpace,this.cropSpace,!1);return se.absoluteToRelativePoint(t,this.cropSpace,!1)};this.mapSizeToRelativeUnscaledCropSize=e=>e/Math.min(this.outputSize.height,this.outputSize.width);this.mapSizeToRelativeScaledCropSize=e=>e/Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.getPointInDirection=(e,t=0,i=3)=>{const r=Math.tan(t),o=Math.sqrt(r**2+1);return{x:e.x+i/o,y:e.y+i*r/o}};this.previewPosition=e,this.previewSize=t,this.outputSize=i,this.imageSize=r,this.imageSpace=o,this.cropSpace=n,this.outputScale=n.getScale()}static serializeFilters(e){return{type:"filter",options:{intensity:e.intensity,identifier:e.identifier}}}static serializeAdjustments(e){return{type:"adjustments",options:e}}static serializeOverlay(e){return{type:"overlay",options:{identifier:e.identifier,intensity:e.opacity,blendMode:e.blendMode.replace(/[A-Z]/g,t=>` ${t.toLowerCase()}`)}}}static serializeMetaData(){return{platform:"html5",version:FD.version,createdAt:new Date().toISOString()}}serialise(e,t,i){const r=Qa.serializeMetaData(),o={width:this.imageSize.width,height:this.imageSize.height};t&&(o.type=i,o.data=t);const n=[],s=[],{adjustment:a}=e;Object.keys(a).map(b=>a[b]).filter(Boolean).length&&n.push(Qa.serializeAdjustments(a));const{filter:l}=e;l.identifier!=="identity"&&n.push(Qa.serializeFilters(l));const{overlay:d}=e;if(d.identifier!=="identity"&&s.push(Qa.serializeOverlay(d)),e.transform){const{transform:b,orientation:_}=this.serializeTransform(e.transform),g=[b.options.start.x!==0,b.options.start.y!==0,b.options.end.x!==1,b.options.end.y!==1,b.options.rotation!==0],S=[_.options.rotation!==0,_.options.flipVertically!==!1,_.options.flipHorizontally!==!1];g.some(x=>x)&&n.push(b),S.some(x=>x)&&n.push(_)}const{frame:c}=e;c.identifier!=="identity"&&s.push(this.serialzeFrame(c));const{focus:p}=e;if(p.identifier!=="identity"&&n.push(this.serializeFocus(p)),e.sprite&&e.sprite.spriteIdList.forEach(b=>{const _=e.sprite.common[b];switch(_.tool){case"sticker":const g=e.sprite.sticker[b];s.push(this.serializeSticker(g,_,e.transform));break;case"text":const S=e.sprite.text[b];s.push(this.serializeText(S,_));break;case"textdesign":const x=e.sprite.textdesign[b];s.push(this.serializeTextDesign(x,_));break}}),e.brush.strokes.length&&s.push({type:"brush",options:{paths:e.brush.strokes.map(b=>({points:b.path.controlPoints.map(this.mapImagePointToRelativeCropPoint),brush:{color:{rgba:b.brush.color},size:b.brush.size,hardness:b.brush.hardness}}))}}),s.length){const b={type:"sprite",options:{sprites:s}};n.push(b)}const h=e.customStickers?e.customStickers.map(b=>y(y({},b),{raster:y(y({},b.raster),{data:b.raster.data.replace(TU(b.raster.type),"")})})):[],m={assets:{stickers:h}};return{version:Qa.version,meta:r,image:o,operations:n,assetLibrary:m}}serialzeFrame(e){return{type:"frame",options:{identifier:e.identifier,alpha:e.opacity,tintColor:{rgba:e.color},size:this.mapSizeToRelativeUnscaledCropSize(e.width)}}}serializeFocus(e){const t=Math.sqrt(this.previewSize.width**2+this.previewSize.height**2);switch(e.identifier){case Ce.LINEAR:return{type:"focus",options:{type:"linear",options:{start:this.mapImagePointToRelativeCropPoint(e.linear.start),end:this.mapImagePointToRelativeCropPoint(e.linear.end),blurRadius:this.mapSizeToRelativeScaledCropSize(e.linear.blurRadius)}}};case Ce.RADIAL:return{type:"focus",options:{type:"radial",options:{start:this.mapImagePointToRelativeCropPoint(e.radial.center),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(e.radial.center,0,e.radial.radius)),blurRadius:this.mapSizeToRelativeScaledCropSize(e.radial.blurRadius),gradientRadius:.1}}};case Ce.MIRRORED:const{mirrored:i}=e;return{type:"focus",options:{type:"mirrored",options:{start:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(i.origin,i.rotation,t/2)),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(i.origin,i.rotation,-t/2)),size:this.mapSizeToRelativeScaledCropSize(e.mirrored.size),blurRadius:this.mapSizeToRelativeScaledCropSize(e.mirrored.blurRadius),gradientSize:.1}}};default:return{type:"focus",options:{type:"gaussian",options:{blurRadius:this.mapSizeToRelativeScaledCropSize(e.gaussian.blurRadius)}}}}}serializeSticker(e,t,i){return{type:"sticker",options:{position:this.mapImagePointToRelativeCropPoint(t.position),dimensions:{x:this.mapSizeToRelativeScaledCropSize(t.size.width),y:this.mapSizeToRelativeScaledCropSize(t.size.height)},rotation:t.rotation,flipVertically:(t.flipVertically||!1)!==(i.flipVertically||!1),flipHorizontally:(t.flipHorizontally||!1)!==(i.flipHorizontally||!1),identifier:e.identifier,alpha:e.opacity,tintColor:{rgba:e.tintColor},tintMode:e.tintMode}}}serializeText(e,t){return{type:"text",options:{position:this.mapImagePointToRelativeCropPoint(t.position),rotation:t.rotation,flipVertically:!1,flipHorizontally:!1,fontIdentifier:e.identifier,fontSize:this.mapSizeToRelativeScaledCropSize(e.fontSize),maxWidth:this.mapSizeToRelativeScaledCropSize(e.width),text:e.text,lineHeight:e.lineHeight,color:{rgba:e.textColor},backgroundColor:{rgba:e.backgroundColor},alignment:e.alignment}}}serializeTextDesign(e,t){return{type:"textdesign",options:{position:this.mapImagePointToRelativeCropPoint(t.position),rotation:t.rotation,flipVertically:!1,flipHorizontally:!1,identifier:e.identifier,inverted:e.isInverted,text:e.text,seed:e.seed,width:this.mapSizeToRelativeScaledCropSize(e.width),padding:this.mapSizeToRelativeScaledCropSize(e.padding),color:{rgba:e.color}}}}serializeTransform(e){const{start:t,end:i}=e,r={type:"transform",options:{start:t,end:i,rotation:e.rotation,meta:{identifier:e.identifier}}},o={type:"orientation",options:{rotation:e.outputRotation,flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}};return{transform:r,orientation:o}}}Qa.version="3.9.0";const fg=(e=Ut.PNG)=>`data:${e};base64,`;class Oi{constructor(e){this.spriteOrder=0;this.mapRelativeCropPointToImageSpace=e=>{const t=se.relativeToAbsolutePoint(e,this.cropSpace,!1);return se.pointFromSpaceToSpace(t,this.cropSpace,this.imageSpace,!1)};this.mapRelativeCropSizeToScaledImageSize=e=>e*Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.mapRelativeCropSizeToUnscaledImageSize=e=>e*Math.min(this.outputSize.height,this.outputSize.width);this.editor=e}static deserializeFilter(e){return{intensity:e.intensity,identifier:e.identifier}}static deserializeAdjustments(e){return y({},e)}static deserializeOverlay(e){return{identifier:e.identifier,opacity:e.intensity,blendMode:e.blendMode.replace(/([ _][a-z])/g,t=>t.toUpperCase().replace(" ","").replace("_",""))}}static initializeEmptyTransform(){return{outputRotation:0,flipHorizontally:!1,flipVertically:!1,start:{x:0,y:0},end:{x:1,y:1},rotation:0}}static deserialzeColor(e){return e&&e.rgba?e.rgba:[0,0,0,0]}static validateVersion(e){return Oi.version===e}static checkIfPlatformHTML(e){return e==="html5"}static deserializeStickers(e){return{identifier:e.identifier,opacity:e.alpha||0,tintMode:e.tintMode||"none",tintColor:Oi.deserialzeColor(e.tintColor)}}static checkIsSerialisationValid(e){if(typeof e!="string"&&Oi.validateVersion(e.version))return!0;if(typeof e=="string")throw new Error("Invalid input of type string, please provide an object");return!1}static deserializeImage(e){const t={};return e.image&&(t.image={width:e.image.width,height:e.image.height,data:e.image.data?e.image.data.replace(fg(),""):""},t.image.data=t.image.data?fg()+t.image.data:""),t}deserializeTransformation(e){const t={},i=e.operations.find(n=>n.type==="orientation"),r=e.operations.find(n=>n.type==="transform"),[o]=this.editor.engine.getRootContainers();return this.previewPosition=this.editor.transformToolStore.defaultCropMaskPosition,this.previewSize=this.editor.transformToolStore.maxCropMaskSize,this.imageSpace=o,t.transform=Oi.initializeEmptyTransform(),i!=null&&(t.transform.outputRotation=i.options.rotation,t.transform.flipHorizontally=i.options.flipHorizontally||!1,t.transform.flipVertically=i.options.flipVertically||!1),r&&(t.transform.start=r.options.start,t.transform.end=r.options.end,t.transform.rotation=r.options.rotation||0,t.transform.identifier=r.options.meta?r.options.meta.identifier:""),t}deserialize(e){const t={};(e.meta?!Oi.checkIfPlatformHTML(e.meta.platform):!1)&&console.warn("Read serialisation from another Platform");const i=this.editor.engineMediator.output.container.getResolution(),{size:r}=this.editor.engineMediator.image.container.getBounds();return this.outputSize=i,this.imageSize=r,this.cropSpace=this.editor.engine.getOutputContainer(),this.outputScale=this.cropSpace.getScale(),e.operations.forEach(o=>{switch(o.type){case"filter":t.filter=Oi.deserializeFilter(o.options);break;case"adjustments":t.adjustment=Oi.deserializeAdjustments(o.options);break;case"focus":t.focus=this.deserializeFocus(o.options);break;case"sprite":const{sprites:n}=o.options;n.forEach(s=>{switch(s.type){case"frame":t.frame=this.deserializeFrame(s.options);break;case"overlay":t.overlay=Oi.deserializeOverlay(s.options);break;case"brush":t.brush?t.brush.strokes.push(...this.deserializeBrush(s.options).strokes):t.brush=this.deserializeBrush(s.options);break;case"sticker":case"text":case"textdesign":t.sprite||(t.sprite={spriteIdList:[],sticker:{},text:{},textdesign:{},common:{}});const a=So();t.sprite.spriteIdList.push(a),t.sprite.common[a]={order:this.spriteOrder,position:this.mapRelativeCropPointToImageSpace(s.options.position),tool:w.STICKER,rotation:s.options.rotation||0,flipHorizontally:s.options.flipHorizontally,flipVertically:s.options.flipVertically},this.spriteOrder+=1,s.type===w.STICKER?(t.sprite.common[a].tool=w.STICKER,t.sprite.common[a].size={width:this.mapRelativeCropSizeToScaledImageSize(s.options.dimensions.x),height:this.mapRelativeCropSizeToScaledImageSize(s.options.dimensions.y)},t.sprite.sticker[a]=Oi.deserializeStickers(s.options)):s.type===w.TEXT?(t.sprite.common[a].tool=w.TEXT,t.sprite.text[a]=this.deserializeTexts(s.options)):s.type===w.TEXT_DESIGN&&(t.sprite.common[a].tool=w.TEXT_DESIGN,t.sprite.textdesign[a]=this.deserializeTextDesign(s.options));break;default:break}});break;default:break}}),e.assetLibrary&&(t.customStickers=e.assetLibrary&&e.assetLibrary.assets&&e.assetLibrary.assets.stickers||[],t.customStickers=t.customStickers.map(o=>{const n=o.raster.data.replace(fg(o.raster.type),"");return y(y({},o),{raster:y(y({},o.raster),{data:fg(o.raster.type)+n})})})),t}deserializeFrame(e){return{identifier:e.identifier,opacity:e.alpha,width:this.mapRelativeCropSizeToUnscaledImageSize(e.size),color:Oi.deserialzeColor(e.tintColor)}}deserializeFocus(e){switch(e.type){case"linear":return{identifier:"linear",linear:this.deserializeLinearFocus(e.options)};case"gaussian":return{identifier:"gaussian",gaussian:this.deserializeGaussianFocus(e.options)};case"radial":return{identifier:"radial",radial:this.deserializeRadialFocus(e.options)};case"mirrored":return{identifier:"mirrored",mirrored:this.deserializeMirroredFocus(e.options)}}return}deserializeRadialFocus(e){return{center:this.mapRelativeCropPointToImageSpace(e.start),radius:new E(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new E(this.mapRelativeCropPointToImageSpace(e.end))).magnitude,blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeLinearFocus(e){return{start:this.mapRelativeCropPointToImageSpace(e.start),end:this.mapRelativeCropPointToImageSpace(e.end),blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeGaussianFocus(e){return{blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeMirroredFocus(e){const t=new E(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new E(this.mapRelativeCropPointToImageSpace(e.end)));return{origin:new E(this.mapRelativeCropPointToImageSpace(e.start)).add(new E(this.mapRelativeCropPointToImageSpace(e.end))).divide(2),rotation:Math.atan2(t.y,t.x),size:this.mapRelativeCropSizeToScaledImageSize(e.size),blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeTexts(e){return{identifier:e.fontIdentifier,fontSize:this.mapRelativeCropSizeToScaledImageSize(e.fontSize),width:this.mapRelativeCropSizeToScaledImageSize(e.maxWidth),alignment:e.alignment,textColor:Oi.deserialzeColor(e.color),backgroundColor:Oi.deserialzeColor(e.backgroundColor),lineHeight:e.lineHeight,text:e.text}}deserializeTextDesign(e){return{identifier:e.identifier,width:this.mapRelativeCropSizeToScaledImageSize(e.width),padding:this.mapRelativeCropSizeToScaledImageSize(e.padding),color:Oi.deserialzeColor(e.color),seed:e.seed,text:e.text,isInverted:e.inverted}}deserializeBrush(e){return{strokes:e.paths.map(t=>({path:{controlPoints:t.points.map(this.mapRelativeCropPointToImageSpace)},brush:{id:"imgly_brush_radial",color:Oi.deserialzeColor(t.brush.color),size:t.brush.size,hardness:t.brush.hardness}}))}}}Oi.version="3.9.0";const Bc=v(Ve()),PD=/^data:image\/(.+?);base64,/,kU=e=>PD.test(e),EU=e=>e.match(/^data:([^;]+)/)[1],DU=e=>e.replace(PD,"");class $_{constructor(e){this.applySerialization=(e,t,i,r)=>Z(this,null,function*(){this.editor.resetToolStates();const o=this.editor.activeStore.tool===w.TRANSFORM;o||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.reset(),o||this.editor.transformToolStore.onLeave();const n=new t(this.editor),s="Unexpected error occured",a=t.deserializeImage(e);if(a.image&&a.image.data){const d=a.image.data;yield this.editor.setImage(d),this.editor.scale.defaultScale=1,this.editor.scale.resetOffset(),this.editor.transformToolStore.reset(),this.editor.activeStore.setImage(d),yield this.editor.engineMediator.image.addImageToContainer(),this.editor.engineMediator.output.applyNewImageTransform(),this.editor.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.editor.transformToolStore.setCropDefaults(),this.editor.historyStore.addInitialSnapshot(),this.editor.transformToolStore.saveTransforms()}const l=n.deserializeTransformation(e);if(l){yield this.applyStateOnUI(l);const d=n.deserialize(e);d?(yield this.applyStateOnUI(d),yield this.editor.render(),this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i()):r(s)}else r(s)});this.editor=e}serialize({image:e}={image:!1}){const t=this.editor.activeStore.tool===w.TRANSFORM;return this.editor.modalStore.showInfoModal("saving"),new Promise((i,r)=>{Promise.resolve().then(()=>v(Wy())).then(n=>Z(this,[n],function*({Serializer:o}){try{t&&this.editor.transformToolStore.onLeave(),yield this.editor.wait(),this.editor.transformToolStore.applyDefaultCrop(!1);const{originalImage:s}=this.editor.imageContainer.getData(),a=this.editor.engineMediator.output.container.getResolution(),l={width:s.width,height:s.height},d=new o(this.editor.transformToolStore.defaultCropMaskPosition,this.editor.transformToolStore.maxCropMaskSize,a,l,this.editor.engine.getRootContainers()[0],this.editor.engine.getOutputContainer()),c={[w.ADJUSTMENT]:Bc.toJS(this.editor.adjustmentsToolStore.state),[w.FILTER]:Bc.toJS(this.editor.filterToolStore.state),[w.FOCUS]:Bc.toJS(this.editor.focusToolStore.serializableState),[w.OVERLAY]:Bc.toJS(this.editor.overlayToolStore.state),[w.FRAME]:Bc.toJS(this.editor.frameToolStore.state),[w.BRUSH]:this.editor.brushToolStore.strokes||{strokes:[]}},{sprite:p,customStickers:h}=this.editor.spriteStore.serializableState;p.spriteIdList=p.spriteIdList.sort((_,g)=>{const S=p.common[_].order,x=p.common[g].order;return S-x}),c.sprite=p,c.customStickers=h,c.transform=this.editor.transformToolStore.serializableState;let m,b;if(e){const _=$_.getDataURL(s);b=EU(_),m=DU(_)}this.editor.modalStore.hideModal(),i(d.serialise(c,m,b)),t&&this.editor.transformToolStore.onEnter()}catch(s){this.editor.modalStore.hideModal(),r(s)}}))})}deserialize(e){return this.editor.modalStore.showInfoModal("loading"),new Promise((t,i)=>{try{Promise.resolve().then(()=>v(Wy())).then(({Deserializer:r})=>{r.checkIsSerialisationValid(e)?this.applySerialization(e,r,t,i):(this.editor.modalStore.hideModal(),this.editor.modalStore.showActionModal({type:ot.WARNING,identifier:"unsupportedSerializationVersion",handleConfirm:()=>this.applySerialization(e,r,t,i)}))})}catch(r){this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i(r)}})}static getDataURL(e){if(e instanceof HTMLCanvasElement)return e.toDataURL(Ut.PNG);const{src:t}=e;if(kU(t))return t;const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const r=i.getContext("2d");return r.drawImage(e,0,0),i.toDataURL(Ut.PNG)}applyStateOnUI(e){return Z(this,null,function*(){const t=this.editor.activeStore.tool===w.TRANSFORM;try{e.transform&&(t||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e.transform,!0),yield this.editor.wait(),t||(this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),yield this.editor.wait(),this.editor.transformToolStore.onLeave())),e.filter&&(yield this.editor.filterToolStore.updateStateFromSerialization(e.filter)),e.adjustment&&this.editor.adjustmentsToolStore.updateStateFromSerialization(e.adjustment),e.focus&&(yield this.editor.focusToolStore.updateStateFromSerialization(e.focus)),e.overlay&&(yield this.editor.overlayToolStore.updateStateFromSerialization(e.overlay)),e.sprite&&(e.sprite.spriteIdList=e.sprite.spriteIdList.sort((i,r)=>{const o=e.sprite.common[i].order,n=e.sprite.common[r].order;return o-n}),yield this.editor.spriteStore.updateStateFromSerialization(e.sprite,e.customStickers)),e.brush&&this.editor.brushToolStore.updateStateFromHistory(e.brush),e.frame&&(yield this.editor.frameToolStore.updateStateFromSerialization(e.frame)),this.editor.outputContainer.updateChildrenContainers()}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:ot.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}}const na={identifier:"identity",opacity:1,width:0,color:gr.white};const sa=v(Ve()),IU=new ra(0,1);class aa{constructor(e){this.engineMediator=e,this.state=na}changeIdentifier(e){this.state.identifier=e}changeOpacity(e){const t=IU.clamp(e);this.state.opacity=t}changeWidth(e){this.state.width=e}changeColor(e){this.state.color=e}reset(){this.indexInContainer===-1&&(this.state.identifier=na.identifier,this.state.opacity=na.opacity,this.state.width=na.width,this.state.color=na.color,this.removeIndex())}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}removeFrameEffect(){this.effect&&(this.engine.removeEffect(this.effect),this.effect=void 0)}setEffectProperties(e){return this.effect?(this.removeIndex(),this.effect.setProperties(e),this.effect.getProperties()):null}setFrameEffect({identifier:e,width:t,opacity:i,color:r}){const o=y({},this.state);this.changeIdentifier(e),this.changeWidth(t),this.changeOpacity(i),this.changeColor(r),this.removeFrameEffect();const n=this.engineMediator.orderHelper.addSprite(e);return new Promise((s,a)=>{this.engine.addFrameFromAssets(e,this.engineMediator.image.container,n).then(l=>{this.effect=l,this.effect.setProperties({tintColor:r,opacity:i,width:t}),s()}).catch(l=>{this.changeIdentifier(o.identifier),this.changeOpacity(o.opacity),this.changeWidth(o.width),this.changeColor(o.color),o.identifier==="identity"&&this.removeIndex(),a(l)})})}removeIndex(){this.engineMediator.orderHelper.removeSprite(this.state.identifier)}}u([sa.observable],aa.prototype,"state",2),u([sa.action],aa.prototype,"changeIdentifier",1),u([sa.action],aa.prototype,"changeOpacity",1),u([sa.action],aa.prototype,"changeWidth",1),u([sa.action],aa.prototype,"changeColor",1),u([sa.action],aa.prototype,"reset",1);const Ot=v(Ve());class Gt{constructor(e){this.colorList=It.defaultColors;this.changeOpacity=e=>{const t=this.frameStore.setEffectProperties({opacity:e});t&&(this.frameStore.changeOpacity(t.opacity),this.editor.render())};this.changeWidth=e=>{const t=this.frameStore.setEffectProperties({width:e});t&&(this.frameStore.changeWidth(t.width),this.editor.render())};this.changeColor=e=>{const t=this.frameStore.setEffectProperties({tintColor:e});t&&(this.frameStore.changeColor(t.tintColor),this.editor.render())};this.colorSnapshot=()=>{this.addSnapshot(be.EDIT,this.locale.controls.selectColor)};this.reset=()=>{this.pureReset(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.frameStore=new aa(this.editor.engineMediator);const t=this.editor.assetProvider.getAssets("frame"),{config:i}=this;this.entityManager=new Ht([{identifier:"",name:"",items:t}],y(y({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("frame")})),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ao(Ot.toJS(this.config.colors)))}selectFrame(e){return Z(this,null,function*(){if(e!==this.identifier){const t=.1*this.editor.shortestOutputSide;yield this.frameStore.setFrameEffect({identifier:e,width:t,opacity:1,color:na.color}),this.editor.render(),this.addSnapshot(be.ADD,w.FRAME)}})}toolSnapshot(e){this.addSnapshot(be.EDIT,e)}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}pureReset(){this.frameStore.removeFrameEffect(),this.frameStore.reset()}updateStateFromHistory(e){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.frameStore.setFrameEffect(e)}updateStateFromSerialization(e){return Z(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.frameStore.setFrameEffect(e):new Promise((i,r)=>{r(new Error("Frame Asset doesn't exist"))})})}get state(){return this.frameStore.state}get identifier(){return this.state.identifier}get color(){return this.state.color}get size(){return this.state.width}get tintable(){const e=this.entityManager.items.find(t=>t.identifier===this.identifier);return e&&e.tintable||!1}get opacity(){return this.state.opacity}get minSize(){return this.editor.shortestOutputSide*.05}get maxSize(){return this.editor.shortestOutputSide*.3}get config(){return this.editor.configStore.config[w.FRAME]}get locale(){return this.editor.configStore.locale[w.FRAME]}get localeColor(){return this.editor.configStore.locale.common.color}get entities(){return this.entityManager.getEntities()}get isOptionSelected(){return this.identifier!=="identity"}}u([Ot.action],Gt.prototype,"selectFrame",1),u([Ot.action],Gt.prototype,"changeOpacity",2),u([Ot.action],Gt.prototype,"changeWidth",2),u([Ot.action],Gt.prototype,"changeColor",2),u([Ot.action],Gt.prototype,"pureReset",1),u([Ot.action],Gt.prototype,"reset",2),u([Ot.action],Gt.prototype,"updateStateFromHistory",1),u([Ot.action],Gt.prototype,"updateStateFromSerialization",1),u([Ot.computed],Gt.prototype,"state",1),u([Ot.computed],Gt.prototype,"identifier",1),u([Ot.computed],Gt.prototype,"color",1),u([Ot.computed],Gt.prototype,"size",1),u([Ot.computed],Gt.prototype,"tintable",1),u([Ot.computed],Gt.prototype,"opacity",1),u([Ot.computed],Gt.prototype,"minSize",1),u([Ot.computed],Gt.prototype,"maxSize",1),u([Ot.computed],Gt.prototype,"config",1),u([Ot.computed],Gt.prototype,"locale",1),u([Ot.computed],Gt.prototype,"localeColor",1),u([Ot.computed],Gt.prototype,"entities",1),u([Ot.computed],Gt.prototype,"isOptionSelected",1);const Zt=v(Ve()),OU={options:[],query:""};class Bi{constructor(e){this.initProvider=e=>{e&&(this.libraryProvider=new e)};this.addOptionsToSelectedCategory=(e,t,i)=>{const r=e.findIndex(o=>o.identifier===t);return r!==-1?[...e.slice(0,r+1),...i,...e.slice(r+1)]:e};this.configStore=e.configStore,this.state=Zt.observable(OU),this.selectedCategory=""}saveScrollbar(e){this.scrollbar=e}recalculateScrollContainer(){setTimeout(()=>this.scrollbar.recalculate(),0)}fetchImages(e=""){return Z(this,null,function*(){if(this.libraryProvider){const t=[this.libraryProvider.getCategories(),this.libraryProvider.searchImages(e)],[i,r]=yield Promise.all(t),o=i.map(n=>{const s=r.filter(a=>a.category===n.name);return{identifier:n.name,name:n.name,coverImage:n.coverImageUrl,options:s.map((a,l)=>({name:a.title||`image${l}`,identifier:`${n.name}-${a.title||`image${l}`}`,coverImage:a.thumbUrl,rawUrl:a.rawUrl}))}}).filter(n=>n.options.length);Zt.runInAction(()=>{this.state.query=e,this.state.options=o})}})}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory!==e?e:""}get selectedCategoryIdentifier(){return this.selectedCategory}get images(){return this.state.options.map(e=>e.options).reduce((e,t)=>[...e,...t],[])}get query(){return this.state.query}get config(){return this.configStore.config[w.LIBRARY]}get locale(){return this.configStore.locale[w.LIBRARY]}get categories(){return this.state.options.map((e,t)=>({type:pe.LARGE,identifier:e.name,name:e.name,coverImage:e.coverImage,delay:t*.08,items:e.options.map((i,r)=>y({type:pe.MEDIUM,delay:r*.08},i))}))}get options(){const{selectedCategory:e}=this,t=this.state.options.findIndex(i=>i.name===e);return t!==-1?this.state.options[t].options.map((i,r)=>y({type:pe.MEDIUM,delay:r*.08},i)):[]}get categoriesAndOptions(){return this.addOptionsToSelectedCategory(this.categories,this.selectedCategory,this.options)}getRawUrl(e){const t=this.images.findIndex(i=>i.identifier===e);return t!==-1?this.images[t].rawUrl:e}}u([Zt.observable],Bi.prototype,"selectedCategory",2),u([Zt.action],Bi.prototype,"saveScrollbar",1),u([Zt.action],Bi.prototype,"recalculateScrollContainer",1),u([Zt.action],Bi.prototype,"initProvider",2),u([Zt.action],Bi.prototype,"fetchImages",1),u([Zt.action],Bi.prototype,"toggleCategorySelection",1),u([Zt.computed],Bi.prototype,"selectedCategoryIdentifier",1),u([Zt.computed],Bi.prototype,"images",1),u([Zt.computed],Bi.prototype,"query",1),u([Zt.computed],Bi.prototype,"config",1),u([Zt.computed],Bi.prototype,"locale",1),u([Zt.computed],Bi.prototype,"categories",1),u([Zt.computed],Bi.prototype,"options",1),u([Zt.computed],Bi.prototype,"categoriesAndOptions",1);const wp={identifier:"identity",opacity:1,blendMode:ye.LIGHTEN};const la=v(Ve()),RU=new ra(0,1);class da{constructor(e,t){this.correctOverlayFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();this.effect&&(this.effect.setFlipHorizontally(e),this.effect.setFlipVertically(t))};this.engineMediator=e,this.editor=t,this.state=wp}changeIdentifier(e){this.state.identifier=e}changeOpacity(e){const t=RU.clamp(e);this.state.opacity=t}changeBlendMode(e){this.state.blendMode=e}reset(){this.indexInContainer===-1&&(this.state.identifier=wp.identifier,this.state.opacity=wp.opacity,this.state.blendMode=wp.blendMode,this.removeIndex())}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}removeOverlayEffect(){this.effect&&(this.removeIndex(),this.engineMediator.engine.removeEffect(this.effect),this.effect=void 0)}setEffectProperties(e){return this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null}setOverlayEffect({identifier:e,blendMode:t,opacity:i}){const r=y({},this.state);this.changeIdentifier(e),this.changeOpacity(i),this.changeBlendMode(t),this.removeOverlayEffect();const o=this.engineMediator.orderHelper.addIndex(w.OVERLAY);return new Promise((n,s)=>{this.engineMediator.engine.addOverlayFromAssets(e,this.engineMediator.image.container,o).then(a=>{this.effect=a,this.effect.setProperties({blendMode:t,opacity:i}),this.correctOverlayFlip(),n()}).catch(a=>{this.changeIdentifier(r.identifier),this.changeOpacity(r.opacity),this.changeBlendMode(r.blendMode),r.identifier==="identity"&&this.removeIndex(),s(a)})})}removeIndex(){this.engineMediator.orderHelper.removeIndex(w.OVERLAY)}}u([la.observable],da.prototype,"state",2),u([la.action],da.prototype,"changeIdentifier",1),u([la.action],da.prototype,"changeOpacity",1),u([la.action],da.prototype,"changeBlendMode",1),u([la.action],da.prototype,"reset",1),u([la.action],da.prototype,"correctOverlayFlip",2);const ni=v(Ve());class si{constructor(e){this.changeOpacity=e=>{const t=this.overlayStore.setEffectProperties({opacity:e});t&&(this.overlayStore.changeOpacity(t.opacity),this.editor.render())};this.reset=()=>{this.pureReset(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.correctOverlayFlip=()=>{this.overlayStore.correctOverlayFlip()};this.editor=e,this.overlayStore=new da(this.editor.engineMediator,e);const t=this.editor.assetProvider.getAssets("overlay"),{config:i}=this;this.entityManager=new Ht([{identifier:"",name:"",items:t}],y(y({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("overlay")}))}selectOverlay(e){return Z(this,null,function*(){if(e!==this.identifier){const t=this.defaultBlendModeForIdentifier(e);yield this.overlayStore.setOverlayEffect({identifier:e,opacity:1,blendMode:t}),this.addSnapshot(be.ADD,w.OVERLAY),this.editor.render()}})}toolSnapshot(){this.addSnapshot(be.EDIT,this.locale.controls.sliderOpacity)}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}changeBlendMode(e){const t=this.overlayStore.setEffectProperties({blendMode:e});t&&(this.overlayStore.changeBlendMode(t.blendMode),this.addSnapshot(be.EDIT,this.locale.controls.carouselBlendMode),this.editor.render())}pureReset(){this.overlayStore.removeOverlayEffect(),this.overlayStore.reset()}updateStateFromSerialization(e){return Z(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.overlayStore.setOverlayEffect(e):new Promise((i,r)=>{r(new Error(`Overlay Asset ${e.identifier} doesn't exist`))})})}updateStateFromHistory(e){return Z(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.overlayStore.setOverlayEffect(e)})}get state(){return this.overlayStore.state}get identifier(){return this.overlayStore.state.identifier}get opacity(){return this.overlayStore.state.opacity}get blendMode(){return this.overlayStore.state.blendMode}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[w.OVERLAY]}get locale(){return this.editor.configStore.locale[w.OVERLAY]}get entities(){return this.entityManager.getEntities()}get allBlendModes(){const e=this.locale.controls;return Object.keys(ye).map(t=>{const i=ye[t],r=`blendMode${i.charAt(0).toUpperCase()}${i.slice(1)}`;return{identifier:i,value:e[r]}})}defaultBlendModeForIdentifier(e){const t=this.entityManager.items.findIndex(i=>i.identifier===e);return t!==-1?this.entityManager.items[t].defaultBlendMode:ye.LIGHTEN}}u([ni.action],si.prototype,"selectOverlay",1),u([ni.action],si.prototype,"changeOpacity",2),u([ni.action],si.prototype,"changeBlendMode",1),u([ni.action],si.prototype,"pureReset",1),u([ni.action],si.prototype,"reset",2),u([ni.action],si.prototype,"updateStateFromSerialization",1),u([ni.action],si.prototype,"updateStateFromHistory",1),u([ni.action],si.prototype,"correctOverlayFlip",2),u([ni.computed],si.prototype,"state",1),u([ni.computed],si.prototype,"identifier",1),u([ni.computed],si.prototype,"opacity",1),u([ni.computed],si.prototype,"blendMode",1),u([ni.computed],si.prototype,"isOptionSelected",1),u([ni.computed],si.prototype,"config",1),u([ni.computed],si.prototype,"locale",1),u([ni.computed],si.prototype,"entities",1),u([ni.computed],si.prototype,"allBlendModes",1);const AU=e=>{const t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let n=0;n<t.length;n+=1)o[n]=t.charCodeAt(n);return new Blob([r],{type:i})};var q_=AU;const gg={size:0,color:gr.white,hardness:0,maximumSize:.125,minimumSize:0,maximumHardness:1,minimumHardness:0};const pt=v(Ve());class Mt{constructor(e){this.colorList=It.defaultColors;this.dirty=pt.observable.box(!1);this.id="";this.containerId=()=>this.id;this.initSize=()=>{const{minimumSize:e,maximumSize:t}=this.state,{size:i}=this;i===0&&this.changeSize(Jy(this.config,"defaultSize",[e,t]))};this.changeColor=e=>{this.state.color=e};this.changeSize=e=>{this.state.size=e};this.changeRelativeSize=e=>{const{maximumSize:t,minimumSize:i}=this.state;this.state.size=(t-i)*e/100+i};this.changeHardness=e=>{this.state.hardness=e};this.reset=()=>{this.pureReset(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.state=y(y({},gg),{hardness:Jy(this.config,"defaultHardness",[gg.minimumHardness,gg.maximumHardness])}),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ao(pt.toJS(this.config.colors)))}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}clickableCanvas(e){this.editor.clickableCanvas(e)}beginStroke(e=[]){if(!this.drawingContainer){const t=this.editor.orderHelper.addSprite(w.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e},this.editor.imageContainer,t)}this.id=this.drawingContainer.getID(),this.drawingContainer.beginStroke({id:"imgly_brush_radial",color:pt.toJS(this.state.color),size:this.state.size,hardness:this.state.hardness})}strokePosition(e){if(this.drawingContainer){const t=this.editor.previewToWorld(e,!1);this.drawingContainer.addPointToCurrentStroke(t),this.editor.render()}}endStroke(){this.drawingContainer&&(this.drawingContainer.endStroke(),this.editor.render(),this.strokes=this.drawingContainer.getData(),this.addSnapshot(be.EDIT,this.locale.history.brushStroke),this.dirty.set(!0))}updateStateFromHistory(e){if(e=e||{strokes:[]},this.drawingContainer){if(this.strokes&&this.strokes.strokes.length===e.strokes.length)return;this.strokes=e,this.drawingContainer.setData(this.strokes),e.strokes.length!==0&&this.dirty.set(!0)}else{const t=this.editor.orderHelper.addSprite(w.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e.strokes},this.editor.imageContainer,t),this.strokes=this.drawingContainer.getData()}this.id=this.drawingContainer.getID()}pureReset(){this.dirty.set(!1),this.strokes={strokes:[]},this.drawingContainer&&(this.editor.engine.removeContainer(this.drawingContainer),this.drawingContainer=void 0)}get config(){return this.editor.configStore.config[w.BRUSH]}get locale(){return this.editor.configStore.locale[w.BRUSH]}get localeColor(){return this.editor.configStore.locale.common.color}get color(){return this.state.color}get size(){return this.state.size}get relativeSize(){const{size:e,maximumSize:t,minimumSize:i}=this.state;return(e-i)*100/(t-i)}get sizeOnScreenSpace(){const e=this.editor.engineMediator.engine.getSmallerOutputSide();return this.editor.worldToPreview(this.state.size*e)}get hardness(){return this.state.hardness}get isDirty(){return this.dirty.get()}}u([pt.observable],Mt.prototype,"state",2),u([pt.observable],Mt.prototype,"dirty",2),u([pt.action],Mt.prototype,"initSize",2),u([pt.action],Mt.prototype,"changeColor",2),u([pt.action],Mt.prototype,"changeSize",2),u([pt.action],Mt.prototype,"changeRelativeSize",2),u([pt.action],Mt.prototype,"changeHardness",2),u([pt.action],Mt.prototype,"clickableCanvas",1),u([pt.action],Mt.prototype,"beginStroke",1),u([pt.action],Mt.prototype,"strokePosition",1),u([pt.action],Mt.prototype,"endStroke",1),u([pt.action],Mt.prototype,"updateStateFromHistory",1),u([pt.action],Mt.prototype,"reset",2),u([pt.computed],Mt.prototype,"config",1),u([pt.computed],Mt.prototype,"locale",1),u([pt.computed],Mt.prototype,"localeColor",1),u([pt.computed],Mt.prototype,"color",1),u([pt.computed],Mt.prototype,"size",1),u([pt.computed],Mt.prototype,"relativeSize",1),u([pt.computed],Mt.prototype,"sizeOnScreenSpace",1),u([pt.computed],Mt.prototype,"hardness",1),u([pt.computed],Mt.prototype,"isDirty",1);const Bo=v(Ve());var Mo;(function(e){e.LEADING="leading",e.CENTER="center",e.TRAILING="trailing"})(Mo||(Mo={}));const FU={horizontalGuides:[],verticalGuides:[],rotationGuides:[]};class Jn{constructor(e){this.previewTopLeftPosition={x:0,y:0};this.getGuideValue=(e,t)=>{const{height:i,width:r}=this.editor.getPreviewSize(),{snapToLeft:o,snapToRight:n,snapToTop:s,snapToBottom:a}=this.configStore.config.snapping.position,l=Math.min(i,r);let d=0;return t==="bottom"?d=Math.round(i-l*a):t==="top"?d=Math.round(l*s):t==="right"?d=Math.round(r-l*n):t==="left"?d=Math.round(l*o):e==="vertical"&&t==="center"?d=Math.round(r/2):e==="horizontal"&&t==="center"&&(d=Math.round(i/2)),d};this.getVerticalGuidesFromConfig=()=>{const{snapToVerticalCenter:e,snapToLeft:t,snapToRight:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("vertical","center"),edge:Mo.CENTER,isVisible:!1,direction:"vertical"}),t&&r.push({value:this.getGuideValue("vertical","left"),edge:Mo.LEADING,isVisible:!1,direction:"vertical"}),i&&r.push({value:this.getGuideValue("vertical","right"),edge:Mo.TRAILING,isVisible:!1,direction:"vertical"}),r};this.getHorizontalGuidesFromConfig=()=>{const{snapToHorizontalCenter:e,snapToTop:t,snapToBottom:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("horizontal","center"),edge:Mo.CENTER,isVisible:!1,direction:"horizontal"}),t&&r.push({value:this.getGuideValue("horizontal","top"),edge:Mo.LEADING,isVisible:!1,direction:"horizontal"}),i&&r.push({value:this.getGuideValue("horizontal","bottom"),edge:Mo.TRAILING,isVisible:!1,direction:"horizontal"}),r};this.getRotationGuidesFromConfig=()=>{const{angles:e}=this.configStore.config.snapping.rotation,t=[];e.forEach(r=>{t.push(r),t.push(r+360),t.push(r-360)});const i=t.filter((r,o)=>t.indexOf(r)===o);return i.map(r=>({value:r*Math.PI/180,edge:Mo.CENTER,isVisible:!1,position:{x:0,y:0}}))};this.getSpriteDimensions=({leftTop:e,leftBottom:t,rightTop:i,rightBottom:r})=>{const o=Math.min(e.y,i.y,t.y,r.y),n=Math.max(e.y,i.y,t.y,r.y),s=Math.min(e.x,i.x,t.x,r.x),a=Math.max(e.x,i.x,t.x,r.x);return{height:Math.round(n-o),width:Math.round(a-s)}};this.mapRange=({value:e,fromMin:t,fromLength:i,toMin:r,toLength:o})=>(e-t)*o/i+r;this.updateGuides=()=>{this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig()};this.mapToSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e-i;for(let o=0;o<t.length-1;o+=1){const n=t[o],s=t[o+1];let a=n+i,l=s-i,d=0;r&&(d=o*i*2,a+=d,l+=d+i*2);const c=1e-5;if(n<=e&&e<=s)return e<=n+c?n+d:e>=s-c?s+d+(r?i*2:0):this.mapRange({value:e,fromMin:n,fromLength:s-n,toMin:a,toLength:l-a})}return r?e+(t.length-1)*i*2+i:e};this.mapFromSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e>=t[0]-i?t[0]:e+i;let o=e;for(let s=0;s<t.length-1;s+=1){const a=t[s],l=t[s+1],d=a+i;let c=l-i,p=l;if(r&&(c+=i*2,p+=i*2,o=e-s*i*2),a<=o&&o<=p)return d<=o&&o<=c?this.mapRange({value:o,fromMin:d,fromLength:c-d,toMin:a,toLength:l-a}):o<d?a:l}o-=i*3;const n=t[t.length-1];return o<=n?n:o};this.centerSnapValue=(e,t)=>{const i=t*.5,{value:r,edge:o}=e;let n=r;return o===Mo.LEADING?n+=i:o===Mo.TRAILING&&(n-=i),n};this.mapSnappingGuidesToCenter=(e,t)=>{const i=[];return e.forEach(r=>{i.push(this.centerSnapValue(r,t))}),i};this.calcSnapThresholdInRadians=(e,t)=>e===0?0:t/e;this.calculatePreviewTopLeftPosition=()=>{const e=this.editor.engineMediator.preview.container.getPosition(),t=this.editor.getPreviewSize(),i=It.devicePixelRatio;this.previewTopLeftPosition={x:e.x/i-t.width/2,y:e.y/i-t.height/2}};this.snapToRotation=(e,t,i)=>{const{rotationGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.rotation,{x:s,y:a}=this.previewTopLeftPosition,{width:l}=this.editor.getPreviewSize();let d=(e+Math.PI*2)%(Math.PI*2);if(o){const c=new E(t).magnitude,p=r.map(b=>b.value).sort((b,_)=>b-_),h=this.calcSnapThresholdInRadians(c,n);if(!this.rotationOffset){const b=this.mapToSnapSystem(e,p,h,!1);this.rotationOffset=b-d}d=this.mapFromSnapSystem(d+this.rotationOffset,p,h,!1);const m={x:i.position.x-s-l,y:i.position.y-a};return r.forEach(b=>{b.isVisible=b.value===d,b.position=m}),d}return e};this.snapToPosition=(e,t)=>{const{horizontalGuides:i,verticalGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.position,s=new E(this.previewTopLeftPosition),{height:a,width:l}=this.getSpriteDimensions(t),{x:d,y:c}=new E(e).subtract(s);if(o){const p=this.mapSnappingGuidesToCenter(i,a).sort((_,g)=>_-g),h=this.mapSnappingGuidesToCenter(r,l).sort((_,g)=>_-g);if(!this.positionOffset){const _=this.mapToSnapSystem(d,h,n,!0),g=this.mapToSnapSystem(c,p,n,!0);this.positionOffset=new E(_,g).subtract(new E(d,c))}let m=this.mapFromSnapSystem(d+this.positionOffset.x,h,n,!0),b=this.mapFromSnapSystem(c+this.positionOffset.y,p,n,!0);return m=Math.round(m),b=Math.round(b),i.forEach(_=>{const g=Math.round(this.centerSnapValue(_,a));_.isVisible=g===b}),r.forEach(_=>{const g=Math.round(this.centerSnapValue(_,l));_.isVisible=g===m}),new E(m,b).add(s)}return{x:d,y:c}};this.editor=e,this.configStore=e.configStore,this.state=Bo.observable(FU),this.rotationOffset=null,this.positionOffset=null,this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig(),this.state.rotationGuides=this.getRotationGuidesFromConfig()}hidePositionGuides(){this.positionOffset=null,this.state.verticalGuides=this.state.verticalGuides.map(e=>y(y({},e),{isVisible:!1})),this.state.horizontalGuides=this.state.horizontalGuides.map(e=>y(y({},e),{isVisible:!1}))}hideRotationGuides(){this.rotationOffset=null,this.state.rotationGuides=this.state.rotationGuides.map(e=>y(y({},e),{isVisible:!1}))}get positionGuides(){const{verticalGuides:e,horizontalGuides:t}=this.state;return[...e,...t]}get rotationGuides(){return this.state.rotationGuides}}u([Bo.observable],Jn.prototype,"state",2),u([Bo.action],Jn.prototype,"snapToRotation",2),u([Bo.action],Jn.prototype,"snapToPosition",2),u([Bo.action],Jn.prototype,"hidePositionGuides",1),u([Bo.action],Jn.prototype,"hideRotationGuides",1),u([Bo.computed],Jn.prototype,"positionGuides",1),u([Bo.computed],Jn.prototype,"rotationGuides",1);function X_(e,t=!1){return new Promise((i,r)=>{const o=new Image;o.addEventListener("load",()=>{let n=null;if(t){const s=document.createElement("canvas"),a=s.getContext("2d"),l=150,d=l*o.height/o.width;s.width=l,s.height=d,a.drawImage(o,0,0,l,d),n=s.toDataURL()}i({image:e,smallImage:n})}),o.addEventListener("error",()=>{r()}),o.src=e})}function BD(e,t=!1){return new Promise((i,r)=>{const o=new FileReader;o.onload=n=>Z(this,null,function*(){X_(n.target.result,t).then(s=>{i(y(y({},s),{name:e.name||"",type:e.type,id:So()}))}).catch(s=>{r(s)})}),o.readAsDataURL(e)})}const PU="white",no={identifier:"identity",opacity:1,tintColor:gr[PU],tintMode:"none",resizeMode:"keepAspect"},Y_={};const He=v(Ve()),MD="identity",J_="imgly_sticker_custom";class Ye{constructor(e){this.state=He.observable.map(Y_);this.customStickerIds=[];this.colorList=It.defaultColors;this.changeOpacity=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{opacity:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.opacity=i.opacity,this.state.set(this.id,t)}}};this.changeTintColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){const{tintMode:i}=this.entityManager.items.find(o=>o.identifier===this.identifier);this.editor.spriteStore.setContainerProperties(this.id,{tintColor:e,tintMode:i});const r=this.editor.spriteStore.getContainerProperties(this.id);t.tintColor=r.tintColor,t.tintMode=r.tintMode||no.tintMode,this.state.set(this.id,t)}}};this.tintColorSnapshot=()=>{this.addSnapshot(be.EDIT,this.locale.history.color)};this.editor=e,this.selectedCategory=MD;const{config:t}=this,i=this.editor.assetProvider.getAssets("sticker");this.entityManager=new Ht(i,y(y({},t),{categoryKey:"thumbnailURI",categoryDynamicKey:"thumbnail",itemKey:"stickerURI",itemDynamicKey:"sticker",locale:y(y({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("sticker")})),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ao(He.toJS(this.config.colors)))}selectLast(){this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))}doesStickerAssetExist(e){return this.entityManager.items.findIndex(t=>t.identifier===e)!==-1}add(e){const t=this.entityManager.items.find(o=>o.identifier===e),i=t?t.tintMode:no.tintMode,r=t?t.resizeMode:no.resizeMode;this.editor.spriteStore.addSticker({state:{identifier:e,tintMode:i,tintColor:no.tintColor,opacity:no.opacity,resizeMode:r}})}duplicate(){if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id),t=this.editor.spriteStore.getDuplicateContainerFlip(this.id),{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData();this.editor.spriteStore.addSticker({state:{identifier:this.identifier,tintColor:He.toJS(this.tintColor),tintMode:this.tintMode,resizeMode:this.resizeMode,opacity:this.opacity,flipHorizontally:i!==t.flipHorizontally,flipVertically:r!==t.flipVertically},transform:e})}}bringToFront(){this.id&&this.editor.spriteStore.bringToFront(this.id)}flipHorizontally(){this.id&&this.editor.spriteStore.flipHorizontally(this.id)}delete(){if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}}updateStateFromHistory(e,t){this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)}setState(e,t){const i=this.state.get(e);i?("opacity"in t&&(i.opacity=t.opacity),t.tintColor&&(i.tintColor=t.tintColor),t.tintMode&&(i.tintMode=t.tintMode),t.resizeMode&&(i.resizeMode=t.resizeMode),this.state.set(e,i)):this.state.set(e,{identifier:t.identifier,opacity:t.opacity,tintMode:t.tintMode,resizeMode:t.resizeMode,tintColor:t.tintColor?t.tintColor:no.tintColor})}addFiles(e){return Z(this,null,function*(){if(this.editor.modalStore.showInfoModal("loading"),e.length){let t=0;const i=[];for(t=0;t<e.length;t+=1)i.push(BD(e[t],!0));try{const r=yield Promise.all(i);this.addCustomStickerAsset(r)}catch(r){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}}})}addCustomStickerAsset(e){return Z(this,null,function*(){const t=e.map(n=>({sticker:n.image,thumbnailURI:n.smallImage,name:n.name,tintMode:this.customStickerTintMode,resizeMode:"keepAspect",identifier:n.id,type:n.type}));this.customStickerIds=this.customStickerIds.concat(t.map(n=>({identifier:n.identifier,type:n.type})));const i=this.locale.categories[J_];this.editor.assetProvider.addCustomStickerAsset(t,J_,i);const r=this.editor.assetProvider.getAssets("sticker"),{config:o}=this;this.entityManager=new Ht(r,y(y({},o),{categoryKey:"thumbnailURI",categoryDynamicKey:"thumbnail",itemDynamicKey:"thumbnailURI",itemKey:"stickerURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("sticker")})),this.selectedCategory=no.identifier,yield this.editor.wait(),this.selectedCategory=J_,this.editor.modalStore.hideModal()})}toolSnapshot(){this.addSnapshot(be.EDIT,this.locale.history.opacity)}addSnapshot(e,t){this.currentSticker&&this.editor.spriteStore.addSnapshot(e,t)}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?MD:e}pureReset(){this.state=He.observable.map(Y_)}get isStickerSelected(){return this.editor.spriteStore.isSpriteSticker}get isCustomStickerEnabled(){return this.config.enableCustomUpload}get customStickerTintMode(){return this.config.customStickerTintMode}get currentSticker(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e}return}get identifier(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e.identifier}return"none"}get id(){return this.isStickerSelected?this.editor.spriteStore.id:void 0}get opacity(){return this.currentSticker?this.currentSticker.opacity:no.opacity}get tintMode(){return this.currentSticker?this.currentSticker.tintMode:no.tintMode}get resizeMode(){return this.currentSticker?this.currentSticker.resizeMode:no.resizeMode}get tintable(){return this.currentSticker?this.currentSticker.tintMode==="solid"||this.currentSticker.tintMode==="colorized":!1}get tintColor(){return this.currentSticker?this.currentSticker.tintColor:no.tintColor}get config(){return this.editor.configStore.config[w.STICKER]}get locale(){return this.editor.configStore.locale[w.STICKER]}get localeColor(){return this.editor.configStore.locale.common.color}get selectedCategoryIdentifier(){return this.selectedCategory}get entities(){return this.entityManager.getEntities(this.selectedCategoryIdentifier)}get categories(){return this.entityManager.getCategories(this.selectedCategoryIdentifier)}}u([He.observable],Ye.prototype,"selectedCategory",2),u([He.action],Ye.prototype,"selectLast",1),u([He.action],Ye.prototype,"add",1),u([He.action],Ye.prototype,"duplicate",1),u([He.action],Ye.prototype,"bringToFront",1),u([He.action],Ye.prototype,"flipHorizontally",1),u([He.action],Ye.prototype,"delete",1),u([He.action],Ye.prototype,"updateStateFromHistory",1),u([He.action],Ye.prototype,"setState",1),u([He.action],Ye.prototype,"changeOpacity",2),u([He.action],Ye.prototype,"changeTintColor",2),u([He.action],Ye.prototype,"addFiles",1),u([He.action],Ye.prototype,"addCustomStickerAsset",1),u([He.action],Ye.prototype,"toggleCategorySelection",1),u([He.action],Ye.prototype,"pureReset",1),u([He.computed],Ye.prototype,"isStickerSelected",1),u([He.computed],Ye.prototype,"isCustomStickerEnabled",1),u([He.computed],Ye.prototype,"customStickerTintMode",1),u([He.computed],Ye.prototype,"currentSticker",1),u([He.computed],Ye.prototype,"identifier",1),u([He.computed],Ye.prototype,"id",1),u([He.computed],Ye.prototype,"opacity",1),u([He.computed],Ye.prototype,"tintMode",1),u([He.computed],Ye.prototype,"resizeMode",1),u([He.computed],Ye.prototype,"tintable",1),u([He.computed],Ye.prototype,"tintColor",1),u([He.computed],Ye.prototype,"config",1),u([He.computed],Ye.prototype,"locale",1),u([He.computed],Ye.prototype,"localeColor",1),u([He.computed],Ye.prototype,"selectedCategoryIdentifier",1),u([He.computed],Ye.prototype,"entities",1),u([He.computed],Ye.prototype,"categories",1);const BU="imgly_font_open_sans_bold",vt={text:"Write Something",identifier:BU,fontSize:73.3,defaultFontSize:73.3,fontFamily:"Open Sans",fontStyle:"",fontWeight:"bold",lineHeight:1,alignment:"center",textColor:gr.white,backgroundColor:gr.transparent||[0,0,0,0],width:0},Z_={};const me=v(Ve()),LD={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular",lighter:"Lighter"};class fe{constructor(e){this.state=me.observable.map(Z_);this.colorList=It.defaultColors;this.backgroundColorList=It.defaultBackgroundColors;this.loadingObservable=me.observable.box(!1);this.add=()=>{const e=()=>{this.editor.spriteStore.addText({state:{identifier:vt.identifier,text:vt.text,textColor:vt.textColor,backgroundColor:vt.backgroundColor,lineHeight:vt.lineHeight,alignment:vt.alignment,fontSize:0}})};this.loadfonts(e)};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.changeFont=e=>{const t=this.fonts.find(i=>i.identifier===e);this.changeIdentifier(t,this.id),this.id&&this.addSnapshot(be.EDIT,this.locale.history.fontFamily)};this.changeIdentifier=(e,t)=>{me.runInAction(()=>{if(e&&t){const i=this.state.get(t);if(i){this.editor.spriteStore.setContainerProperties(t,{fontIdentifier:e.identifier},!0);const r=this.editor.spriteStore.getContainerProperties(t);i.identifier=r.fontIdentifier,i.fontFamily=e.fontFamily,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.fontSize=r.fontSize,i.width=r.width,i.defaultFontSize=i.fontSize,this.state.set(t,i)}}})};this.changeFontSize=(e,t=!1)=>{if(this.id){const i=this.state.get(this.id);i&&(i.fontSize=e,t&&(i.defaultFontSize=e),this.state.set(this.id,i))}};this.updateDefaultFontSize=()=>{if(this.id){const e=this.state.get(this.id);e&&(e.defaultFontSize=e.fontSize,this.state.set(this.id,e))}};this.changeSize=(e,t)=>{const i=this.state.get(e);i&&(i.width=t.width,i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize,this.state.set(e,i))};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);let i=this.editor.spriteStore.getContainerProperties(this.id);const r=this.editor.outputContainer.getSizeInOutputSpace(),o=this.editor.spriteStore.getSize(this.id);this.config.disableAutoScaling||o.height>r.height&&this.editor.spriteStore.setContainerProperties(this.id,{fontSize:this.calculateFitFontSize(this.id,r.height)},!0),i=this.editor.spriteStore.getContainerProperties(this.id),t.text=i.text,t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t),this.addSnapshot(be.EDIT,this.locale.history.edit)}}};this.changeLineHeight=e=>{if(this.id){const t=this.state.get(this.id);if(t&&e){this.editor.spriteStore.setContainerProperties(this.id,{lineHeight:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.lineHeight=i.lineHeight,this.state.set(this.id,t)}}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{textColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.textColor=i.textColor,this.state.set(this.id,t)}}};this.changeBackgroundColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{backgroundColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.backgroundColor=i.backgroundColor,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(be.EDIT,this.locale.history.textColor)};this.backgroundColorSnapshot=()=>{this.addSnapshot(be.EDIT,this.locale.history.backgroundColor)};this.changeAlignment=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{alignment:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.alignment=i.alignment,this.state.set(this.id,t),this.addSnapshot(be.EDIT,this.locale.history.alignment)}}};this.setFontSize=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{fontSize:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t)}}};this.editor=e,this.fonts.find(t=>t.identifier===vt.identifier)||(vt.identifier=this.fonts[0].identifier),vt.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=Ao(me.toJS(this.config.colors))),this.config.backgroundColors&&this.config.backgroundColors.length>0&&(this.backgroundColorList=Ao(me.toJS(this.config.backgroundColors)))}static defaultText(){return vt.text}static getDisplayFontStyle(e){const t=e.fontWeight&&LD[e.fontWeight].toLowerCase()!=="regular"?LD[e.fontWeight]:"",i=e.fontStyle&&e.fontStyle.toLowerCase()!=="normal"?e.fontStyle:"";return`${t} ${i}`.trim()}loadfonts(e){if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForText().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.loadingObservable.set(!0),e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:ot.ERROR,identifier:"fontLoading",error:r})})}}doesTextAssetExist(e){return this.editor.assetProvider.getFontAssets().findIndex(t=>t.identifier===e)!==-1}addOrselect(){this.state.size?this.selectLast():this.add()}selectLast(){this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))}duplicate(){if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addText({state:{identifier:this.identifier,text:this.text,textColor:me.toJS(this.textColor),lineHeight:this.lineHeight,alignment:this.alignment,fontSize:this.fontSize,backgroundColor:me.toJS(this.backgroundColor),width:this.width},transform:e})}}bringToFront(){this.id&&this.editor.spriteStore.bringToFront(this.id)}delete(){if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}}calculateFitFontSize(e,t){if(!fe.measureContext){const h=document.createElement("canvas");fe.measureContext=h.getContext("2d")}const i=this.editor.spriteStore.getContainerProperties(e),r=this.editor.engine.assetProvider.getFontManager().getFontWithId(i.fontIdentifier),o=this.config.minFontSizeForAutoScaling,n=_l(fe.measureContext,i.text,r,i.fontSize,i.lineHeight,i.width,r.textMetrics),s=Math.min(Math.floor(i.fontSize*(t/n.height)),1),a=Math.round(i.fontSize);let l=0,d=a-s,c=Math.floor((a-s)*2),p=d;for(;l<=c;){d=l+Math.floor((c-l)/2);const h=_l(fe.measureContext,i.text,r,d,i.lineHeight,i.width,r.textMetrics);if(t<h.height)c=d-1,p=d-1;else if(t>h.height){if(l=d+1,s+d>=a)return a}else{p=d;break}}return o&&p<o?o:p}toolSnapshot(){this.addSnapshot(be.EDIT,this.locale.history.lineSpacing)}addSnapshot(e,t){this.currentText&&this.editor.spriteStore.addSnapshot(e,t)}updateStateFromHistory(e,t){this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)}setState(e,t){const i=this.state.get(e);if(i)t.alignment&&(i.alignment=t.alignment),t.text&&(i.text=t.text),t.lineHeight&&(i.lineHeight=t.lineHeight),t.textColor&&(i.textColor=t.textColor),t.backgroundColor&&(i.backgroundColor=t.backgroundColor),t.fontIdentifier&&(i.identifier=t.fontIdentifier),t.fontSize&&(i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize),t.width&&(i.width=t.width);else{const r=this.fonts.find(o=>o.identifier===t.fontIdentifier);this.state.set(e,{text:t.text,identifier:t.fontIdentifier,alignment:t.alignment,textColor:t.textColor?t.textColor:vt.textColor,backgroundColor:t.backgroundColor?t.backgroundColor:vt.backgroundColor,fontFamily:r.fontFamily,fontStyle:r.fontStyle,fontSize:t.fontSize,fontWeight:r.fontWeight,lineHeight:t.lineHeight,width:t.width,defaultFontSize:t.fontSize})}}pureReset(){this.state=me.observable.map(Z_)}get isEditMode(){return this.editor.spriteStore.isEditMode}get isTextSelected(){return this.editor.spriteStore.isSpriteText}get fontsLoaded(){return this.loadingObservable.get()}get currentText(){if(this.isTextSelected){const e=this.state.get(this.id);if(e)return e}return}get text(){return this.currentText?this.currentText.text:vt.text}get fontSize(){return this.currentText?this.currentText.fontSize:vt.fontSize}get defaultFontSize(){return this.currentText?this.currentText.defaultFontSize:vt.defaultFontSize}get width(){return this.currentText?this.currentText.width:vt.width}get fontFamily(){return this.currentText?this.currentText.fontFamily:vt.fontFamily}get fontStyle(){return this.currentText?this.currentText.fontStyle:vt.fontStyle}get fontWeight(){return this.currentText?this.currentText.fontWeight:vt.fontWeight}get lineHeight(){return this.currentText?this.currentText.lineHeight:vt.lineHeight}get identifier(){return this.currentText?this.currentText.identifier:vt.identifier}get id(){return this.isTextSelected?this.editor.spriteStore.id:void 0}get alignment(){return this.currentText?this.currentText.alignment:vt.alignment}get textColor(){return this.currentText?this.currentText.textColor:vt.textColor}get backgroundColor(){return this.currentText?this.currentText.backgroundColor:vt.backgroundColor}get config(){return this.editor.configStore.config[w.TEXT]}get locale(){return this.editor.configStore.locale[w.TEXT]}get localeColor(){return this.editor.configStore.locale.common.color}get rawOptions(){return this.editor.assetProvider.getFontAssetsForText()}get availableOptions(){return this.config.fonts.length?this.config.fonts.map(e=>e.identifier):this.rawOptions.map(e=>e.identifier)}get fonts(){return this.rawOptions.reduce((e,t)=>this.availableOptions.indexOf(t.identifier)!==-1?[...e,{identifier:t.identifier,fontFamily:t.fontFamily,fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||""}]:e,[])}get fontFamilies(){return[...new Set(this.fonts)]}}u([me.action],fe.prototype,"addOrselect",1),u([me.action],fe.prototype,"selectLast",1),u([me.action],fe.prototype,"add",2),u([me.action],fe.prototype,"duplicate",1),u([me.action],fe.prototype,"bringToFront",1),u([me.action],fe.prototype,"delete",1),u([me.action],fe.prototype,"setEditMode",2),u([me.action],fe.prototype,"changeFont",2),u([me.action],fe.prototype,"changeIdentifier",2),u([me.action],fe.prototype,"changeFontSize",2),u([me.action],fe.prototype,"updateDefaultFontSize",2),u([me.action],fe.prototype,"changeSize",2),u([me.action],fe.prototype,"changeWidth",2),u([me.action],fe.prototype,"changeText",2),u([me.action],fe.prototype,"changeLineHeight",2),u([me.action],fe.prototype,"changeColor",2),u([me.action],fe.prototype,"changeBackgroundColor",2),u([me.action],fe.prototype,"changeAlignment",2),u([me.action],fe.prototype,"updateStateFromHistory",1),u([me.action],fe.prototype,"setState",1),u([me.action],fe.prototype,"setFontSize",2),u([me.action],fe.prototype,"pureReset",1),u([me.computed],fe.prototype,"isEditMode",1),u([me.computed],fe.prototype,"isTextSelected",1),u([me.computed],fe.prototype,"fontsLoaded",1),u([me.computed],fe.prototype,"currentText",1),u([me.computed],fe.prototype,"text",1),u([me.computed],fe.prototype,"fontSize",1),u([me.computed],fe.prototype,"defaultFontSize",1),u([me.computed],fe.prototype,"width",1),u([me.computed],fe.prototype,"fontFamily",1),u([me.computed],fe.prototype,"fontStyle",1),u([me.computed],fe.prototype,"fontWeight",1),u([me.computed],fe.prototype,"lineHeight",1),u([me.computed],fe.prototype,"identifier",1),u([me.computed],fe.prototype,"id",1),u([me.computed],fe.prototype,"alignment",1),u([me.computed],fe.prototype,"textColor",1),u([me.computed],fe.prototype,"backgroundColor",1),u([me.computed],fe.prototype,"config",1),u([me.computed],fe.prototype,"locale",1),u([me.computed],fe.prototype,"localeColor",1),u([me.computed],fe.prototype,"rawOptions",1),u([me.computed],fe.prototype,"availableOptions",1),u([me.computed],fe.prototype,"fonts",1),u([me.computed],fe.prototype,"fontFamilies",1);const MU="imgly_text_design_blocks",fi={identifier:MU,color:gr.white,isInverted:!1,text:"Write Something With Style",seed:0,padding:0,width:0},Q_={imgly_text_design_blocks:835,imgly_text_design_rotated:6,imgly_text_design_blocks_light:3,imgly_text_design_equal_width:727,imgly_text_design_masked:259,imgly_text_design_celebrate:579,imgly_text_design_sunshine:77,imgly_text_design_masked_badge:683,imgly_text_design_blocks_condensed:673,imgly_text_design_celebrate_simple:425,imgly_text_design_equal_width_fat:961,imgly_text_design_watercolor:671,imgly_text_design_particles:683,imgly_text_design_masked_speech_bubble:317,imgly_text_design_masked_speech_bubble_comic:229,imgly_text_design_multiline:831},ex={};const Le=v(Ve());class Ke{constructor(e){this.state=Le.observable.map(ex);this.colorList=It.defaultColors;this.fontsLoaded=!1;this.add=()=>{const e=()=>{this.editor.spriteStore.addTextDesign({state:{identifier:fi.identifier,text:fi.text,color:fi.color,isInverted:fi.isInverted,seed:Q_[fi.identifier]||fi.seed,padding:0}})};this.loadfonts(e)};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.text=i.text,this.state.set(this.id,t),this.addSnapshot(be.EDIT,this.locale.history.edit)}}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.changeSeed=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{seed:-1},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.seed=t.seed,this.state.set(this.id,e),this.addSnapshot(be.EDIT,this.locale.history.shuffle)}}};this.changeIdentifier=(e,t=!0,i=null,r=this.id)=>{if(r&&e!==this.identifier){const o=this.state.get(r),n=this.editor.spriteStore.getContainerTransform(r);this.editor.spriteStore.addTextDesign({spriteId:r,state:{identifier:e,text:o.text,color:Le.toJS(o.color),isInverted:o.isInverted,seed:i||Q_[e]||o.seed,padding:o.padding,width:o.width},transform:n},t,!0)}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{color:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.color=i.color,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(be.EDIT,this.locale.history.color)};this.invertBackground=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{inverted:!e.isInverted},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.isInverted=t.inverted,this.state.set(this.id,e),this.addSnapshot(be.EDIT,this.locale.history.invert)}}};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changePadding=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.padding=e,this.state.set(this.id,t))}};this.editor=e,this.entityManager=new Ht([{identifier:"",name:"",items:this.editor.assetProvider.getAssets("textdesign")}],y(y({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:{},getAssetPath:this.editor.getAssetPath("textdesign")})),this.entityManager.items.find(t=>t.identifier===fi.identifier)||(fi.identifier=this.entityManager.items[0].identifier),fi.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=Ao(Le.toJS(this.config.colors)))}static defaultText(){return fi.text}loadfonts(e){if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForTextDesign().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.fontsLoaded=!0,e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:ot.ERROR,identifier:"fontLoading",error:i[0]})})}}doesTextDesignAssetExist(e){return this.entityManager.items.findIndex(t=>t.identifier===e)!==-1}addOrselect(){this.state.size?this.selectLast():this.add()}selectLast(){this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))}updateStateFromHistory(e,t){const i=this.state.get(e);t.identifier===i.identifier?(this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)):this.changeIdentifier(t.identifier,!1,t.seed,e)}setState(e,t){const i=this.state.get(e);i?(t.inverted&&(i.isInverted=t.inverted),t.seed&&(i.seed=t.seed),t.color&&(i.color=t.color),t.padding&&(i.padding=t.padding),t.width&&(i.width=t.width)):this.state.set(e,{width:t.width,text:t.text,isInverted:t.inverted,identifier:t.identifier,seed:t.seed,color:t.color?t.color:fi.color,padding:t.padding})}duplicate(){if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addTextDesign({state:{identifier:this.identifier,text:this.text,color:Le.toJS(this.color),isInverted:this.isInverted,seed:this.seed,padding:this.padding,width:this.width},transform:e})}}bringToFront(){this.id&&this.editor.spriteStore.bringToFront(this.id)}addSnapshot(e,t){this.currentTextDesign&&this.editor.spriteStore.addSnapshot(e,t)}delete(e=this.id){e&&(this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast())}pureReset(){this.state=Le.observable.map(ex)}get isTextDesignSelected(){return this.editor.spriteStore.isSpriteTextDesign}get isEditMode(){return this.editor.spriteStore.isEditMode}get currentTextDesign(){if(this.isTextDesignSelected&&this.id){const e=this.state.get(this.id);if(e)return e}return}get id(){return this.isTextDesignSelected?this.editor.spriteStore.id:void 0}get text(){return this.currentTextDesign?this.currentTextDesign.text:fi.text}get seed(){return this.currentTextDesign?this.currentTextDesign.seed:fi.seed}get padding(){return this.currentTextDesign?this.currentTextDesign.padding:fi.padding}get width(){return this.currentTextDesign?this.currentTextDesign.width:fi.width}get identifier(){return this.currentTextDesign?this.currentTextDesign.identifier:null}get isInverted(){return this.currentTextDesign?this.currentTextDesign.isInverted:fi.isInverted}get color(){return this.currentTextDesign?this.currentTextDesign.color:fi.color}get config(){return this.editor.configStore.config[w.TEXT_DESIGN]}get locale(){return this.editor.configStore.locale[w.TEXT_DESIGN]}get localeColor(){return this.editor.configStore.locale.common.color}get entities(){return this.entityManager.getEntities()}}u([Le.action],Ke.prototype,"addOrselect",1),u([Le.action],Ke.prototype,"selectLast",1),u([Le.action],Ke.prototype,"add",2),u([Le.action],Ke.prototype,"updateStateFromHistory",1),u([Le.action],Ke.prototype,"setState",1),u([Le.action],Ke.prototype,"changeText",2),u([Le.action],Ke.prototype,"setEditMode",2),u([Le.action],Ke.prototype,"duplicate",1),u([Le.action],Ke.prototype,"bringToFront",1),u([Le.action],Ke.prototype,"delete",1),u([Le.action],Ke.prototype,"changeSeed",2),u([Le.action],Ke.prototype,"changeIdentifier",2),u([Le.action],Ke.prototype,"changeColor",2),u([Le.action],Ke.prototype,"invertBackground",2),u([Le.action],Ke.prototype,"changeWidth",2),u([Le.action],Ke.prototype,"changePadding",2),u([Le.action],Ke.prototype,"pureReset",1),u([Le.computed],Ke.prototype,"isTextDesignSelected",1),u([Le.computed],Ke.prototype,"isEditMode",1),u([Le.computed],Ke.prototype,"currentTextDesign",1),u([Le.computed],Ke.prototype,"id",1),u([Le.computed],Ke.prototype,"text",1),u([Le.computed],Ke.prototype,"seed",1),u([Le.computed],Ke.prototype,"padding",1),u([Le.computed],Ke.prototype,"width",1),u([Le.computed],Ke.prototype,"identifier",1),u([Le.computed],Ke.prototype,"isInverted",1),u([Le.computed],Ke.prototype,"color",1),u([Le.computed],Ke.prototype,"config",1),u([Le.computed],Ke.prototype,"locale",1),u([Le.computed],Ke.prototype,"localeColor",1),u([Le.computed],Ke.prototype,"entities",1);const J=v(Ve()),LU=e=>({height:e.y,width:e.x}),zU={},bg="none",NU={position:{x:0,y:0},rotation:0};class te{constructor(e){this.state=J.observable.map(zU);this.selectedId=J.observable.box(bg);this.editMode=J.observable.box(!1);this.dragMode=J.observable.box(!1);this.minLength=0;this.setEditMode=e=>{this.currentSprite&&([w.TEXT,w.TEXT_DESIGN].indexOf(this.tool)!==-1&&(e?this.editor.modalStore.showTextEditModal():this.editor.modalStore.hideModal(),this.editMode.set(e)))};this.onWidthDrag=({x:e,y:t})=>{const i=new E(this.currentSprite.position),r=new E(e,t),o=r.subtract(i).magnitude,n=this.editor.previewToWorld(2*o);if(n>this.minLength&&(this.setContainerProperties(this.id,{width:n},!0),this.isSpriteText)){const s=this.getContainerProperties(this.id);this.textToolStore.changeWidth(s.width)}};this.onPaddingDrag=({x:e,y:t})=>{if(this.isSpriteTextDesign){let i=this.getContainerProperties(this.id);const r=new E(this.currentSprite.position),o=new E(e,t),n=o.subtract(r).magnitude,s=Math.max(this.editor.previewToWorld(n)-i.width/2,0);this.setContainerProperties(this.id,{padding:s},!0),this.isSpriteTextDesign&&(i=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(i.padding))}};this.correctTextFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();Object.values(this.container).forEach(i=>{(i.type==="text"||i.type==="text-design")&&(i.setFlipHorizontally(e),i.setFlipVertically(t))})};this.reverseTextHorizontally=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipHorizontally(!e.getFlipHorizontally())})};this.reverseTextVertically=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipVertically(!e.getFlipVertically())})};this.updatePositionAndSize=(e=this.id,t=!1)=>{const{position:i,size:r}=this.getSizePositionFromContainer(e),o=this.state.get(e);if(o){if(o.position.x=i.x,o.position.y=i.y,o.size.width=r.width,o.size.height=r.height,t){const n=this.container[e].getRotation();this.container[e].setRotation(n),o.rotation=this.container[e].getRotation()}this.state.set(e,o)}};this.getSize=(e=this.id)=>{const t=this.container[e];return t?this.editor.worldSizeToPreview(t.getSizeInWorldSpace()):{width:0,height:0}};this.editor=e,this.container={},this.stickerToolStore=new Ye(e),this.textToolStore=new fe(e),this.textDesignToolStore=new Ke(e),this.rect=new ct(this.editor,this),this.minLength=this.editor.configStore.measurements.canvasControls.sprite.minSize/Math.sqrt(2)}static magnitude(e,t){return new E(e,t||e).magnitude}static sizeMagnitude(e){return Math.sqrt(e.width*e.width+e.height*e.height)}addSticker(e,t=!0){return Z(this,null,function*(){yield this.addStickerAsync(e,t)})}addStickerAsync(o){return Z(this,arguments,function*({spriteId:e,state:t,transform:i},r=!0){return new Promise((n,s)=>{i=this.getInitialTransform(i);const{identifier:a}=t,l=this.editor.orderHelper.addSprite(a);this.editor.engine.addStickerFromAssets(a,this.editor.engineMediator.image.container,l).then(d=>Z(this,null,function*(){e&&d.setData({id:e});const c=d.getID();this.container[c]=d,this.editor.orderHelper.renameSprite(a,c);const p=this.getSize(c);p.width*=d.getScale().x,p.height*=d.getScale().y,d.setPivot(.5,.5);let h;if(i.scale)h=i.scale;else if(i.size)h={x:i.size.width/p.width,y:i.size.height/p.height};else{const g=this.editor.shortestOutputSide*.4,S=te.magnitude(g)/te.sizeMagnitude(d.getSizeInWorldSpace());h={x:S,y:S}}const{flipHorizontally:m,flipVertically:b}=this.editor.outputContainer.getData();d.setFlipHorizontally(m),d.setFlipVertically(b),d.setTransform({position:i.position,scale:h,rotation:i.rotation}),t.flipHorizontally!==void 0&&d.setFlipHorizontally(t.flipHorizontally!==m),t.flipVertically!==void 0&&d.setFlipVertically(t.flipVertically!==b),this.setContainerProperties(c,y({},t));const _=d.getData();this.setInitialSpriteState(c,w.STICKER),this.stickerToolStore.setState(c,y(y({},_),{identifier:a})),yield this.editor.renderPromise(),r&&(this.selectedId.set(c),this.addSnapshot(be.ADD,this.stickerLocale.add)),n()})).catch(d=>{console.error(d),s()})})})}addText(e,t=!0){return Z(this,null,function*(){yield this.addTextAsync(e,t)})}addTextAsync({spriteId:e,state:t,transform:i},r=!0){return new Promise((o,n)=>{i=this.getInitialTransform(i);const s=this.editor.orderHelper.addSprite(t.identifier),a=this.editor.shortestOutputSide,l={fontIdentifier:t.identifier,text:t.text,width:t.width||a*.6,fontSize:t.fontSize||a*.1,lineHeight:t.lineHeight,alignment:t.alignment,textColor:t.textColor,backgroundColor:t.backgroundColor};t.backgroundColor===vt.backgroundColor&&delete l.backgroundColor,this.editor.engine.addTextWithFontLoading(l,this.editor.engineMediator.image.container,s).then(d=>Z(this,null,function*(){e&&d.setData({id:e});const c=d.getID();this.container[c]=d,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:p,flipVertically:h}=this.editor.outputContainer.getData();d.setFlipHorizontally(p),d.setFlipVertically(h),d.setPivot(.5,.5),d.setPosition(i.position),d.setRotation(i.rotation),this.setInitialSpriteState(c,w.TEXT);const m=d.getData();this.textToolStore.setState(c,y({},m)),yield this.editor.renderPromise(),r&&(this.selectedId.set(c),this.addSnapshot(be.ADD,this.textLocale.add)),o()})).catch(d=>{console.error(d),n()})})}addTextDesign(e,t=!0,i=!1){return Z(this,null,function*(){yield this.addTextDesignAsync(e,t,i)})}addTextDesignAsync({spriteId:e,state:t,transform:i},r=!0,o=!1){return new Promise((n,s)=>{i=this.getInitialTransform(i);const a=this.editor.orderHelper.addSprite(t.identifier),l=this.editor.shortestOutputSide,d={width:t.width||l*.6,text:t.text,color:t.color,inverted:t.isInverted,seed:t.seed,padding:t.padding};this.editor.engine.addTextDesignAsync(t.identifier,d,this.editor.engineMediator.image.container,a).then(c=>Z(this,null,function*(){e&&(o&&(this.pureRemoveSprite(e),this.textDesignToolStore.state.delete(e)),c.setData({id:e}));const p=c.getID();this.container[p]=c,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:h,flipVertically:m}=this.editor.outputContainer.getData();c.setFlipHorizontally(h),c.setFlipVertically(m),c.setPivot(.5,.5),c.setPosition(i.position),c.setRotation(i.rotation),this.setInitialSpriteState(p,w.TEXT_DESIGN);const b=c.getData();this.textDesignToolStore.setState(p,y(y({},b),{identifier:t.identifier})),yield this.editor.renderPromise(),r&&(this.selectedId.set(p),this.addSnapshot(be.ADD,this.textDesignLocale.add)),n()})).catch(c=>{console.error(c),s()})})}spriteLocalTransform(){return{position:this.editor.previewToOutput(this.position),size:this.size,rotation:this.rotation}}clickableCanvas(e){this.editor.clickableCanvas(e)}setContainerProperties(e,t,i=!1){this.container[e].setData(t),i&&this.updatePositionAndSize(),this.editor.render()}setContainerPosition(e,t){this.container[e].setPosition(t)}pureRemoveSprite(e){this.editor.engine.removeContainer(this.container[e]);const t=this.container[e].getIndexInParent();return t===-1?(delete this.container[e],this.state.delete(e),this.editor.orderHelper.removeSprite(e),!0):!1}deleteSprite(e=this.id){const t=this.state.get(e);t.tool===w.STICKER?this.stickerToolStore.delete():t.tool===w.TEXT?this.textToolStore.delete():t.tool===w.TEXT_DESIGN&&this.textDesignToolStore.delete()}removeSprite(e){const t=this.pureRemoveSprite(e);t&&(this.selectLast(),this.spriteSnapshot("delete"),this.editor.render())}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}spriteSnapshot(e){this.addSnapshot(be.EDIT,this.historyLocale[e])}updateStateFromHistory(e){return Z(this,null,function*(){const t=Object.keys(this.container),i=e.spriteIdList;if(i.length!==t.length){const r=t.filter(n=>i.indexOf(n)===-1),o=i.filter(n=>t.indexOf(n)===-1);r.forEach(n=>{this.pureRemoveSprite(n)});for(let n=0;n<o.length;n+=1){const s=o[n],a=e.common?e.common[s]:void 0,l=e.text?e.text[s]:void 0,d=e.sticker?e.sticker[s]:void 0,c=e.textdesign?e.textdesign[s]:void 0;if(a){const p={spriteId:s,transform:{size:a.size?LU(E.fromSize(a.size)):void 0,position:new E(a.position),rotation:a.rotation}};l?yield this.addNewText(p,l):c?yield this.addNewTextDesign(p,c):d&&(yield this.addNewSticker(p,y(y({},d),{flipHorizontally:a.flipHorizontally,flipVertically:a.flipVertically})))}}}else this.updateSpriteStateFromHistory(e)})}addNewText(e,t){return Z(this,null,function*(){if(this.textToolStore.doesTextAssetExist(t.identifier))yield this.addTextAsync(y(y({},e),{state:t}),!1);else throw new Error(`Text identifier ${t.identifier} doesn't exist`)})}addNewTextDesign(e,t){return Z(this,null,function*(){if(this.textDesignToolStore.doesTextDesignAssetExist(t.identifier))yield this.addTextDesignAsync(y(y({},e),{state:t}),!1);else throw new Error(`TextDesign identifier ${t.identifier} doesn't exist`)})}addNewSticker(e,t){return Z(this,null,function*(){if(this.stickerToolStore.doesStickerAssetExist(t.identifier))yield this.addStickerAsync(y(y({},e),{state:t}),!1);else throw new Error(`Sticker identifier ${t.identifier} doesn't exist`)})}updateSpriteStateFromHistory(e){return Z(this,null,function*(){Object.keys(this.container).forEach(t=>{const i=e.common?e.common[t]:void 0,r=e.sticker?e.sticker[t]:void 0,o=e.text?e.text[t]:void 0,n=e.textdesign?e.textdesign[t]:void 0,s=this.state.get(t);if(s&&i){this.state.set(t,s);const a=this.container[t];a.setPosition(new E(i.position)),a.setRotation(i.rotation),s.rotation=a.getRotation(),i.flipHorizontally!==void 0&&a.setFlipHorizontally(i.flipHorizontally),i.flipVertically!==void 0&&a.setFlipVertically(i.flipVertically),r?(a.setSizeInWorldSpace(i.size),this.stickerToolStore.updateStateFromHistory(t,r)):o?this.textToolStore.updateStateFromHistory(t,y(y({},o),{fontIdentifier:o.identifier})):n&&this.textDesignToolStore.updateStateFromHistory(t,y(y({},n),{inverted:n.isInverted})),this.updatePositionAndSize(t)}})})}getSpriteHistoryState(){const e=J.toJS(this.state),t=J.toJS(this.textToolStore.state),i=J.toJS(this.textDesignToolStore.state),r={common:e,[w.STICKER]:J.toJS(this.stickerToolStore.state),[w.TEXT]:t,[w.TEXT_DESIGN]:i,spriteIdList:Object.keys(this.container)};return Object.keys(r.common).forEach(o=>{r.common[o].size=this.container[o].getSizeInWorldSpace(),r.common[o].position=this.container[o].getPosition(),r.common[o].order=this.container[o].getIndexInParent()}),r}updateStateFromSerialization(e,t){return Z(this,null,function*(){if(t&&t.length)try{const i=t.map(o=>X_(o.raster.data,!0)),r=yield Promise.all(i);yield this.stickerToolStore.addCustomStickerAsset(t.map((o,n)=>({image:r[n].image,smallImage:r[n].smallImage,name:o.name,type:o.raster.type,id:o.identifier})))}catch(i){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}for(let i=0;i<e.spriteIdList.length;i+=1){const r=e.spriteIdList[i],o=e.common?e.common[r]:void 0,n=e.sticker?e.sticker[r]:void 0,s=e.text?e.text[r]:void 0,a=e.textdesign?e.textdesign[r]:void 0;if(o){let{size:l}=o;l&&(l={width:this.editor.worldToPreview(o.size.width),height:this.editor.worldToPreview(o.size.height)});const{flipHorizontally:d,flipVertically:c}=this.editor.outputContainer.getData(),p=this.editor.outputContainer.getRotation(),h=c!==d?o.rotation-p:o.rotation+p,m=c!==d?-h:h,b={spriteId:r,transform:{size:l,position:o.position,rotation:m}};s?yield this.addNewText(b,s):a?yield this.addNewTextDesign(b,a):n&&(yield this.addNewSticker(b,y(y({},n),{flipHorizontally:o.flipHorizontally,flipVertically:o.flipVertically})))}}})}get serializableState(){const e=this.editor.spriteStore.getSpriteHistoryState();Object.keys(e.common).forEach(r=>{const{flipHorizontally:o,flipVertically:n}=this.editor.outputContainer.getData(),s=this.editor.outputContainer.getRotation(),a=n!==o?-e.common[r].rotation:e.common[r].rotation;e.common[r].rotation=n!==o?a+s:a-s});const t=this.editor.spriteStore.stickerToolStore.customStickerIds,i=t.map(({identifier:r,type:o})=>{const n=this.editor.spriteStore.stickerToolStore.entities.find(s=>r===s.identifier);if(n){const s=this.editor.assetProvider.getStickerAsset(n.identifier);if(Ls(s))return{identifier:r,raster:{type:o,name:n.name,data:s.sticker}}}return}).filter(Boolean);return{sprite:e,customStickers:i}}updateCanvasControls(){Object.keys(this.container).forEach(e=>{this.updatePositionAndSize(e,!0);const t=this.state.get(e);if(t){if(t.tool===w.TEXT){const i=this.getContainerProperties(e);this.textToolStore.changeSize(e,i)}else if(t.tool===w.TEXT_DESIGN){const i=this.getContainerProperties(e);this.textToolStore.changeWidth(i.width)}}})}setDragMode(e){this.dragMode.set(e)}setPosition(e){const t=this.currentSprite,i=this.container[this.id];if(t&&i){i.setPosition(this.editor.previewToWorld(e));const{position:r}=this.getSizePositionFromContainer();t.position.x=r.x,t.position.y=r.y,this.state.set(this.id,t),this.editor.render()}}setSize(e){const t=this.currentSprite;t&&(t.size.width=e.width,t.size.height=e.height,this.state.set(this.id,t))}setRotation(e){const t=this.currentSprite;if(t){const{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData(),o=this.editor.outputContainer.getRotation(),n=up({rotation:e+o,flipHorizontally:i,flipVertically:r});this.container[this.id].setRotation(n),t.rotation=this.container[this.id].getRotation(),this.state.set(this.id,t),this.editor.render()}}onCanvasClick(e){this.isEditMode||this.selectHighestOrderSprite(e)}select(e){const t=this.state.get(e);if(t){const i=this.editor.activeStore.tool;i!==t.tool&&this.editor.activeStore.selectTool(t.tool),this.selectedId.set(e)}}selectLast(){const e=this.editor.orderHelper.getLastSpriteId();e&&this.select(e)}selectNext(){if(this.currentSprite){const e=this.container[this.id],t=e.getIndexInParent();if(t){const i=Object.keys(this.container).find(r=>this.container[r].getIndexInParent()===t-1);i&&this.select(i)}}}deselect(){this.selectedId.set(bg)}bringToFront(e){const t=this.editor.orderHelper.bringToFront(e);this.container[e].setIndexInParent(t),this.spriteSnapshot("order"),this.editor.render()}flipHorizontally(e){const t=this.state.get(e),i=this.container[e];i.setFlipHorizontally(!i.getFlipHorizontally()),t.flipHorizontally=i.getFlipHorizontally(),this.spriteSnapshot("flip"),this.state.set(e,t),this.editor.render()}pureReset(){this.selectedId.set(bg),Array.from(this.state.keys()).forEach(e=>{this.pureRemoveSprite(e)}),this.stickerToolStore.pureReset(),this.textToolStore.pureReset(),this.textDesignToolStore.pureReset()}selectHighestOrderSprite(e){const t=this.editor.brushToolStore.containerId();if(e=e.filter(o=>o!==t),e.length<1){this.deselect();return}let i="",r=0;e.forEach(o=>{const n=this.container[o],s=n&&n.getIndexInParent()||0;s>=r&&(r=s,i=o)}),this.select(i)}onCornerDrag({x:e,y:t}){if(this.currentSprite){const i=new E(this.currentSprite.position),r=new E(e,t),o=r.subtract(i).magnitude,n=this.getSize(),s=o*2/te.sizeMagnitude(n);if(o>this.minLength)if(this.isSpriteSticker)if(this.stickerToolStore.resizeMode!=="unrestricted")this.setStickerSize({width:n.width*s,height:n.height*s});else{const a=this.rotationWRTOutputRotation,l=r.subtract(i),d=Math.cos(a),c=Math.sin(a),p=Math.max(Math.abs(l.x*d*2+l.y*c*2),this.minLength),h=Math.max(Math.abs(l.x*-c*2+l.y*d*2),this.minLength);this.setStickerSize({width:p,height:h})}else this.isSpriteText?this.setTextSize(n.width*s):this.isSpriteTextDesign&&this.setTextDesignScale(s);this.editor.render()}}get currentSprite(){return this.isSpriteSelected?this.state.get(this.id):void 0}get padding(){return this.textDesignToolStore.padding}get isEditMode(){return this.editMode.get()}get isDragMode(){return this.dragMode.get()}get id(){return this.selectedId.get()}get isSpriteSelected(){return this.id!==bg}get position(){return this.currentSprite?this.currentSprite.position:void 0}get tool(){return this.currentSprite?this.currentSprite.tool:void 0}get size(){return this.currentSprite?this.currentSprite.size:void 0}get rotation(){return this.currentSprite?this.currentSprite.rotation:void 0}get rotationWRTOutputRotation(){if(this.currentSprite){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData(),i=this.editor.outputContainer.getRotation();return up({rotation:this.currentSprite.rotation-i,flipHorizontally:e,flipVertically:t})}return}get flipHorizontal(){return this.currentSprite?this.currentSprite.flipHorizontally:void 0}get isSpriteSticker(){return this.tool===w.STICKER}get isSpriteText(){return this.tool===w.TEXT}get isSpriteTextDesign(){return this.tool===w.TEXT_DESIGN}get spritePosition(){if(this.currentSprite){const{x:e,y:t}=this.currentSprite.position,{height:i,width:r}=this.currentSprite.size;return{x:Math.round(e-r/2),y:Math.round(t-i/2)}}return}get currentRect(){return this.currentSprite?this.rect:void 0}get leftTopPosition(){return this.currentSprite?this.rect.leftTop:void 0}get leftBottomPosition(){return this.currentSprite?this.rect.leftBottom:void 0}get leftMidPosition(){return this.currentSprite?this.rect.leftMid:void 0}get leftMidPadPosition(){if(this.currentSprite){const{leftMid:e}=this.rect;return{x:e.x-this.editor.worldToPreview(this.padding),y:e.y}}return}get rightTopPosition(){return this.currentSprite?this.rect.rightTop:void 0}get rightBottomPosition(){return this.currentSprite?this.rect.rightBottom:void 0}get rightMidPosition(){return this.currentSprite?this.rect.rightMid:void 0}get rightMidPadPosition(){if(this.currentSprite){const{rightMid:e}=this.rect;return{x:e.x+this.editor.worldToPreview(this.padding),y:e.y}}return}get leftBottomHandlePosition(){return this.currentSprite?this.rect.leftBottomHandle:void 0}get rightBottomHandlePosition(){return this.currentSprite?this.rect.rightBottomHandle:void 0}get historyLocale(){return this.isSpriteSticker?this.stickerLocale:this.isSpriteText?this.textDesignLocale:this.textLocale}get stickerLocale(){return this.editor.configStore.locale[w.STICKER].history}get textLocale(){return this.editor.configStore.locale[w.TEXT].history}get textDesignLocale(){return this.editor.configStore.locale[w.TEXT_DESIGN].history}getOutputProperties(){return this.editor.outputContainer.getData()}getContainerProperties(e){return this.container[e].getData()}getContainerTransform(e){return this.container[e].getTransform()}getDuplicateContainerTransform(e){const t=this.container[e].getTransform(),i=this.editor.shortestOutputSide*.1,r=new E(t.position).add(new E(i,i));return y(y({},t),{position:r})}getDuplicateContainerFlip(e){const t=this.container[e].getFlipHorizontally(),i=this.container[e].getFlipVertically();return{flipHorizontally:t,flipVertically:i}}getInitialTransform(e){const t=this.editor.outputToWorld(NU.position);if(!e){const i=this.editor.outputContainer.getRotation();return{rotation:i,position:t}}return y({position:t},e)}setInitialSpriteState(e,t){const i=this.container[e],{position:r,size:o}=this.getSizePositionFromContainer(e),n=i.getRotation(),s=t!==w.STICKER?!1:i.getFlipHorizontally(),a=t!==w.STICKER?!1:i.getFlipVertically();this.state.set(e,{tool:t,position:r,rotation:n,size:o,flipHorizontally:s,flipVertically:a})}setStickerSize(e){const t=this.container[this.id];t.setSizeInWorldSpace(this.editor.previewSizeToWorld(e));const i=this.currentSprite;i&&(i.size=this.editor.worldSizeToPreview(t.getSizeInWorldSpace()),this.state.set(this.id,i))}setTextSize(e){let t=this.getContainerProperties(this.id);const i={width:this.editor.previewToWorld(e)},r=i.width/t.width,o={fontSize:Math.round(t.fontSize*r)},n=this.isSpriteText?y(y({},i),o):i;i.width>this.minLength&&o.fontSize&&(this.setContainerProperties(this.id,n,!0),t=this.getContainerProperties(this.id),this.textToolStore.changeFontSize(t.fontSize,!0),this.textToolStore.changeWidth(t.width))}setTextDesignScale(e){let t=this.getContainerProperties(this.id);const i=t.width*e;if(i>this.minLength){this.setContainerProperties(this.id,{width:i},!0);const{width:r}=this.getContainerProperties(this.id);this.textDesignToolStore.changeWidth(r),t=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(t.padding)}}getSizePositionFromContainer(e=this.id){const t=this.container[e];if(t){const i=this.editor.worldToPreview(t.getPosition()),r=this.editor.worldSizeToPreview(t.getSizeInWorldSpace());return{position:i,size:r}}return{position:{x:0,y:0},size:{height:1,width:1}}}}u([J.action],te.prototype,"addSticker",1),u([J.action],te.prototype,"addStickerAsync",1),u([J.action],te.prototype,"addText",1),u([J.action],te.prototype,"addTextAsync",1),u([J.action],te.prototype,"addTextDesign",1),u([J.action],te.prototype,"addTextDesignAsync",1),u([J.action],te.prototype,"clickableCanvas",1),u([J.action],te.prototype,"setContainerProperties",1),u([J.action],te.prototype,"setContainerPosition",1),u([J.action],te.prototype,"pureRemoveSprite",1),u([J.action],te.prototype,"deleteSprite",1),u([J.action],te.prototype,"removeSprite",1),u([J.action],te.prototype,"addSnapshot",1),u([J.action],te.prototype,"updateStateFromHistory",1),u([J.action],te.prototype,"addNewText",1),u([J.action],te.prototype,"addNewTextDesign",1),u([J.action],te.prototype,"addNewSticker",1),u([J.action],te.prototype,"updateSpriteStateFromHistory",1),u([J.action],te.prototype,"updateStateFromSerialization",1),u([J.action],te.prototype,"updateCanvasControls",1),u([J.action],te.prototype,"setEditMode",2),u([J.action],te.prototype,"setDragMode",1),u([J.action],te.prototype,"setPosition",1),u([J.action],te.prototype,"setSize",1),u([J.action],te.prototype,"setRotation",1),u([J.action],te.prototype,"onCanvasClick",1),u([J.action],te.prototype,"select",1),u([J.action],te.prototype,"selectLast",1),u([J.action],te.prototype,"selectNext",1),u([J.action],te.prototype,"deselect",1),u([J.action],te.prototype,"bringToFront",1),u([J.action],te.prototype,"flipHorizontally",1),u([J.action],te.prototype,"pureReset",1),u([J.action],te.prototype,"onCornerDrag",1),u([J.action],te.prototype,"onWidthDrag",2),u([J.action],te.prototype,"onPaddingDrag",2),u([J.action],te.prototype,"correctTextFlip",2),u([J.action],te.prototype,"reverseTextHorizontally",2),u([J.action],te.prototype,"reverseTextVertically",2),u([J.computed],te.prototype,"currentSprite",1),u([J.computed],te.prototype,"padding",1),u([J.computed],te.prototype,"isEditMode",1),u([J.computed],te.prototype,"isDragMode",1),u([J.computed],te.prototype,"id",1),u([J.computed],te.prototype,"isSpriteSelected",1),u([J.computed],te.prototype,"position",1),u([J.computed],te.prototype,"tool",1),u([J.computed],te.prototype,"size",1),u([J.computed],te.prototype,"rotation",1),u([J.computed],te.prototype,"rotationWRTOutputRotation",1),u([J.computed],te.prototype,"flipHorizontal",1),u([J.computed],te.prototype,"isSpriteSticker",1),u([J.computed],te.prototype,"isSpriteText",1),u([J.computed],te.prototype,"isSpriteTextDesign",1),u([J.computed],te.prototype,"spritePosition",1),u([J.computed],te.prototype,"currentRect",1),u([J.computed],te.prototype,"leftTopPosition",1),u([J.computed],te.prototype,"leftBottomPosition",1),u([J.computed],te.prototype,"leftMidPosition",1),u([J.computed],te.prototype,"leftMidPadPosition",1),u([J.computed],te.prototype,"rightTopPosition",1),u([J.computed],te.prototype,"rightBottomPosition",1),u([J.computed],te.prototype,"rightMidPosition",1),u([J.computed],te.prototype,"rightMidPadPosition",1),u([J.computed],te.prototype,"leftBottomHandlePosition",1),u([J.computed],te.prototype,"rightBottomHandlePosition",1),u([J.computed],te.prototype,"historyLocale",1),u([J.computed],te.prototype,"stickerLocale",1),u([J.computed],te.prototype,"textLocale",1),u([J.computed],te.prototype,"textDesignLocale",1);const zD=v(Ve()),Lo={position:{x:0,y:0},size:{height:0,width:0},lockResolution:!1,forceDimensions:!1,ratio:"*"},ND={identifier:"identity",outputRotation:0,rotationInDegrees:0,flipHorizontally:!1,flipVertically:!1,cropState:zD.observable.map({})};const je=v(Ve());class We{constructor(e,t){this.minCropSize=0;this.state=ND,this.configStore=e.configStore,this.minCropSize=this.configStore.measurements.crop.minSize,this.defaults=t}changeIdentifier(e){this.state.identifier=e;const t=this.state.cropState.get(e);t||this.state.cropState.set(e,y({},Lo))}changeRatio(e){const t=this.state.cropState.get(this.identifier);t&&this.state.cropState.set(this.identifier,y(y({},t),{ratio:e}))}changeSize(e){const t=this.state.cropState.get(this.identifier);t&&(e.width&&e.width>0&&(t.size.width=Math.round(e.width)),e.height&&e.height>0&&(t.size.height=Math.round(e.height)),this.state.cropState.set(this.identifier,t))}changeHeight(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.height=Math.round(e),this.state.cropState.set(this.identifier,t)))}changeWidth(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.width=Math.round(e),this.state.cropState.set(this.identifier,t)))}changePositionX(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.x=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePositionY(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.y=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePosition(e,t){const i=this.state.cropState.get(this.identifier);return i&&(e.x<=t.width-this.minCropSize&&e.x>=0&&e.y<=t.height-this.minCropSize&&e.y>=0)?(i.position.x=Math.round(e.x),i.position.y=Math.round(e.y),this.state.cropState.set(this.identifier,i),!0):!1}changeLockResolution(e){const t=this.state.cropState.get(this.identifier);t&&(t.lockResolution=e!==void 0?e:!t.lockResolution,this.state.cropState.set(this.identifier,t))}changeForceDimensions(e){const t=this.state.cropState.get(this.identifier);t&&(t.forceDimensions=e,this.state.cropState.set(this.identifier,t))}setRotation(e){this.state.rotationInDegrees=e}resetRotation(){this.state.rotationInDegrees=0}resetOutputRotation(){this.state.outputRotation=0}resetFlip(){this.state.flipHorizontally=!1,this.state.flipVertically=!1}updateFlip({flipHorizontally:e,flipVertically:t}){this.state.flipHorizontally=e,this.state.flipVertically=t}setOutputRotation(e){this.state.outputRotation=e}flipHorizontally(){this.state.flipHorizontally=!this.state.flipHorizontally}flipVertically(){this.state.flipVertically=!this.state.flipVertically}get flipCenter(){const{width:e,height:t}=this.defaults.maxCropMaskSize;return new E(e/2,t/2)}get isFlippedHorizontal(){return this.state.flipHorizontally}get isFlippedVertical(){return this.state.flipVertically}get identifier(){return this.state.identifier}get height(){return this.selectedCrop?this.selectedCrop.size.height:Lo.size.height}get width(){return this.selectedCrop?this.selectedCrop.size.width:Lo.size.width}get position(){return this.selectedCrop?this.selectedCrop.position:Lo.position}get ratio(){return this.selectedCrop?this.selectedCrop.ratio:Lo.ratio}get size(){return this.selectedCrop?this.selectedCrop.size:Lo.size}get x(){return this.selectedCrop?this.selectedCrop.position.x:Lo.position.x}get y(){return this.selectedCrop?this.selectedCrop.position.y:Lo.position.y}get lockResolution(){return this.selectedCrop?this.selectedCrop.lockResolution:Lo.lockResolution}get forceDimensions(){return this.selectedCrop?this.selectedCrop.forceDimensions:Lo.forceDimensions}get selectedCrop(){return this.state.cropState.get(this.identifier)}get rotationInDegrees(){return this.state.rotationInDegrees}get outputRotation(){return this.state.outputRotation}}u([je.observable],We.prototype,"state",2),u([je.action],We.prototype,"changeIdentifier",1),u([je.action],We.prototype,"changeRatio",1),u([je.action],We.prototype,"changeSize",1),u([je.action],We.prototype,"changeHeight",1),u([je.action],We.prototype,"changeWidth",1),u([je.action],We.prototype,"changePositionX",1),u([je.action],We.prototype,"changePositionY",1),u([je.action],We.prototype,"changePosition",1),u([je.action],We.prototype,"changeLockResolution",1),u([je.action],We.prototype,"changeForceDimensions",1),u([je.action],We.prototype,"setRotation",1),u([je.action],We.prototype,"resetRotation",1),u([je.action],We.prototype,"resetOutputRotation",1),u([je.action],We.prototype,"resetFlip",1),u([je.action],We.prototype,"updateFlip",1),u([je.action],We.prototype,"setOutputRotation",1),u([je.action],We.prototype,"flipHorizontally",1),u([je.action],We.prototype,"flipVertically",1),u([je.computed],We.prototype,"flipCenter",1),u([je.computed],We.prototype,"isFlippedHorizontal",1),u([je.computed],We.prototype,"isFlippedVertical",1),u([je.computed],We.prototype,"identifier",1),u([je.computed],We.prototype,"height",1),u([je.computed],We.prototype,"width",1),u([je.computed],We.prototype,"position",1),u([je.computed],We.prototype,"ratio",1),u([je.computed],We.prototype,"size",1),u([je.computed],We.prototype,"x",1),u([je.computed],We.prototype,"y",1),u([je.computed],We.prototype,"lockResolution",1),u([je.computed],We.prototype,"forceDimensions",1),u([je.computed],We.prototype,"selectedCrop",1),u([je.computed],We.prototype,"rotationInDegrees",1),u([je.computed],We.prototype,"outputRotation",1);const Cp=v(Ve());class UD{constructor(e){this.transforms={output:JSON.stringify(mt.IDENTITY),preview:JSON.stringify(mt.IDENTITY)};this.editor=e,this.overlayOpacity=0,this.frameOpacity=0}static rotateOutput(e,t){e%=360;switch(e){case 90:case-270:return t.swapped.multiply(-1,1);case 180:case-180:return t.multiply(-1);case 270:case-90:return t.swapped.multiply(1,-1);default:return t}}onLeave(){const{flipHorizontally:e,flipVertically:t,rotation:i,outputRotation:r}=this.transformToolStore.rotateFlipState;this.editor.overlayToolStore.identifier!=="identity"&&this.editor.overlayToolStore.changeOpacity(this.overlayOpacity),this.editor.frameToolStore.identifier!=="identity"&&this.editor.frameToolStore.changeOpacity(this.frameOpacity);const o=this.editor.previewToWorld(new E(this.transformToolStore.leftTopRespectFlip).add(new E(this.transformToolStore.rightBottomRespectFlip)).divide(2).add(new E(this.transformToolStore.unRotatedDefaults.cropMaskPosition)),!0),n=this.engineMediator.preview.container,{outputContainer:s}=this.editor;s.setResolution(Cp.toJS(this.transformToolStore.localOutputImageSize)),s.setData({flipVertically:t,flipHorizontally:e});const a=n.getScale();this.editor.overlayToolStore.correctOverlayFlip(),this.saveTransforms();let l=1;if(this.transformToolStore.lockResolution){const{cropMaskSize:m,defaultImageSize:b}=this.transformToolStore,_=this.transformToolStore.maxCropMaskSize,g={height:m.height*b.height/_.height,width:m.width*b.width/_.width};l=g.width/this.transformToolStore.localOutputImageSize.width}const d=Math.abs(a.x),c=l/(d/this.transformToolStore.defaultScale),p={x:c,y:c},h=-(i-r);s.setTransform({scale:p,position:o,rotation:h}),this.editor.engineMediator.preview.updateTransform(0,!1),this.editor.scale.setInitialTransform(),this.editor.spriteStore.updateCanvasControls(),this.editor.focusToolStore.updateCanvasControls()}onEnter(){this.editor.overlayToolStore.identifier!=="identity"&&(this.overlayOpacity=this.editor.overlayToolStore.opacity,this.editor.overlayToolStore.changeOpacity(0)),this.editor.frameToolStore.identifier!=="identity"&&(this.frameOpacity=this.editor.frameToolStore.opacity,this.editor.frameToolStore.changeOpacity(0)),this.editor.scale.setScaleToDefault();const e=this.engineMediator.preview.container,{outputContainer:t}=this.editor,i=JSON.parse(this.transforms.preview);t.setResolution(Cp.toJS(this.transformToolStore.defaultImageSize)),e.setTransform(i),t.setTransform(JSON.parse(this.transforms.output));const r=i.scale;t.setData({flipVertically:!1,flipHorizontally:!1}),this.transformToolStore.transformStore.updateFlip({flipVertically:r.y<0,flipHorizontally:r.x<0}),this.engineMediator.preview.savePreviewTransform(i);const{scale:o}=this.engineMediator.preview.calculateTransform();this.editor.scale.setInitialTransform(o.x)}rotateOutputContainer(e=!1){this.editor.outputContainer.rotate90(e),this.transformToolStore.transformStore.setOutputRotation(this.editor.outputContainer.getRotation());const{rotation:t}=this.transformToolStore.rotateFlipState;this.engineMediator.preview.updateTransform(t),Cp.runInAction(()=>{this.editor.scale.setInitialTransform();const i=this.getScaleWithFlip(t);this.engineMediator.preview.container.setScale(i),this.transformToolStore.setCropDefaults(!0),this.transformToolStore.updateCropMask()}),this.editor.render()}applyPreviewTransform(){const{rotation:e,flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=this.editor.scale.getPositionWithOffset(),o=this.getScaleWithFlip();let n=e;t&&(n=Ic(n)),i&&(n=Ic(n));const s={position:r,rotation:n,scale:o};this.engineMediator.preview.savePreviewTransform(s),this.engineMediator.preview.container.setTransform(s)}getScaleWithFlip(e=this.transformToolStore.rotateFlipState.rotation){const{flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=t?-1:1,o=i?-1:1,n=this.editor.scale.calculateScale(e);return{x:n*r,y:n*o}}saveTransforms(){const e=JSON.stringify(this.engineMediator.preview.container.getTransform()),t=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:e,output:t}}saveTransformsBasedOnFlip(){const e=this.engineMediator.preview.container.getTransform(),{scale:t}=e,{flipVertically:i,flipHorizontally:r}=this.editor.outputContainer.getData(),o=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:JSON.stringify(y(y({},e),{scale:{x:r?-t.x:t.x,y:i?-t.y:t.y}})),output:o}}get engineMediator(){return this.editor.engineMediator}get transformToolStore(){return this.editor.transformToolStore}}const G=v(Ve()),HD="identity";class ${constructor(e){this.unRotatedDefaults={cropMaskPosition:{x:0,y:0},scale:1};this.defaultAngle=0;this.dragMode=G.observable.box(!1);this.minCropSize=0;this.localSnapshotEnabled=!0;this.defaults={cropMaskPosition:{x:0,y:0},maxCropMaskSize:{width:0,height:0},imageSize:{width:0,height:0},scale:1};this.localOutputSize={width:0,height:0};this.checkIfTransformThumbnailExits=e=>{let t=this.editor.configStore.config.assetBaseUrl;const{length:i}=t;if(t[i-1]!=="/"&&(t+="/"),`${t}transform`===e)return!1;const r=new Image;try{return r.src=e,!0}catch(o){return!1}};this.reset=()=>{this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.setDefaultAngle(0);const e=this.editor.outputContainer.getRotation();e!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop(),this.editor.render()};this.changeLocalOutputSize=e=>{this.localOutputSize.height=Math.round(e.height),this.localOutputSize.width=Math.round(e.width)};this.changeDefaultScale=e=>{this.defaults.scale=e};this.changeLocalOutputHeight=e=>{this.localOutputSize.height=Math.round(e)};this.changeLocalOutputWidth=e=>{this.localOutputSize.width=Math.round(e)};this.changeLockResolution=()=>{this.transformStore.changeLockResolution(),this.addLocalSnapshot()};this.rotateClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical!==this.isFlippedHorizontal)};this.rotateAntiClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical===this.isFlippedHorizontal)};this.flipHorizontally=(e=!0)=>{this.transformStore.flipHorizontally(),this.editor.spriteStore.reverseTextHorizontally(),this.transformRender(e),e&&this.addLocalSnapshot()};this.flipVertically=(e=!0)=>{this.transformStore.flipVertically(),this.editor.spriteStore.reverseTextVertically(),this.transformRender(e),e&&this.addLocalSnapshot()};this.applyDefaultCrop=(e=!1)=>{if(this.identifier==="identity"){const{identifier:t}=this.getMatchingItem();this.changeIdentifier(t,e)}};this.updateCropMask=()=>{this.changeIdentifier(this.identifier,!0)};this.onLeftTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,s=Math.min(Math.max(0,e),r.x-o.width),a=Math.min(Math.max(0,t),r.y-o.height),l=r.x-s,d=r.y-a,c={width:Math.max(this.minCropSize,Math.min(l,n.width-s)),height:Math.max(this.minCropSize,Math.min(d,n.height-a))};if(i==="*")this.changePosition({x:s,y:a})&&this.changeCropAndOutputSize(c);else{const p=this.proportionalSize(i,c),h=new E(r).rounded.subtract({x:p.width,y:p.height});this.changePosition(h)&&this.changeCropAndOutputSize(p)}};this.onLeftBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,s=Math.min(Math.max(0,e),r.x-o.width),a=Math.max(0,t,r.y+o.height),l=r.x-s,d=a-r.y,c={width:Math.max(1,Math.min(l,n.width-s)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*"){const p=this.changeCropAndOutputSize(c);p&&this.changePositionX(s)}else{const p=this.proportionalSize(i,c);this.changePositionX(Math.round(r.x)-p.width)&&this.changeCropAndOutputSize(p)}};this.onRightTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,s=Math.max(0,e,r.x+o.width),a=Math.min(Math.max(0,t),r.y-o.height),l=s-r.x,d=r.y-a,c={width:Math.max(1,Math.min(l,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-a))};if(i==="*")this.changePositionY(a)&&this.changeCropAndOutputSize(c);else{const p=this.proportionalSize(i,c);this.changePositionY(Math.round(r.y)-p.height)&&this.changeCropAndOutputSize(p)}};this.onRightBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,s=Math.max(0,e,r.x+o.width),a=Math.max(0,t,r.y+o.height),l=s-r.x,d=a-r.y,c={width:Math.max(1,Math.min(l,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*")this.changeCropAndOutputSize(c);else{const p=this.proportionalSize(i,c);this.changeCropAndOutputSize(p)}};this.onPixelWidth=e=>{const t=JSON.stringify(G.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.height,{ratio:s}=i;if(s==="*"&&this.lockResolution&&(s=this.localOutputSize.width/this.localOutputSize.height),s==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.width),this.minCropSize),this.changeLocalOutputWidth(o);else{const a=$.placeCropMask(s,r);o=Math.max(Math.min(o,a.width),this.minCropSize),n=o/s,this.changeLocalOutputSize({height:n,width:o})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.onPixelHeight=e=>{const t=JSON.stringify(G.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.width,{ratio:s}=i;if(s==="*"&&this.lockResolution&&(s=this.localOutputSize.width/this.localOutputSize.height),s==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.height),this.minCropSize),this.changeLocalOutputHeight(o);else{const a=$.placeCropMask(s,r);o=Math.max(Math.min(o,a.height),this.minCropSize),n=o*s,this.changeLocalOutputSize({height:o,width:n})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.closestRatioReducer=e=>(t,i)=>(!t.ratio||typeof t.ratio!="number")&&(!i.ratio||typeof i.ratio!="number")?{}:!i.ratio||typeof i.ratio!="number"?t:!t.ratio||typeof t.ratio!="number"?i:Math.abs(e-t.ratio)<Math.abs(e-i.ratio)?t:i;this.closestDimensionsReducer=e=>(t,i)=>{if((!t.dimensions||t.ratio)&&(!i.dimensions||i.ratio))return{};if(!i.dimensions||i.ratio)return t;if(!t.dimensions||t.ratio)return i;const r=Math.abs(t.dimensions.x/t.dimensions.y),o=Math.abs(i.dimensions.x/i.dimensions.y);return r===o?t.dimensions.x*t.dimensions.y>i.dimensions.x*i.dimensions.y?t:i:Math.abs(e-r)<Math.abs(e-o)?t:i};this.getMatchingItem=()=>{const e=this.entityManager.items.findIndex(a=>a.identifier==="imgly_transform_common_custom");if(e!==-1)return this.entityManager.items[e];const t=this.entityManager.items.findIndex(a=>a.ratio==="*");if(t!==-1)return this.entityManager.items[t];const i=G.toJS(this.editor.outputContainer.getResolution()),r=Math.abs(i.width/i.height),o=this.entityManager.items.reduce(this.closestRatioReducer(r)),n=this.entityManager.items.reduce(this.closestDimensionsReducer(r));if(!Object.prototype.hasOwnProperty.call(o,"ratio")&&!Object.prototype.hasOwnProperty.call(n,"dimensions"))return this.entityManager.items[0];if(!Object.prototype.hasOwnProperty.call(n,"dimensions"))return o;if(!Object.prototype.hasOwnProperty.call(o,"ratio"))return n;const s=Math.abs(n.dimensions.x/n.dimensions.y);return s===o.ratio||Math.abs(r-o.ratio)<Math.abs(r-s)?o:n};this.getTransform=e=>{let t=this.entityManager.items.find(i=>i.identifier===e);return t||(t=this.getMatchingItem()),t};this.editor=e,this.selectedCategory=HD,this.transformStore=new We(e,this.defaults),this.transformations=new UD(e);const n=this.config,{enableRotation:t,enableFlip:i}=n,r=Jt(n,["enableRotation","enableFlip"]),o=this.editor.assetProvider.getAssets("transform");this.entityManager=new Ht(o,y(y({},r),{categoryKey:"",itemKey:"thumbnailURI",locale:y(y({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("transform")})),this.rect=new ct(this.editor,this.transformStore,"topLeft",!1,!1),this.rectForUi=new ct(this.editor,this.transformStore,"topLeft",!1,!0),this.minCropSize=this.editor.configStore.measurements.crop.minSize}static inRadians(e){return e*Math.PI/180}static placeCropMask(e,t){if(t.height*e>t.width){const r=t.width/e;return{height:r,width:t.width,yChanged:!0}}const i=t.height*e;return{height:t.height,width:i,yChanged:!1}}changeIdentifier(e,t=!1){this.transformStore.changeIdentifier(e);const i=this.getCropMask(e,this.defaults.imageSize);i&&(this.transformStore.changeRatio(i.ratio),this.changeLocalOutputSize(i),this.updatePreviewSizeWRTImageSize(),i.yChanged!==void 0&&this.updateInitialCropMaskPosition(i.yChanged),i.dimensions&&this.changeLocalOutputSize({width:i.dimensions.x,height:i.dimensions.y}),t&&this.addLocalSnapshot())}setDragMode(e){this.dragMode.set(e)}getCropMask(e,t){const i=this.getTransform(e);if(i){const{ratio:r,forceDimensions:o,lockDimensions:n,dimensions:s=null}=i;if(o&&this.transformStore.changeForceDimensions(o),n&&this.transformStore.changeLockResolution(n),r)switch(r){case"*":return this.changePosition({x:0,y:0}),y(y({},t),{yChanged:void 0,ratio:"*",dimensions:s});default:return y(y({},$.placeCropMask(i.ratio,t)),{ratio:i.ratio,dimensions:s})}else{const{x:a,y:l}=i.dimensions;return y(y({},$.placeCropMask(a/l,t)),{ratio:null,dimensions:s})}}return null}setCropDefaults(e=!1){const t=this.editor.outputContainer.getResolution();this.setDefaultImageSize(t);const i=this.editor.getPreviewSize(),{position:r}=this.editor.engineMediator.preview.previewTransformWithoutDpr;this.setMaxCropSize(i),this.setDefaultCropPosition({x:r.x-i.width/2,y:r.y-i.height/2}),this.changeDefaultScale(this.editor.scale.defaultScale),e||(this.unRotatedDefaults.cropMaskPosition=this.defaultCropMaskPosition,this.unRotatedDefaults.scale=this.defaultScale)}setDefaultImageSize(e){this.defaults.imageSize=y({},G.toJS(e)),this.lockResolution||(this.localOutputSize=y({},G.toJS(e)))}setMaxCropSize(e){this.defaults.maxCropMaskSize.height=e.height,this.defaults.maxCropMaskSize.width=e.width}setDefaultCropPosition(e){this.defaults.cropMaskPosition.x=e.x,this.defaults.cropMaskPosition.y=e.y}resetCrop(){this.state.cropState=G.observable.map({}),this.state.identifier="identity"}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?HD:e}pureReset(){this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.resetCrop()}changePosition(e){return this.transformStore.changePosition(e,this.defaults.maxCropMaskSize)}changePositionX(e){return this.transformStore.changePositionX(e,this.defaults.maxCropMaskSize.width)}changePositionY(e){return this.transformStore.changePositionY(e,this.defaults.maxCropMaskSize.height)}changeCropAndOutputHeight(e){return e&&e>=this.minCropSize?(this.transformStore.changeHeight(e),this.lockResolution||this.changeLocalOutputHeight(e*this.defaults.imageSize.height/this.defaults.maxCropMaskSize.height),!0):!1}changeCropAndOutputWidth(e){return e&&e>=this.minCropSize?(this.transformStore.changeWidth(e),this.lockResolution||this.changeLocalOutputWidth(e*this.defaults.imageSize.width/this.defaults.maxCropMaskSize.width),!0):!1}changeCropAndOutputSize(e){const t=this.changeCropAndOutputHeight(e.height),i=this.changeCropAndOutputWidth(e.width);return{widthChanged:t,heightChanged:i}}transformRender(e=!0){this.transformations.applyPreviewTransform(),e&&this.editor.render()}addLocalSnapshot(e=`Local ${this.locale.title}`){if(this.localSnapshotEnabled){const t=this.state,{cropState:i}=t,r=Jt(t,["cropState"]);this.editor.addLocalTransformSnapshot(y(y(y({},r),this.cropState),{localOutputSize:G.toJS(this.localOutputSize),outputSize:this.engineMediator.output.container.getResolution(),defaults:G.toJS(this.defaults),previewTransform:this.engineMediator.preview.container.getTransform(),outputTransform:this.engineMediator.output.container.getTransform()}),e)}}updateLocalStateFromHistory(e){const{tool:t}=this.editor.activeStore;t===w.TRANSFORM&&(this.transformStore.changeLockResolution(e.lockResolution),this.transformStore.changeForceDimensions(e.forceDimensions),this.transformStore.changeIdentifier(e.identifier),this.transformStore.setRotation(e.rotationInDegrees),this.setDefaultAngle(e.rotationInDegrees),this.transformStore.setOutputRotation(e.outputRotation),this.transformStore.updateFlip(e),this.engineMediator.output.container.setRotation(e.outputRotation),this.setDefaultImageSize(e.defaults.imageSize),this.localOutputSize=e.defaults.imageSize,this.changeLocalOutputSize(e.localOutputSize),this.transformStore.changeSize(e.size),this.changePosition(e.position),this.setMaxCropSize(e.defaults.maxCropMaskSize),this.setDefaultCropPosition(e.defaults.cropMaskPosition),this.changeDefaultScale(e.defaults.scale),this.engineMediator.output.container.setResolution(e.outputSize),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setTransform(e.outputTransform))}updateStateFromHistory(e){const{tool:t}=this.editor.activeStore;t!==w.TRANSFORM&&(this.engineMediator.output.container.setTransform(e.outputTransform),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setResolution(e.outputSize),this.changeLocalOutputSize(e.outputSize))}get serializableState(){const{flipHorizontally:e,flipVertically:t}=this.rotateFlipState,i=this.editor.engineMediator.output.container.getRotation()*180/Math.PI%360,{identifier:r,rotationInDegrees:o}=this,n=o*Math.PI/180;let s=i+o;s=Math.round(s/90)*90,s=s<0?s+360:s,s=(360-s)%360;const{start:a,end:l}=this.convertUIToOperationOptions(n,s);return{flipHorizontally:e,flipVertically:t,rotation:n,start:a,end:l,identifier:r,outputRotation:s}}getStartEndForOperation(e){const{leftTop:t,rightBottom:i,maxCropMaskSize:r}=this,o=t.y,n=t.x,s=i.x,a=i.y;switch(e){case 270:return{leftTop:{x:r.height-a,y:n},rightBottom:{x:r.height-o,y:s}};case 180:return{leftTop:{x:r.width-s,y:r.height-a},rightBottom:{x:r.width-n,y:r.height-o}};case 90:return{leftTop:{x:o,y:r.width-s},rightBottom:{x:a,y:r.width-n}}}return{leftTop:{x:n,y:o},rightBottom:{x:s,y:a}}}getStartEndForUI(e,t,i){const{maxCropMaskSize:r}=this,o=t.y,n=t.x,s=i.x,a=i.y;switch(e){case 90:return{leftTop:{x:o,y:r.height-s},rightBottom:{x:a,y:r.height-n}};case 180:return{leftTop:{x:r.width-s,y:r.height-a},rightBottom:{x:r.width-n,y:r.height-o}};case 270:return{leftTop:{x:r.width-a,y:n},rightBottom:{x:r.width-o,y:s}}}return{leftTop:{x:n,y:o},rightBottom:{x:s,y:a}}}convertOperationOptionsToUI({start:e,end:t,rotation:i,outputRotation:r}){const o=r===90||r===270,n=o?E.fromSize(this.defaultImageSize).swapped:E.fromSize(this.defaultImageSize),s=Math.cos(i),a=Math.sin(i),l=this.calculateScale(i),d=new E(Math.min(e.x,t.x),Math.min(e.y,t.y)),c=new E(Math.max(e.x,t.x),Math.max(e.y,t.y)),p=c.subtract(d).divide(2),h=d.add(p).multiply(n),m=h.subtract(n.multiply(.5)),b=new E(m.x*s-m.y*a,m.x*a+m.y*s).multiply(l),_=n.multiply(.5).add(b),g=_.divide(n),S=g.subtract(p.multiply(l)),x=g.add(p.multiply(l)),C=o?E.fromSize(this.maxCropMaskSize).swapped:E.fromSize(this.maxCropMaskSize),R=S.multiply(C),T=x.multiply(C),{leftTop:k,rightBottom:M}=this.getStartEndForUI(r,R,T);return{start:new E(k),end:new E(M)}}convertUIToOperationOptions(e,t){const i=t===90||t===270,r=i?E.fromSize(this.defaultImageSize).swapped:E.fromSize(this.defaultImageSize),o=i?E.fromSize(this.maxCropMaskSize).swapped:E.fromSize(this.maxCropMaskSize),n=Math.cos(-e),s=Math.sin(-e),a=this.calculateScale(e,i),{leftTop:l,rightBottom:d}=this.getStartEndForOperation(t),c=new E(l).divide(o),p=new E(d).divide(o),h=p.subtract(c).divide(2),m=c.add(h).multiply(r),b=m.subtract(r.multiply(.5)),_=new E(b.x*n-b.y*s,b.x*s+b.y*n).divide(a),g=r.multiply(.5).add(_),S=g.divide(r),x=S.subtract(h.divide(a)),C=S.add(h.divide(a));return{start:x,end:C}}calculateScale(e,t=!1){const i=t?E.fromSize(this.defaultImageSize).swapped:E.fromSize(this.defaultImageSize),r=new E(Math.abs(i.x*Math.cos(e))+Math.abs(i.y*Math.sin(e)),Math.abs(i.x*Math.sin(e))+Math.abs(i.y*Math.cos(e))),o=i.subtract(r.clone()).divide(2).abs;return o.y>o.x?o.y*2/i.y+1:o.x*2/i.x+1}updateStateFromSerialization(e,t){this.localSnapshotEnabled=t,this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop();const i=Math.round(e.rotation*180/Math.PI);this.transformStore.setRotation(i>180?i-360:i),this.applyOutputRotationFromSerialization(e),e.identifier&&this.transformStore.changeIdentifier(e.identifier);let r=e.outputRotation<0?e.outputRotation+360:e.outputRotation;if(r=(360-r)%360,e.start&&e.end){(e.end.x===0||e.end.y===0)&&(e.end.x=1,e.end.y=1);const{start:o,end:n}=this.convertOperationOptionsToUI({start:new E(e.start),end:new E(e.end),rotation:e.rotation,outputRotation:r});this.changePositionX(o.x),this.changePositionY(o.y);const s=n.x-o.x,a=n.y-o.y;this.transformStore.changeSize({width:s,height:a});const{maxCropMaskSize:l,imageSize:d}=this.defaults,c={height:a*d.height/l.height,width:s*d.width/l.width};this.changeLocalOutputSize(c)}this.editor.outputContainer.setData({flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}),e.flipHorizontally&&this.flipHorizontally(!1),e.flipVertically&&this.flipVertically(!1),this.editor.overlayToolStore.correctOverlayFlip(),this.localSnapshotEnabled=!0}applyOutputRotationFromSerialization(e){if(e.outputRotation!==void 0)switch(e.outputRotation){case 90:this.transformations.rotateOutputContainer();break;case 180:this.transformations.rotateOutputContainer(),this.transformations.rotateOutputContainer();break;case 270:this.transformations.rotateOutputContainer(!0);break}this.transformations.rotateOutputContainer(!0),this.transformations.rotateOutputContainer()}setDefaultAngle(e){this.defaultAngle=e}updateCanvasControls(e){const t=G.toJS(this.cropMaskPosition),i=G.toJS(this.cropMaskSize),r=G.toJS(this.defaults.maxCropMaskSize);this.changeCropAndOutputSize({height:r.height*i.height/e.height,width:r.width*i.width/e.width}),this.changePosition({y:r.height*t.y/e.height,x:r.width*t.x/e.width})}onLeave(){this.transformations.onLeave()}onEnter(){this.transformations.onEnter()}saveTransforms(){this.transformations.saveTransforms()}saveTransformsBasedOnFlip(){this.transformations.saveTransformsBasedOnFlip()}setRotation(e){this.transformStore.setRotation(e),this.transformRender()}rotateOutputContainer(e=!1){return Z(this,null,function*(){this.setDragMode(!0),this.transformations.rotateOutputContainer(e),yield this.editor.wait(),this.setDragMode(!1)})}applyInitialCrop(){const{identifier:e}=this.getMatchingItem();this.changeIdentifier(e,!1)}clickableCanvas(e){this.editor.clickableCanvas(e)}proportionalSize(e,t,i=this.defaults.maxCropMaskSize,r=this.minCropSize){const o={width:t.height*e,height:t.height};return(o.width>i.width||o.width<r||o.height<r)&&(o.width=t.width,o.height=t.width/e),o.width=Math.round(o.width),o.height=Math.round(o.height),o}checkAndAddSnapshot(e){const t=G.toJS(this.localOutputSize);(e.width!==t.width||e.height!==t.height)&&this.addLocalSnapshot()}updateInitialCropMaskPosition(e){const{cropMaskSize:t}=this,i=this.defaults.maxCropMaskSize;e?this.changePosition({x:0,y:Math.abs(i.height-t.height)/2}):this.changePosition({x:Math.abs(i.width-t.width)/2,y:0})}updatePreviewSizeWRTImageSize(){const e=G.toJS(this.localOutputSize),t=G.toJS(this.defaults.imageSize),i=G.toJS(this.defaults.maxCropMaskSize),r={height:i.height*e.height/t.height,width:i.width*e.width/t.width};this.transformStore.changeSize(r)}getScaleWithFlip(e=this.rotateFlipState.rotation){return this.transformations.getScaleWithFlip(e)}get cropState(){return this.transformStore.selectedCrop}get identifier(){return this.transformStore.identifier}get ratio(){return this.transformStore.ratio}get height(){return this.transformStore.height}get width(){return this.transformStore.width}get localOutputImageSize(){return this.localOutputSize}get localOutputHeight(){return this.localOutputSize.height}get localOutputWidth(){return this.localOutputSize.width}get lockResolution(){return this.transformStore.lockResolution}get forceDimensions(){return this.transformStore.forceDimensions}get rotationInDegrees(){return this.transformStore.rotationInDegrees}get outputRotation(){return this.transformStore.outputRotation}get isDragMode(){return this.dragMode.get()}get rotateFlipState(){const{flipHorizontally:e,flipVertically:t,rotationInDegrees:i,outputRotation:r}=this.transformStore.state;return{flipHorizontally:e,flipVertically:t,rotation:$.inRadians(i),outputRotation:r}}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.entityManager.categories}get entities(){return this.entityManager.getEntities(this.selectedCategoryIdentifier)}get items(){return this.entityManager.categories.reduce((e,t)=>{const i=Ht.isCategory(t)?t.items:[t];return[...e,...i]},[])}get config(){return this.editor.configStore.config[w.TRANSFORM]}get locale(){return this.editor.configStore.locale[w.TRANSFORM]}get isOptionSelected(){return this.identifier!=="identity"}get leftTop(){return this.rect.leftTop}get leftBottom(){return this.rect.leftBottom}get rightTop(){return this.rect.rightTop}get rightBottom(){return this.rect.rightBottom}get isFlippedHorizontal(){return this.transformStore.isFlippedHorizontal}get isFlippedVertical(){return this.transformStore.isFlippedVertical}get leftTopRespectFlip(){return this.rectForUi.leftTop}get leftBottomRespectFlip(){return this.rectForUi.leftBottom}get rightTopRespectFlip(){return this.rectForUi.rightTop}get rightBottomRespectFlip(){return this.rectForUi.rightBottom}get cropMaskPosition(){return this.transformStore.position}get cropMaskSize(){return this.transformStore.size}get state(){return this.transformStore.state}get defaultImageSize(){return this.defaults.imageSize}get maxCropMaskSize(){return this.defaults.maxCropMaskSize}get minCropMaskSize(){const e=this.getRatio();return e==="*"||e===1?{width:this.minCropSize,height:this.minCropSize}:e>1?{width:this.minCropSize*e,height:this.minCropSize}:{width:this.minCropSize,height:this.minCropSize*e}}get defaultCropMaskPosition(){return this.defaults.cropMaskPosition}get defaultScale(){return this.defaults.scale}get engineMediator(){return this.editor.engineMediator}getRatio(){const e=this.getTransform(this.identifier);if(e){if(Object.prototype.hasOwnProperty.call(e,"ratio"))return this.lockResolution?this.localOutputWidth/this.localOutputHeight:e.ratio;const{x:t,y:i}=e.dimensions;return t/i}return"*"}}u([G.observable],$.prototype,"selectedCategory",2),u([G.observable],$.prototype,"defaults",2),u([G.observable],$.prototype,"localOutputSize",2),u([G.action],$.prototype,"changeIdentifier",1),u([G.action],$.prototype,"setDragMode",1),u([G.action],$.prototype,"setCropDefaults",1),u([G.action],$.prototype,"setDefaultImageSize",1),u([G.action],$.prototype,"setMaxCropSize",1),u([G.action],$.prototype,"setDefaultCropPosition",1),u([G.action],$.prototype,"resetCrop",1),u([G.action],$.prototype,"toggleCategorySelection",1),u([G.action],$.prototype,"pureReset",1),u([G.action],$.prototype,"reset",2),u([G.action],$.prototype,"changePosition",1),u([G.action],$.prototype,"changePositionX",1),u([G.action],$.prototype,"changePositionY",1),u([G.action],$.prototype,"changeCropAndOutputHeight",1),u([G.action],$.prototype,"changeCropAndOutputWidth",1),u([G.action],$.prototype,"changeCropAndOutputSize",1),u([G.action],$.prototype,"onLeave",1),u([G.action],$.prototype,"onEnter",1),u([G.action],$.prototype,"changeLocalOutputSize",2),u([G.action],$.prototype,"changeDefaultScale",2),u([G.action],$.prototype,"changeLocalOutputHeight",2),u([G.action],$.prototype,"changeLocalOutputWidth",2),u([G.action],$.prototype,"changeLockResolution",2),u([G.action],$.prototype,"setRotation",1),u([G.action],$.prototype,"rotateClockwise",2),u([G.action],$.prototype,"rotateAntiClockwise",2),u([G.action],$.prototype,"rotateOutputContainer",1),u([G.action],$.prototype,"flipHorizontally",2),u([G.action],$.prototype,"flipVertically",2),u([G.action],$.prototype,"applyDefaultCrop",2),u([G.action],$.prototype,"applyInitialCrop",1),u([G.action],$.prototype,"updateCropMask",2),u([G.action],$.prototype,"clickableCanvas",1),u([G.action],$.prototype,"onLeftTop",2),u([G.action],$.prototype,"onLeftBottom",2),u([G.action],$.prototype,"onRightTop",2),u([G.action],$.prototype,"onRightBottom",2),u([G.action],$.prototype,"proportionalSize",1),u([G.action],$.prototype,"onPixelWidth",2),u([G.action],$.prototype,"onPixelHeight",2),u([G.action],$.prototype,"updateInitialCropMaskPosition",1),u([G.action],$.prototype,"updatePreviewSizeWRTImageSize",1),u([G.computed],$.prototype,"cropState",1),u([G.computed],$.prototype,"identifier",1),u([G.computed],$.prototype,"ratio",1),u([G.computed],$.prototype,"height",1),u([G.computed],$.prototype,"width",1),u([G.computed],$.prototype,"localOutputImageSize",1),u([G.computed],$.prototype,"localOutputHeight",1),u([G.computed],$.prototype,"localOutputWidth",1),u([G.computed],$.prototype,"lockResolution",1),u([G.computed],$.prototype,"forceDimensions",1),u([G.computed],$.prototype,"rotationInDegrees",1),u([G.computed],$.prototype,"outputRotation",1),u([G.computed],$.prototype,"isDragMode",1),u([G.computed],$.prototype,"rotateFlipState",1),u([G.computed],$.prototype,"selectedCategoryIdentifier",1),u([G.computed],$.prototype,"categories",1),u([G.computed],$.prototype,"entities",1),u([G.computed],$.prototype,"items",1),u([G.computed],$.prototype,"config",1),u([G.computed],$.prototype,"locale",1),u([G.computed],$.prototype,"isOptionSelected",1),u([G.computed],$.prototype,"leftTop",1),u([G.computed],$.prototype,"leftBottom",1),u([G.computed],$.prototype,"rightTop",1),u([G.computed],$.prototype,"rightBottom",1),u([G.computed],$.prototype,"isFlippedHorizontal",1),u([G.computed],$.prototype,"isFlippedVertical",1),u([G.computed],$.prototype,"leftTopRespectFlip",1),u([G.computed],$.prototype,"leftBottomRespectFlip",1),u([G.computed],$.prototype,"rightTopRespectFlip",1),u([G.computed],$.prototype,"rightBottomRespectFlip",1),u([G.computed],$.prototype,"cropMaskPosition",1),u([G.computed],$.prototype,"cropMaskSize",1),u([G.computed],$.prototype,"state",1),u([G.computed],$.prototype,"defaultImageSize",1),u([G.computed],$.prototype,"maxCropMaskSize",1),u([G.computed],$.prototype,"minCropMaskSize",1),u([G.computed],$.prototype,"defaultCropMaskPosition",1),u([G.computed],$.prototype,"defaultScale",1);const Mc=v(Ve());class It{constructor(e){this.checkImageResize=()=>{this.engine.on(ia.BEGAN_IMAGE_DOWNSCALING,()=>{this.modalStore.showInfoModal("resizing")}),this.engine.on(ia.IMAGE_DOWNSCALED,()=>{})};this.init=e=>{const t=this.historyStore.isDirty();t?this.modalStore.showActionModal({type:ot.WARNING,identifier:"discardChanges",handleConfirm:()=>{this.setImage(e),this.resetToolStates()},handleDismiss:()=>{this.setImage(e,!0)}}):this.setImage(e,!0).then(()=>{const{engine:i,displayCanvasRendererWarning:r}=this.configStore.config;i.preferredRenderer==="canvas"&&r&&this.modalStore.showActionModal({type:ot.WARNING,identifier:"unsupportedWebGLRenderer",handleConfirm:()=>{this.modalStore.hideModal()}})}),this.historyStore.reset(),this.libraryStore.fetchImages()};this.setImage=(e,t=!1)=>Z(this,null,function*(){try{this.modalStore.showInfoModal(this.configStore.config.displayResizeWarning?"resizing":"loading"),this.scale.defaultScale=1,this.scale.resetOffset(),yield this.activeStore.setImage(e),yield this.engineMediator.image.addImageToContainer(),this.engineMediator.output.applyNewImageTransform(),this.engineMediator.preview.updateTransform(),this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.historyStore.addInitialSnapshot();const{flipHorizontally:i,flipVertically:r}=this.transformToolStore.rotateFlipState;this.outputContainer.setData({flipVertically:r,flipHorizontally:i}),t?(this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls(),this.transformToolStore.resetCrop(),this.transformToolStore.applyDefaultCrop(),this.transformToolStore.saveTransformsBasedOnFlip(),this.transformToolStore.onEnter(),this.transformToolStore.setRotation(this.transformToolStore.rotationInDegrees),this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()):this.transformToolStore.saveTransforms(),this.snappingStore.calculatePreviewTopLeftPosition(),yield this.renderPromise(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"&&this.filterToolStore.setImageAndGetPreviews();const o=this.activeStore.tool;o||this.onReady(),this.modalStore.hideModal()}catch(i){this.configStore.events.onErrorImageLoading(i),this.modalStore.hideModal(),this.modalStore.showActionModal({type:ot.ERROR,identifier:i.identifier?i.identifier:"rendering",error:i,handleConfirm:()=>{window.location.reload()}})}});this.onToolChange=(e,t=null,i=!0)=>{if(e===t)return;if(this.engineMediator.preview.container){if([e,t].indexOf(w.TRANSFORM)!==-1){const{canvasSize:r}=this.canvasStore,o=this.configStore.measurements.basicToolControlBar.controlsBarHeight;if(e===w.TRANSFORM){this.transformToolStore.onLeave(),this.historyStore.removeTransformLocalSnapshots();const n=this.engineMediator.preview.container.getScale().x,s=this.engineMediator.output.container.getResolution(),{defaultImageSize:a}=this.transformToolStore,l=n!==1||a.width!==s.width||a.height!==s.height;l&&this.addSnapshot(void 0,be.EDIT,this.configStore.locale.transform.title),this.snappingStore.calculatePreviewTopLeftPosition(),this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height+o,this.resize(!0))}else t===w.TRANSFORM&&(this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height-o,this.resize(),this.render()),this.transformToolStore.onEnter(),this.transformToolStore.addLocalSnapshot(),this.historyStore.saveTransformLocalSnapshotIndex())}else this.scale.resetOffset(),this.scale.resetPosition(),this.scale.setScaleToDefault(),this.scale.scaleRender(!0);i&&this.render()}};this.resize=(e=!1)=>{try{this.transformToolStore.applyDefaultCrop(),this.canvasStore.updateCanvasDimensions();const t=Mc.toJS(this.transformToolStore.maxCropMaskSize),i=this.activeStore.tool===w.TRANSFORM;(!i||e)&&this.transformToolStore.onEnter();const r=this.engineMediator.preview.container.getRotation(),o=this.engineMediator.preview.updateTransform(r);if(o){this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.transformToolStore.updateCanvasControls(t),this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls();const n=this.transformToolStore.getScaleWithFlip(r);this.engineMediator.preview.container.setScale(n),(!i||e)&&(this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()),this.snappingStore.calculatePreviewTopLeftPosition(),this.render()}}catch(t){this.modalStore.showActionModal({type:ot.ERROR,identifier:"rendering",handleConfirm:()=>{window.location.reload()}})}};this.export=(i={})=>{var{preventExportEvent:e}=i,t=Jt(i,["preventExportEvent"]);return new Promise((r,o)=>{this.modalStore.showInfoModal("exporting");const n=this.activeStore.tool===w.TRANSFORM;n&&this.transformToolStore.onLeave();const{config:s}=this.configStore,a=y(y({},s.export.image),t),{exportType:l,format:d,quality:c,enableDownload:p}=a;this.engineMediator.engine.export(l,d,c).then(h=>{p&&this.triggerFileDownload(s.export.filename,d,l,h),e||this.configStore.events.onExport(h),r(h),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal(),this.historyStore.isDirtySinceSave=!1}).catch(h=>{o(h),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal()})})};this.serialize=({image:e}={image:!0})=>this.serializationMediator.serialize({image:e});this.deserialize=e=>this.serializationMediator.deserialize(e);this.close=()=>{this.historyStore.isDirtySinceSave&&this.configStore.config.displayCloseWarning?this.modalStore.showActionModal({type:ot.WARNING,identifier:"unsavedChanges",handleConfirm:()=>{this.configStore.events.onClose()}}):this.configStore.events.onClose()};this.hasChanges=()=>this.historyStore.isDirty();this.wait=(e=0)=>new Promise(t=>setTimeout(t,e));this.clickableCanvas=e=>Z(this,null,function*(){e?(yield new Promise(t=>setTimeout(t,0)),this.canvasStore.enableCanvasClick()):this.canvasStore.disableCanvasClick()});this.onReady=()=>Z(this,null,function*(){const{layout:e,forceCrop:t}=this.configStore.config;if(e==="advanced"&&this.activeStore.selectTool(this.configStore.defaultTool),t){const i=this.transformToolStore.localOutputImageSize,r=i.width/i.height,o=this.transformToolStore.entityManager.items.map(n=>n.ratio==="*"||n.ratio?n.ratio:n.dimensions.x/n.dimensions.y);o.indexOf("*")!==-1?console.error('ForceCrop will not work if "*" is one of the ratios'):o.indexOf(r.toFixed(2))===-1&&this.activeStore.selectTool(w.TRANSFORM)}this.configStore.events.onEditorReady()});this.addSnapshot=(e,t,i)=>{this.historyStore.addSnapshot(e,t,i)};this.addLocalTransformSnapshot=(e,t,i=be.EDIT)=>{this.historyStore.addSnapshot({localTransform:e},i,t)};this.resetToolStates=()=>{this.filterToolStore.pureReset(),this.focusToolStore.pureReset(),this.adjustmentsToolStore.pureReset(),this.overlayToolStore.pureReset(),this.frameToolStore.pureReset(),this.brushToolStore.pureReset(),this.spriteStore.pureReset(),this.transformToolStore.pureReset(),this.historyStore.reset(),this.render()};this.getAssetPath=e=>this.assetProvider.getPathForCategory(e);this.render=()=>Z(this,null,function*(){yield this.renderPromise()});this.applyFlipToPreview=e=>this.engineMediator.previewSpaceToFlippedPreviewSpace(e);this.getPreviewSize=()=>{const{width:e,height:t}=this.engine.getOutputDimensions();return e&&t?{width:Math.round(this.worldToPreview(this.outputToWorld(e))),height:Math.round(this.worldToPreview(this.outputToWorld(t)))}:{height:t,width:e}};this.triggerFileDownload=(e,t,i,r)=>{const o=t===Ut.JPEG&&i!==ci.MSBLOB?".jpeg":".png",n=e+o,s=this.blobFromExportData(r);this.triggerBlobDownload(n,s)};this.triggerBlobDownload=(e,t)=>{if(navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{const i=document.createElement("a"),r=URL.createObjectURL(t);i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),lS()||URL.revokeObjectURL(r)}};this.blobFromExportData=e=>typeof e=="string"?q_(e):e instanceof HTMLImageElement?q_(e.src):e;this.configStore=new io;const t=this.configStore.saveConfig(e);if(this.engineMediator=new GD(this),this.serializationMediator=new $_(this),this.spriteStore=new te(this),this.scale=new oi(this),this.filterToolStore=new Xt(this),this.adjustmentsToolStore=new nt(this),this.focusToolStore=new ze(this),this.overlayToolStore=new si(this),this.frameToolStore=new Gt(this),this.brushToolStore=new Mt(this),this.transformToolStore=new $(this),this.libraryStore=new Bi(this),this.modalStore=new Po(this),this.snappingStore=new Jn(this),this.activeStore=new pn(this),this.canvasStore=new Fr(this),this.historyStore=new Rc(this),this.modalStore.showInfoModal("loading"),this.libraryStore.initProvider(t),this.configStore.config.displayResizeWarning&&this.checkImageResize(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"){const i=this.configStore.config.engine;this.previewThumbnails=new W_(y(y({},i),{license:this.configStore.config.license,assetProvider:this.configStore.assetProvider}))}}static get defaultColors(){return Object.keys(gr).map(e=>{const t=gr[e];return{identifier:e,color:t,colorString:Yn(t)}})}static get defaultBackgroundColors(){return Object.keys(E_).map(e=>{const t=E_[e];return{identifier:e,color:t,colorString:Yn(t)}})}static get devicePixelRatio(){return window.devicePixelRatio||1}get shortestOutputSide(){const e=this.outputContainer.getBounds();return Math.min(e.width,e.height)}get assetProvider(){return this.configStore.assetProvider}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get orderHelper(){return this.engineMediator.orderHelper}renderPromise(){return this.engineMediator.render(this.engineMediator.preview.container)}previewToWorld(e,t){return nn(e)?this.engineMediator.previewSpaceToWorldSpace(e,t):this.engineMediator.previewSpaceToWorldSpace(e,t)}worldToPreview(e){return nn(e)?this.engineMediator.worldSpaceToPreviewSpace(e):this.engineMediator.worldSpaceToPreviewSpace(e)}worldSizeToPreview(e){return{width:this.engineMediator.worldSpaceToPreviewSpace(e.width),height:this.engineMediator.worldSpaceToPreviewSpace(e.height)}}previewSizeToWorld(e,t){return{width:this.engineMediator.previewSpaceToWorldSpace(e.width,t),height:this.engineMediator.previewSpaceToWorldSpace(e.height,t)}}outputToWorld(e){return nn(e)?this.engineMediator.outputSpaceToWorldSpace(e):this.engineMediator.outputSpaceToWorldSpace(e)}previewToOutput(e){return nn(e)?this.engineMediator.previewSpaceToOutputSpace(e):this.engineMediator.previewSpaceToOutputSpace(e)}get outputContainer(){return this.engineMediator.output.container}}u([Mc.action],It.prototype,"resize",2),u([Mc.action],It.prototype,"export",2),u([Mc.action],It.prototype,"clickableCanvas",2);function tx(e,t){const i=e.width/e.height,r=t.width/t.height;return i>r?e.height/t.height:e.width/t.width}const so=v(Ve()),UU={transform:mt.IDENTITY};class ca{constructor(e){this.initialTransform=mt.IDENTITY;this.editor=e,this.state=so.observable(UU)}createPreview(e){this.container=this.editor.engine.createPreview(e)}updateTransform(e=0,t=!0){const i=this.calculateTransform(e);return i.scale.x?(t?this.saveInitialTransform(i):this.savePreviewTransform(i),this.container.setTransform(this.state.transform),!0):!1}saveInitialTransform(e){this.initialTransform=e,this.savePreviewTransform(e)}savePreviewTransform(e){so.runInAction(()=>{this.state.transform.position=e.position,this.state.transform.scale=e.scale,this.state.transform.rotation=e.rotation;const t=It.devicePixelRatio;this.previewTransformWithoutDpr={position:new E(e.position).divide(t),scale:new E(e.scale).divide(t),rotation:e.rotation}})}get transform(){return this.state.transform}get position(){return this.state.transform.position}get scale(){return this.state.transform.scale}get rotation(){return this.state.transform.rotation}calculateTransform(e=0){const t=It.devicePixelRatio,{width:i,height:r}=this.editor.canvasStore.canvasSize,o=this.editor.engine.getOutputDimensions();let n=tx({width:i,height:r},o),s=.95;window.innerWidth<600&&(s=.98),n*=s;const a=r-o.height*n,l=this.editor.configStore.measurements.mainCanvasActionBar.height*2;a<l&&(n=tx({width:i,height:r-l},o),n*=s),n*=t;const d={x:i*t/2,y:r*t/2},c={x:n,y:n};return new mt(d,c,e)}}u([so.action],ca.prototype,"updateTransform",1),u([so.action],ca.prototype,"savePreviewTransform",1),u([so.computed],ca.prototype,"transform",1),u([so.computed],ca.prototype,"position",1),u([so.computed],ca.prototype,"scale",1),u([so.computed],ca.prototype,"rotation",1);class Zn{constructor(){this.imageContainerOrder=[];this.spriteContainerOrder=[]}static checkTool(e){if([w.STICKER,w.TEXT,w.TEXT_DESIGN,w.BRUSH,w.FRAME].indexOf(e)!==-1)throw new Error("addIndex is used for non sprites, for sprites use addSprite")}static remove(e,t){const i=t.findIndex(r=>r===e);i!==-1&&t.splice(i,1);return}static indexForOrder(e,t,i){const r=e[i],o=t.findIndex(s=>s===i);if(o!==-1)return{index:o,order:t};const{length:n}=t;if(n){let s;for(s=0;s<n;s+=1){const a=t[s],l=e[a];if(r<l)return t=[...t.slice(0,s),i,...t.slice(s)],{index:s,order:t}}}return t.push(i),{index:t.length-1,order:t}}addIndex(e){Zn.checkTool(e);const{index:t,order:i}=Zn.indexForOrder(Zn.IMAGE_CONTAINER_INDEX,this.imageContainerOrder,e);return this.imageContainerOrder=i,t}removeIndex(e){Zn.checkTool(e),Zn.remove(e,this.imageContainerOrder)}addSprite(e){return this.spriteContainerOrder.push(e),this.imageContainerOrder.length+this.spriteContainerOrder.length-1}removeSprite(e){Zn.remove(e,this.spriteContainerOrder)}renameSprite(e,t){const i=this.spriteContainerOrder.findIndex(r=>r===e);i!==-1&&(this.spriteContainerOrder[i]=t)}bringToFront(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t!==-1&&(this.spriteContainerOrder.splice(t,1),this.spriteContainerOrder.push(e)),this.getLastSpriteIndex()}getLastSpriteId(){const{length:e}=this.spriteContainerOrder;return this.spriteContainerOrder[e-1]}getSpriteIndex(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t+this.imageContainerOrder.length-1}getLastSpriteIndex(){return this.imageContainerOrder.length+this.spriteContainerOrder.length-1}}Zn.IMAGE_CONTAINER_INDEX={[w.ART_FILTER]:0,[w.FILTER]:1,[w.ADJUSTMENT]:2,[w.FOCUS]:3,[w.OVERLAY]:4};class GD{constructor(e){this.orderHelper=new Zn;const t=e.configStore.config.engine;this.engine=new fp(y(y({},t),{license:e.configStore.config.license,assetProvider:e.configStore.assetProvider})),this.image=new pD(e),this.output=new uD(e),this.preview=new ca(e),this.editor=e}render(e){return this.engine.render(e)}previewSpaceToWorldSpace(e,t){const i=this.preview.previewTransformWithoutDpr;if(nn(e)){const r=this.editor.engine.convertPointFromPreviewIntoWorldSpace(E.ZERO,i,t),o=this.editor.engine.convertPointFromPreviewIntoWorldSpace({x:e,y:0},i,t);return E.distance(new E(r),new E(o))}return this.editor.engine.convertPointFromPreviewIntoWorldSpace(e,i,t)}worldSpaceToPreviewSpace(e){const t=this.preview.previewTransformWithoutDpr;if(nn(e)){const i=this.editor.engine.convertPointFromWorldIntoPreviewSpace(E.ZERO,t),r=this.editor.engine.convertPointFromWorldIntoPreviewSpace({x:e,y:0},t);return E.distance(new E(i),new E(r))}return this.editor.engine.convertPointFromWorldIntoPreviewSpace(e,t)}outputSpaceToWorldSpace(e){return nn(e)?se.getScalarInWorldSpace(e,this.editor.engine.getOutputContainer()):se.getPointInWorldSpace(e,this.editor.engine.getOutputContainer())}previewSpaceToOutputSpace(e){const t=this.preview.previewTransformWithoutDpr;if(nn(e)){const i=this.editor.engine.convertPointFromPreviewIntoOutputSpace(E.ZERO,t),r=this.editor.engine.convertPointFromPreviewIntoOutputSpace({x:e,y:0},t);return E.distance(new E(i),new E(r))}return this.editor.engine.convertPointFromPreviewIntoOutputSpace(e,t)}previewSpaceToFlippedPreviewSpace(e){return this.editor.engine.convertPointFromPreviewIntoFlippedPreviewSpace(e)}}const Qi=v(Ve()),jD=[[0,0],[0,1],[1,0],[1,1]],HU=[[0,1,2,3],[2,3,0,1],[1,0,3,2],[3,2,1,0]];class ct{constructor(e,t,i="center",r=!0,o=!1){this.considerRotation=!0;this.considerFlip=!0;this.store=t,this.m=i==="center"?ct.movePivotTo([.5,.5]):jD,this.considerRotation=r,this.considerFlip=o,this.configStore=e.configStore}static getFlippedEdgeIndex(e,t,i){return HU[(t?1:0)+(i?2:0)][e]}static movePivotTo(e){return jD.map(t=>[t[0]-e[0],t[1]-e[1]])}get position(){return this.store.position}get size(){return this.store.size}get rotation(){return this.considerRotation?this.store.rotationWRTOutputRotation:0}get flipHorizontally(){return this.considerFlip?this.store.isFlippedHorizontal:!1}get flipVertically(){return this.considerFlip?this.store.isFlippedVertical:!1}get flipCenter(){return this.considerFlip?this.store.flipCenter:null}handleOrigin(e,t,i){const r=ct.getFlippedEdgeIndex(e,t,i),o=this.m[r][0]*this.size.width,n=this.m[r][1]*this.size.height;return{width:o,height:n}}get leftTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(0,t,i);return ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(2,t,i);return ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,ct.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftMid(){const e=new E(this.leftTop),t=new E(this.leftBottom);return e.add(t).divide(2)}get rightMid(){const e=new E(this.rightTop),t=new E(this.rightBottom);return e.add(t).divide(2)}}ct.coordinatesWithRotation=({width:e,height:t},i,r,o,n,s)=>{let a=e*Math.cos(i)-t*Math.sin(i)+s.x,l=e*Math.sin(i)+t*Math.cos(i)+s.y;return r&&(a=n.x*2-a),o&&(l=n.y*2-l),new E({x:a,y:l}).rounded},u([Qi.computed],ct.prototype,"position",1),u([Qi.computed],ct.prototype,"size",1),u([Qi.computed],ct.prototype,"rotation",1),u([Qi.computed],ct.prototype,"flipHorizontally",1),u([Qi.computed],ct.prototype,"flipVertically",1),u([Qi.computed],ct.prototype,"flipCenter",1),u([Qi.computed],ct.prototype,"leftTop",1),u([Qi.computed],ct.prototype,"leftBottom",1),u([Qi.computed],ct.prototype,"rightTop",1),u([Qi.computed],ct.prototype,"rightBottom",1),u([Qi.computed],ct.prototype,"leftBottomHandle",1),u([Qi.computed],ct.prototype,"rightBottomHandle",1),u([Qi.computed],ct.prototype,"leftMid",1),u([Qi.computed],ct.prototype,"rightMid",1);const Lc=(e,t=0,i=3)=>{const r=Math.tan(t),o=Math.sqrt(r**2+1);return{x:e.x+i/o,y:e.y+i*r/o}};const Ne=v(Ve());class ze{constructor(e){this.changeIntensity=e=>{const t=this.focusStore.setEffectProperties({blurRadius:e});t&&(this.focusStore.changeBlurRadius(this.identifier,t.blurRadius),this.editor.render())};this.reset=()=>{this.pureReset(),this.editor.render(),this.addSnapshot(be.DELETE,this.locale.controls.buttonReset)};this.editor=e,this.focusStore=new Ji(this.editor);const t=this.editor.assetProvider.getAssets("focus");this.entityManager=new Ht([{identifier:"",name:"",items:t}],y(y({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("focus")}))}static get minIntensity(){return 0}static doesFocusIdentifierExist(e){return Object.keys(Ce).map(t=>Ce[t]).findIndex(t=>t===e)!==-1}selectFocus(e){if(e!==this.identifier){this.focusStore.removeFocus();const t=this.maxIntensity*.2,{width:i}=this.editor.engine.getOutputContainer().getBounds(),r=this.editor.shortestOutputSide*.2;switch(e){case Ce.LINEAR:const o=this.editor.outputToWorld({x:-i/2,y:0}),n=this.editor.outputToWorld({x:i/2,y:0});this.setLinearFocus({start:o,end:n,blurRadius:t});break;case Ce.RADIAL:const s=this.editor.outputToWorld({x:0,y:0});this.setRadialFocus({center:s,radius:r,blurRadius:t});break;case Ce.MIRRORED:const a=this.editor.outputToWorld({x:0,y:0}),l=r,d=this.editor.outputToWorld(Lc({x:0,y:0},0));this.setMirroredFocus({mirrorAxisOrigin:a,clearAreaWidth:l,blurRadius:t,mirrorAxisDirection:d});break;case Ce.GAUSSIAN:this.setGaussianFocus({blurRadius:t})}this.focusStore.selectFocus(e,t),this.editor.render(),this.addSnapshot(be.ADD,w.FOCUS)}}toolSnapshot(e){this.addSnapshot(be.EDIT,e)}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}clickableCanvas(e){this.editor.clickableCanvas(e)}pureReset(){this.focusStore.removeFocus(),this.focusStore.reset()}setStart(e){const t=this.focusStore.setEffectProperties({start:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearStart(this.editor.worldToPreview(t.start)),this.editor.render())}setEnd(e){const t=this.focusStore.setEffectProperties({end:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearEnd(this.editor.worldToPreview(t.end)),this.editor.render())}setCenter(e){const t=this.focusStore.setEffectProperties({center:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialCenter(this.editor.worldToPreview(t.center)),this.editor.render())}setRadius(e){const t=this.focusStore.setEffectProperties({radius:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialRadius(this.editor.worldToPreview(t.radius)),this.editor.render())}setOrigin(e){const t=this.focusStore.setEffectProperties({mirrorAxisOrigin:this.editor.previewToWorld(e),mirrorAxisDirection:this.editor.previewToWorld(Lc(e,this.rotation))});t&&(this.focusStore.setMirroredOrigin(this.editor.worldToPreview(t.mirrorAxisOrigin)),this.editor.render())}setSize(e){const t=this.focusStore.setEffectProperties({clearAreaWidth:this.editor.previewToWorld(e)});t&&(this.focusStore.setMirroredSize(this.editor.worldToPreview(t.clearAreaWidth)),this.editor.render())}setRotation(e){this.focusStore.setEffectProperties({mirrorAxisDirection:this.editor.previewToWorld(Lc(this.origin,e))}),this.focusStore.setMirroredRotation(e),this.editor.render()}updateStateFromHistory(e,t){this.focusStore.removeFocus();const{magnitude:i}=t;Ne.runInAction(()=>{switch(e.identifier){case Ce.LINEAR:this.focusStore.selectFocus(Ce.LINEAR),this.setLinearFocus({start:this.editor.previewToWorld(new E(e.linear.start).multiply(t)),end:this.editor.previewToWorld(new E(e.linear.end).multiply(t)),blurRadius:e.linear.blurRadius});break;case Ce.GAUSSIAN:this.focusStore.selectFocus(Ce.GAUSSIAN),this.setGaussianFocus({blurRadius:e.gaussian.blurRadius});break;case Ce.RADIAL:this.focusStore.selectFocus(Ce.RADIAL),this.setRadialFocus({center:this.editor.previewToWorld(new E(e.radial.center).multiply(t)),radius:this.editor.previewToWorld(e.radial.radius*i),blurRadius:e.radial.blurRadius});break;case Ce.MIRRORED:this.focusStore.selectFocus(Ce.MIRRORED),this.setMirroredFocus({mirrorAxisOrigin:this.editor.previewToWorld(new E(e.mirrored.origin).multiply(t)),clearAreaWidth:this.editor.previewToWorld(e.mirrored.size*i),blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:this.editor.previewToWorld(Lc(e.mirrored.origin,e.mirrored.rotation))});break;case"identity":this.pureReset();break}})}updateStateFromSerialization(e){return Z(this,null,function*(){if(ze.doesFocusIdentifierExist(e.identifier))this.focusStore.removeFocus(),Ne.runInAction(()=>{this.focusStore.selectFocus(e.identifier);switch(e.identifier){case Ce.LINEAR:this.setLinearFocus(e.linear);break;case Ce.GAUSSIAN:this.setGaussianFocus(e.gaussian);break;case Ce.RADIAL:this.setRadialFocus(e.radial);break;case Ce.MIRRORED:this.setMirroredFocus({mirrorAxisOrigin:e.mirrored.origin,clearAreaWidth:e.mirrored.size,blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:Lc(e.mirrored.origin,e.mirrored.rotation)});break}});else throw new Error(`Focus identifier ${e.identifier} doesn't exist`)})}updateCanvasControls(){this.focusStore.updateFromEngineState(this.identifier)}get state(){return this.focusStore.state}get serializableState(){switch(this.identifier){case Ce.LINEAR:return{identifier:this.identifier,linear:this.focusStore.getEffectProperties()};case Ce.RADIAL:return{identifier:this.identifier,radial:this.focusStore.getEffectProperties()};case Ce.MIRRORED:const e=this.focusStore.getEffectProperties();return{identifier:this.identifier,mirrored:{blurRadius:e.blurRadius,origin:e.mirrorAxisOrigin,rotation:Ne.toJS(this.state.mirrored.rotation),size:e.clearAreaWidth}};case Ce.GAUSSIAN:return{identifier:this.identifier,gaussian:this.focusStore.getEffectProperties()}}return Tl}getFocusStateForHistory(){const e=this.editor.canvasStore.sizeVector,{linear:t}=this.focusStore.state,{radial:i}=this.focusStore.state,{mirrored:r}=this.focusStore.state,o=e,{magnitude:n}=o;return y(y({},this.focusStore.state),{linear:y(y({},t),{start:new E(t.start).divide(o),end:new E(t.end).divide(o)}),radial:y(y({},i),{center:new E(i.center).divide(o),radius:i.radius/n}),mirrored:y(y({},r),{origin:new E(r.origin).divide(o),size:r.size/n}),gaussian:y({},this.focusStore.state.gaussian)})}get start(){return this.focusStore.state.linear.start}get startOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.start);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get end(){return this.focusStore.state.linear.end}get endOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.end);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get center(){return this.focusStore.state.radial.center}get radius(){return this.focusStore.state.radial.radius}get origin(){return this.focusStore.state.mirrored.origin}get rotation(){return this.focusStore.state.mirrored.rotation}get rotationOnPreview(){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();return up({rotation:this.focusStore.state.mirrored.rotation,flipHorizontally:e,flipVertically:t})}get size(){return this.focusStore.state.mirrored.size}get mirroredAreaWidth(){const{width:e,height:t}=this.editor.canvasStore.canvasSize;return Math.sqrt(e**2+t**2)*2}get identifier(){return this.state.identifier}get intensity(){return this.identifier==="identity"?Tl.gaussian.blurRadius:this.state[this.identifier].blurRadius}get maxIntensity(){return this.editor.shortestOutputSide/10}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[w.FOCUS]}get locale(){return this.editor.configStore.locale[w.FOCUS]}get entities(){return this.entityManager.items}setGaussianFocus({blurRadius:e}){this.focusStore.setGaussianFocus({blurRadius:e})}setLinearFocus({start:e,end:t,blurRadius:i}){this.focusStore.setLinearFocus({start:e,end:t,blurRadius:i})}setRadialFocus({center:e,radius:t,blurRadius:i}){this.focusStore.setRadialFocus({center:e,radius:t,blurRadius:i})}setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r}){this.focusStore.setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r})}}u([Ne.action],ze.prototype,"selectFocus",1),u([Ne.action],ze.prototype,"changeIntensity",2),u([Ne.action],ze.prototype,"clickableCanvas",1),u([Ne.action],ze.prototype,"pureReset",1),u([Ne.action],ze.prototype,"reset",2),u([Ne.action],ze.prototype,"setStart",1),u([Ne.action],ze.prototype,"setEnd",1),u([Ne.action],ze.prototype,"setCenter",1),u([Ne.action],ze.prototype,"setRadius",1),u([Ne.action],ze.prototype,"setOrigin",1),u([Ne.action],ze.prototype,"setSize",1),u([Ne.action],ze.prototype,"setRotation",1),u([Ne.action],ze.prototype,"updateStateFromHistory",1),u([Ne.action],ze.prototype,"updateStateFromSerialization",1),u([Ne.action],ze.prototype,"updateCanvasControls",1),u([Ne.computed],ze.prototype,"state",1),u([Ne.computed],ze.prototype,"start",1),u([Ne.computed],ze.prototype,"startOnPreview",1),u([Ne.computed],ze.prototype,"end",1),u([Ne.computed],ze.prototype,"endOnPreview",1),u([Ne.computed],ze.prototype,"center",1),u([Ne.computed],ze.prototype,"radius",1),u([Ne.computed],ze.prototype,"origin",1),u([Ne.computed],ze.prototype,"rotation",1),u([Ne.computed],ze.prototype,"rotationOnPreview",1),u([Ne.computed],ze.prototype,"size",1),u([Ne.computed],ze.prototype,"mirroredAreaWidth",1),u([Ne.computed],ze.prototype,"identifier",1),u([Ne.computed],ze.prototype,"intensity",1),u([Ne.computed],ze.prototype,"maxIntensity",1),u([Ne.computed],ze.prototype,"isOptionSelected",1),u([Ne.computed],ze.prototype,"config",1),u([Ne.computed],ze.prototype,"locale",1),u([Ne.computed],ze.prototype,"entities",1);const GU=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g),WD=e=>e.replace(GU,"");const VD=v(require("styled-components")),KD=VD.default.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  background: ${e=>e.theme.background};
  color: ${e=>e.theme.foreground};
  display: flex;
  flex-direction: row;
  overflow-y: hidden;
  overflow-x: hidden;
  -webkit-touch-callout: none;
  user-select: none;
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
    /* css reset for a global box-sizing: border-box */
    box-sizing: content-box;
    /* todo: fix the issue with these settings */
    font-size: inherit;
    color: inherit;
    line-height: normal;
  }
`;var $D=KD;KD.defaultProps={theme:X};const zc=v(require("styled-components")),jU=zc.keyframes`
  from { transform: translate(-50%, 0%); }
  to { transform: translate(-50%, 50%); }
`,WU=zc.default.div`
  position: absolute;
  top: ${e=>e.position.y}px;
  left: ${e=>e.position.x}px;
  transform: translate(-50%, 50%);
  background: black;
  color: white;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  padding: 10px 16px;
  text-align: center;
  z-index: ${e=>e.theme.measurements.zIndex.toast};
  visibility: hidden;

  ${({show:e})=>e&&zc.css`
      visibility: visible;
      animation: ${jU} 0.5s, fadeout 0.5s 2.5s;
    `}
`;var qD=WU;const Rt=v(Ve()),Qt=v(require("react")),Nc=v(require("react-dom"));function ha(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ha=function(t){return typeof t}:ha=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ha(e)}function yg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XD(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vg(e,t,i){return t&&XD(e.prototype,t),i&&XD(e,i),e}function Sp(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function rx(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ix(e,t)}function Tp(e){return Tp=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},Tp(e)}function ix(e,t){return ix=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},ix(e,t)}function VU(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ox(e,t){return t&&(typeof t=="object"||typeof t=="function")?t:VU(e)}function KU(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function YD(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Lt=YD(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=typeof Symbol=="function"&&Symbol.for,r=i?Symbol.for("react.element"):60103,o=i?Symbol.for("react.portal"):60106,n=i?Symbol.for("react.fragment"):60107,s=i?Symbol.for("react.strict_mode"):60108,a=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,c=i?Symbol.for("react.async_mode"):60111,p=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,m=i?Symbol.for("react.suspense"):60113,b=i?Symbol.for("react.memo"):60115,_=i?Symbol.for("react.lazy"):60116;function g(x){if(typeof x=="object"&&x!==null){var C=x.$$typeof;switch(C){case r:switch(x=x.type,x){case c:case p:case n:case a:case s:return x;default:switch(x=x&&x.$$typeof,x){case d:case h:case l:return x;default:return C}}case o:return C}}}function S(x){return g(x)===p}t.typeOf=g,t.AsyncMode=c,t.ConcurrentMode=p,t.ContextConsumer=d,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=n,t.Profiler=a,t.Portal=o,t.StrictMode=s,t.isValidElementType=function(x){return typeof x=="string"||typeof x=="function"||x===n||x===p||x===a||x===s||x===m||typeof x=="object"&&x!==null&&(x.$$typeof===_||x.$$typeof===b||x.$$typeof===l||x.$$typeof===d||x.$$typeof===h)},t.isAsyncMode=function(x){return S(x)||g(x)===c},t.isConcurrentMode=S,t.isContextConsumer=function(x){return g(x)===d},t.isContextProvider=function(x){return g(x)===l},t.isElement=function(x){return typeof x=="object"&&x!==null&&x.$$typeof===r},t.isForwardRef=function(x){return g(x)===h},t.isFragment=function(x){return g(x)===n},t.isProfiler=function(x){return g(x)===a},t.isPortal=function(x){return g(x)===o},t.isStrictMode=function(x){return g(x)===s}});KU(Lt);var BPe=Lt.typeOf,MPe=Lt.AsyncMode,LPe=Lt.ConcurrentMode,zPe=Lt.ContextConsumer,NPe=Lt.ContextProvider,UPe=Lt.Element,HPe=Lt.ForwardRef,GPe=Lt.Fragment,jPe=Lt.Profiler,WPe=Lt.Portal,VPe=Lt.StrictMode,KPe=Lt.isValidElementType,$Pe=Lt.isAsyncMode,qPe=Lt.isConcurrentMode,XPe=Lt.isContextConsumer,YPe=Lt.isContextProvider,JPe=Lt.isElement,ZPe=Lt.isForwardRef,QPe=Lt.isFragment,eBe=Lt.isProfiler,tBe=Lt.isPortal,iBe=Lt.isStrictMode,$U=YD(function(e){e.exports=Lt}),JD={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},qU={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},XU={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},nx={};nx[$U.ForwardRef]=XU;var YU=Object.defineProperty,JU=Object.getOwnPropertyNames,ZD=Object.getOwnPropertySymbols,ZU=Object.getOwnPropertyDescriptor,QU=Object.getPrototypeOf,QD=Object.prototype;function e2(e,t,i){if(typeof t!="string"){if(QD){var r=QU(t);r&&r!==QD&&e2(e,r,i)}var o=JU(t);ZD&&(o=o.concat(ZD(t)));for(var n=nx[e.$$typeof]||JD,s=nx[t.$$typeof]||JD,a=0;a<o.length;++a){var l=o[a];if(!qU[l]&&!(i&&i[l])&&!(s&&s[l])&&!(n&&n[l])){var d=ZU(t,l);try{YU(e,l,d)}catch(c){}}}return e}return e}var t2=e2,i2=function(){function e(){yg(this,e),this.listeners=[]}return vg(e,[{key:"on",value:function(i){var r=this;return this.listeners.push(i),function(){var o=r.listeners.indexOf(i);o!==-1&&r.listeners.splice(o,1)}}},{key:"emit",value:function(i){this.listeners.forEach(function(r){return r(i)})}}]),e}();function r2(e){function t(r,o,n,s,a,l){for(var d=arguments.length,c=new Array(d>6?d-6:0),p=6;p<d;p++)c[p-6]=arguments[p];return Rt.untracked(function(){if(s=s||"<<anonymous>>",l=l||n,o[n]==null){if(r){var h=o[n]===null?"null":"undefined";return new Error("The "+a+" `"+l+"` is marked as required in `"+s+"`, but its value is `"+h+"`.")}return null}else return e.apply(void 0,[o,n,s,a,l].concat(c))})}var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function e9(e,t){return e==="symbol"||t["@@toStringTag"]==="Symbol"?!0:typeof Symbol=="function"&&t instanceof Symbol}function o2(e){var t=ha(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":e9(t,e)?"symbol":t}function t9(e){var t=o2(e);if(t==="object"){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function Uc(e,t){return r2(function(i,r,o,n,s){return Rt.untracked(function(){if(e&&o2(i[r])===t.toLowerCase())return null;var a;switch(t){case"Array":a=Rt.isObservableArray;break;case"Object":a=Rt.isObservableObject;break;case"Map":a=Rt.isObservableMap;break;default:throw new Error("Unexpected mobxType: ".concat(t))}var l=i[r];if(!a(l)){var d=t9(l),c=e?" or javascript `"+t.toLowerCase()+"`":"";return new Error("Invalid prop `"+s+"` of type `"+d+"` supplied to `"+o+"`, expected `mobx.Observable"+t+"`"+c+".")}return null})})}function n2(e,t){return r2(function(i,r,o,n,s){for(var a=arguments.length,l=new Array(a>5?a-5:0),d=5;d<a;d++)l[d-5]=arguments[d];return Rt.untracked(function(){if(typeof t!="function")return new Error("Property `"+s+"` of component `"+o+"` has invalid PropType notation.");var c=Uc(e,"Array")(i,r,o);if(c instanceof Error)return c;for(var p=i[r],h=0;h<p.length;h++)if(c=t.apply(void 0,[p,h,o,n,s+"["+h+"]"].concat(l)),c instanceof Error)return c;return null})})}var rBe=Uc(!1,"Array"),oBe=n2.bind(null,!1),nBe=Uc(!1,"Map"),sBe=Uc(!1,"Object"),aBe=Uc(!0,"Array"),lBe=n2.bind(null,!0),sx=Uc(!0,"Object");function i9(e){return!(e.prototype&&e.prototype.render)}var s2=0;function r9(e){if(typeof Symbol=="function")return Symbol(e);var t="__$mobx-react ".concat(e," (").concat(s2,")");return s2++,t}var ax={};function pa(e){return ax[e]||(ax[e]=r9(e)),ax[e]}var a2=pa("patchMixins"),l2=pa("patchedDefinition");function o9(e,t){var i=e[a2]=e[a2]||{},r=i[t]=i[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}function d2(e,t){for(var i=this,r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];t.locks++;try{var s;return e!=null&&(s=e.apply(this,o)),s}finally{t.locks--,t.locks===0&&t.methods.forEach(function(a){a.apply(i,o)})}}function c2(e,t){var i=function(){for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];d2.call.apply(d2,[this,e,t].concat(n))};return i}function n9(e,t){for(var i=o9(e,t),r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];for(var s=0;s<o.length;s++){var a=o[s];i.methods.indexOf(a)<0&&i.methods.push(a)}var l=Object.getOwnPropertyDescriptor(e,t);if(l&&l[l2])return;var d=e[t],c=h2(e,t,l?l.enumerable:void 0,i,d);Object.defineProperty(e,t,c)}function h2(e,t,i,r,o){var n,s=c2(o,r);return n={},Sp(n,l2,!0),Sp(n,"get",function(){return s}),Sp(n,"set",function(l){if(this===e)s=c2(l,r);else{var d=h2(this,t,i,r,l);Object.defineProperty(this,t,d)}}),Sp(n,"configurable",!0),Sp(n,"enumerable",i),n}var p2={mobxStores:sx};Object.seal(p2);var s9={contextTypes:{get:function(){return p2},set:function(t){console.warn("Mobx Injector: you are trying to attach `contextTypes` on an component decorated with `inject` (or `observer`) HOC. Please specify the contextTypes on the wrapped component instead. It is accessible through the `wrappedComponent`")},configurable:!0,enumerable:!1},isMobxInjector:{value:!0,writable:!0,configurable:!0,enumerable:!0}};function u2(e,t,i){var r="inject-"+(t.displayName||t.name||t.constructor&&t.constructor.name||"Unknown");i&&(r+="-with-"+i);var o=function(n){rx(s,n);function s(){var a,l;yg(this,s);for(var d=arguments.length,c=new Array(d),p=0;p<d;p++)c[p]=arguments[p];return l=ox(this,(a=Tp(s)).call.apply(a,[this].concat(c))),l.storeRef=function(h){l.wrappedInstance=h},l}return vg(s,[{key:"render",value:function(){var l={};for(var d in this.props)this.props.hasOwnProperty(d)&&(l[d]=this.props[d]);var c=e(this.context.mobxStores||{},l,this.context)||{};for(var p in c)l[p]=c[p];return i9(t)||(l.ref=this.storeRef),Qt.createElement(t,l)}}]),s}(Qt.Component);return o.displayName=r,t2(o,t),o.wrappedComponent=t,Object.defineProperties(o,s9),o}function a9(e){return function(t,i){return e.forEach(function(r){if(r in i)return;if(!(r in t))throw new Error("MobX injector: Store '"+r+"' is not available! Make sure it is provided by some Provider");i[r]=t[r]}),i}}function O(){var e;if(typeof arguments[0]=="function")return e=arguments[0],function(r){var o=u2(e,r);return o.isMobxInjector=!1,o=I(o),o.isMobxInjector=!0,o};for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e=a9(t),function(r){return u2(e,r,t.join("-"))}}var lx=Rt.$mobx||"$mobx",m2=pa("isUnmounted"),Il=!1,dx=!1,f2=!1,Hc=typeof WeakMap!="undefined"?new WeakMap:void 0,cx=new i2,_g=pa("skipRender"),xg=pa("isForcingUpdate"),g2=typeof Qt.forwardRef=="function"&&Qt.forwardRef(function(e,t){}).$$typeof;function Qn(e,t,i){Object.hasOwnProperty.call(e,t)?e[t]=i:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:i})}function b2(e){if(Nc.findDOMNode)try{return Nc.findDOMNode(e)}catch(t){return null}return null}function y2(e){var t=b2(e);t&&Hc&&Hc.set(t,e),cx.emit({event:"render",renderTime:e.__$mobRenderEnd-e.__$mobRenderStart,totalTime:Date.now()-e.__$mobRenderStart,component:e,node:t})}function l9(){if(typeof WeakMap=="undefined")throw new Error("[mobx-react] tracking components is not supported in this browser.");Il||(Il=!0)}var d9=new i2;function c9(e,t){n9(e,t,hx[t])}function _2(e,t){if(v2(e,t))return!0;if(ha(e)!=="object"||e===null||ha(t)!=="object"||t===null)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(!hasOwnProperty.call(t,i[o])||!v2(e[i[o]],t[i[o]]))return!1;return!0}function v2(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function h9(e){var t=this;if(dx===!0)return e.call(this);function i(){var l=this;s=!1;var d=void 0,c=void 0;if(a.track(function(){Il&&(l.__$mobRenderStart=Date.now());try{c=Rt._allowStateChanges(!1,n)}catch(p){d=p}Il&&(l.__$mobRenderEnd=Date.now())}),d)throw d9.emit(d),d;return c}var r=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",o=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID||this._reactInternalInstance&&this._reactInternalInstance._debugID||this._reactInternalFiber&&this._reactInternalFiber._debugID;Qn(this,_g,!1),Qn(this,xg,!1);var n=e.bind(this),s=!1,a=new Rt.Reaction("".concat(r,"#").concat(o,".render()"),function(){if(!s&&(s=!0,typeof t.componentWillReact=="function"&&t.componentWillReact(),t[m2]!==!0)){var l=!0;try{Qn(t,xg,!0),t[_g]||Qt.Component.prototype.forceUpdate.call(t),l=!1}finally{Qn(t,xg,!1),l&&a.dispose()}}});return a.reactComponent=this,i[lx]=a,this.render=i,i.call(this)}var hx={componentWillUnmount:function(){if(dx===!0)return;if(this.render[lx]&&this.render[lx].dispose(),this[m2]=!0,Il){var t=b2(this);t&&Hc&&Hc.delete(t),cx.emit({event:"destroy",component:this,node:t})}},componentDidMount:function(){Il&&y2(this)},componentDidUpdate:function(){Il&&y2(this)},shouldComponentUpdate:function(t,i){return dx&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==i?!0:!_2(this.props,t)}};function x2(e,t){var i=pa("reactProp_".concat(t,"_valueHolder")),r=pa("reactProp_".concat(t,"_atomHolder"));function o(){return this[r]||Qn(this,r,Rt.createAtom("reactive "+t)),this[r]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return o.call(this).reportObserved(),this[i]},set:function(s){!this[xg]&&!_2(this[i],s)?(Qn(this,i,s),Qn(this,_g,!0),o.call(this).reportChanged(),Qn(this,_g,!1)):Qn(this,i,s)}})}function I(e,t){if(typeof e=="string")throw new Error("Store names should be provided as array");if(Array.isArray(e))return f2||(f2=!0,console.warn('Mobx observer: Using observer to inject stores is deprecated since 4.0. Use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))` instead of `@observer(["store1", "store2"]) ComponentClass`')),t?O.apply(null,e)(I(t)):function(d){return I(e,d)};var i=e;if(i.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),i.__proto__===Qt.PureComponent&&console.warn("Mobx observer: You are using 'observer' on React.PureComponent. These two achieve two opposite goals and should not be used together"),g2&&i.$$typeof===g2){var r=i.render;if(typeof r!="function")throw new Error("render property of ForwardRef was not a function");return Qt.forwardRef(function(){var c=arguments;return Qt.default.createElement(px,null,function(){return r.apply(void 0,c)})})}if(typeof i=="function"&&(!i.prototype||!i.prototype.render)&&!i.isReactClass&&!Qt.Component.isPrototypeOf(i)){var o,n,s=I((n=o=function(d){rx(c,d);function c(){return yg(this,c),ox(this,Tp(c).apply(this,arguments))}return vg(c,[{key:"render",value:function(){return i.call(this,this.props,this.context)}}]),c}(Qt.Component),o.displayName=i.displayName||i.name,o.contextTypes=i.contextTypes,o.propTypes=i.propTypes,o.defaultProps=i.defaultProps,n));return t2(s,i),s}if(!i)throw new Error("Please pass a valid component to 'observer'");var a=i.prototype||i;p9(a),i.isMobXReactObserver=!0,x2(a,"props"),x2(a,"state");var l=a.render;return a.render=function(){return h9.call(this,l)},i}function p9(e){["componentDidMount","componentWillUnmount","componentDidUpdate"].forEach(function(t){c9(e,t)}),e.shouldComponentUpdate?e.shouldComponentUpdate!==hx.shouldComponentUpdate&&console.warn("Use `shouldComponentUpdate` in an `observer` based component breaks the behavior of `observer` and might lead to unexpected results. Manually implementing `sCU` should not be needed when using mobx-react."):e.shouldComponentUpdate=hx.shouldComponentUpdate}var px=I(function(e){var t=e.children,i=e.inject,r=e.render,o=t||r;if(typeof o=="undefined")return null;if(!i)return o();console.warn("<Observer inject=.../> is no longer supported. Please use inject on the enclosing component instead");var n=O(i)(o);return Qt.default.createElement(n,null)});px.displayName="Observer";var w2=function(t,i,r,o,n){var s=i==="children"?"render":"children";return typeof t[i]=="function"&&typeof t[s]=="function"?new Error("Invalid prop,do not use children and render in the same time in`"+r):typeof t[i]=="function"||typeof t[s]=="function"?void 0:new Error("Invalid prop `"+n+"` of type `"+ha(t[i])+"` supplied to `"+r+"`, expected `function`.")};px.propTypes={render:w2,children:w2};function C2(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function S2(e){function t(i){var r=this.constructor.getDerivedStateFromProps(e,i);return r!=null?r:null}this.setState(t.bind(this))}function T2(e,t){try{var i=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(i,r)}finally{this.props=i,this.state=r}}C2.__suppressDeprecationWarning=!0;S2.__suppressDeprecationWarning=!0;T2.__suppressDeprecationWarning=!0;function u9(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var i=null,r=null,o=null;if(typeof t.componentWillMount=="function"?i="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(i="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?o="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(o="UNSAFE_componentWillUpdate"),i!==null||r!==null||o!==null){var n=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+n+" uses "+s+" but also contains the following legacy lifecycles:"+(i!==null?`
  `+i:"")+(r!==null?`
  `+r:"")+(o!==null?`
  `+o:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=C2,t.componentWillReceiveProps=S2),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=T2;var a=t.componentDidUpdate;t.componentDidUpdate=function(d,c,p){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:p;a.call(this,d,c,h)}}return e}var m9={children:!0,key:!0,ref:!0},Ol=function(e){rx(t,e);function t(i,r){var o;return yg(this,t),o=ox(this,Tp(t).call(this,i,r)),o.state={},ux(i,o.state),o}return vg(t,[{key:"render",value:function(){return Qt.Children.only(this.props.children)}},{key:"getChildContext",value:function(){var r={};return ux(this.context.mobxStores,r),ux(this.props,r),{mobxStores:r}}}],[{key:"getDerivedStateFromProps",value:function(r,o){if(!r)return null;if(!o)return r;if(Object.keys(r).filter(wg).length!==Object.keys(o).filter(wg).length&&console.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!r.suppressChangedStoreWarning)for(var n in r)wg(n)&&o[n]!==r[n]&&console.warn("MobX Provider: Provided store '"+n+"' has changed. Please avoid replacing stores as the change might not propagate to all children");return r}}]),t}(Qt.Component);Ol.contextTypes={mobxStores:sx};Ol.childContextTypes={mobxStores:sx.isRequired};function ux(e,t){if(!e)return;for(var i in e)wg(i)&&(t[i]=e[i])}function wg(e){return!m9[e]&&e!=="suppressChangedStoreWarning"}u9(Ol);var dBe=pa("disposeOnUnmount");if(!Qt.Component)throw new Error("mobx-react requires React to be available");if(!Rt.spy)throw new Error("mobx-react requires mobx to be available");typeof Nc.unstable_batchedUpdates=="function"&&Rt.configure({reactionScheduler:Nc.unstable_batchedUpdates});if((typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="undefined"?"undefined":ha(__MOBX_DEVTOOLS_GLOBAL_HOOK__))==="object"){var f9={spy:Rt.spy,extras:{getDebugName:Rt.getDebugName}},g9={renderReporter:cx,componentByNodeRegistry:Hc,componentByNodeRegistery:Hc,trackComponents:l9};__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobxReact(g9,f9)}const Cg=v(require("styled-components")),kp=Cg.css`
  position: absolute;
  top: 0;
  left: 0;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  pointer-events: none;
`,k2=Cg.default.div.attrs(e=>({style:{background:e.color}}))`
  ${kp}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.background};
`;k2.defaultProps={theme:X};var Sg=k2;const E2=v(require("styled-components")),D2=E2.default.div.attrs(e=>{const t=e.url?{backgroundImage:`url(${e.url})`}:{};return{style:t}})`
  ${kp}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.tiledBackground};
`;D2.defaultProps={theme:X};var Tg=D2;const Rl=v(require("react")),Ep=v(require("styled-components")),I2=Ep.default.div`
  ${kp}
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.overlay};

  box-sizing: border-box;
  border: 2px solid transparent;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  transition: border-color 300ms ease-in-out;
  ${e=>e.isActive&&Ep.css`
      border-color: ${e.theme.selectColor.activeBorderColor};
    `}
`,mx=Ep.default.span`
  display: inline-block;
  height: 2px;
  width: 2px;
  border-radius: 50%;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
  background: rgba(255, 255, 255, 0.87);
  margin: 1px;
  pointer-events: none;
`,b9=({isActive:e,className:t,style:i})=>Rl.default.createElement(I2,{isActive:e,className:t,style:i},e&&Rl.default.createElement(Rl.default.Fragment,null,Rl.default.createElement(mx,null),Rl.default.createElement(mx,null),Rl.default.createElement(mx,null)));I2.defaultProps={theme:X};var kg=b9;const O2=v(require("styled-components")),Gc=O2.css`
  &:focus {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
  &:-moz-focusring {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
`;const fx=v(require("styled-components")),Eg=fx.css`
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
`,R2=fx.css`
  -webkit-overflow-scrolling: touch;
  &::-webkit-scrollbar {
    display: none;
    /* Safari */
    -webkit-appearance: none; /* stylelint-disable-line */
    width: 0;
    height: 0;
  }
  -ms-overflow-style: none; /* IE 11 */
  scrollbar-width: none; /* Firefox 64 */
`;const A2=v(require("styled-components")),Dg=A2.keyframes`
from {
  opacity: 1;
  transform: scale(0);
}
to {
  opacity: 0;
  transform: scale(10);
}
`;const F2=v(require("styled-components")),P2=F2.keyframes`
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`;const B2=v(require("styled-components")),Ig=B2.keyframes`
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
`;const jc=v(require("styled-components")),Og=jc.default.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,gx=jc.default(Og)``,er=jc.default(Og)``,Wc=jc.default(Og)``,Rg={display:"none",left:0,top:0},Ag=jc.default(Og)`
  display: ${({display:e})=>e};
  left: ${({left:e})=>e}px;
  top: ${({top:e})=>e}px;
  pointer-events: none;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.12);
  animation: ${Dg} 1.2s;
  width: 100px;
  height: 100px;
  margin-top: -50px;
  margin-left: -50px;
  opacity: 0;
`;const Vc=v(require("react")),Fg=v(require("styled-components")),es=Fg.css`
  color: ${e=>e.theme.button.activeForeground};
`,y9=Fg.default.button`
  &&& {
    box-sizing: border-box;
  }
  text-align: center;
  position: relative;
  padding: 4px 8px;
  min-height: 32px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  font-size: ${e=>e.theme.measurements.fontSystem.button1.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button1.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button1.case};
  font-family: ${e=>e.theme.typography.fontFamily}, sans-serif;
  cursor: pointer;
  border: none;
  background-color: transparent;
  overflow: hidden;
  ${Gc}

  /* Active */

  &:active {
    ${es}
  }

  ${({isActive:e})=>e&&es}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${er} {
      background-color: ${e=>e.theme.button.outlinedInactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Wc} {
      background-color: ${e=>e.theme.button.hoverOverlayColor};
    }
  }
`;class Mi extends Vc.default.Component{constructor(){super(...arguments);this.state=Rg;this.timeout=null;this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const c=this.props,{isActive:e,isDisabled:t,label:i,ariaLabel:r,children:o,className:n}=c,s=Jt(c,["isActive","isDisabled","label","ariaLabel","children","className"]),{left:a,top:l,display:d}=this.state;return Vc.default.createElement(y9,y(y({"data-test":r,className:n,isActive:e,disabled:t,"aria-label":r},s),{onClick:this.onClick}),i,o,Vc.default.createElement(Ag,{display:d,left:a,top:l}),Vc.default.createElement(er,null),Vc.default.createElement(Wc,null))}}Mi.defaultProps={type:"button",isDisabled:!1,isActive:!1};const Pg=v(require("react")),Al=v(require("styled-components")),v9=Al.default(Mi)`
  ${({fullWidth:e})=>e&&Al.css`
      width: 100%;
    `}
`,_9=Al.default.div`
  &:focus {
    outline: none;
  }

  > img {
    height: 18px;
    width: 18px;
  }

  > svg {
    height: 18px;
    width: 18px;
  }
  display: none;

  @media all and (min-width: 0) and (max-width: 599px) {
    display: flex;
  }
`,x9=Al.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  &:focus {
    outline: none;
  }

  ${({hasIcon:e})=>e&&Al.css`
      @media all and (min-width: 0) and (max-width: 599px) {
        display: none;
      }
    `}
`,zo=n=>{var{label:e,children:t,icon:i,fullWidth:r}=n,o=Jt(n,["label","children","icon","fullWidth"]);const s=Pg.default.createElement(x9,{hasIcon:!!i},e,t);return Pg.default.createElement(v9,y({fullWidth:r},o),i&&Pg.default.createElement(_9,null,i),(t||e)&&s)};const M2=v(require("styled-components")),Nd=M2.default(zo)`
  background: ${e=>e.theme.button.outlinedPrimaryBackground};
  color: ${e=>e.theme.button.outlinedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
  min-width: 32px;
`;const L2=v(require("styled-components")),$r=L2.default(Mi)`
  color: ${e=>e.theme.button.textSecondaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&es}

  ${er} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;const z2=v(require("styled-components")),Ms=z2.default(Mi)`
  color: ${e=>e.theme.button.textPrimaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&es}

  ${er} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;const N2=v(require("styled-components")),Mn=N2.default(zo)`
  background: ${e=>e.theme.button.outlinedSecondaryBackground};
  color: ${e=>e.theme.button.outlinedSecondaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
`;const bx=v(require("react")),yx=v(require("styled-components")),w9=yx.default(Mi)`
  color: ${e=>e.theme.foreground};
  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&es}

  ${er} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`,C9=yx.default.div`
  display: flex;
  &:focus {
    outline: none;
  }
`,on=o=>{var{label:e,icon:t,children:i}=o,r=Jt(o,["label","icon","children"]);return bx.default.createElement(w9,y({},r),bx.default.createElement(C9,null,t))};const U2=v(require("styled-components")),Ud=U2.default(zo)`
  background: ${e=>e.theme.button.containedPrimaryBackground};
  color: ${e=>e.theme.button.containedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.containedPrimaryBackground};

  &:active {
    color: ${e=>e.theme.button.containedPrimaryForeground};
  }
`;const Fl=v(require("react")),Dp=v(require("styled-components")),S9=()=>Dp.css`
    animation: ${Ig} 0.2s linear;
  `,T9=Dp.css`
  border: 1px solid ${e=>e.theme.card.activeBorderColor};
  ${gx} {
    background-color: ${e=>e.theme.card.activeOverlayColor};
  }
`,k9=Dp.default.button.attrs(e=>{const t={};return console.log("test123"),console.log(e.image),e.image&&(t.backgroundImage=`url(${e.image})`),{style:t}})`
  background-image: ${e=>(console.log("test456"),console.log(e.image),"test")};
  &&& {
    box-sizing: border-box;
  }

  padding: 0;
  cursor: pointer;
  /* Safari will change the height of the toolbar and position the category cards at the bottom for some reason */
  vertical-align: top;
  border: none;
  box-sizing: border-box;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-color: ${e=>e.theme.card.background};
  color: ${e=>e.theme.card.foreground};
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  ${S9};
  animation-fill-mode: both;
  overflow: hidden;

  ${Gc}

  /* Active */

  /* No :active styles on purpose. */

  ${({isActive:e})=>e&&T9}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${er} {
      background-color: ${e=>e.theme.card.inactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Wc} {
      background-color: ${e=>e.theme.card.hoverOverlayColor};
    }
  }
`;class No extends Fl.default.Component{constructor(){super(...arguments);this.state=Rg;this.timeout=null;this.onKeyDown=e=>{(e.key==="Space"||e.key==="Enter")&&(this.props.onClick&&this.props.onClick())};this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const{children:e,label:t,isActive:i,isDisabled:r,image:o,style:n,className:s}=this.props,{left:a,top:l,display:d}=this.state;return Fl.default.createElement(k9,{isActive:i,"data-test":t,"aria-label":t,disabled:r,image:o,onClick:this.onClick,onKeyDown:this.onKeyDown,style:n,className:s},e,Fl.default.createElement(Ag,{display:d,left:a,top:l}),Fl.default.createElement(gx,null),Fl.default.createElement(er,null),Fl.default.createElement(Wc,null))}}const Kc=v(require("react")),Uo=v(require("styled-components")),E9=Uo.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
`,D9=Uo.default.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 0px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  left: 0;
  ${e=>e.withBackground?Uo.css`
          color: ${e.theme.card.labelForeground};
          height: 40px;
          background: ${e.theme.card.labelBackground};
        `:Uo.css`
          color: ${e.theme.card.foreground};
          height: 32px;
        `}
  width: 100%;
  cursor: pointer;
`,I9=Uo.default.div`
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.card.labelForeground};
  ${e=>e.withBackground?Uo.css`
          border-top-color: ${e.theme.card.labelForeground};
        `:Uo.css`
          border-top-color: ${e.theme.card.foreground};
        `}
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
`,O9=Uo.default.span`
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 10px;
`,R9=Uo.default.div`
  ${Eg}
`,Ip=({children:e,className:t,caret:i,isActive:r,style:o,withBackground:n,hidden:s})=>{if(s)return Kc.default.createElement(R9,null,e);const a=()=>Kc.default.createElement(O9,null,Kc.default.createElement(I9,{"aria-hidden":!0,rotation:r?180:0,withBackground:n}));return Kc.default.createElement(D9,{className:t,withBackground:n,style:o},Kc.default.createElement(E9,null,e,i&&a()))};const zt={Focused:Gc,HiddenScrollbar:R2,VisuallyHidden:Eg},H2={ripple:Dg,scale:P2,slide:Ig};const G2=v(require("styled-components")),j2=G2.default.button.attrs({type:"button"})`
  &&& {
    box-sizing: border-box;
  }
  position: relative;
  background: transparent;
  border: none;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  margin: ${e=>e.theme.colorItem.margin};
  padding: 0;
  cursor: pointer;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};

  &:hover {
    opacity: 0.7;
  }

  ${zt.Focused}

  &:disabled {
    opacity: ${e=>e.theme.selectColor.inactiveOpacity};
    cursor: default;
  }
`;j2.defaultProps={theme:X};var Bg=j2;const Op=v(require("react")),A9=({isActive:e,onClick:t,color:i,label:r,isDisabled:o,tiledBackgroundUrl:n,className:s,style:a,children:l})=>Op.default.createElement(Bg,{disabled:o,onClick:t,"aria-label":r,className:s,style:a},Op.default.createElement(Tg,{url:n}),Op.default.createElement(Sg,{color:i}),Op.default.createElement(kg,{isActive:e}),l);var W2=O("config")(I(A9));const V2=v(require("react")),Mg=v(require("styled-components")),F9=Mg.default.div`
  display: none;
  visibility: hidden;
  opacity: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.base};
  transition: opacity 100s ease-in-out;

  ${e=>e.isVisible&&Mg.css`
      opacity: 1;
      display: block;
      visibility: visible;
    `};
`,P9=({isVisible:e,className:t,children:i})=>V2.default.createElement(F9,{isVisible:e,className:t},i);var Lg=P9;const K2=v(require("styled-components")),B9=K2.default.div`
  display: block;
  opacity: 1;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.backdrop};
  text-align: left;
  background: ${e=>e.theme.modal.backdrop};
  height: 100%;
  width: 100%;
`;var zg=B9;const $2=v(require("styled-components")),M9=$2.default.div.attrs(()=>({role:"dialog","aria-hidden":!1}))`
  display: flex;
  flex: 0 0 auto;
  flex-direction: column;
  transition: top 0.25s ease;
  position: absolute;
  top: calc(50% + ${e=>e.top}px);
  left: calc(50% + ${e=>e.left}px);
  width: ${e=>e.width};
  height: ${e=>e.height};
  transform: translate(-50%, -50%);
  border-radius: ${e=>e.theme.shape.radiusLarge}px;
  background: ${e=>e.theme.modal.background};
  color: ${e=>e.theme.modal.bodyForeground};
  z-index: ${e=>e.theme.measurements.zIndex.dialog.container};

  @media all and (min-width: 0) and (max-width: 640px) {
    text-align: center;
    width: auto;
    min-width: 200px;
    height: auto;
    top: 50%;
    left: 50%;
  }
`;var Ng=M9;const Ug=v(require("react")),L9=({isVisible:e=!1,width:t="350px",height:i="fit-content",position:r,header:o,body:n,footer:s,className:a,children:l})=>Ug.default.createElement(Lg,{isVisible:e},Ug.default.createElement(zg,null),Ug.default.createElement(Ng,{height:i,width:t,left:r.x,top:r.y,className:a},o,n,l,s));var q2=L9;const X2=v(require("styled-components")),z9=X2.default.h3`
  font-size: ${e=>e.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.headline2.case};
  color: ${e=>e.theme.modal.headerForeground};

  padding: 11px 20px 0px;
`;var $c=z9;const Y2=v(require("styled-components")),N9=Y2.default.div`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  box-sizing: border-box;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.modal.bodyForeground};

  padding: 0px 20px 11px;
  &:first-child {
    padding-top: 11px;
  }

  @media all and (min-width: 0) and (max-width: 640px) {
    align-items: center;
  }
`;var ts=N9;const J2=v(require("styled-components")),U9=J2.default.div`
  display: flex;
  border-top: 2px solid ${e=>e.type==="error"?e.theme.error:e.theme.warning};

  height: 40px;
  justify-content: flex-end;
  @media all and (min-width: 0) and (max-width: 640px) {
    height: auto;
    flex-direction: column;
    justify-content: space-around;
  }
`;var qc=U9;const Pl=v(require("styled-components")),Z2=Pl.keyframes`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,H9=Pl.css`
  animation: ${Z2} 2s infinite ease 1.5s;
`,G9=Pl.css`
  animation: ${Z2} 2s infinite ease;
`,j9=Pl.default.div`
  color: ${e=>e.theme.primary};
  margin: 12px 0;
  position: relative;
  width: 40px;
  height: 40px;
  box-shadow: inset 0 0 0 2px;
  transform: translateZ(0);
  border-radius: 50%;
  &:before,
  &:after {
    border-radius: 50%;
    position: absolute;
    content: '';
  }
  &:before {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 45px 0 0 45px;
    top: -2.5px;
    left: -2.5px;
    transform-origin: 25px 25px;
    ${H9};
  }
  &:after {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 0 45px 45px 0;
    top: -2.5px;
    left: 25px;
    transform-origin: 0px 25px;
    ${G9};
  }
`;var Hg=j9;const Ho=v(require("react")),Rp=v(require("styled-components")),W9=Rp.default.div`
  display: flex;
`,V9=Rp.default($c)`
  padding: 0;
`,K9=Rp.default.div`
  display: flex;
  flex-direction: column;
  margin-left: 8px;
  @media all and (min-width: 640px) {
    margin-left: 30px;
  }
`,$9=Rp.default(ts)`
  padding: 0;
  margin: 0;
`;class vx extends Ho.default.PureComponent{render(){const{headerLabel:e,bodyLabel:t,children:i}=this.props,r=Ho.default.Children.toArray(i)[0];if(!Ho.default.isValidElement(r))throw new Error("Child is not a valid react element");return Ho.default.cloneElement(r,{height:"90px",body:Ho.default.createElement(ts,null,Ho.default.createElement(W9,null,Ho.default.createElement(Hg,null),Ho.default.createElement(K9,null,Ho.default.createElement(V9,null,e),Ho.default.createElement($9,null,t))))})}}const Q2=v(require("styled-components")),ua=Q2.css`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  width: 100%;
  min-height: 26px;
  color: ${e=>e.theme.textInput.foreground};
  padding-bottom: 7px;
  border: none;
  appearance: none;
  border-bottom: 1px solid ${e=>e.theme.textInput.borderColor};
  background: ${e=>e.theme.textInput.background};
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
  transition: border-color 0.4s ease-in-out;

  &:focus {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:-moz-focusring {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    pointer-events: none;
  }

  &:hover {
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
`;const Br=v(require("react")),Ap=v(require("styled-components")),q9=Ap.default.form`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,X9=Ap.default.textarea`
  display: flex;
  caret-color: ${e=>e.theme.primary};
  ${ua}
  min-height: 100%;
  padding: 0px;
  outline-offset: -8px;
  color: ${e=>e.theme.modal.bodyForeground};
  resize: none;
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;

  &:selection,
  &:-moz-selection {
    background-color: ${e=>e.theme.primary};
    color: ${e=>e.theme.foreground};
  }
`,Y9=Ap.default.label`
  padding: 11px 20px 8px;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
  color: ${e=>e.theme.modal.headerForeground};
`,J9=Ap.default(qc)`
  border-top: none;
`;class eI extends Br.default.Component{constructor(){super(...arguments);this.state={value:""};this.input=Br.default.createRef();this.handleKeydown=e=>{gS(this.handleDismiss)(e)};this.handleDismiss=()=>{const{handleDismiss:e}=this.props;e&&e(!1)};this.handleConfirm=()=>{const{handleConfirm:e}=this.props,{value:t}=this.input.current;t&&(e&&e(t),this.handleDismiss())};this.onChange=e=>{const t=WD(e.target.value);this.input.current.value=t,this.setState({value:t})};this.onSubmit=e=>{e.preventDefault()}}componentDidMount(){const{text:e,defaultText:t}=this.props;this.input.current.focus(),this.input.current.value=e||t||"",this.setState({value:this.input.current.value}),document.addEventListener("keydown",this.handleKeydown,!1),e===t&&this.input.current.select()}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown,!1)}componentDidUpdate(e){const{isVisible:t}=this.props;e.isVisible!==t&&(t&&this.input.current.focus())}render(){const{headerLabel:e,dismissLabel:t,confirmLabel:i,maxLength:r,type:o,children:n}=this.props,{value:s}=this.state,a=Br.default.Children.toArray(n)[0];if(!Br.default.isValidElement(a))throw new Error("Child is not a valid react element");return Br.default.cloneElement(a,{handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss,isConfirmDisabled:!s,height:"150px",header:Br.default.createElement(Y9,{htmlFor:"photoeditorsdk-TextInput"},e),body:Br.default.createElement(ts,null,Br.default.createElement(q9,{onSubmit:this.onSubmit},Br.default.createElement(X9,{ref:this.input,id:"photoeditorsdk-TextInput",placeholder:"Write Something",autoFocus:!0,onChange:this.onChange,maxLength:r}))),footer:Br.default.createElement(J9,{type:o},Br.default.createElement($r,{label:t,ariaLabel:t,onClick:this.handleDismiss}),Br.default.createElement(Ms,{label:i,ariaLabel:i,isDisabled:!s,onClick:this.handleConfirm}))})}}eI.defaultProps={defaultText:"Write Something"};var tI=eI;const un=v(require("react"));class _x extends un.default.Component{constructor(){super(...arguments);this.onDismiss=()=>{const{handleClose:e,handleDismiss:t}=this.props;e&&e(),t&&t()};this.onConfirm=()=>{const{handleClose:e,handleConfirm:t}=this.props;e&&e(),t&&t()}}render(){const{headerLabel:e,bodyLabel:t,confirmLabel:i,dismissLabel:r,type:o,children:n}=this.props,s=un.default.Children.toArray(n)[0];if(!un.default.isValidElement(s))throw new Error("Child is not a valid react element");return un.default.cloneElement(s,{handleConfirm:this.onConfirm,handleDismiss:this.onDismiss,header:un.default.createElement($c,null,e),body:un.default.createElement(ts,null,t),footer:un.default.createElement(qc,{type:o},r&&un.default.createElement($r,{label:r,ariaLabel:r,onClick:this.onDismiss}),i&&un.default.createElement(Ms,{label:i,ariaLabel:i,onClick:this.onConfirm}))})}}const iI=v(require("styled-components")),rI=iI.default.div`
  padding-bottom: ${e=>(e.count||1)*8}px;
`;var ao=rI;rI.defaultProps={count:1};const oI=v(require("react")),Fp=v(require("styled-components")),Z9=Fp.default.label`
  ${zt.VisuallyHidden}
`,nI=Fp.default.label`
  display: block;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
  margin: 0;

  ${({isDisabled:e})=>e&&Fp.css`
      opacity: ${t=>t.theme.toolControlBar.inputLabelInactiveOpacity};
      cursor: default;
      pointer-events: none;
    `}
`,sI=({label:e,htmlFor:t,show:i,style:r,isDisabled:o,className:n})=>{const s=i?nI:Z9,a=t||(e?e.replace(" ","-"):void 0);return oI.default.createElement(s,{style:r,isDisabled:o,htmlFor:a,className:n},e)};sI.defaultProps={show:!0};nI.defaultProps={theme:X};var Li=sI;const Gg=v(require("react")),xx=v(require("styled-components")),aI=xx.default.input`
  ${ua}
  /* override user agent style */
  padding: 0;
  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    cursor: default;
    pointer-events: none;
  }
`,Q9=xx.default.div`
  position: relative;
  &:first-child {
    margin-right: 15px;
  }
`;class lI extends Gg.default.Component{constructor(){super(...arguments);this.onChange=e=>{const{onChange:t}=this.props;t&&t(e.target.value)}}render(){const{id:e,testId:t,value:i,type:r,min:o,max:n,onBlur:s,onFocus:a,onKeyUp:l,onKeyDown:d,onMouseUp:c,onTouchEnd:p,isDisabled:h,className:m,children:b}=this.props;return Gg.default.createElement(Q9,{className:m},Gg.default.createElement(aI,{id:e,"data-test":t,"aria-hidden":h,disabled:h,value:i,type:r,min:o,max:n,onChange:this.onChange,onBlur:s,onFocus:a,onKeyUp:l,onKeyDown:d,onMouseUp:c,onTouchEnd:p}),b)}}lI.defaultProps={type:"text"};var jg=lI;aI.defaultProps={theme:X};const Bl=v(require("react")),Pp=v(require("styled-components")),eH=Pp.default.div`
  ${ti()?Pp.css``:Pp.css`
        display: flex;
        flex: 0 1 auto;
        flex-direction: column;
      `}
`;class Bp extends Bl.default.Component{constructor(e){super(e);this.node=null;this.handleOutsideClick=e=>{if(this.node&&this.node.current&&this.node.current.contains(e.target))return;this.onSubmit()};this.onSubmit=()=>{const{onSubmit:e}=this.props,{value:t,isActive:i}=this.state;if(e){const r=parseFloat(Bp.cleanValue(t));!Number.isNaN(r)&&i&&e(`${r}`)}this.setState({isActive:!1})};this.onBlur=()=>{this.onSubmit()};this.onFocus=()=>{this.setState({isActive:!0})};this.onKeyDown=e=>{const{value:t}=this.state;if(e.key==="Enter")this.onSubmit();else if(e.key==="ArrowUp"){const i=parseFloat(Bp.cleanValue(t));typeof i=="number"&&this.setState({value:(i+1).toString(),isActive:!0})}else if(e.key==="ArrowDown"){const i=parseFloat(Bp.cleanValue(t));typeof i=="number"&&this.setState({value:(i-1).toString(),isActive:!0})}};this.onChange=e=>{this.setState({value:e.replace(/[^\d.,-]/g,""),isActive:!0})};this.state={value:this.props.value||"",isActive:!1},this.node=Bl.default.createRef(),document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1)}static getDerivedStateFromProps({value:e},{value:t,isActive:i}){return e!==t&&!i?{value:e}:null}static cleanValue(e){return e?e.replace(",",".").replace(/[a-zA-Z]/g,"").trim():""}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1)}render(){const{id:e,label:t,isDisabled:i,ariaHidden:r,onMouseUp:o,onTouchEnd:n,className:s}=this.props,{value:a}=this.state;return Bl.default.createElement(eH,{ref:this.node,className:s},Bl.default.createElement(Li,{htmlFor:e,label:t,show:!!t,isDisabled:i}),!!t&&Bl.default.createElement(ao,null),Bl.default.createElement(jg,{id:e,value:a,isDisabled:i,"aria-hidden":r,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,onMouseUp:o,onTouchEnd:n}))}}Bp.defaultProps={showLabel:!0};var Wg=Bp;const mn=v(require("react")),Go=v(require("styled-components")),tH=Go.default.div`
  display: flex;
  flex-direction: column;
  /* needed for IE11 to properly calculate the width */
  min-width: 1px;
`,wx=Go.css`
  ${tl()||ti()?Go.css`
        width: 16px;
        height: 16px;
      `:Go.css`
        width: 20px;
        height: 20px;
      `}
  background: ${e=>e.theme.slider.thumbBackground};
  border: 2px solid ${e=>e.theme.slider.thumbBorderColor};
  border-radius: 50%;
  cursor: pointer;
`,iH=e=>{let t=(e.value-e.min)*100/(e.max-e.min);return e.adjust?e.value>0?(t=e.value*(e.max/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.activeTrackColor} ${50+t}%,
      ${e.theme.slider.trackColor} ${50+t}%,
      ${e.theme.slider.trackColor} 100%
      `):e.value<0?(t=e.value*(e.min/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.trackColor} 100%
      `):`${e.theme.slider.trackColor} 0%,
    ${e.theme.slider.trackColor} 100%`:`${e.theme.slider.activeTrackColor} 0%,
    ${e.theme.slider.activeTrackColor} ${t}%,
    ${e.theme.slider.trackColor} ${t}%,
    ${e.theme.slider.trackColor} 100%`},dI=Go.default.input`
  display: flex;
  flex: 1 0 auto;
  appearance: none;
  max-width: calc(100% - 50px);
  outline: none;
  border-radius: 0; /* iOS */

  ${zt.Focused}

  ${tl()||ti()?Go.css`
        margin-top: 10px;
        height: 20px;
        /* remove once we have a better concept for focus in all browser */
        &:focus {
          box-shadow: none;
        }
      `:Go.css`
        height: 2px;
        background: ${e=>`linear-gradient(to right, ${iH(e)})`};
      `}
  &::-moz-focus-outer {
    /** This is to remove the dotted focus lines in firefox */
    border: 0;
  }
  &:disabled {
    opacity: ${e=>e.theme.slider.inactiveOpacity};
    pointer-events: none;
  }
  &:hover {
    opacity: ${e=>e.theme.slider.hoverOpacity};
  }
  &::-webkit-slider-runnable-track {
    cursor: pointer;
    appearance: none;
  }
  &::-moz-range-track {
    appearance: none;
    cursor: pointer;
  }
  &::-ms-track {
    cursor: pointer;
    height: 2px;
    appearance: none;
    background: transparent;
    color: transparent;
    border-color: transparent;
    border-width: 6px 0;
  }
  &::-webkit-slider-thumb {
    appearance: none;
    ${wx}
  }
  &::-moz-range-thumb {
    appearance: none;
    ${wx}
  }
  &::-ms-thumb {
    appearance: none;
    ${wx}
  }
  &::-ms-fill-lower {
    background: ${e=>`${e.theme.slider.activeTrackColor}`};
  }
  &::-ms-fill-upper {
    background: ${e=>`${e.theme.slider.trackColor}`};
  }
  &::-ms-tooltip {
    display: none;
  }
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 200px;
  }
`,rH=Go.default.div`
  display: flex;
  align-items: center;
  height: 26px;
  margin-right: ${e=>e.centerSlider?-56:0}px;
`,oH=Go.default(Wg)`
  max-width: 50px;
  padding-left: 16px;
  > div > input {
    text-align: center;
  }
`;class cI extends mn.default.Component{constructor(e){super(e);this.onSubmit=e=>{const{onChange:t,suffix:i,divider:r,min:o,max:n,value:s}=this.props,a=e.replace(i,""),l=a?parseFloat(a)/r:s,d=Math.max(o,Math.min(n,l));Number.isNaN(d)||(t(d),this.props.onMouseUp?this.props.onMouseUp():this.props.onTouchEnd&&this.props.onTouchEnd())};this.onSliderChange=e=>{const{onChange:t}=this.props,i=parseFloat(e.target.value);t(i)};this.randomId=So()}render(){const{value:e,snap:t,min:i,max:r,divider:o,suffix:n,decimal:s,showLabel:a,showInput:l,style:d,centerSlider:c,adjust:p,label:h,isDisabled:m,step:b,"aria-hidden":_,onMouseUp:g,onTouchEnd:S,className:x}=this.props,C=`photoeditorsdk-slider-${this.randomId}`,R=`${C}-list`,T=`${C}-input`,k=typeof t=="number",M=k&&mn.default.createElement("datalist",{id:R},mn.default.createElement("option",{value:t})),U=`${(e*o).toFixed(s)}${n}`,L=l&&mn.default.createElement(oH,{id:T,value:U,isDisabled:m,"aria-hidden":_,onSubmit:this.onSubmit});return mn.default.createElement(tH,{className:x,"data-test":h},mn.default.createElement(Li,{isDisabled:m,label:h,show:a}),mn.default.createElement(ao,{count:.25}),mn.default.createElement(rH,{centerSlider:l&&c},mn.default.createElement(dI,{type:"range",role:"slider","aria-hidden":_,tabIndex:0,value:e,min:i,max:r,step:b,style:d,disabled:m,id:C,list:k?R:void 0,onChange:this.onSliderChange,adjust:p,name:h,onKeyUp:this.onSliderChange,onKeyDown:this.onSliderChange,onMouseUp:g,onTouchEnd:S}),M,L))}}cI.defaultProps={showLabel:!0,showInput:!0,adjust:!1,centerSlider:!1,min:-1,max:1,value:0,step:.01,decimal:0,divider:100,suffix:""};var hI=cI;dI.defaultProps={theme:X};const Vg=v(require("react")),pI=v(require("styled-components")),uI=pI.default.input.attrs({type:"search"})`
  ${ua}
`,nH=e=>{const t=i=>{e.onChange(i.target.value)};return Vg.default.createElement("div",null,Vg.default.createElement(Li,{show:!1,label:"photoeditorsdk-Search"}),Vg.default.createElement(uI,{id:"photoeditorsdk-Search",onChange:t,placeholder:e.placeholder}))};var mI=nH;uI.defaultProps={theme:X};const fI=v(require("styled-components")),sH=fI.default.input.attrs({type:"file",id:"fileUpload",accept:"image/png, image/jpeg"})`
  display: none;
`;var gI=sH;const bI=v(require("react")),aH=({children:e})=>{const t=i=>{i.preventDefault()};return bI.default.createElement("form",{onSubmit:t},e)};var yI=aH;const vI=v(require("styled-components")),_I=vI.default.ul.attrs(({scrollable:e})=>({"data-simplebar":e?"init":null,"data-simplebar-auto-hide":e?"false":null}))`
  list-style: none;
  background: ${e=>e.theme.dropdown.listBackground};
  color: ${e=>e.theme.dropdown.listForeground};
  border: 1px solid ${e=>e.theme.dropdown.listBorderColor};
  box-shadow: ${e=>e.theme.dropdown.listShadow};
  visibility: hidden;
  opacity: 0;
  min-width: 5rem;
  position: absolute;
  transition: all 0.5s ease;
  left: -1px;
  display: none;
  padding: unset;
  width: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.input.list};
  max-height: 160px;
  overflow-x: hidden;
  margin: 5px 0;
  border-radius: 0 0 ${e=>e.theme.shape.radiusMedium}px ${e=>e.theme.shape.radiusMedium}px;
  &[data-simplebar] {
    position: absolute;
  }
`;var Kg=_I;_I.defaultProps={theme:X,scrollable:!0};const Xc=v(require("styled-components")),xI=Xc.css`
  outline: none;
`,wI=Xc.css`
  opacity: ${e=>e.theme.dropdown.inactiveOpacity};
  pointer-events: none;
`,CI=Xc.default.div`
  display: block;
  position: relative;
  width: 100%;
  white-space: nowrap;
  transition-duration: 0.5s;

  &:focus a {
    ${xI}
  }

  ${({isOpen:e})=>e&&Xc.css`
      a {
        ${xI}
      }
      ${Kg} {
        visibility: visible;
        opacity: 1;
        display: block;
      }
    `}

  &:disabled {
    ${wI}
  }

  ${({isDisabled:e})=>e&&wI}
`;var SI=CI;CI.defaultProps={theme:X};const $g=v(require("styled-components")),TI=$g.default.li`
  padding: 10px 16px;
  text-overflow: ellipsis;
  font-size: ${e=>e.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button2.case};
  white-space: nowrap;
  color: ${e=>e.theme.dropdown.foreground};

  &:hover {
    cursor: pointer;
    background: ${e=>e.theme.dropdown.listItemHoverBackground};
  }

  ${({isActive:e})=>e&&$g.css`
      border-left: 2px solid ${t=>t.theme.primary};
    `}

  ${zt.Focused}
`;var kI=TI;TI.defaultProps={theme:X};const EI=v(require("styled-components")),lH=EI.default.div`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.dropdown.foreground};
  background-color: ${e=>e.theme.dropdown.background};
  border: none;
  border-bottom: 1px solid ${e=>e.theme.dropdown.borderColor};
  padding: 5px 0;
  cursor: ${e=>e.showList?"pointer":"default"};
  transition: border-color 0.4s ease-in-out;

  &:hover {
    border-color: ${e=>e.theme.dropdown.hoverBorderColor};
  }

  ${zt.Focused}
`;var DI=lH;const jo=v(require("react")),Cx=v(require("styled-components")),dH=Cx.default.div`
  position: absolute;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.dropdown.caretColor};
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
  right: 0;
  top: 13px;
`,cH=Cx.default.div``;class hH extends jo.default.PureComponent{constructor(e){super(e);this.state={isOpen:!1};this.handleOutsideClick=e=>{if(this.node&&this.node.contains(e.target))return;this.setState({isOpen:!1})};this.onSelect=e=>{this.props.onSelect(e),this.setState({isOpen:!1})};this.onClick=()=>{this.setState(e=>({isOpen:!e.isOpen}))};this.listItem=e=>{const{itemStyle:t,selectedItem:i}=this.props,{value:r,label:o}=e;let n={};return typeof t=="function"?n=t(e):t!==null&&typeof t=="object"&&(n=t),jo.default.createElement(kI,{"aria-hidden":!this.state.isOpen,tabIndex:0,style:n,onClick:()=>this.onSelect(r),key:r,isActive:i===r},o)};this.onKeyDown=e=>{(e.code==="Space"||e.code==="Enter")&&this.onClick()};this.nodeRef=t=>{this.node=t}}componentDidMount(){document.addEventListener("mousedown",this.handleOutsideClick,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1)}render(){const{selectedItem:e,list:t,label:i,style:r,isDisabled:o}=this.props,{isOpen:n}=this.state,s=t.length>1,a=o?{}:{tabIndex:0};return jo.default.createElement(cH,null,jo.default.createElement(Li,{isDisabled:o,style:{paddingLeft:"0px"},label:i}),jo.default.createElement(ao,null),jo.default.createElement("div",{ref:this.nodeRef},jo.default.createElement(SI,{id:i.replace(" ","-"),isOpen:n,isDisabled:o},jo.default.createElement(DI,y(y({"aria-hidden":o},a),{showList:s,style:r,onClick:s?this.onClick:void 0,onKeyDown:this.onKeyDown}),e,s&&jo.default.createElement(dH,{rotation:n?180:0})),jo.default.createElement(Kg,{scrollable:t.length>4},s&&t.map(this.listItem)))))}}var II=hH;const OI=v(require("styled-components")),pH=OI.default.div`
  display: flex;
  position: relative;
  margin-bottom: 12px;
  max-width: ${e=>e.theme.measurements.basicToolControlBar.maxWidth}px;
`;var qg=pH;const RI=v(require("styled-components")),uH=RI.default.input.attrs({type:"checkbox",tabIndex:0})`
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
  margin: 0;
  padding: 0;
  ${zt.Focused}
`;var Xg=uH;const Mp=v(require("styled-components")),mH=Mp.default.div.attrs({tabIndex:0})`
  position: relative;
  height: 16px;
  width: 16px;
  cursor: pointer;
  background-color: ${e=>e.theme.checkbox.background};
  border-radius: ${e=>e.theme.shape.radiusSmall}px;
  transition-timing-function: ease-in;
  transition-duration: 0.3s;
  &::after {
    content: '';
    position: absolute;
    display: inline-block;
    left: 5px;
    width: 5px;
    height: 10px;
    border-style: solid;
    border-width: 0 2px 2px 0;
    border-color: transparent;
    transform: rotate(45deg) scale(0.8);
  }

  &:first-child {
    margin-right: 8px;
  }

  &:last-child {
    margin-left: 8px;
  }

  ${zt.Focused}

  &:hover {
    opacity: ${e=>e.theme.checkbox.hoverOpacity};
  }
  ${e=>e.isChecked&&Mp.css`
      background-color: ${e.theme.checkbox.activeBackground};
      &::after {
        color: ${e.theme.checkbox.activeForeground};
        border-color: ${e.theme.checkbox.foreground};
      }
      &:hover {
        background-color: ${e.theme.checkbox.activeBackground};
        opacity: 0.8;
      }
    `}
  ${e=>e.isDisabled&&Mp.css`
      opacity: 0.5;
      cursor: default;
      pointer-events: none;
    `}
`;var Lp=mH;const Yc=v(require("react")),AI=({label:e,value:t,checkMarkPosition:i,onClick:r,isDisabled:o,className:n,style:s})=>{const a=`photoeditorsdk-${e.replace(" ","-")}`;return Yc.default.createElement(qg,{className:n,style:s},i==="left"&&Yc.default.createElement(Lp,{onClick:r,isDisabled:o,isChecked:t}),Yc.default.createElement(Li,{isDisabled:o,label:e,htmlFor:a}),Yc.default.createElement(Xg,{id:a,disabled:o,checked:t,onChange:r}),i==="right"&&Yc.default.createElement(Lp,{onClick:r,isDisabled:o,isChecked:t}))};var FI=AI;AI.defaultProps={value:!1,checkMarkPosition:"left"};const Mr=v(require("react")),lo=v(require("styled-components")),PI=v(Ly()),fH=lo.default.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`,gH=lo.default(Li)`
  align-self: flex-start;
`,BI=lo.default(Mi)`
  color: ${e=>e.theme.button.textSecondaryForeground};
  padding: 1px 7px 2px;
`,bH=lo.default.div`
  display: flex;
  justify-content: space-between;
  width: ${e=>e.theme.measurements.advancedUIToolControlBar.width-48}px;
`,yH=lo.default.article`
  /* 0.6 of width here refers to the width of the container without padding */
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  text-align: center;
  margin-top: 7px;
  display: inline-block;
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
`,vH=lo.default.div`
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  transform: translateZ(0);
  overflow: hidden;
  transition: all 500ms ease-out;
`,_H=lo.default.span`
  width: ${e=>Math.round(e.length*.6*e.theme.measurements.advancedUIToolControlBar.width)}px;
  margin-left: -${e=>e.activeIndex*.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  position: relative;
  display: inline-block;
  transform: translateZ(0);
  transition: all 600ms cubic-bezier(0.77, 0, 0.175, 1);
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
`,MI=lo.default.div`
  border: solid ${e=>e.theme.card.foreground};
  border-width: 0 2px 2px 0;
  padding: 3px;
  height: 0;
  width: 0;

  ${({direction:e})=>e==="left"?lo.css`
          margin-left: 2px;
          transform: rotate(135deg);
        `:lo.css`
          margin-right: 2px;
          transform: rotate(-45deg);
        `}
`;class LI extends Mr.default.PureComponent{constructor(e){super(e);this.updateIndex=(e,t=!1)=>{let i=e+(t?-1:1);const r=this.props.list.length-1;i>r&&(i=0),i<0&&(i=r),this.props.onSelect(this.props.list[i].identifier)};this.getActiveIndex=e=>{const{list:t}=this.props,i=t.findIndex(r=>r.identifier===e);return i!==-1?i:0};this.throttledUpdateIndex=PI.default(this.updateIndex,600)}render(){const{list:e,label:t,showLabel:i=!0}=this.props,r=this.getActiveIndex(this.props.defaultIdentifier),o=e.length<=1;return Mr.default.createElement(fH,null,Mr.default.createElement(gH,{show:i,label:t}),i?Mr.default.createElement(ao,null):null,Mr.default.createElement(bH,{id:`photoeditorsdk-${t.replace(" ","-")}`},Mr.default.createElement(BI,{ariaLabel:"Select Previous",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r,!0)},Mr.default.createElement(MI,{direction:"left"})),Mr.default.createElement(vH,null,Mr.default.createElement(_H,{activeIndex:r,length:e.length},e.map(n=>Mr.default.createElement(yH,{key:n.identifier},n.value)))),Mr.default.createElement(BI,{ariaLabel:"Select Next",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r)},Mr.default.createElement(MI,{direction:"right"}))))}}LI.defaultProps={showLabel:!0};var zI=LI;const zp=v(require("react")),Np=v(require("styled-components")),xH=Np.default.div``,NI=({label:e,children:t,inline:i,showLabel:r,isDisabled:o})=>zp.default.createElement(xH,null,zp.default.createElement(Li,{isDisabled:o,label:e,show:r}),r&&zp.default.createElement(ao,null)||null,zp.default.createElement(wH,{id:`photoeditorsdk-${e.replace(" ","-")}`,inline:!!i},t)),wH=Np.default.div`
  display: inline-flex;
  ${e=>!e.inline&&Np.css`
        flex-wrap: wrap;
      `||""}
`;NI.defaultProps={showLabel:!0};var UI=NI;function Yg(e,t){for(let i=0,{length:r}=e;i<r;i+=1)if(t.apply(t,[e[i],i,e]))return e[i];return null}function Sx(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function Jc(e){return typeof e=="number"&&!Number.isNaN(e)}function gi(e){return parseInt(e,10)}const Tx=["Moz","Webkit","O","ms"];function CH(e){let t="",i=!0,r;for(r=0;r<e.length;r+=1)i?(t+=e[r].toUpperCase(),i=!1):e[r]==="-"?i=!0:t+=e[r];return t}function kx(e,t){return t?`${t}${CH(e)}`:e}function SH(e="transform"){if(typeof window=="undefined"||typeof window.document=="undefined")return"";const{style:t}=window.document.documentElement;if(e in t)return"";let i;for(i=0;i<Tx.length;i+=1)if(kx(e,Tx[i])in t)return Tx[i];return""}var HI=SH();let Jg="";function TH(e,t){return Jg||(Jg=Yg(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],i=>Sx(e[i]))),Sx(e[Jg])?e[Jg](t):!1}function Ex(e,t,i){let r=e;do{if(TH(r,t))return!0;if(r===i)return!1;r=r.parentNode}while(r);return!1}function Zg(e,t,i){if(!e)return;e.attachEvent?e.attachEvent(`on${t}`,i):e.addEventListener?e.addEventListener(t,i,!0):e[`on${t}`]=i}function ma(e,t,i){if(!e)return;e.detachEvent?e.detachEvent(`on${t}`,i):e.removeEventListener?e.removeEventListener(t,i,!0):e[`on${t}`]=null}function GI(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=gi(i.borderTopWidth),t+=gi(i.borderBottomWidth),t}function jI(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=gi(i.borderLeftWidth),t+=gi(i.borderRightWidth),t}function WI(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=gi(i.paddingTop),t-=gi(i.paddingBottom),t}function VI(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=gi(i.paddingLeft),t-=gi(i.paddingRight),t}function KI(e,t){const i=t===t.ownerDocument.body,r=i?{left:0,top:0}:t.getBoundingClientRect(),o=e.clientX+t.scrollLeft-r.left,n=e.clientY+t.scrollTop-r.top;return{x:o,y:n}}function $I({x:e,y:t,rotation:i}){const r=`translate(${e}px,${t}px) rotate(${i}rad)`;return{[kx("transform",HI)]:r}}function qI(e,t){let i=null;return e.targetTouches&&(i=Yg(e.targetTouches,r=>t===r.identifier)),e.changedTouches&&!i&&(i=Yg(e.changedTouches,r=>t===r.identifier)),i}function XI(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:null}const YI=v(require("react-dom"));function Dx(e){const t=YI.default.findDOMNode(e);if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}function JI(e,t,i){if(!e.props.bounds)return[t,i];let{bounds:r}=e.props;r=typeof r=="string"?r:y({},r);const o=Dx(e);if(typeof r=="string"){const{ownerDocument:n}=o,s=n.defaultView,a=r==="parent"?o.parentNode:n.querySelector(r);if(!(a instanceof HTMLElement))throw new Error(`Bounds selector "${r}" could not find an element.`);if(o instanceof HTMLElement){const l=s.getComputedStyle(o),d=s.getComputedStyle(a);r={left:-o.offsetLeft+gi(d.paddingLeft)+gi(l.marginLeft),top:-o.offsetTop+gi(d.paddingTop)+gi(l.marginTop),right:VI(a)-jI(o)-o.offsetLeft+gi(d.paddingRight)-gi(l.marginRight),bottom:WI(a)-GI(o)-o.offsetTop+gi(d.paddingBottom)-gi(l.marginBottom)}}}return r=r,Jc(r.right)&&(t=Math.min(t,r.right)),Jc(r.bottom)&&(i=Math.min(i,r.bottom)),Jc(r.left)&&(t=Math.max(t,r.left)),Jc(r.top)&&(i=Math.max(i,r.top)),[t,i]}function Qg(e,t,i){const{state:r}=e,o=!Jc(r.lastX),n=Dx(e);return o?{node:n,deltaX:0,deltaY:0,lastX:t,lastY:i,x:t,y:i}:{node:n,deltaX:t-r.lastX,deltaY:i-r.lastY,lastX:r.lastX,lastY:r.lastY,x:t,y:i}}function eb(e,t){return{node:t.node,x:e.state.x+t.deltaX,y:e.state.y+t.deltaY,deltaX:t.deltaX,deltaY:t.deltaY,lastX:e.state.x,lastY:e.state.y}}function ZI(e){return e.props.axis==="both"||e.props.axis==="x"}function QI(e){return e.props.axis==="both"||e.props.axis==="y"}function tb(e,t){const i=Dx(t);let{offsetParent:r}=t.props;return!r&&i instanceof HTMLElement&&(r=i.offsetParent||i.ownerDocument.body),KI(e,r)}const ib=v(require("react")),rb=v(require("react-dom")),fn={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Lr=fn.mouse;const Ix={cancel:null,disabled:!1,offsetParent:null,handle:null,transform:null,onStart:()=>{},onDrag:()=>{},onStop:()=>{},onMouseDown:()=>{}};class Zc extends ib.default.Component{constructor(){super(...arguments);this.state={dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:void 0};this.getTouchFromEvent=e=>{const t=XI(e);return this.setState({touchIdentifier:t}),qI(e,t)};this.preventDefault=e=>{e.stopPropagation&&e.stopPropagation()};this.handleDragStart=e=>{const t=rb.default.findDOMNode(this);if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:i}=t;if(this.props.disabled||!(e.target instanceof Node)||this.props.handle&&!Ex(e.target,this.props.handle,t)||this.props.cancel&&Ex(e.target,this.props.cancel,t))return!1;const r=tb(e,this);if(r==null)return!1;const{x:o,y:n}=r,s=Qg(this,o,n),a=this.props.onStart(e,s);if(a===!1)return!1;this.setState({dragging:!0,lastX:o,lastY:n}),Lr.move==="touchmove"?Zg(i,Lr.move,this.onTouchDrag):Zg(i,Lr.move,this.onMouseDrag),Zg(i,Lr.stop,this.handleDragStop)};this.handleDrag=e=>{const t=tb(e,this);if(t==null)return;const{x:i,y:r}=t,o=Qg(this,i,r),n=this.props.onDrag(e,o);if(n===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(s){const a=document.createEvent("MouseEvents");a.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(a)}return}this.setState({lastX:i,lastY:r})};this.handleDragStop=e=>{if(!this.state.dragging)return;const t=tb(e,this);if(t==null)return;const{x:i,y:r}=t,o=Qg(this,i,r),n=rb.default.findDOMNode(this);this.setState({dragging:!1,lastX:NaN,lastY:NaN}),this.props.onStop(e,o),n&&(Lr.move==="touchmove"?ma(n.ownerDocument,Lr.move,this.onTouchDrag):ma(n.ownerDocument,Lr.move,this.onMouseDrag),ma(n.ownerDocument,Lr.stop,this.handleDragStop))};this.onMouseDown=e=>(this.preventDefault(e),Lr=fn.mouse,this.props.onMouseDown(e),e.button&&typeof e.button=="number"&&e.button!==0?!1:this.handleDragStart(e));this.onMouseDrag=e=>(this.preventDefault(e),this.handleDrag(e));this.onMouseUp=e=>(this.preventDefault(e),Lr=fn.mouse,this.handleDragStop(e));this.onTouchStart=e=>{this.preventDefault(e),Lr=fn.touch;const t=this.getTouchFromEvent(e);return this.handleDragStart(t)};this.onTouchDrag=e=>{this.preventDefault(e),Lr=fn.touch;const t=this.getTouchFromEvent(e);return this.handleDrag(t)};this.onTouchEnd=e=>{this.preventDefault(e),Lr=fn.touch;const t=this.getTouchFromEvent(e);return this.handleDragStop(t)}}componentWillUnmount(){const e=rb.default.findDOMNode(this);if(e){const{ownerDocument:t}=e;ma(t,fn.mouse.move,this.onMouseDrag),ma(t,fn.touch.move,this.onTouchDrag),ma(t,fn.mouse.stop,this.handleDragStop),ma(t,fn.touch.stop,this.handleDragStop)}}render(){return ib.default.cloneElement(ib.default.Children.only(this.props.children),{style:y({touchAction:"none"},this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}Zc.defaultProps=Ix,Zc.displayName="DraggableCore";const Up=v(require("react")),kH=y(y({},Ix),{axis:"both",bounds:!1,defaultClassName:"draggable",defaultClassNameDragging:"draggable-dragging",defaultClassNameDragged:"draggable-dragged",defaultPosition:{x:0,y:0},position:null,rotation:0,updateOnPosition:!1});class Ox extends Up.default.Component{constructor(e){super(e);this.onDragStart=(e,t)=>{const i=this.props.onStart(e,eb(this,t));if(i===!1)return!1;this.setState({dragging:!0,dragged:!0})};this.onDrag=(e,t)=>{const{position:i,defaultPosition:r,onDrag:o,bounds:n}=this.props;if(!this.state.dragging)return!1;const s=eb(this,t),a=Boolean(i),l={x:a?s.x:r.x,y:a?s.y:r.y,slackX:0,slackY:0};if(n){const{x:c,y:p}=l;l.x+=this.state.slackX,l.y+=this.state.slackY;const[h,m]=JI(this,l.x,l.y);l.x=h,l.y=m,l.slackX=this.state.slackX+(c-l.x),l.slackY=this.state.slackY+(p-l.y),s.x=l.x,s.y=l.y,s.deltaX=l.x-this.state.x,s.deltaY=l.y-this.state.y}const d=o(e,s);if(d===!1)return!1;this.setState(l)};this.onDragStop=(e,t)=>{if(!this.state.dragging)return!1;const i=this.props.onStop(e,eb(this,t));if(i===!1)return!1;const r={dragging:!1,slackX:0,slackY:0,x:0,y:0},o=Boolean(this.props.position);if(o){const{x:n,y:s}=this.props.position;r.x=n,r.y=s}this.setState(r)};this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,slackX:0,slackY:0}}componentDidUpdate(e){const t=Boolean(this.props.position);t&&(this.props.updateOnPosition?(e.position&&e.position.x!==this.props.position.x||e.position.y!==this.props.position.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}):(e.position&&this.props.position.x!==this.state.x||this.props.position.y!==this.state.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}))}componentWillUnmount(){this.setState({dragging:!1})}render(){const C=this.props,{position:e,defaultPosition:t,rotation:i,defaultClassName:r,defaultClassNameDragging:o,defaultClassNameDragged:n}=C,s=Jt(C,["position","defaultPosition","rotation","defaultClassName","defaultClassNameDragging","defaultClassNameDragged"]),{x:a,y:l,dragging:d,dragged:c}=this.state;let p={};const h=Boolean(e),m=!h||d,b=e||t,_={x:ZI(this)&&m?a:b.x,y:QI(this)&&m?l:b.y,rotation:i};p=$I(_);const g=Up.default.Children.only(this.props.children),S=[g.props.className||"",r,d?o:"",c?n:""].join(" ").trim(),x=Up.default.cloneElement(g,{className:S,style:y(y({},g.props.style),p)});return Up.default.createElement(Zc,y(y({},s),{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),x)}}Ox.defaultProps=kH,Ox.displayName="Draggable";var eO=Ox;const Ml=v(require("react"));class tO extends Ml.default.Component{getChildren(){const e=[],t=[];return Ml.default.Children.forEach(this.props.children,i=>{switch(i.type.componentName){case"case":this.props.type===i.props.value&&e.push(i);break;case"default":t.push(i);break}}),e.length>0?e:t}render(){const e=this.getChildren();return e.length===0?null:Ml.default.createElement(Ml.default.Fragment,null,e)}}class Rx extends Ml.default.Component{render(){return this.props.children}}Rx.componentName="case";class Ax extends Ml.default.Component{render(){return this.props.children}}Ax.componentName="default";const D={Container:$D,ColorItem:W2,ColorItemBase:Bg,ColorItemBackground:Sg,ColorItemTiledBackground:Tg,ColorItemActiveOverlay:kg,Dialog:q2,DialogBase:Lg,DialogContainer:Ng,DialogBackdrop:zg,DialogHeader:$c,DialogBody:ts,DialogFooter:qc,DialogSpinner:Hg,TextEditModal:tI,ActionModal:_x,InfoModal:vx,Spacer:ao,Draggable:eO,DraggableCore:Zc,Toast:qD,Input:{Label:Li,File:gI,Search:mI,Slider:hI,CarouselSlider:zI,Selection:UI,Checkbox:FI,CheckboxBase:qg,CheckboxInput:Xg,CheckboxCheckMark:Lp,Dropdown:II,Text:jg,NumericInput:Wg,Form:yI},Switch:{Index:tO,Case:Rx,Default:Ax}},cze={CommonInputStyles:ua};const iO=v(require("styled-components")),rO=iO.default(No)`
  width: ${e=>e.theme.measurements.advancedCard.small.width}px;
  height: ${e=>e.theme.measurements.advancedCard.small.height}px;
  margin-bottom: ${e=>e.theme.measurements.advancedSpacer}px;
  color: ${e=>e.theme.card.foreground};
  &:nth-child(3n + 1),
  &:nth-child(3n + 2) {
    margin-right: ${e=>e.theme.measurements.advancedSpacer}px;
  }
`;const oO=v(require("styled-components")),nO=oO.default(No)`
  width: ${e=>e.theme.measurements.advancedCard.medium.width}px;
  height: ${e=>e.theme.measurements.advancedCard.medium.height}px;
  margin-bottom: ${e=>e.theme.measurements.advancedSpacer}px;
  color: ${e=>e.theme.card.foreground};
  &:nth-child(2n + 1) {
    margin-right: ${e=>e.theme.measurements.advancedSpacer}px;
  }
`;const sO=v(require("react")),aO=v(require("styled-components")),EH=aO.default(No)`
  width: ${e=>e.theme.measurements.advancedCard.large.width}px;
  height: ${e=>e.theme.measurements.advancedCard.large.height}px;
  margin-bottom: ${e=>e.theme.measurements.advancedSpacer}px;
  color: ${e=>e.theme.card.foreground};
`,DH=i=>{var{isActive:e}=i,t=Jt(i,["isActive"]);return sO.default.createElement(EH,y({},t))};var lO=DH;const dO=v(require("react")),Hp=e=>{const t=e.type===pe.LARGE,i=e.type===pe.SMALL;let r=nO;return t?r=lO:i&&(r=rO),dO.default.createElement(r,y({},e))};const cO=v(require("styled-components")),ob=cO.default.div`
  display: flex;
  flex-wrap: wrap;
  /* we need this for IE11, width - padding on both sides */
  max-width: ${e=>e.theme.measurements.advancedUIToolControlBar.width-48}px;
`;const hO=Ip;const pO=v(require("styled-components")),Gh=pO.default(zo)`
  font-size: ${e=>e.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button2.case};
  color: ${e=>e.theme.button.textSecondaryForeground};

  ${er} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;const Fx=v(require("react")),Px=v(require("styled-components")),IH=Px.default(Mi)`
  width: 60px;
  height: 60px;
  background-color: gray;
  border-radius: 50%;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  z-index: ${e=>e.theme.measurements.zIndex.button.float};
  padding: 2px;
`,OH=Px.default.div`
  height: 56px;
  width: 56px;
  border-radius: 50%;
  background-color: ${e=>e.theme.webcam.floatButton};
`,uO=e=>Fx.default.createElement(IH,y({},e),Fx.default.createElement(OH,null));const Ll=v(require("styled-components")),mO=Ll.default.div`
  display: inline-flex;
`,Co=Ll.default(zo)`
  background: ${e=>e.theme.canvasActionBar.background};
  color: ${e=>e.theme.canvasActionBar.foreground};
  font-size: ${e=>e.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button2.case};
  padding: 4px 10px;
  position: relative;
  /* for safari */
  margin: 0;
  &:last-child:after {
    opacity: 0;
  }
`,Gp=Ll.default.div`
  ${({show:e})=>e?Ll.css`
          opacity: 1;
        `:Ll.css`
          opacity: 0;
        `};
  position: absolute;
  transform: translate(-50%, -100%);
  background: ${e=>e.theme.canvasActionBar.background};
  color: ${e=>e.theme.canvasActionBar.foreground};
  border-radius: ${e=>e.theme.canvasActionBar.borderRadius?e.theme.canvasActionBar.borderRadius:e.theme.shape.radiusMedium}px;
  white-space: nowrap;
  transition: opacity 0.3s ease-in-out;
  z-index: ${e=>e.theme.measurements.zIndex.buttonGroup};

  ${Co} {
    &:after {
      content: '';
      position: absolute;
      right: 0px;
      top: 6px;
      height: calc(100% - 12px);
      border-right: 1px solid ${e=>e.theme.canvasActionBar.separatorColor};
      &:last-child {
        border-right: unset;
      }
    }
  }
`;const fO=v(require("styled-components")),RH=fO.default.div`
  display: flex;
  position: relative;
  flex-direction: column;
  width: 100%;
  height: 100%;
`;var fa=RH;const gO=v(require("styled-components")),AH=gO.default.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`;var bO=AH;const jp=v(require("styled-components")),yO=jp.default.div`
  &&& {
    display: ${e=>e.hide?"none":"flex"};
    flex-direction: row;
    align-items: center;
    height: ${e=>e.theme.measurements.mainCanvasActionBar.height}px;
    color: ${e=>e.theme.mainCanvasActionBar.foreground};
    border-bottom: 1px solid ${e=>e.theme.mainCanvasActionBar.borderColor};
    padding: 8px 24px;
    box-sizing: border-box;
    position: absolute;
    width: 100%;
    z-index: ${e=>e.theme.measurements.zIndex.canvas.bar};
    background: ${e=>e.transparentBackgound?"transparent":e.theme.mainCanvasActionBar.background};
    ${e=>e.bottom?jp.css`
            justify-content: space-around;
            bottom: 0;
            transform: rotate(180deg);
          `:jp.css`
            justify-content: space-between;
          `}
  }
`;var vO=yO;yO.defaultProps={theme:X};const _O=v(require("styled-components")),FH=_O.default.div.attrs({role:"main"})`
  background-color: ${e=>e.theme.canvas.background};
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: auto;
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  /* added this for safari, else the webcam overlay did not know the height */
  height: 100%;
  width: 100%;
  margin-top: ${e=>e.theme.measurements.canvas.marginTop}px;
`;var xO=FH;const wO=v(require("styled-components")),PH=wO.default.canvas`
  position: absolute;
  top: 0;
  left: 0;
`;var CO=PH;const SO=v(require("styled-components")),TO=SO.default.div`
  position: relative;
  transition: all 0.4s cubic-bezier(0.17, 0.04, 0.03, 0.94);
  height: 100%;
  width: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.canvas.webcam.backdrop};
  background-color: ${e=>e.theme.webcam.background};
`;TO.defaultProps={theme:X};var kO=TO;const EO=v(require("styled-components")),BH=EO.default.video`
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
`;var DO=BH;const IO=v(require("styled-components")),OO=IO.default.div.attrs(({radius:e})=>({style:{height:`${e*2}px`,width:`${e*2}px`}}))`
  border-radius: 50%;
  border: 2px solid ${e=>e.theme.canvas.controlsOutline};
  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.2), inset 0 2px 6px 0 rgba(0, 0, 0, 0.2);
  cursor: move;
`;var RO=OO;OO.defaultProps={theme:X};const AO=v(require("styled-components")),FO=AO.default.div`
  position: absolute;
  color: ${e=>e.theme.canvas.controlsOutline};
`;var PO=FO;FO.defaultProps={theme:X};const BO=v(require("styled-components")),MO=BO.default.div`
  position: absolute;
  height: ${e=>e.theme.measurements.canvasControls.knob.touchable.desktop}px;
  width: ${e=>e.theme.measurements.canvasControls.knob.touchable.desktop}px;
  margin-left: -10px;
  margin-top: -10px;
  z-index: ${e=>e.theme.measurements.zIndex.canvas.knob};
  will-change: transform;
  cursor: ew-resize;
  &:before {
    display: block;
    position: absolute;
    content: '';
    background: ${e=>e.theme.canvas.controlsColor};
    border-radius: 50%;
    width: ${e=>e.theme.measurements.canvasControls.knob.size}px;
    height: ${e=>e.theme.measurements.canvasControls.knob.size}px;
    top: ${e=>e.theme.measurements.canvasControls.knob.size/4}px;
    left: ${e=>e.theme.measurements.canvasControls.knob.size/4}px;
    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24);
  }
`;MO.defaultProps={theme:X};var LO=MO;const Ct=v(require("styled-components")),MH=Ct.default.div(e=>{const{desktop:t,mobile:i}=e.theme.measurements.canvasControls.corner.touchable,r=t/4,o=i/2;return Ct.css`
    position: absolute;
    width: ${t}px;
    height: ${t}px;
    ${n=>n.vertical==="top"?Ct.css`
            top: 0px;
          `:Ct.css`
            bottom: 0px;
          `}
    ${n=>n.horizontal==="left"?Ct.css`
            left: 0px;
          `:Ct.css`
            right: 0px;
          `}
  ${n=>n.vertical==="top"?Ct.css`
            margin-top: -${r}px;
          `:Ct.css`
            margin-bottom: -${r}px;
          `}
  ${n=>n.horizontal==="left"?Ct.css`
            margin-left: -${r}px;
          `:Ct.css`
            margin-right: -${r}px;
          `}
  @media all and (min-width: 0) and (max-width: 599px) {
      width: ${i}px;
      height: ${i}px;
      ${n=>n.vertical==="top"?Ct.css`
              margin-top: -${o}px;
            `:Ct.css`
              margin-bottom: -${o}px;
            `}
      ${n=>n.horizontal==="left"?Ct.css`
              margin-left: -${o}px;
            `:Ct.css`
              margin-right: -${o}px;
            `}
    }
  `}),zO=Ct.default(MH)(e=>{const t=e.horizontal==="right"?e.borderWidth:0,i=e.vertical==="bottom"?e.borderWidth:0,r=e.horizontal==="left"?e.borderWidth:0,o=e.vertical==="top"?e.borderWidth:0,n=`${o}px ${t}px ${i}px ${r}px`,s=e.horizontal==="left"&&e.vertical==="bottom"||e.horizontal==="right"&&e.vertical==="top"?"nesw-resize":"nwse-resize",a=e.theme.measurements.canvasControls.corner.touchable.desktop/4-e.borderWidth,l=e.theme.measurements.canvasControls.corner.touchable.mobile/4+e.borderWidth;return Ct.css`
    &:before {
      display: block;
      position: absolute;
      content: '';
      width: ${d=>d.theme.measurements.canvasControls.corner.size}px;
      height: ${d=>d.theme.measurements.canvasControls.corner.size}px;
      z-index: ${d=>d.theme.measurements.zIndex.canvas.controls};
      border-color: ${d=>d.theme.canvas.controlsColor};
      border-style: solid;
      border-width: ${n};
      pointer-events: auto;
      ${e.vertical==="top"?Ct.css`
            top: ${a}px;
          `:Ct.css`
            bottom: ${a}px;
          `}
      ${e.horizontal==="left"?Ct.css`
            left: ${a}px;
          `:Ct.css`
            right: ${a}px;
          `}
      @media all and (min-width: 0) and (max-width: 599px) {
        ${e.vertical==="top"?Ct.css`
              margin-top: ${l}px;
            `:Ct.css`
              margin-bottom: ${l}px;
            `}
        ${e.horizontal==="left"?Ct.css`
              margin-left: ${l}px;
            `:Ct.css`
              margin-right: ${l}px;
            `}
      }
    }
    cursor: ${s};
    pointer-events: none;
  `});zO.defaultProps={theme:X};var nb=zO;const NO=v(require("styled-components")),UO=NO.default.div`
  position: absolute;
  height: ${e=>e.theme.measurements.canvasControls.width.size}px;
  width: 4px;
  z-index: ${e=>e.theme.measurements.zIndex.canvas.controls};
  background: ${e=>e.theme.canvas.controlsColor};
  cursor: pointer;
`;UO.defaultProps={theme:X};var HO=UO;const GO=v(require("styled-components")),jO=GO.default.div.attrs(({height:e,width:t})=>({style:{height:`${e}px`,width:`${t}px`}}))`
  border-style: solid;
  border-width: 2px 0 2px 0;
  border-color: ${e=>e.theme.canvas.controlsOutline};
  box-shadow: 0 -6px 6px -6px rgba(0, 0, 0, 0.2), inset 0 6px 6px -6px rgba(0, 0, 0, 0.2);
  cursor: move;
  position: absolute;
`;var WO=jO;jO.defaultProps={theme:X};const VO=v(require("styled-components")),KO=VO.default.div.attrs(({height:e,width:t,theme:i})=>({style:{height:`${e+i.measurements.canvasControls.sprite.controlPadding}px`,width:`${t+i.measurements.canvasControls.sprite.controlPadding}px`}}))`
  left: -${e=>e.theme.measurements.canvasControls.sprite.controlPadding/2}px;
  top: -${e=>e.theme.measurements.canvasControls.sprite.controlPadding/2}px;
  transform-origin: center center;
  border-style: solid;
  border-width: 2px;
  border-color: ${e=>e.theme.canvas.controlsColor};
  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.2), inset 0 2px 6px 0 rgba(0, 0, 0, 0.2);
  cursor: move;
  will-change: transform;
  position: absolute;
`;var $O=KO;KO.defaultProps={theme:X};const qO=v(require("styled-components")),LH=qO.default.div.attrs(e=>({style:{left:`${e.x}px`}}))`
  position: absolute;
  bottom: -${e=>e.theme.measurements.canvasControls.sprite.rotateHandle.height}px;
  height: ${e=>e.theme.measurements.canvasControls.sprite.rotateHandle.height}px;
  width: 2px;
  background-color: ${e=>e.theme.canvas.controlsOutline};
`;var XO=LH;const YO=v(require("styled-components")),zH=YO.default.div`
  position: relative;
  height: inherit;
  width: inherit;
`;var JO=zH;const ZO=v(require("styled-components")),NH=ZO.default.div.attrs({tabIndex:0})`
  position: absolute;
  height: ${e=>e.height}px;
  width: ${e=>e.width}px;
  top: 0;
  left: 0;
  &:focus {
    outline: 0;
  }
`;var QO=NH;const ga=v(require("styled-components")),sb=aS()?ga.css`
      transition: unset;
    `:ga.css`
      transition: all 0.4s ease-in-out;
    `,eR=ga.default.div`
  position: absolute;
  background: ${e=>e.theme.canvas.cropBackdrop};
  z-index: ${e=>e.theme.measurements.zIndex.canvas.crop.backdrop};
  ${sb}
`,tR=ga.default.div.attrs({"data-test":"CropMask"})`
  position: absolute;
  box-shadow: inset 0 0 0 2px ${e=>e.theme.canvas.controlsOutline};
  cursor: move;
  ${sb}
`,iR=ga.default.div`
  position: absolute;
  background: ${e=>e.theme.canvas.controlsOutline};
  z-index: ${e=>e.theme.measurements.zIndex.canvas.crop.grid};
  ${sb}
`,zl=ga.default(nb)`
  z-index: ${e=>e.theme.measurements.zIndex.canvas.controls};
  ${sb};
`;const ae={Index:bO,Area:fa,Bar:{Index:vO,ButtonGroup:mO},Button:{TextSecondary:Gh,Float:uO},Container:xO,Element:CO,Wrapper:kO,Webcam:DO,Controls:{Knob:LO,Circle:RO,Corner:nb,Line:PO,Area:WO,Sprite:$O,RotateHandle:XO,Container:JO,Wrapper:QO,SpriteActionsWrapper:Gp,SpriteActionButton:Co,Width:HO},Crop:{Mask:tR,GridLine:iR,Backdrop:eR,Control:zl}};const is=v(require("react")),Bx=24;class UH extends is.default.Component{constructor(e){super(e);this.init=()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{this.video.srcObject=e}).catch(()=>{this.props.modal.showActionModal({type:ot.ERROR,identifier:"webcamUnavailable",error:"Webcam not supported",handleConfirm:()=>{this.props.active.selectWebcam(!1)}})}):this.props.modal.showActionModal({type:ot.ERROR,identifier:"webcamUnavailable",error:"Webcam not supported",handleConfirm:()=>{this.props.active.selectWebcam(!1)}})};this.stop=()=>{const{active:e}=this.props,t=this.video.srcObject,i=t.getTracks();i.forEach(r=>{r.stop()}),this.video.srcObject=null,e.selectWebcam(!1)};this.captureAndCloseWebcam=()=>{this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0),this.props.active.newImage(this.canvas.toDataURL("image/webp")),this.stop()};this.videoRef=is.default.createRef()}componentDidMount(){this.canvas=document.createElement("canvas"),this.video=this.videoRef.current,this.init()}render(){const{editor:e}=this.props,{height:t,width:i}=e.getPreviewSize(),{measurements:r}=e.configStore,o=this.props.canvas.canvasSize.height,n=(o-t)/2,s=n<Bx+r.buttons.float.size?o-Bx*2-r.buttons.float.size/2:o-n+Bx,a=this.props.active.webcamLabel;return is.default.createElement(ae.Wrapper,null,is.default.createElement(ae.Bar.Index,{transparentBackgound:!0,style:{justifyContent:"flex-end"}},is.default.createElement(ae.Bar.ButtonGroup,null,is.default.createElement(Mn,{ariaLabel:a,onClick:this.stop},a))),is.default.createElement(ae.Webcam,{style:{height:t,width:i},autoPlay:!0,ref:this.videoRef}),is.default.createElement(ae.Button.Float,{ariaLabel:"Click and Save",style:{top:s},onClick:this.captureAndCloseWebcam}))}}var rR=O("active","canvas","modal","editor")(I(UH));const Wp=v(require("react"));class HH extends Wp.Component{constructor(e){super(e);this.wrapperElementRef=null;this.timeout=null;this.updateDimensions=(e=!0)=>{e?(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.update(e)},100)):this.update(e)};this.update=(e=!0)=>{const t=this.wrapperElementRef.current;this.props.canvas.saveDimensions({width:t&&t.clientWidth||0,height:t&&t.clientHeight||0,render:e})};this.wrapperElementRef=Wp.default.createRef(),this.resizeObserver=new xp(()=>{this.updateDimensions(!1)})}componentDidMount(){this.updateDimensions(!1),window.addEventListener("resize",()=>this.updateDimensions(!0)),this.wrapperElementRef.current&&this.resizeObserver.observe(this.wrapperElementRef.current)}componentWillUnmount(){window.removeEventListener("resize",()=>this.updateDimensions(!0)),this.timeout&&clearTimeout(this.timeout)}render(){return Wp.default.createElement(ae.Container,{"data-test":hi.CanvasContainer,ref:this.wrapperElementRef},this.props.children)}}var oR=O("canvas")(I(HH));const co=(e,t)=>e!==void 0&&t!==void 0&&!Number.isNaN(e)&&!Number.isNaN(t);const gn=v(require("react")),Mx=v(require("styled-components")),Lx=Mx.default(ae.Controls.Knob)`
  margin-top: -${e=>e.theme.measurements.canvasControls.knob.touchable.desktop/2}px;
  margin-left: -${e=>e.theme.measurements.canvasControls.knob.touchable.desktop/2}px;
`,GH=Mx.default(ae.Controls.Container)`
  overflow: unset;
`;class jH extends gn.default.Component{constructor(){super(...arguments);this.start=(e,{x:t,y:i})=>{co(t,i)&&this.focusTool.setStart({x:t,y:i})};this.end=(e,{x:t,y:i})=>{co(t,i)&&this.focusTool.setEnd({x:t,y:i})};this.onKnob1DragStart=(e,t)=>{this.focusTool.clickableCanvas(!1),this.start(e,t)};this.onKnob1DragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusPosition),this.start(e,t),this.focusTool.clickableCanvas(!0)};this.onKnob2DragStart=(e,t)=>{this.focusTool.clickableCanvas(!1),this.end(e,t)};this.onKnob2DragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusPosition),this.end(e,t),this.focusTool.clickableCanvas(!0)};this.addSnapshot=({x:e,y:t},i)=>{co(e,t)&&this.focusTool.toolSnapshot(i)};this.getLine=()=>{const{height:e,width:t}=this.props.canvas.canvasSize,i=this.focusTool.startOnPreview,r=this.focusTool.endOnPreview;return gn.default.createElement("svg",{focusable:"false",height:e,width:t},gn.default.createElement("line",{x1:i.x,y1:i.y,x2:r.x,y2:r.y,strokeWidth:"2",stroke:"currentColor"}))}}get focusTool(){return this.props.focusTool}get historyLocale(){return this.focusTool.locale.history}render(){return gn.default.createElement(GH,null,gn.default.createElement(ae.Controls.Line,null,this.getLine()),gn.default.createElement(D.Draggable,{bounds:"parent",position:this.focusTool.startOnPreview,onStart:this.onKnob1DragStart,onDrag:this.start,onStop:this.onKnob1DragStop},gn.default.createElement(Lx,null)),gn.default.createElement(D.Draggable,{bounds:"parent",onStart:this.onKnob2DragStart,onDrag:this.end,onStop:this.onKnob2DragStop,position:this.focusTool.endOnPreview},gn.default.createElement(Lx,null)))}}Lx.defaultProps={theme:X};var nR=O("canvas","focusTool")(I(jH));const Nl=v(require("react"));class WH extends Nl.default.Component{constructor(){super(...arguments);this.state={knobAngle:2.35};this.onCircle=(e,{x:t,y:i})=>{if(co(t,i)){const{radius:r}=this.focusTool;this.focusTool.setCenter({x:t+r,y:i+r})}};this.onKnob=(e,{x:t,y:i})=>{if(co(t,i)){const{center:r}=this.focusTool,o=new E(t,i),n=new E(r.x,r.y),s=n.subtract(o),a=s.magnitude,l=-Math.atan2(s.y,s.x);this.setState({knobAngle:l}),this.focusTool.setRadius(a)}};this.onCircleDragStart=(e,t)=>{this.focusTool.clickableCanvas(!1),this.onCircle(e,t)};this.onCircleDragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusPosition),this.onCircle(e,t),this.focusTool.clickableCanvas(!0)};this.onKnobDragStart=(e,t)=>{this.focusTool.clickableCanvas(!1),this.onKnob(e,t)};this.onKnobDragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusSize),this.onKnob(e,t),this.focusTool.clickableCanvas(!0)};this.addSnapshot=({x:e,y:t},i)=>{co(e,t)&&this.focusTool.toolSnapshot(i)}}componentDidMount(){this.setState({knobAngle:2.35})}get historyLocale(){return this.focusTool.locale.history}get focusTool(){return this.props.focusTool}render(){const{center:e,radius:t}=this.focusTool,i={x:e.x-t,y:e.y-t},r=Math.PI-this.state.knobAngle,o={x:e.x+t*Math.cos(r),y:e.y+t*Math.sin(r)};return Nl.default.createElement(ae.Controls.Container,null,Nl.default.createElement(D.Draggable,{bounds:"parent",onStart:this.onKnobDragStart,onDrag:this.onKnob,onStop:this.onKnobDragStop,position:o},Nl.default.createElement(ae.Controls.Knob,null)),Nl.default.createElement(D.Draggable,{onStart:this.onCircleDragStart,onDrag:this.onCircle,onStop:this.onCircleDragStop,position:i},Nl.default.createElement(ae.Controls.Circle,{radius:t})))}}var sR=O("focusTool","canvas")(I(WH));const Ul=v(require("react"));class VH extends Ul.default.Component{constructor(){super(...arguments);this.getKnobPosition=()=>{const{origin:e}=this.focusTool,t=this.focusTool.size/2,i=Math.PI/2+this.focusTool.rotation;return{x:e.x+t*Math.cos(i),y:e.y+t*Math.sin(i)}};this.onArea=(e,{x:t,y:i})=>{const{editor:r}=this.props,o=r.configStore.measurements.canvasControls.knob.size;if(co(t,i)){const{canvas:n}=this.props,{size:s,mirroredAreaWidth:a}=this.focusTool,l=t+a/2,d=i+s/2,c=new E(this.getKnobPosition()),p=new E({x:t,y:i}),h=p.subtract(new E(this.areaPosition)),m=c.add(h);m.x>o&&m.x<n.canvasSize.width-o&&(m.y>o&&m.y<n.canvasSize.height-o&&this.focusTool.setOrigin({x:l,y:d}))}};this.onKnob=(e,{x:t,y:i})=>{if(co(t,i)){this.focusTool.clickableCanvas(!1);const r=new E(this.focusTool.origin),o=new E(t,i),n=r.subtract(o),s=n.magnitude,a=Math.PI/2+Math.atan2(n.y,n.x);this.focusTool.setSize(s*2),this.focusTool.setRotation(a)}};this.onAreaDragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusPosition),this.onArea(e,t),this.focusTool.clickableCanvas(!0)};this.onKnobDragStop=(e,t)=>{this.addSnapshot(t,this.historyLocale.focusSize),this.onKnob(e,t),this.focusTool.clickableCanvas(!0)};this.addSnapshot=({x:e,y:t},i)=>{co(e,t)&&this.focusTool.toolSnapshot(i)}}get historyLocale(){return this.focusTool.locale.history}get focusTool(){return this.props.focusTool}get areaPosition(){const{origin:e,size:t,mirroredAreaWidth:i}=this.focusTool;return{x:e.x-i/2,y:e.y-t/2}}render(){const{x:e,y:t}=this.areaPosition;return Ul.default.createElement(ae.Controls.Container,null,Ul.default.createElement(D.Draggable,{bounds:"parent",onStart:this.onKnob,onDrag:this.onKnob,onStop:this.onKnobDragStop,position:this.getKnobPosition()},Ul.default.createElement(ae.Controls.Knob,null)),Ul.default.createElement(D.Draggable,{onStart:this.onArea,onDrag:this.onArea,onStop:this.onAreaDragStop,position:{x:e,y:t},rotation:this.focusTool.rotation},Ul.default.createElement(ae.Controls.Area,{height:this.focusTool.size,width:this.focusTool.mirroredAreaWidth})))}}var aR=O("focusTool","canvas","editor")(I(VH));const lR=v(require("react")),KH=({focusTool:e})=>{const{state:t}=e,i=()=>{switch(t.identifier){case Ce.LINEAR:return nR;case Ce.RADIAL:return sR;case Ce.MIRRORED:return aR}return null},r=i();return e.isOptionSelected&&r?lR.default.createElement(r,null):null};var dR=O("focusTool")(I(KH));const Vp=v(require("react")),zx=v(require("styled-components")),$H=zx.default(ae.Controls.Container)`
  cursor: none;
`,qH=zx.default.div`
  position: absolute;
  width: 20px;
  height: 20px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  border-width: 2px;
  border-style: solid;
  box-shadow: 0 0 0 0.5px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 1);
`;class XH extends Vp.default.Component{constructor(e){super(e);this.INITIAL_POSITION={x:void 0,y:void 0};this.state=y(y({},this.INITIAL_POSITION),{isDrawing:!1});this.containerElementRef=null;this.getCursorCoordinates=e=>{let t=0,i=0;if(e.type.indexOf("touch")!==-1){const s=e;if(!s.touches.length)return y(y({},this.INITIAL_POSITION),{height:0,width:0});t=s.touches[0].clientX,i=s.touches[0].clientY}else{const s=e;t=s.clientX,i=s.clientY}const r=this.containerElementRef.current.getBoundingClientRect(),o=t-r.left,n=i-r.top;return{x:o,y:n,height:r.height,width:r.width}};this.draw=e=>{e.preventDefault(),e.stopPropagation(),this.touchDraw(e)};this.touchDraw=e=>{const{x:t,y:i}=this.getCursorCoordinates(e);t!==void 0&&i!==void 0&&(this.setState({x:t,y:i}),this.state.isDrawing&&this.brushTool.strokePosition({x:t,y:i}))};this.start=()=>{this.brushTool.clickableCanvas(!1),this.setState({isDrawing:!0}),this.brushTool.beginStroke()};this.stop=e=>{this.state.isDrawing&&(e.preventDefault(),e.stopPropagation(),this.setState({isDrawing:!1}),this.brushTool.endStroke(),this.brushTool.clickableCanvas(!0))};this.setInitialPosition=()=>{this.setState(y({},this.INITIAL_POSITION))};this.mouseOut=e=>{const{config:t}=this.props;e.preventDefault(),e.stopPropagation();const i=this.brushTool.sizeOnScreenSpace/2,{x:r,y:o,height:n,width:s}=this.getCursorCoordinates(e);r&&o&&((r<0||o<0||r>s-i||o>n-i||o<t.measurements.mainCanvasActionBar.height)&&this.setInitialPosition())};this.touchEnd=e=>{e.preventDefault(),e.stopPropagation();const{x:t,y:i}=this.state;t&&i&&this.setInitialPosition()};this.getCursor=()=>{const{x:e,y:t}=this.state;if(e&&t){const i=Yn(this.brushTool.color),r=`${this.brushTool.sizeOnScreenSpace}px`,o={left:`${this.state.x}px`,top:`${this.state.y}px`,borderColor:i,height:r,width:r};return Vp.default.createElement(qH,{style:o,"data-test":hi.Cursor})}return null};this.containerElementRef=Vp.default.createRef()}componentDidMount(){document.addEventListener("mouseup",this.stop,!1),document.addEventListener("touchend",this.stop,{passive:!1})}componentWillUnmount(){document.removeEventListener("mouseup",this.stop,!1),document.removeEventListener("touchend",this.stop,!1)}get brushTool(){return this.props.brushTool}render(){return Vp.default.createElement($H,{ref:this.containerElementRef,"data-test":hi.CursorContainer,onMouseMove:this.draw,onTouchMove:this.touchDraw,onMouseDown:this.start,onTouchStart:this.start,onMouseOut:this.mouseOut,onTouchEnd:this.touchEnd},this.getCursor())}}var cR=O("brushTool","config")(I(XH));const Si=v(require("react")),YH=()=>Si.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Adjustments",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},Si.default.createElement("g",{fill:"none",fillRule:"evenodd"},Si.default.createElement("g",null,Si.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},Si.default.createElement("rect",{width:"48",height:"48"})),Si.default.createElement("g",{transform:"translate(12 12)"},Si.default.createElement("rect",{fill:"#D8D8D8",opacity:"0",width:"24",height:"24"}),Si.default.createElement("g",{transform:"translate(2 13)",fill:"currentColor"},Si.default.createElement("path",{d:"M3.02746439,4 C3.00931666,4.16416693 3,4.33099545 3,4.5 C3,4.66900455 3.00931666,4.83583307 3.02746439,5 L0,5 L0,4 L3.02746439,4 Z M13,4 L20,4 L20,5 L13,5 L13,4 Z",fillOpacity:"0.2"}),Si.default.createElement("path",{d:"M5.09842503,6.29819429 C5.0340931,6.05140089 5,5.7851211 5,5.5 C5,3.56700338 6.56700338,2 8.5,2 C8.7851211,2 9.05140089,2.0340931 9.29819429,2.09842503 C10.0278893,2.64566496 10.5,3.5176988 10.5,4.5 C10.5,6.15685425 9.15685425,7.5 7.5,7.5 C6.5176988,7.5 5.64566496,7.02788926 5.09842503,6.29819429 Z M11.1637159,7.11349161 C10.874061,7.51881791 10.5188179,7.87406095 10.1134916,8.16371592 C10.5772175,7.93004328 10.9300433,7.5772175 11.1637159,7.11349161 Z",fillOpacity:"0.2"}),Si.default.createElement("path",{d:"M7.5,7.5 C9.15685425,7.5 10.5,6.15685425 10.5,4.5 C10.5,2.84314575 9.15685425,1.5 7.5,1.5 C5.84314575,1.5 4.5,2.84314575 4.5,4.5 C4.5,6.15685425 5.84314575,7.5 7.5,7.5 Z M7.5,9 C5.01471863,9 3,6.98528137 3,4.5 C3,2.01471863 5.01471863,0 7.5,0 C9.98528137,0 12,2.01471863 12,4.5 C12,6.98528137 9.98528137,9 7.5,9 Z",fillOpacity:"0.87"})),Si.default.createElement("g",{transform:"rotate(-180 11 5.5)",fill:"currentColor"},Si.default.createElement("path",{d:"M11.9725356,4 L20,4 L20,5 L11.9725356,5 C11.9906833,4.83583307 12,4.66900455 12,4.5 C12,4.33099545 11.9906833,4.16416693 11.9725356,4 Z M0,4 L2,4 L2,5 L0,5 L0,4 Z",fillOpacity:"0.2"}),Si.default.createElement("g",{transform:"rotate(-180 5 3.5)",fillOpacity:"0.2"},Si.default.createElement("path",{d:"M0.0984250251,4.29819429 C0.0340930963,4.05140089 0,3.7851211 0,3.5 C0,1.56700338 1.56700338,0 3.5,0 C3.7851211,0 4.05140089,0.0340930963 4.29819429,0.0984250251 C5.02788926,0.645664963 5.5,1.5176988 5.5,2.5 C5.5,4.15685425 4.15685425,5.5 2.5,5.5 C1.5176988,5.5 0.645664963,5.02788926 0.0984250251,4.29819429 Z M6.16371592,5.11349161 C5.87406095,5.51881791 5.51881791,5.87406095 5.11349161,6.16371592 C5.5772175,5.93004328 5.93004328,5.5772175 6.16371592,5.11349161 Z"})),Si.default.createElement("path",{d:"M7.5,7.5 C9.15685425,7.5 10.5,6.15685425 10.5,4.5 C10.5,2.84314575 9.15685425,1.5 7.5,1.5 C5.84314575,1.5 4.5,2.84314575 4.5,4.5 C4.5,6.15685425 5.84314575,7.5 7.5,7.5 Z M7.5,9 C5.01471863,9 3,6.98528137 3,4.5 C3,2.01471863 5.01471863,-3.6739404e-16 7.5,-3.6739404e-16 C9.98528137,-3.6739404e-16 12,2.01471863 12,4.5 C12,6.98528137 9.98528137,9 7.5,9 Z",fillOpacity:"0.87"}))))));var hR=YH;const Wo=v(require("react")),JH=()=>Wo.default.createElement("svg",{"aria-hidden":"true",focusable:"false","aria-label":"Filter",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},Wo.default.createElement("g",{fill:"none",fillRule:"evenodd"},Wo.default.createElement("g",null,Wo.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},Wo.default.createElement("rect",{width:"48",height:"48"})),Wo.default.createElement("g",{transform:"translate(16 14)",fill:"currentColor"},Wo.default.createElement("g",null,Wo.default.createElement("path",{d:"M1.53468397,11.3244256 C2.30584171,10.1516526 4.0927284,8.69757613 8,10 C11.5643313,11.1881104 13.1877038,10.2588113 13.9183327,9.30853287 C14.2918933,10.1286474 14.5,11.0400207 14.5,12 C14.5,15.5898509 11.5898509,18.5 8,18.5 C4.41014913,18.5 1.5,15.5898509 1.5,12 C1.5,11.7718729 1.51175212,11.5464906 1.53468397,11.3244256 Z",fillOpacity:"0.2"}),Wo.default.createElement("path",{d:"M1.53471819,12.6759057 C2.39408133,13.5811739 4.12541941,14.1109247 5.5,13.5 C9.81068889,11.5841383 9.99203585,9.66827654 14.3948028,10.8290113 C14.4639074,11.2088572 14.5,11.6002137 14.5,12 C14.5,15.5898509 11.5898509,18.5 8,18.5 C4.63838968,18.5 1.87279864,15.9481381 1.53471819,12.6759057 Z",fillOpacity:"0.25"}),Wo.default.createElement("path",{d:"M11,1.44328993e-15 L11,4.58151705 C13.9318303,5.7682918 16,8.64262245 16,12 C16,16.418278 12.418278,20 8,20 C3.581722,20 0,16.418278 0,12 C0,8.64262245 2.06816966,5.7682918 5,4.58151705 L5,1.60982339e-15 L6.5,1.44328993e-15 L6.5,5.67393184 C3.6333,6.35109564 1.5,8.92641836 1.5,12 C1.5,15.5898509 4.41014913,18.5 8,18.5 C11.5898509,18.5 14.5,15.5898509 14.5,12 C14.5,8.92641836 12.3667,6.35109564 9.5,5.67393184 L9.5,1.77635684e-15 L11,1.44328993e-15 Z",fillOpacity:"0.87"}))))));var pR=JH;const ho=v(require("react")),ZH=()=>ho.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Focus",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},ho.default.createElement("g",{fill:"none",fillRule:"evenodd"},ho.default.createElement("g",null,ho.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},ho.default.createElement("rect",{width:"48",height:"48"})),ho.default.createElement("g",{transform:"translate(12 12)"},ho.default.createElement("rect",{fill:"#D8D8D8",opacity:"0",width:"24",height:"24"}),ho.default.createElement("g",{transform:"translate(4 2)",fill:"currentColor"},ho.default.createElement("path",{d:"M8.51312274,19.9836057 C8.77273397,19.9669655 9.02898229,19.9377873 9.2812837,19.8966625 C9.14309542,19.9643562 9.04607398,20 9,20 C8.83633495,20 8.67398178,19.9944755 8.51312274,19.9836057 Z M2.27242753,15.0235117 C2.09503729,14.4174909 2,13.7771617 2,13.115 C2,8.89625769 7.39855682,4.1952443 9.03524007,2.8669743 C9.66704719,3.45933018 10.2896864,4.09178959 10.8802638,4.75434357 C12.9939648,7.12565193 14.310818,9.45010207 14.481291,11.4644804 C14.4937541,11.6117488 14.5,11.7569175 14.5,11.9 C14.5,15.5490785 11.5855665,18.5 8,18.5 C5.525182,18.5 3.37015673,17.0943182 2.27242753,15.0235117 Z M15.999821,11.9547651 C15.9999402,11.9698392 16,11.9849176 16,12 C16,12.0581275 15.9984809,12.1163475 15.9954873,12.1746435 C15.9978914,12.1015915 15.9993401,12.0282946 15.999821,11.9547651 Z",fillOpacity:"0.2"}),ho.default.createElement("path",{d:"M3.47269084,16.6357644 C3.47244857,13.6389249 9.59189484,15.3529683 12,11.5 C13.2066771,9.56931667 12.316614,7.05620551 11.0727604,4.97270186 C13.0737756,7.26814668 14.316054,9.51197209 14.481291,11.4644804 C14.4937541,11.6117488 14.5,11.7569175 14.5,11.9 C14.5,15.5490785 11.5855665,18.5 8,18.5 C6.2411126,18.5 4.64375705,17.7899702 3.47269084,16.6357644 Z",fillOpacity:"0.25"}),ho.default.createElement("path",{d:"M7.73975027,2.16383649 C6.84545319,2.94914111 5.95084629,3.82194197 5.11973623,4.75434357 C3.00603518,7.12565193 1.68918197,9.45010207 1.51870896,11.4644804 C1.50624591,11.6117488 1.5,11.7569175 1.5,11.9 C1.5,15.5492218 4.41434886,18.5 8,18.5 C11.5855665,18.5 14.5,15.5490785 14.5,11.9 C14.5,11.7569175 14.4937541,11.6117488 14.481291,11.4644804 C14.310818,9.45010207 12.9939648,7.12565193 10.8802638,4.75434357 C10.0491537,3.82194197 9.15454681,2.94914111 8.26024973,2.16383649 C8.17157048,2.08596503 8.08476013,2.01060875 8,1.93784184 C7.91523987,2.01060875 7.82842952,2.08596503 7.73975027,2.16383649 Z M8,20 C3.581722,20 0,16.3735065 0,11.9 C0,6.05 8,0 8,0 C8,0 16,6.05 16,11.9 C16,16.3732777 12.418278,20 8,20 Z",fillOpacity:"0.87"}))))));var uR=ZH;const zr=v(require("react")),QH=()=>zr.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Library",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},zr.default.createElement("g",{fill:"none",fillRule:"evenodd"},zr.default.createElement("g",{transform:"translate(15 15)",fill:"currentColor"},zr.default.createElement("g",null,zr.default.createElement("polygon",{fillOpacity:"0.2",points:"3 3 12.5 1.5 12.5 15.5 1.5 15.5"}),zr.default.createElement("path",{d:"M1.5,1.5 L1.5,15.5 L12.5,15.5 L12.5,1.5 L1.5,1.5 Z M0,0 L14,0 L14,17 L0,17 L0,0 Z",fillOpacity:"0.87"}),zr.default.createElement("polygon",{fillOpacity:"0.25",points:"3 11 6 7 8 9 9 8.5 11 11"}),zr.default.createElement("circle",{fillOpacity:"0.25",cx:"9",cy:"5",r:"1"}),zr.default.createElement("rect",{fillOpacity:"0.25",x:"3",y:"13",width:"8",height:"1"}),zr.default.createElement("g",{transform:"rotate(14 -2.352 56.952)",fillOpacity:"0.2"},zr.default.createElement("path",{d:"M1.32904158,1.07500967e-13 L5,1.07500967e-13 L5,14.7234101 L4,10.7126291 L4,1 L1.57836958,1 L1.32904158,1.07500967e-13 Z M5,14.9745817 L5,16 L0.887271787,16 L5,14.9745817 Z"}),zr.default.createElement("path",{d:"M1.82769758,2 L3,2 L3,6.70184819 L1.82769758,2 Z"}))))));var mR=QH;const Qc=v(require("react")),e7=()=>Qc.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Overlays",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},Qc.default.createElement("g",{fill:"none",fillRule:"evenodd"},Qc.default.createElement("g",{transform:"translate(15 15)",fill:"currentColor"},Qc.default.createElement("path",{d:"M13.5,4 L13.5,13.5 L4,13.5 L4,5 C4,4.44771525 4.44771525,4 5,4 L13.5,4 Z M15,4 L17,4 C17.5522847,4 18,4.44771525 18,5 L18,17 C18,17.5522847 17.5522847,18 17,18 L5,18 C4.44771525,18 4,17.5522847 4,17 L4,15 L14,15 C14.5522847,15 15,14.5522847 15,14 L15,4 Z",fillOpacity:"0.2"}),Qc.default.createElement("path",{d:"M1.5,1.5 L1.5,13.5 L13.5,13.5 L13.5,1.5 L1.5,1.5 Z M1,0 L14,0 C14.5522847,-1.01453063e-16 15,0.44771525 15,1 L15,14 C15,14.5522847 14.5522847,15 14,15 L1,15 C0.44771525,15 6.76353751e-17,14.5522847 0,14 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 Z",fillOpacity:"0.87"}))));var fR=e7;const bn=v(require("react")),t7=()=>bn.default.createElement("svg",{focusable:"false","aria-hidden":"true",width:"48px",height:"48px",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-label":"Stickers",viewBox:"0 0 48 48"},bn.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},bn.default.createElement("g",null,bn.default.createElement("g",{transform:"translate(14.000000, 14.000000)",fill:"currentColor"},bn.default.createElement("g",{transform:"translate(2.000000, 2.000000)",fillOpacity:"0.2"},bn.default.createElement("path",{d:"M11.5840291,0.290311095 C14.1040281,1.4637822 15.9529364,3.83641178 16.3972985,6.6747443 C11.4538042,7.5567274 7.55733385,11.4556991 6.68374109,16.3973312 C3.83946575,15.9530468 1.46423317,14.1041207 0.290132399,11.5832649 C0.0988489957,10.7650202 3.01980663e-14,9.89786431 3.01980663e-14,9 C3.01980663e-14,6.64646143 0.903391324,4.50392121 2.38232909,2.90022422 C4.02683831,1.11698861 6.38297582,-3.55271368e-15 9,-3.55271368e-15 C9.89814387,-3.55271368e-15 10.7655602,0.0989105588 11.5840291,0.290311095 Z"}),bn.default.createElement("path",{d:"M17.9877222,8 L8,17.9877222 C8.2591955,12.5923102 12.5906864,8.26470667 17.9877222,8 Z"})),bn.default.createElement("path",{d:"M9.87290303,14.9211604 C9.09408801,14.4293124 5,11.7146562 5,9 C5,7.34 6.34,6 8,6 C8.77,6 9.47,6.52 10,7 C10.53,6.52 11.23,6 12,6 C13.66,6 15,7.34 15,9 C15,9.30171667 14.9494261,9.60343334 14.8584511,9.90209822 C12.7354304,11.0373368 10.9933363,12.7905402 9.87290303,14.9211604 Z",fillOpacity:"0.25"}),bn.default.createElement("path",{d:"M10,1.5 C5.30557963,1.5 1.5,5.30557963 1.5,10 C1.5,14.2449983 4.61102233,17.7611603 8.68374109,18.3973312 C9.55733385,13.4556991 13.4538042,9.5567274 18.3972985,8.6747443 C17.7608961,4.60976745 14.2436106,1.5 10,1.5 Z M0,10 C0,4.4771525 4.4771525,0 10,0 C15.5228475,0 20,4.4771525 20,10 C14.5988732,10.2649073 10.2649073,14.5988732 10.0116954,19.9999933 C4.4771525,20 0,15.5228475 0,10 Z",fillOpacity:"0.87"})))));var gR=t7;const eh=v(require("react")),i7=()=>eh.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Texts",width:"48",height:"48"},eh.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},eh.default.createElement("path",{fillOpacity:"0.2",d:"M17.883 19.5H16.07L11.702 6.833l1.235-1.411L17.883 19.5z",transform:"translate(12 12)"}),eh.default.createElement("path",{fillOpacity:"0.87",d:"M10.8 8.818L8.483 14.5h4.275l-1.96-5.682zM10 6.5l3.5-4 5.973 17H21V21h-8v-1.5h1.483L13.276 16H7.873l-1.426 3.5H8V21H3v-1.5h1.704L10 6.5zm1.702.333L16.069 19.5h1.814L12.937 5.422l-1.235 1.411z",transform:"translate(12 12)"}),eh.default.createElement("path",{fillOpacity:"0.2",d:"M19.55 15l-.35-1H21v1h-1.45zm1.05 3l-.35-1H21v1h-.4zM7.639 8L7.25 9H3V8h4.639zm1.167-3l-.39 1H7V5h1.806zm-2.334 6l-.389 1H6v-1h.472zm-1.166 3l-.39 1H3v-1h2.306zm-1.167 3l-.389 1H3v-1h1.139zM15.35 3L15 2h1v1h-.65zm3.15 9l-.35-1H21v1h-2.5zm-1.05-3l-.35-1H21v1h-3.55zM16.4 6l-.35-1H18v1h-1.6zm-5.9-3H9V2h2.5l-1 1zM3 5h3v1H3V5zm16 0h2v1h-2V5zM3 11h2v1H3v-1zm18-8h-4V2h4v1zM8 3H3V2h5v1z",transform:"translate(12 12)"})));var bR=i7;const th=v(require("react")),r7=()=>th.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Text Design",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},th.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},th.default.createElement("path",{fillOpacity:"0.87",d:"M1 0h14a1 1 0 011 1v19l-8-6-8 6V1a1 1 0 011-1zm.5 1.5V17L8 12.125 14.5 17V1.5h-13z",transform:"translate(14 14) translate(2)"}),th.default.createElement("path",{fillOpacity:"0.2",d:"M1.5 1.5h13V17L8 12.125 1.5 17V1.5z",transform:"translate(14 14) translate(2)"}),th.default.createElement("path",{fillOpacity:"0.25",d:"M9 4l2.52 7H10.2l-.7-1.85H6.45L5.77 11H4.49L6.9 4H9zm-1.04.78h-.05L6.73 8.14H9.2L7.96 4.78z",transform:"translate(14 14) translate(2)"})));var yR=r7;const Hl=v(require("react")),o7=()=>Hl.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",focusable:"false","aria-hidden":"true","aria-label":"Frames",width:"48",height:"48",viewBox:"0 0 48 48"},Hl.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(12 12)"},Hl.default.createElement("path",{fillOpacity:"0.2",d:"M8 8L17 7 17 17 7 17z"}),Hl.default.createElement("path",{fillOpacity:"0.87",d:"M4.5 19.5h15v-15h-15v15zM3 3h18v18H3V3z"}),Hl.default.createElement("path",{fillOpacity:"0.87",d:"M7 17h10V7H7v10zM6 6h12v12H6V6z"}),Hl.default.createElement("path",{fillOpacity:"0.25",d:"M9 15L11 12 13 14 14 13.5 15 15z"})));var vR=o7;const ba=v(require("react"));function n7(){return ba.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Transform",width:"48",height:"48",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},ba.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(12 12)"},ba.default.createElement("path",{fillOpacity:"0.2",d:"M10 10L15 9 15 15 9 15z"}),ba.default.createElement("path",{fillOpacity:"0.87",d:"M9 15h6V9H9v6zm-1.5 0V7.5H15V3h1.5v13.5H3V15h4.5zm0 2.5H9V21H7.5v-3.5zM21 7.5V9h-3.5V7.5H21z"}),ba.default.createElement("g",{fillOpacity:"0.2"},ba.default.createElement("path",{d:"M0 10h1a9.003 9.003 0 015.5-8.294L7 3 10.942.044C10.632.014 10.318 0 10 0 4.477 0 0 4.477 0 10z",transform:"translate(2 2)"}),ba.default.createElement("path",{d:"M9 20h1a9.003 9.003 0 015.5-8.294L16 13l3.942-2.956c-.31-.03-.624-.044-.942-.044-5.523 0-10 4.477-10 10z",transform:"translate(2 2) rotate(-180 14.47 15)"}))))}var _R=n7;const ya=v(require("react"));function s7(){return ya.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Brush",width:"48",height:"48",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},ya.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ya.default.createElement("path",{fillOpacity:"0.87",d:"M14.73 18.86C13.293 19.503 11.624 20 10 20 2 20 0 13 0 10c.486.972 2.37 5.848 7.537 4.165C7.873 17.125 10.427 19 13 19c.6 0 1.177-.05 1.73-.14zM8.422 8.63a7.352 7.352 0 00-1.127 1.616L2.401 3.705c-.215-.287-.178-.807.072-1.056l.088-.088L8.5 8.5l-.078.13z",opacity:"0.5",transform:"translate(12 12) translate(2 2)"}),ya.default.createElement("path",{fillOpacity:"0.87",d:"M7.295 10.246c-.27.526-.48 1.09-.615 1.68L1.2 4.603c-.663-.885-.564-2.24.212-3.015l.176-.176c.78-.78 2.121-.881 3.015-.212l7.245 5.421a6.088 6.088 0 00-1.67.624L3.706 2.401c-.294-.22-.801-.184-1.056.072l-.176.176c-.25.25-.287.769-.072 1.056l4.894 6.54z",transform:"translate(12 12) translate(2 2)"}),ya.default.createElement("path",{fillOpacity:"0.87",d:"M9.702 6.554c-.185-.869-.151-.71-.207-.955C8.88 2.902 8.145 2 6 2 3.98 2 2 4.08 2 6.5c0 2.294 1.835 4 4 4 1.545 0 2.915-.342 4.544-1.088-.332-.7-.578-1.619-.842-2.858z",opacity:"0.5",transform:"translate(12 12) translate(2 2) translate(7 7)"}),ya.default.createElement("path",{fillOpacity:"0.25",d:"M10.379 9.027c.053.135.108.263.165.385C8.914 10.158 7.545 10.5 6 10.5c-2.165 0-4-1.706-4-4 0-1.528.79-2.921 1.88-3.74-.882 2.084-1.025 6.482 6.499 6.267z",transform:"translate(12 12) translate(2 2) translate(7 7)"}),ya.default.createElement("path",{fillOpacity:"0.87",d:"M9.702 6.554c-.185-.869-.151-.71-.207-.955C8.88 2.902 8.145 2 6 2 3.98 2 2 4.08 2 6.5c0 2.294 1.835 4 4 4 1.545 0 2.915-.342 4.544-1.088-.332-.7-.578-1.619-.842-2.858zM6 12C3.239 12 .5 9.842.5 6.5S3.239.5 6 .5c6.5 0 4 8 7 9.342C11 10.947 8.761 12 6 12z",transform:"translate(12 12) translate(2 2) translate(7 7)"})))}var xR=s7;const va=v(require("react")),a7=()=>va.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Left Align",width:"26",height:"26"},va.default.createElement("defs",null,va.default.createElement("path",{id:"photoeditorsdk-align-left-icon",d:"M27 30v3H12v-3h15zm9-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),va.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},va.default.createElement("mask",{fill:"#fff"},va.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-left-icon"})),va.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-align-left-icon"})));var wR=a7;const rs=v(require("react"));function l7(){return rs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",width:"26",height:"26",focusable:"false","aria-hidden":"true","aria-label":"Right Align"},rs.default.createElement("defs",null,rs.default.createElement("path",{id:"photoeditorsdk-align-right-icon",d:"M27 30v3H12v-3h15zm9-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),rs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},rs.default.createElement("path",{d:"M0 0H48V48H0z"}),rs.default.createElement("mask",{fill:"#fff"},rs.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-right-icon"})),rs.default.createElement("use",{fill:"currentColor",transform:"matrix(-1 0 0 1 48 0)",xlinkHref:"#photoeditorsdk-align-right-icon"})))}var CR=l7;const _a=v(require("react"));function d7(){return _a.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Center Align",width:"26",height:"26"},_a.default.createElement("defs",null,_a.default.createElement("path",{id:"photoeditorsdk-align-center-icon",d:"M31.5 30v3h-15v-3h15zm4.5-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),_a.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},_a.default.createElement("mask",{fill:"#fff"},_a.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-center-icon"})),_a.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-align-center-icon"})))}var SR=d7;const xa=v(require("react")),c7=()=>xa.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},xa.default.createElement("defs",null,xa.default.createElement("path",{id:"photoeditorsdk-icon-add-text",d:"M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zm1 6h-2v5H6v2h5v5h2v-5h5v-2h-5V6z"})),xa.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},xa.default.createElement("mask",{fill:"currentColor"},xa.default.createElement("use",{xlinkHref:"#photoeditorsdk-icon-add-text"})),xa.default.createElement("use",{fill:"currentColor",fillRule:"nonzero",xlinkHref:"#photoeditorsdk-icon-add-text"})));var TR=c7;const Nx=v(require("react")),h7=()=>Nx.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Nx.default.createElement("path",{fill:"currentColor",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M12 1c5.523 0 10 4.477 10 10a9.98 9.98 0 01-3.678 7.749c1.877.92 3.445 2.251 4.502 3.88l.176.283-1.743 1.02c-1.04-1.735-2.824-3.102-4.995-3.884A9.94 9.94 0 0112 21a9.962 9.962 0 01-4.255-.948c-2.076.748-3.797 2.033-4.852 3.661l-.147.237L1 22.935c1.053-1.766 2.694-3.204 4.684-4.183A9.975 9.975 0 012 11C2 5.477 6.477 1 12 1zm0 2a8 8 0 100 16 8 8 0 000-16zm0 5a5 5 0 110 10 5 5 0 010-10zm0 2a3 3 0 100 6 3 3 0 000-6zm1-4v1h-2V6h2z"}));var kR=h7;const Ux=v(require("react")),p7=()=>Ux.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Ux.default.createElement("path",{fill:"currentColor",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M16.23 10.885a2.292 2.292 0 00-2.285-2.286 2.292 2.292 0 00-2.286 2.286 2.292 2.292 0 002.286 2.286 2.292 2.292 0 002.286-2.286zM13.946.599C8.265.6 3.66 5.205 3.66 10.885H.231l4.571 4.571 4.572-4.571H5.945c0-4.423 3.577-8 8-8s8 3.577 8 8a7.994 7.994 0 01-12.64 6.514l-1.623 1.646a10.3 10.3 0 006.263 2.126c5.68 0 10.286-4.606 10.286-10.286S19.625.599 13.945.599z",transform:"rotate(56 11.298 10.261)"}));var ER=p7;const wa=v(require("react"));function u7(){return wa.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},wa.default.createElement("defs",null,wa.default.createElement("path",{id:"photoeditorsdk-shuffle-icon",d:"M24 10v8a3 3 0 01-3 3H6v3l-6-4 6-4v3h15a1 1 0 001-1v-8h2zM18 0l6 4-6 4V5H3a1 1 0 00-1 1v8H0V6a3 3 0 013-3h15V0z"})),wa.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},wa.default.createElement("mask",{fill:"currentColor"},wa.default.createElement("use",{xlinkHref:"#photoeditorsdk-shuffle-icon"})),wa.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-shuffle-icon"})))}var DR=u7;const Ca=v(require("react")),m7=()=>Ca.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Ca.default.createElement("defs",null,Ca.default.createElement("path",{id:"photoeditorsdk-upload-icon",d:"M4.143 17.286l-.001 3.142h15.715v-3.142H23v6.285H1v-6.285h3.143zM12 0l9.429 9.429-2.2 2.2L13.57 5.97v9.743H10.43V5.971L4.77 11.63l-2.2-2.2L12 0z"})),Ca.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ca.default.createElement("mask",{fill:"currentColor"},Ca.default.createElement("use",{xlinkHref:"#photoeditorsdk-upload-icon"})),Ca.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-upload-icon"})));var IR=m7;const Sa=v(require("react")),f7=()=>Sa.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"25",height:"25",viewBox:"0 0 25 25"},Sa.default.createElement("defs",null,Sa.default.createElement("path",{id:"photoeditorsdk-undo-icon",d:"M4 10.065C4 4.506 8.365 0 13.75 0s9.75 4.506 9.75 10.065v9.29h-3v-9.29c0-3.849-3.022-6.968-6.75-6.968S7 6.217 7 10.065v7.741h3L5.5 24 1 17.806h3v-7.741z"})),Sa.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Sa.default.createElement("mask",{fill:"currentColor"},Sa.default.createElement("use",{xlinkHref:"#photoeditorsdk-undo-icon"})),Sa.default.createElement("use",{fill:"currentColor",transform:"rotate(90 12.25 12)",xlinkHref:"#photoeditorsdk-undo-icon"})));var OR=f7;const Ta=v(require("react")),g7=()=>Ta.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"25",height:"25",viewBox:"0 0 25 25"},Ta.default.createElement("defs",null,Ta.default.createElement("path",{id:"photoeditorsdk-redo-icon",d:"M4 10.065C4 4.506 8.365 0 13.75 0s9.75 4.506 9.75 10.065v9.29h-3v-9.29c0-3.849-3.022-6.968-6.75-6.968S7 6.217 7 10.065v7.741h3L5.5 24 1 17.806h3v-7.741z"})),Ta.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ta.default.createElement("mask",{fill:"currentColor"},Ta.default.createElement("use",{xlinkHref:"#photoeditorsdk-redo-icon"})),Ta.default.createElement("use",{fill:"currentColor",transform:"matrix(0 1 1 0 .25 -.25)",xlinkHref:"#photoeditorsdk-redo-icon"})));var RR=g7;const ka=v(require("react")),b7=()=>ka.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},ka.default.createElement("defs",null,ka.default.createElement("path",{id:"photoeditorsdk-close-icon",d:"M21.583 0L24 2.416 14.416 12 24 21.584 21.583 24 12 14.416 2.417 24 0 21.584 9.584 12 0 2.416 2.417 0 12 9.584 21.583 0z"})),ka.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ka.default.createElement("mask",{fill:"currentColor"},ka.default.createElement("use",{xlinkHref:"#photoeditorsdk-close-icon"})),ka.default.createElement("use",{fill:"currentColor",fillRule:"nonzero",xlinkHref:"#photoeditorsdk-close-icon"})));var AR=b7;const Ea=v(require("react"));function y7(){return Ea.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Ea.default.createElement("defs",null,Ea.default.createElement("path",{id:"photoeditorsdk-export-icon",d:"M22 1.5a1.5 1.5 0 011.493 1.356L23.5 3H22h1.5v17a1.5 1.5 0 01-1.5 1.5H12a1.5 1.5 0 01-1.493-1.356L10.5 20v-6h2v5.499h9v-16h-9V9h-2V3A1.5 1.5 0 0112 1.5h10zM6.15 5.817L7.634 7.3l-3.171 3.171h13.978v2H4.47l3.171 3.17-1.483 1.483L.5 11.467l5.65-5.65z"})),Ea.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ea.default.createElement("mask",{fill:"#fff"},Ea.default.createElement("use",{xlinkHref:"#photoeditorsdk-export-icon"})),Ea.default.createElement("use",{fill:"currentcolor",fillOpacity:"0.9",transform:"rotate(90 12 11.5)",xlinkHref:"#photoeditorsdk-export-icon"})))}var FR=y7;const Hx=v(require("react")),v7=()=>Hx.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Hx.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M2.087 7.115h7.66v15.32h5.027l.223-15.32h7.438V2.087H2.087v5.028zM14.075 24h-4.15a2.42 2.42 0 01-1.718-.711 2.423 2.423 0 01-.711-1.717V9.01H2.429c-.67 0-1.278-.273-1.718-.713A2.426 2.426 0 010 6.579V2.43C0 1.76.272 1.153.711.713A2.424 2.424 0 012.43 0h19.142c.671 0 1.278.272 1.718.713.439.44.711 1.047.711 1.718v4.148c0 .671-.272 1.278-.711 1.718-.44.44-1.047.713-1.718.713h-5.067v12.562c0 .67-.272 1.278-.711 1.717a2.42 2.42 0 01-1.718.711z"}));var PR=v7;const Da=v(require("react")),_7=()=>Da.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Da.default.createElement("defs",null,Da.default.createElement("path",{id:"photoeditorsdk-duplicate-icon",d:"M3.429 8.571v12h12v-12h-12zM1.714 5.143h15.429c.947 0 1.714.767 1.714 1.714v15.429c0 .946-.767 1.714-1.714 1.714H1.714A1.714 1.714 0 010 22.286V6.857c0-.947.768-1.714 1.714-1.714zM22.286 0C23.232 0 24 .768 24 1.714v15.429c0 .947-.768 1.714-1.714 1.714H20.57V3.429L5.142 3.428V1.714C5.143.768 5.91 0 6.858 0h15.429z"})),Da.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Da.default.createElement("mask",{fill:"currentColor"},Da.default.createElement("use",{xlinkHref:"#photoeditorsdk-duplicate-icon"})),Da.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-duplicate-icon"})));var BR=_7;const Ia=v(require("react")),x7=()=>Ia.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Ia.default.createElement("defs",null,Ia.default.createElement("path",{id:"photoeditorsdk-delete-icon",d:"M20 6l-2.312 15.718A1.5 1.5 0 0116.204 23H5.796a1.5 1.5 0 01-1.484-1.282L2 6h18zM7 1a1 1 0 011-1h6a1 1 0 011 1v1h7v2H0V2h7V1z"})),Ia.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ia.default.createElement("mask",{fill:"currentColor"},Ia.default.createElement("use",{xlinkHref:"#photoeditorsdk-delete-icon"})),Ia.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-delete-icon"})));var MR=x7;const os=v(require("react")),w7=()=>os.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},os.default.createElement("defs",null,os.default.createElement("path",{id:"photoeditorsdk-bring-to-front-icon",d:"M21 16a2 2 0 012 2v4a2 2 0 01-2 2H3a2 2 0 01-2-2v-4a2 2 0 012-2h18zM12.006 1l5.996 5.996-1.414 1.414-3.578-3.577V12h-2.008V4.833L7.418 8.417 6.004 7.003 12.006 1z"})),os.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},os.default.createElement("path",{d:"M0 0H24V24H0z"}),os.default.createElement("mask",{fill:"currentColor"},os.default.createElement("use",{xlinkHref:"#photoeditorsdk-bring-to-front-icon"})),os.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-bring-to-front-icon"})));var LR=w7;const ns=v(require("react")),C7=({className:e})=>ns.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 15 14",transform:"scale(-1, 1)",className:e},ns.default.createElement("title",null,"Flip Horizontal"),ns.default.createElement("defs",null,ns.default.createElement("path",{id:"photoeditorsdk-flip-horizontal-icon",d:"M42 1v14h-1.167v-1.167H37a2 2 0 01-2-2V4.167a2 2 0 012-2l3.833-.001V1H42zm5.833 11.958a.875.875 0 01-.875.875h-3.791v-1.166l3.499-.001V3.333h-3.5V2.167h3.792c.446 0 .815.333.869.765l.006.11v9.916z"})),ns.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-34 -1)"},ns.default.createElement("mask",{fill:"none"},ns.default.createElement("use",{xlinkHref:"#photoeditorsdk-flip-horizontal-icon"})),ns.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-flip-horizontal-icon"})));var zR=C7;const ss=v(require("react")),S7=({className:e})=>ss.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 15 14",className:e},ss.default.createElement("title",null,"Flip Vertical"),ss.default.createElement("defs",null,ss.default.createElement("path",{id:"photoeditorsdk-flip-vertical-icon",d:"M42 1v14h-1.167v-1.167H37a2 2 0 01-2-2V4.167a2 2 0 012-2l3.833-.001V1H42zm5.833 11.958a.875.875 0 01-.875.875h-3.791v-1.166l3.499-.001V3.333h-3.5V2.167h3.792c.446 0 .815.333.869.765l.006.11v9.916z"})),ss.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-34 -1)"},ss.default.createElement("mask",{fill:"none"},ss.default.createElement("use",{xlinkHref:"#photoeditorsdk-flip-vertical-icon"})),ss.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",transform:"rotate(-90 41.417 8)",xlinkHref:"#photoeditorsdk-flip-vertical-icon"})));var NR=S7;const Nr=v(require("react")),T7=({height:e=3,width:t=102,x:i=-102,className:r,style:o})=>Nr.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:e,viewBox:"0 0 102 3",className:r,style:o},Nr.default.createElement("pattern",{id:"photoeditorsdk-slider-dots",fill:"currentColor",patternUnits:"userSpaceOnUse",width:"102",height:"3"},Nr.default.createElement("rect",{width:"3",height:"3",x:"99",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"88",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"77",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"66",y:"0",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"55",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"44",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"33",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"22",y:"0",opacity:"0.5",rx:"1.5"}),Nr.default.createElement("rect",{width:"3",height:"3",x:"11",y:"0",rx:"1.5"})),Nr.default.createElement("rect",{fill:"url(#photoeditorsdk-slider-dots)",x:-t*1.5,y:"0",width:t*4,height:"3",transform:`translate(${i}, 0)`}));var UR=T7;const as=v(require("react")),k7=({alt:e="Rotate",className:t})=>as.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 16 16",className:t},as.default.createElement("title",null,e),as.default.createElement("defs",null,as.default.createElement("path",{id:"photoeditorsdk-rotate-icon",d:"M132 0l1.25 1.57a8.01 8.01 0 0110.41.77 8.015 8.015 0 010 11.32c-.33.33-.67.62-1.04.859-1.38.991-3 1.481-4.62 1.481v-2c1.22 0 2.44-.37 3.47-1.111a6 6 0 00.77-9.129 5.992 5.992 0 00-7.73-.63L136 5h-5l1-5zm2.43 12.82c.5.38 1.06.67 1.66.87l-.64 1.89a7.56 7.56 0 01-1.48-.67l-.03-.01v-.01h-.02v-.01h-.01c0-.01-.01-.01-.01-.01h-.01v-.01h-.02v-.01h-.01l-.01-.01s-.01 0-.01-.01h-.01c-.2-.12-.4-.26-.6-.4zm-2.15-3.02c.18.6.47 1.17.83 1.68l-1.63 1.16v-.01s-.01 0-.01-.01c0 0 0-.01-.01-.01v-.01h-.01v-.01c-.01 0-.01-.01-.01-.01v-.01h-.01v-.01h-.01v-.01c0-.01-.01-.01-.01-.01v-.01c-.01 0-.01 0-.01-.01-.27-.39-.49-.79-.68-1.21-.01 0-.01-.01-.01-.01v-.01h-.01v-.02l-.01-.01c0-.02-.01-.02-.01-.02v-.02h-.01v-.02h-.01v-.03h-.01v-.02h-.01v-.02c-.01 0-.01 0-.01-.01v-.01c-.1-.23-.19-.47-.26-.7z"})),as.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-130)"},as.default.createElement("mask",{fill:"none"},as.default.createElement("use",{xlinkHref:"#photoeditorsdk-rotate-icon"})),as.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-rotate-icon"})));var HR=k7;const ei=v(require("react")),E7=({highlight:e="currentColor",width:t=48,height:i=48})=>ei.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:i,viewBox:"0 0 48 48"},ei.default.createElement("g",{fill:"none",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ei.default.createElement("g",{fill:e,transform:"translate(13 13)"},ei.default.createElement("path",{d:"M22 3.701h-1.642V1.644l-2.06-.001V0h2.538c.421 0 .682.174.827.32.322.322.337.748.337.83v2.551z"}),ei.default.createElement("path",{d:"M1.643 3.701H0V1.165C0 .743.174.482.32.336.64.016 1.06 0 1.147 0H3.701v1.643H1.644l-.001 2.058z"}),ei.default.createElement("path",{d:"M13.7232174 1.5486087L17.4249565 1.5486087 17.4249565 0 13.7232174 0z"}),ei.default.createElement("path",{d:"M9.15008696 1.5486087L12.8508696 1.5486087 12.8508696 0 9.15008696 0z"}),ei.default.createElement("path",{d:"M4.57504348 1.5486087L8.27678261 1.5486087 8.27678261 0 4.57504348 0z"}),ei.default.createElement("path",{d:"M0 8.27582609L1.5486087 8.27582609 1.5486087 4.57504348 0 4.57504348z"}),ei.default.createElement("path",{d:"M20.4513913 8.27582609L22 8.27582609 22 4.57504348 20.4513913 4.57504348z"}),ei.default.createElement("path",{d:"M0 12.8508696L1.5486087 12.8508696 1.5486087 9.14913043 0 9.14913043z"}),ei.default.createElement("path",{d:"M0 17.4249565L1.5486087 17.4249565 1.5486087 13.7232174 0 13.7232174z"}),ei.default.createElement("path",{d:"M20.4513913 12.8508696L22 12.8508696 22 9.14913043 20.4513913 9.14913043z"}),ei.default.createElement("path",{d:"M20.4513913 17.4249565L22 17.4249565 22 13.7232174 20.4513913 13.7232174z"}),ei.default.createElement("path",{d:"M3.702 22H1.165c-.421 0-.682-.174-.828-.32-.322-.322-.337-.748-.337-.83v-2.552h1.643v2.059h2.059V22z"}),ei.default.createElement("path",{d:"M20.853 22h-2.554v-1.642h2.057l.001-2.06H22v2.538c0 .42-.174.682-.319.827-.32.32-.742.337-.828.337"}),ei.default.createElement("path",{d:"M4.57504348 22L8.27678261 22 8.27678261 20.4513913 4.57504348 20.4513913z"}),ei.default.createElement("path",{d:"M9.15008696 22L12.8508696 22 12.8508696 20.4513913 9.15008696 20.4513913z"}),ei.default.createElement("path",{d:"M13.7232174 22L17.4249565 22 17.4249565 20.4513913 13.7232174 20.4513913z"}))));var GR=E7;const ab=v(require("react")),D7=({highlight:e="currentColor",width:t=48,height:i=48})=>ab.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:i,viewBox:"0 0 48 48"},ab.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ab.default.createElement("path",{fill:e,d:"M29.967 13.005L26.984 13c-3.35 0-5.516 2.222-5.516 5.66v2.61h-2.999c-.26 0-.469.21-.469.47v3.78c0 .26.21.47.469.47h2.999v9.541c0 .26.21.469.469.469h3.912c.26 0 .47-.21.47-.469V25.99h3.506c.259 0 .469-.21.469-.47l.001-3.78a.47.47 0 00-.469-.47h-3.508v-2.212c0-1.064.254-1.603 1.639-1.603l2.01-.001c.258 0 .468-.21.468-.47v-3.51a.47.47 0 00-.468-.47z"})));var jR=D7;const Gl=v(require("react")),I7=({highlight:e="currentColor",width:t=48,height:i=48})=>Gl.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:i,viewBox:"0 0 48 48"},Gl.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Gl.default.createElement("g",{fill:e,transform:"translate(13 13)"},Gl.default.createElement("path",{d:"M15.125 0h-8.25A6.876 6.876 0 000 6.875v8.25A6.876 6.876 0 006.875 22h8.25A6.876 6.876 0 0022 15.125v-8.25A6.876 6.876 0 0015.125 0zm4.813 15.125a4.818 4.818 0 01-4.813 4.813h-8.25a4.818 4.818 0 01-4.813-4.813v-8.25a4.818 4.818 0 014.813-4.813h8.25a4.818 4.818 0 014.813 4.813v8.25z"}),Gl.default.createElement("path",{d:"M11 5.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zm0 8.938A3.442 3.442 0 017.562 11 3.441 3.441 0 0111 7.562 3.441 3.441 0 0114.438 11 3.442 3.442 0 0111 14.438z"}),Gl.default.createElement("circle",{cx:"16.913",cy:"5.088",r:"1"}))));var WR=I7;const lb=v(require("react")),O7=({highlight:e="currentColor",width:t=48,height:i=48})=>lb.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:i,viewBox:"0 0 48 48"},lb.default.createElement("g",{fill:"none",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},lb.default.createElement("path",{fill:e,d:"M36 17.305c-.892.402-1.843.668-2.835.797a4.997 4.997 0 002.165-2.79 9.685 9.685 0 01-3.12 1.222 4.874 4.874 0 00-3.595-1.596c-2.723 0-4.916 2.267-4.916 5.047 0 .4.032.785.113 1.151-4.09-.205-7.71-2.215-10.141-5.278a5.18 5.18 0 00-.673 2.55c0 1.748.877 3.297 2.185 4.194a4.766 4.766 0 01-2.223-.621v.055c0 2.452 1.705 4.49 3.942 4.958-.4.113-.837.167-1.29.167-.315 0-.633-.019-.931-.087.637 1.999 2.446 3.468 4.597 3.516a9.73 9.73 0 01-6.1 2.152c-.404 0-.791-.018-1.178-.07a13.601 13.601 0 007.548 2.266c9.054 0 14.004-7.693 14.004-14.36 0-.224-.008-.439-.018-.653A9.958 9.958 0 0036 17.305z"})));var VR=O7;const KR=v(require("styled-components")),R7=KR.default.svg.attrs({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"})``;var tr=R7;const ht=v(require("react")),A7=({highlight:e="#565656",width:t=32,height:i=32})=>ht.default.createElement(tr,{width:t,height:i,viewBox:"0 0 32 32"},ht.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ht.default.createElement("g",{fill:e,transform:"translate(-8 -8)"},ht.default.createElement("g",{transform:"translate(8 8)"},ht.default.createElement("g",null,ht.default.createElement("path",{d:"M.941 31.992h2.824v-.94L.941 31.05v-2.822h-.94v2.846s-.004.918.94.918"}),ht.default.createElement("path",{d:"M31.974 31.051v-2.823h-.942v2.823h-2.823v.941h2.846s.919.003.919-.94"}),ht.default.createElement("path",{d:"M4.62305882 31.9926588L8.38776471 31.9926588 8.38776471 31.0514824 4.62305882 31.0514824z"}),ht.default.createElement("path",{d:"M9.32894118 31.9926588L13.0936471 31.9926588 13.0936471 31.0514824 9.32894118 31.0514824z"}),ht.default.createElement("path",{d:"M14.0348235 31.9926588L17.7995294 31.9926588 17.7995294 31.0514824 14.0348235 31.0514824z"}),ht.default.createElement("path",{d:"M18.7407059 31.9926588L22.5054118 31.9926588 22.5054118 31.0514824 18.7407059 31.0514824z"}),ht.default.createElement("path",{d:"M23.4465882 31.9926588L27.2112941 31.9926588 27.2112941 31.0514824 23.4465882 31.0514824z"}),ht.default.createElement("path",{d:"M0 .94v2.824h.941L.942.941h2.823V0H.919S0-.002 0 .94"}),ht.default.createElement("path",{d:"M31.032 0H28.21v.94l2.823.002v2.822h.942V.92s.002-.92-.942-.92"}),ht.default.createElement("path",{d:"M4.62305882 0.940423529L8.38776471 0.940423529 8.38776471 -0.000752941176 4.62305882 -0.000752941176z"}),ht.default.createElement("path",{d:"M9.32894118 0.940423529L13.0936471 0.940423529 13.0936471 -0.000752941176 9.32894118 -0.000752941176z"}),ht.default.createElement("path",{d:"M14.0348235 0.940423529L17.7995294 0.940423529 17.7995294 -0.000752941176 14.0348235 -0.000752941176z"}),ht.default.createElement("path",{d:"M18.7407059 0.940423529L22.5054118 0.940423529 22.5054118 -0.000752941176 18.7407059 -0.000752941176z"}),ht.default.createElement("path",{d:"M23.4465882 0.940423529L27.2112941 0.940423529 27.2112941 -0.000752941176 23.4465882 -0.000752941176z"}),ht.default.createElement("path",{d:"M0 8.46324706L0.941176471 8.46324706 0.941176471 4.69854118 0 4.69854118z"}),ht.default.createElement("path",{d:"M0 13.1691294L0.941176471 13.1691294 0.941176471 9.40442353 0 9.40442353z"}),ht.default.createElement("path",{d:"M0 17.8750118L0.941176471 17.8750118 0.941176471 14.1103059 0 14.1103059z"}),ht.default.createElement("path",{d:"M0 22.5808941L0.941176471 22.5808941 0.941176471 18.8161882 0 18.8161882z"}),ht.default.createElement("path",{d:"M0 27.2867765L0.941176471 27.2867765 0.941176471 23.5220706 0 23.5220706z"}),ht.default.createElement("path",{d:"M30.976 8.46324706L31.9171765 8.46324706 31.9171765 4.69854118 30.976 4.69854118z"}),ht.default.createElement("path",{d:"M30.976 13.1691294L31.9171765 13.1691294 31.9171765 9.40442353 30.976 9.40442353z"}),ht.default.createElement("path",{d:"M30.976 17.8750118L31.9171765 17.8750118 31.9171765 14.1103059 30.976 14.1103059z"}),ht.default.createElement("path",{d:"M30.976 22.5808941L31.9171765 22.5808941 31.9171765 18.8161882 30.976 18.8161882z"}),ht.default.createElement("path",{d:"M30.976 27.2867765L31.9171765 27.2867765 31.9171765 23.5220706 30.976 23.5220706z"}))))));var $R=A7;const yn=v(require("react")),F7=({highlight:e="#565656",mask:t="#fff",width:i=32,height:r=32})=>yn.default.createElement(tr,{width:i,height:r,viewBox:"0 0 32 32"},yn.default.createElement("defs",null,yn.default.createElement("rect",{id:"photoeditorsdk-square-icon",width:"32",height:"32",x:"0.92",y:"0.707",rx:"1"})),yn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},yn.default.createElement("g",{transform:"translate(-8 -8)"},yn.default.createElement("g",{transform:"translate(7.08 7.293)"},yn.default.createElement("mask",{fill:t},yn.default.createElement("use",{xlinkHref:"#photoeditorsdk-square-icon"})),yn.default.createElement("use",{fill:e,xlinkHref:"#photoeditorsdk-square-icon"})))));var qR=F7;const Kp=v(require("react")),P7=({highlight:e="#565656",width:t=32,height:i=48})=>Kp.default.createElement(tr,{width:t,height:i,viewBox:"0 0 42 32"},Kp.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Kp.default.createElement("g",{fill:e,transform:"translate(-3 -8)"},Kp.default.createElement("rect",{width:"42",height:"32",x:"3",y:"8",rx:"0.5"}))));var XR=P7;const $p=v(require("react")),B7=({highlight:e="#565656",width:t=32,height:i=42})=>$p.default.createElement(tr,{width:t,height:i,viewBox:"0 0 32 42"},$p.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},$p.default.createElement("g",{fill:e,transform:"translate(-8 -3)"},$p.default.createElement("rect",{width:"42",height:"32",x:"3",y:"8",rx:"0.5",transform:"rotate(90 24 24)"}))));var YR=B7;const qp=v(require("react")),M7=({highlight:e="#565656",width:t=26,height:i=46})=>qp.default.createElement(tr,{width:t,height:i,viewBox:"0 0 26 46"},qp.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},qp.default.createElement("g",{fill:e,transform:"translate(-11 -1)"},qp.default.createElement("path",{d:"M1 11.496A.5.5 0 011.5 11h45a.5.5 0 01.5.496v25.008a.5.5 0 01-.5.496h-45a.5.5 0 01-.5-.496V11.496z"}))));var JR=M7;const Xp=v(require("react")),L7=({highlight:e="#565656",width:t=26,height:i=46})=>Xp.default.createElement(tr,{width:t,height:i,viewBox:"0 0 26 46"},Xp.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Xp.default.createElement("g",{fill:e,transform:"translate(-11 -1)"},Xp.default.createElement("path",{d:"M1 11.496A.5.5 0 011.5 11h45a.5.5 0 01.5.496v25.008a.5.5 0 01-.5.496h-45a.5.5 0 01-.5-.496V11.496z",transform:"rotate(90 24 24)"}))));var ZR=L7;const vn=v(require("react")),z7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>vn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},vn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},vn.default.createElement("rect",{width:"28",height:"3",x:"12",y:"41",fill:e,rx:"0.5",transform:"matrix(-1 0 0 1 52 0)"}),vn.default.createElement("rect",{width:"34",height:"28",x:"7",y:"8",fill:t,rx:"0.5",transform:"matrix(1 0 0 -1 0 44)"}),vn.default.createElement("rect",{width:"3",height:"3",x:"8",y:"41",fill:e,rx:"0.5",transform:"matrix(-1 0 0 1 19 0)"}),vn.default.createElement("rect",{width:"28",height:"3",x:"12",y:"37",fill:e,rx:"0.5",transform:"matrix(-1 0 0 1 52 0)"}),vn.default.createElement("rect",{width:"28",height:"3",x:"12",y:"4",fill:e,rx:"0.5",transform:"matrix(1 0 0 -1 0 11)"}),vn.default.createElement("rect",{width:"3",height:"3",x:"8",y:"37",fill:e,rx:"0.5",transform:"matrix(-1 0 0 1 19 0)"}),vn.default.createElement("rect",{width:"3",height:"3",x:"8",y:"4",fill:e,rx:"0.5",transform:"matrix(1 0 0 -1 0 11)"})));var QR=z7;const _n=v(require("react")),N7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>_n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},_n.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},_n.default.createElement("g",null,_n.default.createElement("path",{fill:e,d:"M42 5a1 1 0 011 1v13a1 1 0 01-1 1H6a1 1 0 01-1-1V6a1 1 0 011-1h36zM21.505 18h-2.01a.494.494 0 00-.495.5c0 .268.222.5.495.5h2.01c.28 0 .495-.224.495-.5l-.008-.088a.503.503 0 00-.487-.412zm8.004 0h-5.018a.5.5 0 000 1h5.018a.5.5 0 00.491-.5l-.008-.088A.5.5 0 0029.51 18z"}),_n.default.createElement("rect",{width:"22",height:"11",x:"20",y:"29",fill:e,rx:"1"}),_n.default.createElement("rect",{width:"13",height:"10",x:"6",y:"23",fill:e,rx:"1"}),_n.default.createElement("rect",{width:"22",height:"5",x:"20",y:"23",fill:e,rx:"1"}),_n.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:t,rx:"1"}),_n.default.createElement("rect",{width:"13",height:"9",x:"6",y:"34",fill:e,rx:"1"}))));var eA=N7;const xn=v(require("react")),U7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>xn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},xn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},xn.default.createElement("g",{transform:"translate(5 5)"},xn.default.createElement("path",{fill:t,d:"M37 0a1 1 0 011 1v13a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1h36zM16.505 13h-2.01a.494.494 0 00-.495.5c0 .268.222.5.495.5h2.01c.28 0 .495-.224.495-.5l-.008-.088a.503.503 0 00-.487-.412zm8.004 0h-5.018a.5.5 0 000 1h5.018a.5.5 0 00.491-.5l-.008-.088A.5.5 0 0024.51 13z"}),xn.default.createElement("rect",{width:"22",height:"11",x:"15",y:"24",fill:e,rx:"1"}),xn.default.createElement("rect",{width:"13",height:"10",x:"1",y:"18",fill:e,rx:"1"}),xn.default.createElement("rect",{width:"22",height:"5",x:"15",y:"18",fill:e,rx:"1"}),xn.default.createElement("rect",{width:"7",height:"7",x:"4",y:"9",fill:e,rx:"1"}),xn.default.createElement("rect",{width:"13",height:"9",x:"1",y:"29",fill:e,rx:"1"}))));var tA=U7;const ls=v(require("react")),H7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>ls.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},ls.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ls.default.createElement("rect",{width:"26",height:"7",x:"7",y:"18",fill:e,rx:"1"}),ls.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:e,rx:"1"}),ls.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:e,rx:"1"}),ls.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:e,rx:"1"}),ls.default.createElement("rect",{width:"26",height:"21",x:"7",y:"27",fill:e,rx:"1"}),ls.default.createElement("rect",{width:"26",height:"16",x:"7",y:"5",fill:t,rx:"1"})));var iA=H7;const ds=v(require("react")),G7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>ds.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},ds.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ds.default.createElement("rect",{width:"26",height:"7",x:"7",y:"34",fill:e,rx:"1"}),ds.default.createElement("rect",{width:"26",height:"32",x:"7",y:"5",fill:t,rx:"1"}),ds.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:e,rx:"1"}),ds.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:e,rx:"1"}),ds.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:e,rx:"1"}),ds.default.createElement("rect",{width:"26",height:"5",x:"7",y:"43",fill:e,rx:"1"})));var rA=G7;const cs=v(require("react")),j7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>cs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},cs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},cs.default.createElement("rect",{width:"26",height:"7",x:"7",y:"28",fill:e,rx:"1"}),cs.default.createElement("rect",{width:"26",height:"26",x:"7",y:"5",fill:t,rx:"1"}),cs.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:e,rx:"1"}),cs.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:e,rx:"1"}),cs.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:e,rx:"1"}),cs.default.createElement("rect",{width:"26",height:"11",x:"7",y:"37",fill:e,rx:"1"})));var oA=j7;const Yp=v(require("react")),W7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>Yp.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},Yp.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Yp.default.createElement("rect",{width:"20",height:"34",x:"14",y:"10",fill:t,rx:"1.5"}),Yp.default.createElement("rect",{width:"3",height:"3",x:"14",y:"5",fill:e,rx:"1"})));var nA=W7;const ir=v(require("react")),V7=({main:e="#424242",highlight:t="#565656",shadow:i="#333333",width:r="48px",height:o="48px"})=>ir.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:o,viewBox:"0 0 48 48"},ir.default.createElement("defs",null,ir.default.createElement("filter",{id:"photoeditorsdk-twitter-post-icon",width:"166.7%",height:"166.7%",x:"-33.3%",y:"-33.3%",filterUnits:"objectBoundingBox"},ir.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1"}))),ir.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ir.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:t,rx:"0.5"}),ir.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:e,rx:"0.5"}),ir.default.createElement("rect",{width:"9",height:"9",x:"8",y:"13",fill:i,filter:"url(#photoeditorsdk-twitter-post-icon)",rx:"1"}),ir.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:e,rx:"1"})));var sA=V7;const Vo=v(require("react")),K7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>Vo.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},Vo.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Vo.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:e,rx:"0.5"}),Vo.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:t,rx:"1"})));var aA=K7;const Ko=v(require("react")),$7=({main:e="#424242",highlight:t="#565656",width:i="48px",height:r="48px"})=>Ko.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:i,height:r,viewBox:"0 0 48 48"},Ko.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ko.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:t,rx:"0.5"}),Ko.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:e,rx:"0.5"}),Ko.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:e,rx:"1"})));var lA=$7;const Oa=v(require("react")),q7=()=>Oa.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Oa.default.createElement("defs",null,Oa.default.createElement("path",{id:"photoeditorsdk-brightness-icon",d:"M22.185 33.836c.594.109 1.2.164 1.815.164v2c-.735 0-1.462-.066-2.175-.197zm5.58-.568l.753 1.852c-.675.275-1.375.487-2.093.635l-.402-1.96c.597-.122 1.18-.299 1.741-.527zm-9.446-1.037c.5.346 1.03.646 1.586.895l-.82 1.824c-.666-.3-1.303-.66-1.903-1.074zm12.884-1.295l1.44 1.388a12.06 12.06 0 01-1.65 1.429l-1.167-1.625a10.06 10.06 0 001.377-1.192zm-15.758-1.754c.316.52.679 1.01 1.083 1.464l-1.493 1.33a12.038 12.038 0 01-1.3-1.756zm17.97-1.802l1.882.676a11.948 11.948 0 01-.925 1.982l-1.727-1.008a9.948 9.948 0 00.77-1.65zM24 18c.091 0 .182.002.273.006L24 18a6.071 6.071 0 01.668.037l.192.024a5.974 5.974 0 011.847.585l.01.005a5.992 5.992 0 011.154.768A5.99 5.99 0 0130 24c0 3.309-2.691 6-6 6a5.985 5.985 0 01-4.404-1.929l.163.17a6.052 6.052 0 01-1.353-2.07A5.951 5.951 0 0118 24c0-3.309 2.691-6 6-6zm2.827 3.173l-5.654 5.654A3.988 3.988 0 0024 28c2.206 0 4-1.794 4-4a3.988 3.988 0 00-1.173-2.827zM14.08 25.268c.076.606.208 1.2.392 1.777l-1.905.608a11.936 11.936 0 01-.472-2.134zm21.885-2.192a12.16 12.16 0 01-.032 2.198l-1.989-.21a10.193 10.193 0 00.027-1.836zM12.522 20.49l1.912.584a9.943 9.943 0 00-.37 1.783l-1.987-.226c.083-.73.232-1.445.445-2.14zm22.059-2.155c.345.643.63 1.316.853 2.013l-1.905.608a9.934 9.934 0 00-.71-1.676zm-19.587-2.266l1.5 1.323c-.402.456-.762.948-1.075 1.47l-1.715-1.03c.376-.625.808-1.215 1.29-1.763zm16.272-1.62c.58.442 1.12.936 1.61 1.476l-1.479 1.346c-.41-.45-.859-.862-1.343-1.23zm-12.241-1.372l.83 1.82a9.986 9.986 0 00-1.58.903l-1.147-1.638a11.986 11.986 0 011.897-1.085zm7.7-.766c.714.166 1.408.396 2.076.688L28 14.832a9.916 9.916 0 00-1.727-.573zm-2.857-.31l.021 2c-.613.006-1.22.068-1.812.184l-.383-1.964a12.046 12.046 0 012.174-.22z"})),Oa.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Oa.default.createElement("mask",null,Oa.default.createElement("use",{xlinkHref:"#photoeditorsdk-brightness-icon"})),Oa.default.createElement("use",{fillOpacity:"0.9",transform:"rotate(-45 24.039 24)",xlinkHref:"#photoeditorsdk-brightness-icon"})));var dA=q7;const hs=v(require("react")),X7=()=>hs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},hs.default.createElement("defs",null,hs.default.createElement("path",{id:"photoeditorsdk-contrast-icon",d:"M24 34V14c5.51 0 10 4.49 10 10s-4.49 10-10 10m0-22c-6.62 0-12 5.38-12 12s5.38 12 12 12 12-5.38 12-12-5.38-12-12-12"})),hs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},hs.default.createElement("path",{d:"M0 0H48V48H0z"}),hs.default.createElement("mask",{fill:"currentColor"},hs.default.createElement("use",{xlinkHref:"#photoeditorsdk-contrast-icon"})),hs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-contrast-icon"})));var cA=X7;const ps=v(require("react")),Y7=()=>ps.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},ps.default.createElement("defs",null,ps.default.createElement("path",{id:"photoeditorsdk-saturation-icon",d:"M17 31c1.334 1.099 2 2.177 2 3.234 0 .797-.454 1.39-1.211 1.655-.165.057-.428.094-.789.111l-.172-.01a2.54 2.54 0 01-.617-.101C15.454 35.624 15 35.03 15 34.234c0-1.057.666-2.135 2-3.234zm8.7-6l-4.24 4H17v-3.81l.2-.19h8.5zm-.7-7.59l4.24 4.25L26.76 24h-8.54L25 17.41zm7.778-3.532a3 3 0 01.135 4.1l-.135.143-1.414 1.414 1.414 1.415-1.414 1.414-7.07-7.071 1.413-1.414 1.414 1.413 1.414-1.414a3.001 3.001 0 014.243 0z"})),ps.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ps.default.createElement("path",{d:"M0 0H48V48H0z"}),ps.default.createElement("mask",{fill:"currentColor"},ps.default.createElement("use",{xlinkHref:"#photoeditorsdk-saturation-icon"})),ps.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-saturation-icon"})));var hA=Y7;const us=v(require("react")),J7=()=>us.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},us.default.createElement("defs",null,us.default.createElement("path",{id:"photoeditorsdk-clarity-icon",d:"M24 12L13 24.001 24 36l11-11.999L24 12zm-8.29 12.001H21l3-9.041 8.29 9.041-8.28 9.029L28 24.001h-7l2.99 9.029-8.28-9.029z"})),us.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},us.default.createElement("path",{d:"M0 0H48V48H0z"}),us.default.createElement("mask",{fill:"currentColor"},us.default.createElement("use",{xlinkHref:"#photoeditorsdk-clarity-icon"})),us.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-clarity-icon"})));var pA=J7;const ms=v(require("react")),Z7=()=>ms.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},ms.default.createElement("defs",null,ms.default.createElement("path",{id:"photoeditorsdk-shadows-icon",d:"M30.365 17.637l3.076 3.076c.382 1.09.566 2.234.56 3.387l-5.05-5.049-1.414 1.414 6.123 6.124a9.674 9.674 0 01-.792 2.036l-6.746-6.745-1.414 1.414 7.036 7.036c-.212.254-.43.502-.672.742-.24.24-.488.46-.742.672l-7.036-7.036-1.414 1.414 6.745 6.746a9.674 9.674 0 01-2.036.792l-6.124-6.123-1.414 1.414L24.101 34a10.012 10.012 0 01-3.388-.558l-3.076-3.076-.707.707c-3.896-3.896-3.896-10.246 0-14.142 3.896-3.896 10.246-3.896 14.142 0l-.707.707zm-14.849-2.12c-4.688 4.687-4.688 12.281 0 16.97a12.036 12.036 0 004.108 2.693c.064.022.127.057.191.078 4.264 1.577 9.242.658 12.671-2.772 3.43-3.429 4.35-8.407 2.772-12.67-.02-.065-.056-.128-.078-.192a12.036 12.036 0 00-2.694-4.108c-4.688-4.688-12.282-4.688-16.97 0z"})),ms.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ms.default.createElement("path",{d:"M0 0H48V48H0z"}),ms.default.createElement("mask",{fill:"currentColor"},ms.default.createElement("use",{xlinkHref:"#photoeditorsdk-shadows-icon"})),ms.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-shadows-icon"})));var uA=Z7;const fs=v(require("react")),Q7=()=>fs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},fs.default.createElement("defs",null,fs.default.createElement("path",{id:"photoeditorsdk-highlights-icon",d:"M31.07 31.07A9.932 9.932 0 0124 34c-2.67 0-5.18-1.04-7.07-2.93l14.14-14.14c3.9 3.9 3.9 10.24 0 14.14m1.42-15.56A11.995 11.995 0 0024 12c-3.07 0-6.14 1.17-8.49 3.51-4.68 4.69-4.68 12.29 0 16.98C17.86 34.83 20.93 36 24 36c3.07 0 6.14-1.17 8.49-3.51 4.68-4.69 4.68-12.29 0-16.98"})),fs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},fs.default.createElement("path",{d:"M0 0H48V48H0z"}),fs.default.createElement("mask",{fill:"currentColor"},fs.default.createElement("use",{xlinkHref:"#photoeditorsdk-highlights-icon"})),fs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-highlights-icon"})));var mA=Q7;const gs=v(require("react")),eG=()=>gs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},gs.default.createElement("defs",null,gs.default.createElement("path",{id:"photoeditorsdk-exposure-icon",d:"M24 34V14c5.51 0 10 4.49 10 10s-4.49 10-10 10m0-22c6.62 0 12 5.38 12 12s-5.38 12-12 12-12-5.38-12-12 5.38-12 12-12zm-3.536 8.464l-2.121 2.122-2.121-2.122-1.414 1.415L16.929 24l-2.121 2.121 1.414 1.415 2.121-2.122 2.121 2.122 1.415-1.415L19.757 24l2.122-2.121-1.415-1.415zm5.304 4.597l4.242-4.243 1.415 1.414-4.243 4.243-1.414-1.414z"})),gs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},gs.default.createElement("path",{d:"M0 0H48V48H0z"}),gs.default.createElement("mask",{fill:"currentColor"},gs.default.createElement("use",{xlinkHref:"#photoeditorsdk-exposure-icon"})),gs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",transform:"rotate(45 24 24)",xlinkHref:"#photoeditorsdk-exposure-icon"})));var fA=eG;const bs=v(require("react")),tG=()=>bs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},bs.default.createElement("defs",null,bs.default.createElement("path",{id:"photoeditorsdk-gamma-icon",d:"M22.185 33.836c.594.109 1.2.164 1.815.164v2c-.735 0-1.462-.066-2.175-.197zm5.58-.568l.753 1.852c-.675.275-1.375.487-2.093.635l-.402-1.96c.597-.122 1.18-.299 1.741-.527zm-9.446-1.037c.5.346 1.03.646 1.586.895l-.82 1.824c-.666-.3-1.303-.66-1.903-1.074zm12.884-1.295l1.44 1.388a12.06 12.06 0 01-1.65 1.429l-1.167-1.625a10.06 10.06 0 001.377-1.192zm-15.758-1.754c.316.52.679 1.01 1.083 1.464l-1.493 1.33a12.038 12.038 0 01-1.3-1.756zm17.97-1.802l1.882.676a11.948 11.948 0 01-.925 1.982l-1.727-1.008a9.948 9.948 0 00.77-1.65zM24 18c.091 0 .182.002.273.006L24 18a6.071 6.071 0 01.668.037l.192.024a5.974 5.974 0 011.847.585l.01.005a5.992 5.992 0 011.154.768A5.99 5.99 0 0130 24c0 3.309-2.691 6-6 6a5.985 5.985 0 01-4.404-1.929l.163.17a6.052 6.052 0 01-1.353-2.07A5.951 5.951 0 0118 24c0-3.309 2.691-6 6-6zm2.827 3.173l-5.654 5.654A3.988 3.988 0 0024 28c2.206 0 4-1.794 4-4a3.988 3.988 0 00-1.173-2.827zM14.08 25.268c.076.606.208 1.2.392 1.777l-1.905.608a11.936 11.936 0 01-.472-2.134zm21.885-2.192a12.16 12.16 0 01-.032 2.198l-1.989-.21a10.193 10.193 0 00.027-1.836zM12.522 20.49l1.912.584a9.943 9.943 0 00-.37 1.783l-1.987-.226c.083-.73.232-1.445.445-2.14zm22.059-2.155c.345.643.63 1.316.853 2.013l-1.905.608a9.934 9.934 0 00-.71-1.676zm-19.587-2.266l1.5 1.323c-.402.456-.762.948-1.075 1.47l-1.715-1.03c.376-.625.808-1.215 1.29-1.763zm16.272-1.62c.58.442 1.12.936 1.61 1.476l-1.479 1.346c-.41-.45-.859-.862-1.343-1.23zm-12.241-1.372l.83 1.82a9.986 9.986 0 00-1.58.903l-1.147-1.638a11.986 11.986 0 011.897-1.085zm7.7-.766c.714.166 1.408.396 2.076.688L28 14.832a9.916 9.916 0 00-1.727-.573zm-2.857-.31l.021 2c-.613.006-1.22.068-1.812.184l-.383-1.964a12.046 12.046 0 012.174-.22z"})),bs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},bs.default.createElement("path",{d:"M0 0H48V48H0z"}),bs.default.createElement("mask",{fill:"#fff"},bs.default.createElement("use",{xlinkHref:"#photoeditorsdk-gamma-icon"})),bs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-gamma-icon"})));var gA=tG;const ys=v(require("react")),iG=()=>ys.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},ys.default.createElement("defs",null,ys.default.createElement("path",{id:"photoeditorsdk-blacks-icon",d:"M24 12c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12m0 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10m4 12c0 2.788-2.326 3.879-7 3V18.5c4.148-.459 6.516.226 6.516 2.623 0 1.207-.492 1.998-1.512 2.474C27.504 23.999 28 24.619 28 26zm-5-6v3c2.244.068 2.775-.719 2.775-1.536 0-1.22-.531-1.812-2.775-1.464zm0 7.5c2.19.193 3.038-.04 3.038-1.484 0-1.37-1.096-1.695-3.038-1.516v3z"})),ys.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ys.default.createElement("path",{d:"M0 0H48V48H0z"}),ys.default.createElement("mask",{fill:"currentColor"},ys.default.createElement("use",{xlinkHref:"#photoeditorsdk-blacks-icon"})),ys.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-blacks-icon"})));var bA=iG;const vs=v(require("react")),rG=()=>vs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},vs.default.createElement("defs",null,vs.default.createElement("path",{id:"photoeditorsdk-whites-icon",d:"M24 12c6.627 0 12 5.373 12 12s-5.373 12-12 12-12-5.373-12-12 5.373-12 12-12zm-2 6.46h-2c.221 4.539.762 9.051 1 11.04h1.5l1.5-5.52 1.5 5.52H27c.238-1.989.779-6.501 1-11.04h-2c-.051 1.071-.432 7.446-.5 7.973-.459-1.717-.541-3.111-1-4.811h-1c-.442 1.7-.541 2.975-1 4.811-.051-.527-.466-6.902-.5-7.973z"})),vs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},vs.default.createElement("path",{d:"M0 0H48V48H0z"}),vs.default.createElement("mask",{fill:"currentColor"},vs.default.createElement("use",{xlinkHref:"#photoeditorsdk-whites-icon"})),vs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-whites-icon"})));var yA=rG;const _s=v(require("react")),oG=()=>_s.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},_s.default.createElement("defs",null,_s.default.createElement("path",{id:"photoeditorsdk-temperature-icon",d:"M24 12a4 4 0 014 4v7.255a7 7 0 11-8 0V16a4 4 0 014-4zm0 2a2 2 0 00-2 2v8.298l-.856.597a5 5 0 105.712 0L26 24.298V16a2 2 0 00-2-2zm1 6v5.126A4.002 4.002 0 0124 33a4 4 0 01-1-7.874V20h2z"})),_s.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},_s.default.createElement("path",{d:"M0 0H48V48H0z"}),_s.default.createElement("mask",{fill:"currentColor"},_s.default.createElement("use",{xlinkHref:"#photoeditorsdk-temperature-icon"})),_s.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-temperature-icon"})));var vA=oG;const xs=v(require("react")),nG=()=>xs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},xs.default.createElement("defs",null,xs.default.createElement("path",{id:"photoeditorsdk-sharpness-icon",d:"M24 12l11 24H13l11-24zm0 4.8V34h7.883L24 16.8z"})),xs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},xs.default.createElement("path",{d:"M0 0H48V48H0z"}),xs.default.createElement("mask",{fill:"currentColor"},xs.default.createElement("use",{xlinkHref:"#photoeditorsdk-sharpness-icon"})),xs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-sharpness-icon"})));var _A=nG;const db={adjustment:hR,filter:pR,library:mR,overlay:fR,focus:uR,sticker:gR,text:bR,textdesign:yR,frame:vR,transform:_R,brush:xR},cb={left:wR,right:CR,center:SR},Nt={addText:TR,openWebcam:kR,reset:ER,shuffle:DR,uploadImage:IR},Jp={undo:OR,redo:RR,close:AR,export:FR},Je={categories:{[Et.CommonCategory]:GR,[Et.FacebookCategory]:jR,[Et.TwitterCategory]:VR,[Et.InstagramCategory]:WR},crops:{[Et.Custom]:$R,[Et.Square]:qR,[Et.ThreeByFour]:YR,[Et.FourByThree]:XR,[Et.NineBySixteen]:ZR,[Et.SixteenByNine]:JR,[Et.FacebookPost]:QR,[Et.FacebookProfile]:eA,[Et.FacebookTitle]:tA,[Et.InstagramLandscape]:iA,[Et.InstagramPortrait]:rA,[Et.InstagramSquare]:oA,[Et.InstagramStory]:nA,[Et.TwitterPost]:sA,[Et.TwitterProfile]:aA,[Et.TwitterTitle]:lA},dots:UR,duplicate:BR,edit:PR,bringToFront:LR,delete:MR,flipHorizontal:zR,flipVertical:NR,rotate:HR},xA={[Re.BRIGHTNESS]:dA,[Re.CONTRAST]:cA,[Re.SATURATION]:hA,[Re.CLARITY]:pA,[Re.SHADOWS]:uA,[Re.HIGHLIGHTS]:mA,[Re.EXPOSURE]:fA,[Re.GAMMA]:gA,[Re.BLACKS]:bA,[Re.WHITES]:yA,[Re.TEMPERATURE]:vA,[Re.SHARPNESS]:_A};const wn=v(require("react")),Ra=v(require("styled-components")),wA=Ra.default.div`
  overflow: hidden;
  display: none;
  position: relative;
  transform: unset !important;
  vertical-align: bottom;
  ${e=>e.isVisible&&Ra.css`
      display: inline-block;
    `}
`,sG=Ra.default.div`
  position: relative;
  cursor: pointer;
  display: flex;
  align-self: center;
`,aG=Ra.default.div`
  font-size: 15px;
  display: none;
  width: 33px;
  text-align: right;
  color: ${e=>e.theme.foreground};
  z-index: 1;
  margin: 2px;
  ${e=>e.isVisible&&Ra.css`
      display: inline-block;
    `}
`,lG=Ra.default.div`
  transform: translate(0, 0) !important;
`;class dG extends wn.default.Component{constructor(){super(...arguments);this.SLIDER_WIDTH=213;this.MAX_ROTATION=45;this.DEGREES_PER_PIXEL=this.MAX_ROTATION*2/this.SLIDER_WIDTH;this.drag=(e,{x:t})=>{const{flipHorizontally:i,flipVertically:r}=this.transformTool.rotateFlipState;i!==r&&(t*=-1);const o=this.transformTool.defaultAngle-t*this.DEGREES_PER_PIXEL,n=Math.min(this.MAX_ROTATION,Math.max(o,this.MAX_ROTATION*-1));this.transformTool.setRotation(parseInt(`${n}`,10))};this.stop=()=>{this.transformTool.setDefaultAngle(this.transformTool.rotationInDegrees),this.transformTool.addLocalSnapshot()}}get transformTool(){return this.props.transformTool}render(){const{config:e,canvasWidth:t}=this.props,{flipHorizontally:i,flipVertically:r}=this.transformTool.rotateFlipState,o=e.isLayoutAdvanced&&t>e.measurements.canvas.transform.minSliderWidth,n=e.isLayoutAdvanced&&t>e.measurements.canvas.transform.minValueWidth,s=this.transformTool.rotationInDegrees-this.transformTool.defaultAngle,a=i===r?s*-1:s,l=i!==r?this.props.transformTool.rotationInDegrees*-1:this.props.transformTool.rotationInDegrees;return wn.default.createElement(sG,null,wn.default.createElement(D.Draggable,{axis:"x",position:{x:0,y:0},onStart:this.drag,onDrag:this.drag,onStop:this.stop,updateOnPosition:!0,disabled:!o},wn.default.createElement(lG,null,wn.default.createElement(wA,{isVisible:o},wn.default.createElement(Je.dots,{width:90,height:15,x:a})),wn.default.createElement(aG,{isVisible:n},l,""),wn.default.createElement(wA,{isVisible:o},wn.default.createElement(Je.dots,{width:90,height:15,x:a})))))}}var CA=O("transformTool","config")(I(dG));const Aa=v(require("react")),ih=v(require("styled-components")),cG=ih.default(Je.rotate)`
  height: 16px;
  width: 16px;
  transform: scaleX(-1);
`,hG=ih.default(Je.rotate)`
  height: 16px;
  width: 16px;
`,pG=ih.default(Je.flipHorizontal)`
  height: 16px;
  width: 16px;
`,uG=ih.default(Je.flipVertical)`
  height: 16px;
  width: 16px;
`,mG=ih.default.div`
  display: inline-flex;
  transform: scale(0.9);

  @media all and (min-width: 0) and (max-width: 599px) {
    transform: scale(0.7);
  }
`,fG=({transformTool:e,config:t,custom:i,canvas:r})=>{const o=e.locale.transformActions,n=r.canvasSize.width,s=t.isLayoutAdvanced&&n>t.measurements.canvas.transform.minFlipWidth,a=({customButtonKey:m,onClick:b,label:_,icon:g})=>{const S=i.getButton(m);return Aa.default.createElement(S,{key:_,onClick:b,label:_,ariaLabel:_,icon:g,style:{margin:"0 5px"}})},l=a({label:o.buttonFlipHorizontal,icon:Aa.default.createElement(pG,null),onClick:()=>{e.flipHorizontally()},customButtonKey:"transformActionFlipHorizontal"}),d=a({label:o.buttonFlipVertical,icon:Aa.default.createElement(uG,null),onClick:()=>{e.flipVertically()},customButtonKey:"transformActionFlipVertical"}),c=a({label:o.buttonRotateClockwise,icon:Aa.default.createElement(cG,null),onClick:e.rotateClockwise,customButtonKey:"transformActionRotateClockwise"}),p=a({label:o.buttonRotateAntiClockwise,icon:Aa.default.createElement(hG,null),onClick:e.rotateAntiClockwise,customButtonKey:"transformActionRotateAntiClockwise"}),h=t.isLayoutAdvanced?{transform:"rotate(180deg)"}:{};return Aa.default.createElement(mG,{style:h},e.config.enableFlip&&s&&l||null,e.config.enableFlip&&s&&d||null,e.config.enableRotation&&Aa.default.createElement(CA,{canvasWidth:n})||null,e.config.enableRotation&&p||null,e.config.enableRotation&&c||null)};var Zp=O("transformTool","config","custom","canvas")(I(fG));const zi=v(require("react")),ws=v(require("styled-components")),{GridLine:hb}=ae.Crop,gG=ae.Crop.Mask,{Draggable:Qp}=D,Fa=3,bG=ws.default(zl)`
  left: ${Fa}px;
  top: ${Fa}px;
  @media all and (min-width: 0) and (max-width: 599px) {
    left: 6px;
    top: 6px;
  }
`,yG=ws.default(zl)(e=>{const{desktop:t}=e.theme.measurements.canvasControls.corner.touchable,i=t/4-e.borderWidth;return ws.css`
    left: ${i-t}px;
    top: ${Fa}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      left: -30px;
      top: 6px;
    }
  `}),vG=ws.default(zl)(e=>{const{desktop:t}=e.theme.measurements.canvasControls.corner.touchable,i=t/4-e.borderWidth;return ws.css`
    left: ${i-t}px;
    top: ${i-t}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      left: -30px;
      top: -30px;
    }
  `}),_G=ws.default(zl)(e=>{const{desktop:t}=e.theme.measurements.canvasControls.corner.touchable,i=t/4-e.borderWidth;return ws.css`
    top: ${i-t}px;
    left: ${Fa}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      top: -30px;
      left: 6px;
    }
  `}),xG=({transformTool:e})=>{const{leftTopRespectFlip:t,leftBottomRespectFlip:i,rightTopRespectFlip:r,rightBottomRespectFlip:o}=e,{height:n,width:s}=e.cropMaskSize,{maxCropMaskSize:a,defaultCropMaskPosition:l}=e,{isFlippedHorizontal:d,isFlippedVertical:c}=e,p=a.width/2,h=a.height/2,m=y(y({},a),{left:l.x,top:l.y}),b={height:n,width:s},_=e.isDragMode?{transition:"unset"}:{},g=K=>d?p*2-K:K,S=K=>c?h*2-K:K,x=(K,Y,ie)=>{const rt=g(K),st=S(Y);switch(ct.getFlippedEdgeIndex(ie,d,c)){case 0:e.onLeftTop({x:rt,y:st});break;case 1:e.onLeftBottom({x:rt,y:st});break;case 2:e.onRightTop({x:rt,y:st});break;case 3:e.onRightBottom({x:rt,y:st});break}},C=(K,Y,ie)=>{e.setDragMode(!0),e.clickableCanvas(!1),x(K,Y,ie)},R=(K,Y,ie)=>{x(K,Y,ie)},T=(K,Y,ie)=>{e.setDragMode(!1),x(K,Y,ie),e.clickableCanvas(!0),e.addLocalSnapshot()},k=(K,{x:Y,y:ie})=>{C(Y,ie,0)},M=(K,{x:Y,y:ie})=>{R(Y,ie,0)},U=(K,{x:Y,y:ie})=>{T(Y,ie,0)},L=(K,{x:Y,y:ie})=>{C(Y,ie,1)},ee=(K,{x:Y,y:ie})=>{R(Y,ie,1)},de=(K,{x:Y,y:ie})=>{T(Y,ie,1)},ge=(K,{x:Y,y:ie})=>{C(Y,ie,2)},xe=(K,{x:Y,y:ie})=>{R(Y,ie,2)},Oe=(K,{x:Y,y:ie})=>{T(Y,ie,2)},ft=(K,{x:Y,y:ie})=>{C(Y,ie,3)},kt=(K,{x:Y,y:ie})=>{R(Y,ie,3)},Ae=(K,{x:Y,y:ie})=>{T(Y,ie,3)},V=(K,Y)=>{const ie=g(K+s/2)-s/2,rt=S(Y+n/2)-n/2;e.changePosition({x:ie,y:rt})},Q=(K,{x:Y,y:ie})=>{e.setDragMode(!0),e.clickableCanvas(!1),V(Y,ie)},ne=(K,{x:Y,y:ie})=>{V(Y,ie)},Fe=(K,{x:Y,y:ie})=>{e.setDragMode(!1),V(Y,ie),e.clickableCanvas(!0),e.addLocalSnapshot()};return zi.default.createElement("div",{style:y(y({},m),{position:"absolute"})},zi.default.createElement(Qp,{bounds:"parent",position:t,onStart:Q,onDrag:ne,onStop:Fe},zi.default.createElement(gG,{style:y(y({},b),_)})),zi.default.createElement(hb,{style:y({left:t.x+s/3,top:t.y,height:n,width:1},_)}),zi.default.createElement(hb,{style:y({left:t.x+s/3*2,top:t.y,height:n,width:1},_)}),zi.default.createElement(hb,{style:y({left:t.x,top:t.y+n/3,height:1,width:s},_)}),zi.default.createElement(hb,{style:y({left:t.x,top:t.y+n/3*2,height:1,width:s},_)}),zi.default.createElement(Qp,{bounds:"parent",position:y({},t),onStart:k,onDrag:M,onStop:U},zi.default.createElement(bG,{vertical:"top",horizontal:"left",borderWidth:Fa,style:_})),zi.default.createElement(Qp,{bounds:"parent",position:i,onStart:L,onDrag:ee,onStop:de},zi.default.createElement(_G,{vertical:"bottom",horizontal:"left",borderWidth:Fa,style:_})),zi.default.createElement(Qp,{bounds:"parent",position:r,onStart:ge,onDrag:xe,onStop:Oe},zi.default.createElement(yG,{vertical:"top",horizontal:"right",borderWidth:Fa,style:_})),zi.default.createElement(Qp,{bounds:"parent",position:o,onStart:ft,onDrag:kt,onStop:Ae},zi.default.createElement(vG,{vertical:"bottom",horizontal:"right",borderWidth:Fa,style:_})))};var SA=O("transformTool")(I(xG));const Cs=v(require("react")),wG=ae.Bar.Index,{Backdrop:pb}=ae.Crop,CG=({transformTool:e,canvas:t,config:i})=>{const{leftTopRespectFlip:r,leftBottomRespectFlip:o,rightTopRespectFlip:n}=e,{height:s}=e.cropMaskSize,{height:a,width:l}=t.canvasSize,{defaultCropMaskPosition:d}=e,c=e.isDragMode?{transition:"unset"}:{};return Cs.default.createElement(ae.Controls.Container,null,Cs.default.createElement(pb,{style:y({left:0,top:0,width:l,height:r.y+d.y},c)}),Cs.default.createElement(pb,{style:y({left:0,top:r.y+d.y,width:d.x+r.x,height:s},c)}),Cs.default.createElement(pb,{style:y({left:n.x+d.x,top:n.y+d.y,width:l-n.x-d.x,height:s},c)}),Cs.default.createElement(pb,{style:y({left:0,top:o.y+d.y,width:l,height:a-o.y-d.y+i.measurements.basicToolControlBar.controlsBarHeight},c)}),Cs.default.createElement(SA,null),i.isLayoutAdvanced?Cs.default.createElement(wG,{bottom:!0},Cs.default.createElement(Zp,null)):null)};var TA=O("transformTool","canvas","config")(I(CG));const ub=v(require("react")),mb=v(require("styled-components")),SG=mb.default(ae.Controls.Container)`
  ${e=>e.activeCursor?mb.css`
          cursor: move;
        `:""}
  z-index: ${e=>e.theme.measurements.zIndex.canvas.crop.dragImage};
`;class TG extends ub.default.Component{constructor(e){super(e);this.INITIAL_POSITION={x:void 0,y:void 0};this.state=y(y({},this.INITIAL_POSITION),{isDragging:!1});this.containerRef=null;this.getCursorCoordinates=e=>{let t=0,i=0;if(e.type.indexOf("touch")!==-1){const s=e;if(!s.touches.length)return this.INITIAL_POSITION;t=s.touches[0].clientX,i=s.touches[0].clientY}else{const s=e;t=s.clientX,i=s.clientY}const r=this.containerRef.current.getBoundingClientRect(),o=t-r.left,n=i-r.top;return{x:o,y:n}};this.move=e=>{if(this.scale.canDrag){const{x:t,y:i}=this.getCursorCoordinates(e);if(t!==void 0&&i!==void 0&&this.state.isDragging){const r={x:this.state.x-t,y:this.state.y-i};this.scale.setOffset(r)}}};this.touchDrag=e=>{if(this.scale.canDrag){const{x:t,y:i}=this.getCursorCoordinates(e);t!==void 0&&i!==void 0&&this.setState({x:t,y:i,isDragging:!0})}};this.drag=e=>{e.preventDefault(),this.touchDrag(e)};this.stop=()=>{this.scale.canDrag&&(this.scale.savePosition(),this.setState(y(y({},this.INITIAL_POSITION),{isDragging:!1})))};this.touchEnd=e=>{e.preventDefault(),e.stopPropagation();const{x:t,y:i}=this.state;t&&i&&this.setState(y(y({},this.INITIAL_POSITION),{isDragging:!1}))};this.containerRef=ub.default.createRef()}componentDidMount(){document.addEventListener("mouseup",this.stop,!1),document.addEventListener("touchend",this.stop,{passive:!0})}componentWillUnmount(){document.removeEventListener("mouseup",this.stop,!1),document.removeEventListener("touchend",this.stop,!1)}get scale(){return this.props.scale}render(){return ub.default.createElement(SG,{ref:this.containerRef,onMouseMove:this.move,onTouchMove:this.move,onMouseDown:this.drag,onTouchStart:this.touchDrag,onMouseUp:this.stop,onTouchEnd:this.touchEnd,activeCursor:this.scale.canDrag})}}var kA=O("scale")(I(TG));const jl=v(require("react")),Gx=v(require("styled-components")),kG=Gx.default.img`
  position: absolute;
  left: -24px;
  top: calc(50% - 12px);
  cursor: ew-resize;
`,EG=Gx.default.img`
  position: absolute;
  right: -24px;
  top: calc(50% - 12px);
  cursor: ew-resize;
`;let jx=new E(0,0),Wx=new E(0,0);const DG=({sprite:e,config:t})=>{const i=e.leftMidPosition,r=e.rightMidPosition,o=t.assetProvider.getPath("controls","/arrow-left.png"),n=t.assetProvider.getPath("controls","/arrow-right.png"),s=(d,c)=>{e.setDragMode(!0),e.clickableCanvas(!1);const{clientX:p,clientY:h}=d;jx=new E(p,h),Wx=new E(c==="left"?i:r)},a=()=>{e.clickableCanvas(!0),e.setDragMode(!1),e.addSnapshot(be.EDIT,e.textDesignLocale.padding),jx=new E(0,0),Wx=new E(0,0)},l=({clientX:d,clientY:c})=>{if(d!==void 0&&c!==void 0){const p=Wx.subtract(jx.subtract(new E(d,c)));e.onPaddingDrag(p)}};return jl.default.createElement(jl.default.Fragment,null,jl.default.createElement(D.Draggable,{onStart:d=>s(d,"left"),onDrag:l,onStop:a},jl.default.createElement(kG,{src:o})),jl.default.createElement(D.Draggable,{onStart:d=>s(d,"right"),onDrag:l,onStop:a},jl.default.createElement(EG,{src:n})))};var EA=O("sprite","config")(I(DG));const Wl=v(require("react")),fb=v(require("styled-components")),DA=fb.default(ae.Controls.Width)`
  cursor: ew-resize;
  @media all and (min-width: 0) and (max-width: 599px) {
    display: none;
  }
`,IA=fb.default(DA)`
  left: -3px;
  top: calc(50% - ${e=>e.theme.measurements.canvasControls.width.size/2}px);
`,OA=fb.default(DA)`
  right: -3px;
  top: calc(50% - ${e=>e.theme.measurements.canvasControls.width.size/2}px);
`;let Vx=new E(0,0),Kx=new E(0,0);const IG=({sprite:e,textTool:t})=>{const i=e.leftMidPadPosition,r=e.rightMidPadPosition,o=(a,l)=>{e.setDragMode(!0),e.clickableCanvas(!1);const{clientX:d,clientY:c}=a;Vx=new E(d,c),Kx=new E(l==="left"?i:r)},n=()=>{e.clickableCanvas(!0),e.setDragMode(!1),e.addSnapshot(be.EDIT,e.textLocale.width),t.updateDefaultFontSize(),Vx=new E(0,0),Kx=new E(0,0)},s=({clientX:a,clientY:l})=>{if(a!==void 0&&l!==void 0){const d=Kx.subtract(Vx.subtract(new E(a,l)));e.onWidthDrag(d)}};return Wl.default.createElement(Wl.default.Fragment,null,Wl.default.createElement(D.Draggable,{onStart:a=>o(a,"left"),onDrag:s,onStop:n},Wl.default.createElement(IA,null)),Wl.default.createElement(D.Draggable,{onStart:a=>o(a,"right"),onDrag:s,onStop:n},Wl.default.createElement(OA,null)))};IA.defaultProps={theme:X};OA.defaultProps={theme:X};var RA=O("sprite","textTool")(I(IG));const Vl=v(require("react")),OG=({textTool:e,sprite:t,custom:i})=>{const r=e.locale.canvasActions,o=d=>{d.stopPropagation(),e.delete()},n=d=>{d.stopPropagation(),e.bringToFront()},s=({key:d,customButtonKey:c,onClick:p,label:h,icon:m})=>{const b=i.getButton(c);return Vl.default.createElement(b,{key:d,onClick:p,label:h,ariaLabel:h,icon:m})},a={[he.EDIT]:{key:he.EDIT,customButtonKey:"canvasActionEdit",onClick:()=>e.setEditMode(!0),label:r.buttonEdit,icon:Vl.default.createElement(Je.edit,null)},[he.BRING_TO_FRONT]:{key:he.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:n,label:r.buttonBringToFront,icon:Vl.default.createElement(Je.bringToFront,null)},[he.DUPLICATE]:{key:he.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>e.duplicate(),label:r.buttonDuplicate,icon:Vl.default.createElement(Je.duplicate,null)},[he.DELETE]:{key:he.DELETE,customButtonKey:"canvasActionDelete",onClick:o,label:r.buttonDelete,icon:Vl.default.createElement(Je.delete,null)}},l=e.config.canvasActions.map(d=>a[d]?s(a[d]):null);return t.isSpriteText?Vl.default.createElement(ae.Bar.ButtonGroup,null,l):null};var AA=O("textTool","sprite","custom")(I(OG));const Kl=v(require("react")),RG=({stickerTool:e,custom:t})=>{const i=e.locale.canvasActions,r=d=>{d.stopPropagation(),e.delete()},o=d=>{d.stopPropagation(),e.bringToFront()},n=d=>{d.stopPropagation(),e.flipHorizontally()},s=({key:d,customButtonKey:c,onClick:p,label:h,icon:m})=>{const b=t.getButton(c);return Kl.default.createElement(b,{key:d,onClick:p,label:h,ariaLabel:h,icon:m})},a={[he.BRING_TO_FRONT]:{key:he.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:o,label:i.buttonBringToFront,icon:Kl.default.createElement(Je.bringToFront,null)},[he.FLIP]:{key:he.FLIP,customButtonKey:"canvasActionFlip",onClick:n,label:i.buttonFlipHorizontal,icon:Kl.default.createElement(Je.flipHorizontal,null)},[he.DUPLICATE]:{key:he.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>e.duplicate(),label:i.buttonDuplicate,icon:Kl.default.createElement(Je.duplicate,null)},[he.DELETE]:{key:he.DELETE,customButtonKey:"canvasActionDelete",onClick:r,label:i.buttonDelete,icon:Kl.default.createElement(Je.delete,null)}},l=e.config.canvasActions.map(d=>a[d]?s(a[d]):null);return e.isStickerSelected?Kl.default.createElement(ae.Bar.ButtonGroup,null,l):null};var FA=O("stickerTool","custom")(I(RG));const Pa=v(require("react")),AG=({textDesignTool:e,custom:t})=>{const i=e.locale.canvasActions,r=d=>{d.stopPropagation(),e.delete()},o=d=>{d.stopPropagation(),e.bringToFront()},n=d=>{d.stopPropagation(),e.invertBackground()},s=({key:d,customButtonKey:c,onClick:p,label:h,icon:m})=>{const b=t.getButton(c);return Pa.default.createElement(b,{key:d,onClick:p,label:h,ariaLabel:h,icon:m})},a={[he.EDIT]:{key:he.EDIT,customButtonKey:"canvasActionEdit",onClick:()=>e.setEditMode(!0),label:i.buttonEdit,icon:Pa.default.createElement(Je.edit,null)},[he.BRING_TO_FRONT]:{key:he.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:o,label:i.buttonBringToFront,icon:Pa.default.createElement(Je.bringToFront,null)},[he.INVERT]:{key:he.INVERT,customButtonKey:"canvasActionInvert",onClick:n,label:i.buttonInvert,icon:Pa.default.createElement(Je.flipHorizontal,null)},[he.DUPLICATE]:{key:he.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>e.duplicate(),label:i.buttonDuplicate,icon:Pa.default.createElement(Je.duplicate,null)},[he.DELETE]:{key:he.DELETE,customButtonKey:"canvasActionDelete",onClick:r,label:i.buttonDelete,icon:Pa.default.createElement(Je.delete,null)}},l=e.config.canvasActions.map(d=>a[d]?s(a[d]):null);return e.isTextDesignSelected?Pa.default.createElement(ae.Bar.ButtonGroup,null,l):null};var PA=O("textDesignTool","custom")(I(AG));const $l=v(require("react"));class FG extends $l.default.Component{constructor(e){super(e);this.actionsRef=null;this.spriteControlPosition=()=>{const{config:e,sprite:t,canvas:{canvasSize:i}}=this.props,{controlPadding:r,controlOffset:o}=e.measurements.canvasControls.sprite,{x:n,y:s}=t.position,{height:a,width:l}=t.currentSprite.size,d=t.rotationWRTOutputRotation,c=this.actionsRef.current;let p=new E(0,0);if(c){const b=c.getBoundingClientRect();p=new E(b.width/2+o,b.height+o)}const h=Math.abs(l*Math.sin(d))+Math.abs(a*Math.cos(d)),m=new E(n,s-h/2-r-o).clamp(p,new E(i.width,i.height).subtract(p));return{left:m.x,top:m.y}};this.getSpriteControls=()=>{switch(this.props.sprite.tool){case w.TEXT:return $l.default.createElement(AA,null);case w.TEXT_DESIGN:return $l.default.createElement(PA,null);case w.STICKER:return $l.default.createElement(FA,null)}return null};this.actionsRef=$l.default.createRef(),this.state={isMounted:!1}}componentDidMount(){this.setState({isMounted:!0})}render(){const{sprite:e}=this.props,{isMounted:t}=this.state,i=!e.isDragMode&&!e.isEditMode,r=this.spriteControlPosition();return $l.default.createElement(ae.Controls.SpriteActionsWrapper,{ref:this.actionsRef,show:i&&t,style:y({},r)},this.getSpriteControls())}}var BA=O("sprite","config","editor","canvas")(I(FG));const $x=v(require("react")),MA=v(require("styled-components")),LA=MA.default(ae.Controls.Knob)`
  margin-left: -11px;
  margin-top: 0px;
  cursor: url(${e=>e.url}) 9 9, ew-resize;
  &:before {
    top: unset;
    bottom: 0px;
    left: calc(50% - ${e=>e.theme.measurements.canvasControls.knob.size/2}px);
  }
`;let qx=new E(0,0),Xx=new E(0,0);const PG=({config:e,sprite:t,snapping:i})=>{const r=t.rightBottomHandlePosition,o=t.leftBottomHandlePosition,n={x:(r.x+o.x)/2,y:(r.y+o.y)/2},s=({clientX:p,clientY:h})=>{qx=new E(p,h),Xx=new E(n),t.setDragMode(!0),t.clickableCanvas(!1)},a=()=>{t.clickableCanvas(!0),t.setDragMode(!1),t.spriteSnapshot("rotation"),i.hideRotationGuides(),qx=new E(0,0),Xx=new E(0,0)},l=({clientX:p,clientY:h})=>{if(p!==void 0&&h!==void 0){const m=Xx.subtract(qx.subtract(new E(p,h))),b=t.position,_=new E(b.x,b.y),g=m.subtract(_),S=Math.atan2(g.y,g.x)-Math.PI/2,x=i.snapToRotation(S,g,t.currentRect);t.setRotation(x)}},d=p=>{l(p)},c=e.assetProvider.getPath("controls",`/${sS()?"rotate-windows":"rotate-osx"}.png`);return $x.default.createElement(D.Draggable,{onStart:s,onDrag:d,onStop:a},$x.default.createElement(LA,{url:c}))};LA.defaultProps={theme:X};var zA=O("sprite","snapping","config")(I(PG));const po=v(require("react")),{Corner:gb}=ae.Controls,{Draggable:bb}=D;let Yx=new E(0,0),Jx=new E(0,0);class BG extends po.default.Component{get sprite(){return this.props.sprite}render(){const{sprite:e,config:t}=this.props,{leftTopPosition:i,leftBottomPosition:r,rightTopPosition:o,rightBottomPosition:n}=e,{borderWidth:s}=t.measurements.canvasControls.corner,a=({clientX:p,clientY:h})=>{p!==void 0&&h!==void 0&&e.onCornerDrag(Jx.subtract(Yx.subtract(new E(p,h))))},l=p=>{switch(p){case"leftTop":return i;case"leftBottom":return r;case"rightTop":return o;case"rightBottom":return n;default:return i}},d=(p,h)=>{const{clientX:m,clientY:b}=p;Yx=new E(m,b),Jx=new E(l(h)),e.clickableCanvas(!1),e.setDragMode(!0)},c=()=>{e.clickableCanvas(!0),e.setDragMode(!1),e.spriteSnapshot("size"),Yx=new E(0,0),Jx=new E(0,0)};return po.default.createElement(po.default.Fragment,null,po.default.createElement(bb,{onStop:c,onDrag:a,onStart:p=>d(p,"leftTop")},po.default.createElement(gb,{vertical:"top",horizontal:"left",borderWidth:s})),po.default.createElement(bb,{onStop:c,onDrag:a,onStart:p=>d(p,"leftBottom")},po.default.createElement(gb,{vertical:"bottom",horizontal:"left",borderWidth:s})),po.default.createElement(bb,{onStop:c,onDrag:a,onStart:p=>d(p,"rightTop")},po.default.createElement(gb,{vertical:"top",horizontal:"right",borderWidth:s})),po.default.createElement(bb,{onStop:c,onDrag:a,onStart:p=>d(p,"rightBottom")},po.default.createElement(gb,{vertical:"bottom",horizontal:"right",borderWidth:s})))}}var NA=O("sprite","config")(I(BG));const $o=v(require("react")),{Draggable:MG}=D;let Zx=new E(0,0),Qx=new E(0,0);class LG extends $o.default.Component{constructor(){super(...arguments);this.onAreaDrag=({clientX:e,clientY:t})=>{const{snapping:i}=this.props,r=Qx.subtract(Zx.subtract(new E(e,t))),{x:o,y:n}=i.snapToPosition({x:r.x,y:r.y},this.sprite.currentRect);this.sprite.setPosition({x:o,y:n})};this.onAreaDragStart=e=>{const{snapping:t}=this.props,{clientX:i,clientY:r}=e;Zx=new E(i,r),Qx=new E(this.sprite.position),this.sprite.setDragMode(!0),t.updateGuides()};this.onAreaDragStop=()=>{const{snapping:e}=this.props;Zx=new E(0,0),Qx=new E(0,0),this.sprite.setDragMode(!1),this.sprite.spriteSnapshot("position"),e.hidePositionGuides()};this.onDoubleClick=e=>{e.preventDefault(),e.stopPropagation(),this.sprite.setEditMode(!0)};this.isSpriteSelected=()=>{const{active:e}=this.props,t=e.tool,i=this.sprite.tool;return this.sprite.isSpriteSelected&&t===i}}get sprite(){return this.props.sprite}render(){const{sprite:e,config:t}=this.props,i=this.isSpriteSelected();if(!i)return null;const{isSpriteText:r}=this.sprite,o=this.sprite.isSpriteTextDesign&&this.sprite.textDesignToolStore.isInverted,{height:n,width:s}=e.size,a=e.spritePosition,l=e.rotationWRTOutputRotation,{controlPadding:d}=t.measurements.canvasControls.sprite;return $o.default.createElement(ae.Controls.Container,null,$o.default.createElement(MG,{onStart:this.onAreaDragStart,onDrag:this.onAreaDrag,onStop:this.onAreaDragStop,rotation:l,position:a},$o.default.createElement(ae.Controls.Sprite,{onDoubleClick:this.onDoubleClick,height:n,width:s},r&&$o.default.createElement(RA,null)||null,o&&$o.default.createElement(EA,null)||null,$o.default.createElement(NA,null),$o.default.createElement(ae.Controls.RotateHandle,{x:s/2+d/2},$o.default.createElement(zA,null)))),$o.default.createElement(BA,null))}}var UA=O("sprite","active","snapping","config")(I(LG));const Cn=v(require("react"));class zG extends Cn.default.Component{constructor(e){super(e);this.containerElementRef=null;this.getControls=e=>{switch(this.props.active.tool){case w.FOCUS:return Cn.default.createElement(dR,null);case w.TEXT:case w.TEXT_DESIGN:case w.STICKER:return Cn.default.createElement(UA,null);case w.BRUSH:return Cn.default.createElement(cR,null);case w.TRANSFORM:return Cn.default.createElement(TA,null);default:return Cn.default.createElement(ae.Controls.Container,null,e)}};this.canvasClicked=e=>{if(e.preventDefault(),e.stopPropagation(),this.props.canvas.isCanvasClickable){let{clientX:t}=e,{clientY:i}=e;if(e.type.indexOf("touch")!==-1){const s=e;if(!s.touches.length)return;t=s.touches[0].clientX,i=s.touches[0].clientY}const r=this.containerElementRef.current.getBoundingClientRect(),o=t-r.left,n=i-r.top;this.props.canvas.getContainersAtPreviewPoint({x:o,y:n})}};this.onKeyDown=e=>{e.code==="Tab"&&this.props.sprite.selectLast()};this.containerElementRef=Cn.default.createRef()}render(){const{children:e}=this.props,{canvasSize:t}=this.props.canvas,i={height:t.height,width:t.width};return Cn.default.createElement(ae.Controls.Wrapper,y({"aria-hidden":!0,ref:this.containerElementRef,onClick:this.canvasClicked,onKeyDown:this.onKeyDown},i),e,this.getControls(Cn.default.createElement(kA,null)))}}var HA=O("active","canvas","sprite")(I(zG));const GA=v(require("react")),jA=v(require("styled-components")),NG=jA.default.div`
  display: ${({isVisible:e})=>e?"block":"none"};
  position: absolute;
  z-index: ${e=>e.theme.measurements.zIndex.canvas.snappingGuide};
`,WA=({isVisible:e,className:t})=>GA.default.createElement(NG,{isVisible:e,className:t});WA.defaultProps={direction:"horizontal",left:0,top:0};var ew=WA;const yb=v(require("react")),ql=v(require("styled-components")),UG=ql.default(ew)`
  background: ${e=>e.theme.snapping.positionGuideColor};
  ${e=>e.direction==="horizontal"?ql.css`
        width: 100%;
        height: 2px;
        top: ${()=>e.position}px;
      `:ql.css`
      width: 2px;
      height: 100%;
      left: ${()=>e.position}px;
    `}
`,HG=ql.default(ew)`
  border: none;
  border-top: 2px dashed ${e=>e.theme.snapping.rotationGuideColor};
  background: transparent;
  left: ${({position:e})=>e.x}px;
  top: ${({position:e})=>e.y}px;
  transform: rotate(${({rotation:e})=>e}rad);
  width: 200%;
`,GG=ql.default.div`
  position: absolute;
  width: ${({width:e})=>e}px;
  height: ${({height:e})=>e}px;
  top: ${({top:e})=>e}px;
  left: ${({left:e})=>e}px;
  overflow: hidden;
`,jG=({snapping:e,editor:t})=>{const{width:i,height:r}=t.getPreviewSize(),{x:o,y:n}=e.previewTopLeftPosition,s=e.positionGuides.map(({direction:l,value:d,isVisible:c},p)=>yb.default.createElement(UG,{key:`positionGuide-${p}`,direction:l,position:d,isVisible:c})),a=e.rotationGuides.find(({isVisible:l})=>l);return yb.default.createElement(GG,{width:i,height:r,left:o,top:n},s,yb.default.createElement(HG,{key:"rotationGuide",rotation:a?a.value:0,position:a?a.position:{x:0,y:0},isVisible:!!a}))};var VA=O("snapping","editor")(I(jG));const KA=v(require("react")),$A=v(require("styled-components")),WG=$A.default.img`
  z-index: 5;
  position: absolute;
  bottom: 30px;
  right: 30px;
`,VG=()=>KA.default.createElement(WG,{alt:"watermark",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAAAvCAYAAABzC1HpAAAAAXNSR0IArs4c6QAAE7NJREFUeAHtnFlQVdeax2UQBAEFFUUccJ7nAVEDGqNeZxOjiRq9uVpJ3apUP3TnPZXHVKUqlYcMLzGxTXc00XSMxjjjiAMqKijOAiLiBIID89C//9J1antyjp6g1zZde1cd9t5rr/Fb/+//DXtr0EcffbS4WbNmvfi5hyuBl1UCF4KZmQvSl3V73HlZCfQSUN3DlcBLLwEXqC/9FrkTlARcoLo4+EtIwAXqX2Kb3Em6QHUx8JeQgAvUv8Q2uZN87kA9dOhQjzVr1kzyJ9qLFy+29ffMLXcl4E8CzxWot27diszIyJh67dq1XuvWrUt1DnrkyJGkr7/+ehHlS69fvx7lfOZeuxJ4mgRC0tLSJjytUqDPAeGUmJiYkpkzZ24+cODAqxUVFTVhYWFVP/7446zz588P6dWrV3ZVVVV4cHBwZVJS0u1A+3XruRJoEqM2NDQ027lz56CrV6+2siLMyclJhFGTpk+fvicxMfHu1KlTf83KypqwevXqpdHR0Xfee++9FdOmTTvWoUOHQhg1wbZzz64EApFAaCCVvOvcvHkzClM++ejRow0tW7Ys7datWy6g7QFjHo+Nja1S/QEDBhTjjx4pKCjoO3/+/PSQkJBGlbdr1+7W6dOnh5aWlkbU1NSEwLj1rVq1qrLPVcc9XAl4S6BJph9QxgLAJFjyG9i1EkAOuHfvXrvXX399U0RERJ0dBOAWHTt2bNCDBw8aAXD57t27h5w5c2bY3bt3O1A+6sSJEyN0xk1IyczMHAzb5lGv0rZ3z64ErASaxKj4nuEwYDX+aA0+7hmYMaywsLCrZVPbuVgSZs0CkCknT55MiYqKKh00aNBR/NPi1q1bV+ASVOOzhl66dKn9li1b5nXs2LHctnXPrgScEmgSUOvr6x/zbfFN4zHpN5wd2+uuXbsWHz58OGrYsGG78VuP23J7joyMrMNnbRcXF1cYHh5eb8vdsysBpwSaBNTmzZvXNzY2esAKcEOJ5BucHdvrffv2jYFBs32B1Na5fPlyn549e56298/jjA/d7cqVK4mDBw8+hwty63n0+SL6KC4ujiYXPRiLUzZx4kQjE1yjnjdu3OgwZMiQM927dy95EfN42cYIGKgS4NmzZ7ty7lhSUpKA39nmk08++Q/Mu/FJAW+t9+IImhJg227Lli1b4f3M3p87dy7+zp07ibQ/acuedEYpgkiDTZS7Yetp7DZt2pSMHj36DIFZtcoPHjw4ARclNjQ0tP7/Cqhbt24dRuDZ3s7TnlHqxlmzZu2S62TL7JkAtT8yScbXL7dAxSK9Wl1dHdWiRYvKFwnU8vLy8L179yrwbSsiio+Pv/7KK6/kyApqvr/88svY+/fvx9i5YxGrkf+dUaNGncNCPhZr7Nmzpx/7EUHmJ8vWJ86Jpf/klJSUoxDVE9OVAQFVgNu4ceNCJlHMZK/CUplc32My9xFgc5irw/Hjx9NYUIZzgrBpWp8+fTKdZXaS9kwQNVz9woCvskEDWcj2Tp06+fVVWVxcXl7eUNvenvPz85uhSEPfeeedNfKVtbF6hl9839ZpylkKytr/BuBr6XsDWQqflsNX38gtGYWK9PUMRT/gC6iUm3kDSs+8qXezkoPsylX1RZ/BP/zww0zO4aQDtz1JXr7GDqSsqKgohjeMiwHfg4SEhDzk2eLUqVNj2EsBMV99kBsfhayvMb9S3Qu0xCr9SFWOJ3bZRL08lesg4O4LqYnMDFCV9Vm/fv0b9FeM8j0RpGofEFD79etXTN60DNNzZOzYsRfV0HmIsVhYZwKicYsWLdqhZ5irXsg2etKkSR4NcrbRNcBqj3/aCwCsREtr1F5515EjR6ZbNvFuA/uajVS5XAoEWQlrdRIrs8lxMFJv5ngG5m2uOgD1gc5NPQj0OiLUzmqv4DDQfsT8FqSwfUHbtm2v27aAsKp9+/b37L3zDOv8AajLly9f76yDzGL49VQZaw53Pnte19u3b5/AnpS///77q+26AWu6jSPEtrh/IcQeR52AVDkAnwtJTe3du/d3kJCxcLRtiQyMonEdsnbt2tlSxgULFmyFrZ867YCAqo4A6zGi92RfQNUoAHI/Wv4ubJdFwr8MhkwViDZs2JDmbxa8aoXxe2ahsWbT3nrrrXTMXP6uXbvmqo0vsJLa8gB1ypQphsG18M8///zf5DeXlZXF3r5921OHOdTAiMn4eImAthwG2udkMvzjNmQk+gDG9mJN2KmAcXO0ZtyWlrDIMM0lKCiogfX9bfbs2ekSvl56YM4GyhUCLNH0eWfcuHHHLLuprdrpwKqcTk1NPfvw7vG/Yi6UWim7NmQ9CgBqjGoAEqNgKGCL33//PY3x6+fNm7eLOTYgn3G2F15Zj2GuB617k5ub24EUYE/axbP2Klj44vjx48/b+vv37++DLOLHjBlzEms2CGDFLV26dKM3WJBHQo8ePbItSNXeglTXuH9Gxqz7MSKQbMDCTr0qR67d7LpFWuTcTd2ffvppCnsWuWTJktXOPtWvvyMgoKoxVJ7Dpo0mF9p/woQJud4d6m0UFH48PT09TQJn4fWwRj4bGgIrDef5WYT/GIsQMBTLfPz888/B5GD3YTrCWNxIGOgKCuFzY6ljAKCNw2wYPwighNngjrJSJ+synxkwm2kDgJuxyZVz5sw5oPmjTEmsZ5ZlX5UBvN7KYrz99ts7L1y40BHgd1S5+oe5uymlBphCYY2Z3HfXMx1sXFdcoIELFy78T4GVdh6gspkeM/6w9sO/8tFY+wI7P8ZNss9RKiMr5NMRczpA5XV1dXtYQ0vm2MfWYw498Wf36F5+IIHYVCsLlaEIfZFHBj7xYd3z/DX6Cae8J+uIxb83L2j0zHnAdg9YT2/GOmWJxPncyhh5/2Ft8jdRqBrqxKqNrEttbW2E3LBff/11DHNOgpR+8E5nOvv3vg4YqPLNkpOTdxGkTMFHzbMgcXb42muvZX7zzTfLZConT578P0OHDjVUDxOFMdlQGGG/s76utVmbNm2a/v3338/kpUEcQr8nX9CfplnTiKbX024kihBMH2bjxHoI6Sr+agc7DmmzK7DNeX0sg7BawFzmta9YGEd+ukCK332JtWXiNowQUGk/hDUcGDhwYAH+VhECT5QfPWPGjM1iHsA9VCBlDnW020ZZAwCYLADAWCMAeTrto+0cCKrm8TO31G2EldfAsjfpZ5xAylrvQQRbWX9L5DtNFS37oJiGubTxlNUCoLouXbpkA6LBgKyS7yp+lmIwXgRzmCKQdu7c+TR7lMN9ihQIFysZS5L5iB2D1L/myvr2Y45LtCbvA8bdi7s3Z9WqVcvpLxdrcYRU4x1b75Fla4RUKmyZ86y5IW/jflnrwouiLljRPsxlrbU8zjZPuv7jDJ9QG4Eydm040d40aYl3VdE+iz+EUKsQlAGp6vTv3/8sGtxPEb53Gy0eYK5l4W1ZXPW777673h9I1RYTYjYOQYcBolQClvFsZjs9I+rfof5gWMNmKNeDxYsXb0bol2BzI2Q22rAwLkYvAZdmjbD5Vr3yxUwZplVfzDdOLgLgN34pa7sFQMr0jMBgkM6MlS3TJtOKQuSrTCZcZzsHXQOeEPuTwqKMYpsWKIX5F8AjRozYN3z48Cu8DMlXfR2WhS1QkYlhLoENOZkMC/3cFeBVH1AO0BjIvppX1tvp6xq+Y6aeaUzGikEpgiU3lSGrdECeKdno3vvQfDDN32ElT4iVsSB/h7H723qybMi3whfI5RbxIicKmZmg2FoXlCmB+rUQg99g2fbvfQ4YqLBPX8zoHDEIEwlasWLFfF/Aw787iTBrqe9ZFCZ2NEItZ6ETvCegewECd2Ibm6zgysNEvuoCVANCbRzgyGPRl/Glst58881VjH1KbQCJAbOcdStIa16t7wfTxKmuvlWwJoh5eyJ6rs3LBwn8UT3jX0lBYfXWKsPFuaazDsYxbTmbdtpIldNPneZmfwSb3wrwAEd9GGWH8YtUl400bXTNnMx4FvCs19zrmbUqMs+61yHfXGfAcd1mJrzW08Canf0/5oaprffBK+37gH435LFC0b2shiyR6mkfJF/vNrrH2kRJabC6RrGZm5EhLtd6yQeim+GL6Hz1ZcsCMv1ywGEgrPnkXzDnhZiBM/gaqaQXFuKzlcgs2Q6ZYJA0GDM6Ef9qoEyzNhbtXIV5X8Jie/jSYjEA7HiaaDMVwfxm+/M+W+Dg854nYtzt/Vz3jGc2xClI2pky+UmqYwEvFte9Dvw/E8jomk0yWs/GGCHbdjKxPDYAQ/k8bRnTtKWeaWf7B2D35LOpT+dhN09lKI+Rn/X7VIZJfmyejOUBhZWBc32MZ+bpXA9zNW6OXCJlGQiyEtS3DuIDD8gflvj/CyE8gPUPszfzYNfWyuVKWZyK4mwNVgZJQQnkDNvj0kTpXgqKe4jHtmkBQfZYLFmGs92TrgNiVCL5bgxUw8+whTSWiPugqJ9FFGJ+cuyvb9++2ZiN/ZiddJjitD5WIa2VQb0KUhkZRJqp/rSJPg/gz3RjPMN23hOXSbHMaH047zq6txsJAMzm2lSKnlFmTD8bbzZKSiSTqGe4EsakA7bb8sFhs+ZSOj2jzNSHsRR8GHeAuRozr/kCMhN0sRkFqm+BIzBpvfanNehgHp4gBh8yUWVkILrrrE2VP6prFMUqnccXtGVOGdj1wORxGkM/5aXVh4JTmKwZcvAwKooQMFDVB4plFNEqsNbnVBTV0aFPPxUgg4PDNo6R+wJWzHgQUhHuYQZzS1YwaxoF8CcgRoUNtxAMDNWHI5BergC1Y8eOZDbtJqZhj79xcMYHs5i7mPVTqkPAcIr2w3EhhsDOJ7zbaWHKDhBQDEcbTT7WWQdhRcDYBlSW4ZzP7bUFKhtpgMqmGQbUc4QzHpBUw3L5CGsMII388ssvl0vobKRhHJRsv+pa/1TXfOU1Fp82VP4om1wA+yaRrptAUNNDyqjquDA3sBYmz2yBCqt1/vTTT/9dfdiDiHclrHRTlkg+I0HVbOZVyoa2VR0pB67V3Ef5UzN3ANAHeZaS+skRQ6oewB7422+/1cvXJKecp6yD+vjiiy/+ATDruNa8mjFnw1xiNt3DulUwvSEd3XsfemWL4rUGVBfFxGR7OrHW8QRVp5BdnepLxrhdRY8sjHFbUNhO2dnZKci9BIwctf3KwjlBrcCOFFkn3MNp9Pm9XAxb1985IKCqMe/qT5BLzd+2bdur33777TIJkyj+v/11LDYi1TSWV25bYQjDQNJqXpftYWOmM/lIgF6mfhRBItQYgNiBdrEwQKGvfqnjSW4DamNifdWzAQN+lQmg5INSv1CgYax2AiqKUMrG7mUTxsFQ0fppA5nfdvzwy+pXm4IfepZItS/tlJc0Jpq3ZztwfWbJp1afqqvMgYIyrVHHo0DNXHv9aUTJquSX68UGZtJE6lIYNncd6bOZagvQDYOxkRdQ7njmF2UVDiXLQbZpmrNcLfVPOu8C8zxKoDcC2caqjPnehxy2wG7mgyHGMPJjXcZ3VB1fB8+rAGuyglX7HEuRjY/pISVkHEH6bqR+tg7t7pDkz3JkGMwjQN2SZx6fWDJ64403fl+5cuUS3MeZvFRYY+Vm+/I+B/GfpH3sXfi0eyLASWhnLN+jrvNXF4d5HKyT4KvOZ5999k+0zoAIoDYHnHEs8CjaewMXokjA8tcvPlIMi2r0lduzbaTlbFaYMwUi884mxgPY+04NBmxhbHAsgqymfpm3wGRC2Yx4gFXpHFPltGsFC0cCphIBz46vs+YA2Jo7y3SNCayTG2TLVQ8XIhrFuS2XinmHokBtAEYJczLspZcSqi/f0LajTmvAEuIs07NH2YTWkECFctu2vs6SAUFcK/m/yN+4Fs7nzmvVlT+qMejnjp2LrUPQG8XePdRKCtmzCu86tq7WiNJ43BlbLtlDTpHyXW2Zv3OTgIppWYofesDfWyotgsDpH3Pnzl1j35g4J/DVV18txrwe4JcHeNrCTvM//PDDr5113GtXAk4JBGz6bSMxGkzRmug/35Y5z7BPO175zUZjS32BVHUxWZFkCwyr4BY0WL/T2Y977UrAKYE/DVQi1CRo/B7+Sxf5bPI/cQMiMN9RmKPumPvOmKOTmKuhArW3+cHMRcrfkmnTRORjYW6NiXNOzL12JeCUwJ8GKgFHDb5IuaJnfJQwOfjyGeUwEyVm8Jpxm3xATH8kQVMKb4a2Ogckj6oUUBAB2SL8slz6qnTm/px13WtXAlYCfxqoemVov4ixnShPyX8u8QFpqBPWocb/PEZEt5io9oKNohUokGMbTvsNRLZh+Kd9xcAEOFdtX+7ZlYAvCfxpoPrqhAizWu4AH3O0JRVyXflT0iepRIJFfAwyhXfi/yWWpXwkqZlSG4SROskVeIkKPYloX/27Za4EmvTPpX2JTZ+j4ZN24nVrCn5oIknmbXwltJ9P1KJxE5IB6E0S+ZPJQW50fnGD2W8gteN5Femrb7fMlYAnD/asoiAHWUBerA1fSh374IMPvlPqSX3yUmA3IC3n3e5CEtVZ/jIBzzq+2/7/twSalEf1JRIliJWw9vds8+bNybzqO2TfUvmq55a5EvAngefio6pzfyC1z3j9dtDfJNxyVwJPk8BzM/1PG8h97krgWSTgAvVZpOe2fWEScIH6wkTtDvQsEnCB+izSc9u+MAm4QH1honYHehYJ8Jo+OP9ZOnDbuhL4V0tAGDVfh3/88cfmn9D+qwd0+3cl0BQJgM+a/wXEHL3v2Wd6kwAAAABJRU5ErkJggg=="});var qA=VG;const Ss=v(require("react"));class KG extends Ss.default.Component{constructor(e){super(e);this.previewCanvasRef=null;this.previewCanvasRef=Ss.default.createRef()}componentDidMount(){const e=this.previewCanvasRef.current;this.props.canvas.setCanvasElement(e)}render(){const{licenseChecker:e}=this.props.config;return Ss.default.createElement(oR,null,e&&e.isWhiteLabel()?null:Ss.default.createElement(qA,null),this.props.active.isWebcam?Ss.default.createElement(rR,null):null,Ss.default.createElement(ae.Element,{ref:this.previewCanvasRef,"aria-label":"Canvas","data-test":hi.Canvas}),Ss.default.createElement(HA,null,Ss.default.createElement(VA,null)))}}var rh=O("active","canvas","config")(I(KG));const eu=v(require("react")),XA=v(require("styled-components")),YA=ae.Button.TextSecondary,JA=XA.default.span`
  font-size: 14px;
  padding: 3px 1px 2px;
  color: ${e=>e.theme.canvasActionBar.foreground};
  display: flex;
  align-self: center;
`,$G=({scale:e,active:t})=>{const{canZoomIn:i}=e,{canZoomOut:r}=e,{zoomLevel:o}=e,n=[w.TRANSFORM,w.BRUSH,w.FOCUS,w.STICKER,w.TEXT,w.TEXT_DESIGN].indexOf(t.tool)!==-1;return n?null:eu.default.createElement(ae.Bar.ButtonGroup,null,eu.default.createElement(YA,{ariaLabel:"Zoom out",isDisabled:!r,onClick:e.out},"-"),eu.default.createElement(JA,null,o," %"),eu.default.createElement(YA,{ariaLabel:"Zoom in",isDisabled:!i,onClick:e.in},"+"))};var ZA=O("scale","active")(I($G));JA.defaultProps={theme:X};const Ur=v(require("react")),QA=v(require("styled-components")),eF=QA.default(ae.Bar.ButtonGroup)`
  > :last-child {
    margin-left: 10px;
  }
  > :first-child {
    margin-left: 0;
  }
`,qG=({config:e,editor:t,history:i,custom:r})=>{const o=e.locale.mainCanvasActions,{canUndo:n}=i,{canRedo:s}=i,a=e.config.mainCanvasActions,l=()=>{t.export()},d=()=>{if(t.activeStore.tool===w.TRANSFORM)return null;const b=r.getButton("mainCanvasActionUndo");return Ur.default.createElement(b,{key:"mainCanvasActionUndo",onClick:i.undo,isDisabled:!n,label:o.buttonUndo,ariaLabel:o.buttonUndo,icon:Ur.default.createElement(Jp.undo,null)})},c=()=>{if(t.activeStore.tool===w.TRANSFORM)return null;const b=r.getButton("mainCanvasActionRedo");return Ur.default.createElement(b,{key:"mainCanvasActionRedo",onClick:i.redo,isDisabled:!s,label:o.buttonRedo,ariaLabel:o.buttonRedo,icon:Ur.default.createElement(Jp.redo,null)})},p=()=>{const b=r.getButton("mainCanvasActionExport");return Ur.default.createElement(b,{key:"mainCanvasActionExport",onClick:l,label:o.buttonExport,ariaLabel:o.buttonExport,icon:Ur.default.createElement(Jp.export,null)})},h=()=>{if(!e.displayCloseButton)return null;const b=r.getButton("mainCanvasActionClose");return Ur.default.createElement(b,{key:"mainCanvasActionClose","data-test":hi.MainBarButtonClose,onClick:t.close,label:o.buttonClose,ariaLabel:o.buttonClose,icon:Ur.default.createElement(Jp.close,null)})},m=a.map(b=>{switch(b){case he.UNDO:return d;case he.REDO:return c;case he.EXPORT:return p;case he.CLOSE:return h}return null});return Ur.default.createElement(ae.Bar.Index,null,Ur.default.createElement(eF,null,m[0]&&m[0]()||null,m[1]&&m[1]()||null),e.config.enableZoom?Ur.default.createElement(ZA,null):null,Ur.default.createElement(eF,null,m[2]&&m[2]()||null,m[3]&&m[3]()||null))};var oh=O("config","editor","history","custom")(I(qG));const tu=v(require("react")),tF=v(require("styled-components")),XG=tF.default.div`
  position: absolute;
  right: 8px;
  top: 8px;
`;class YG extends tu.default.Component{constructor(e){super(e);this.onChange=e=>{this.setState({value:e.replace(/[^\d.,-]/g,""),isSubmitted:!1})};this.onSubmit=()=>{const{getCorrectValue:e}=this.props,{isSubmitted:t,value:i}=this.state;t||this.setState({value:e(parseInt(i,10)||0).toString(),isSubmitted:!0})};this.state={isSubmitted:!1,value:e.value.toString()}}componentDidUpdate(e){const{value:t}=this.props;e.value!==t&&this.setState({value:t.toString()})}render(){const{id:e,testId:t,isDisabled:i,label:r}=this.props,{value:o}=this.state;return tu.default.createElement(D.Input.Text,{id:e,testId:t,value:o,isDisabled:i,onChange:this.onChange,onBlur:this.onSubmit,onKeyUp:fS(this.onSubmit)},tu.default.createElement(XG,null,tu.default.createElement(D.Input.Label,{label:r,htmlFor:e})))}}var tw=YG;const Xl=v(require("react")),iw=v(require("styled-components")),JG=iw.default.div`
  display: inline-flex;
  justify-content: space-between;
  max-width: ${e=>e.theme.measurements.advancedUIToolControlBar.width}px;
`,ZG=iw.default.span`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  margin-top: 10px;
  margin-right: 13px;
`,QG="photoeditorsdk-transformScaleWidth",ej="photoeditorsdk-transformScaleHeight",tj=({showLabel:e=!0,label:t,isDisabled:i,valueHeight:r,valueWidth:o,labelWidth:n,labelHeight:s,onSubmitWidth:a,onSubmitHeight:l})=>Xl.default.createElement("div",null,Xl.default.createElement(D.Input.Label,{label:t,show:e}),Xl.default.createElement(JG,null,Xl.default.createElement(tw,{id:QG,testId:"TransformScaleWidth",value:o,getCorrectValue:a,label:n,isDisabled:i}),Xl.default.createElement(ZG,null,"x"),Xl.default.createElement(tw,{id:ej,testId:"TransformScaleHeight",value:r,getCorrectValue:l,label:s,isDisabled:i})));var iu=tj;const Ts=v(require("react")),ij=({modal:e,textTool:t,textDesignTool:i,config:r,custom:o})=>{const{type:n,identifier:s,isVisible:a,modalProps:l,positionOffset:d}=e,{headerLabel:c,bodyLabel:p,confirmLabel:h,dismissLabel:m,handleClose:b,handleConfirm:_,handleDismiss:g}=l,S=o.getDialog();if(n===ot.INFO)return Ts.default.createElement(D.InfoModal,{headerLabel:c,bodyLabel:p},Ts.default.createElement(S,{type:n,isVisible:a,identifier:s,position:d,handleClose:b,headerLabel:c,bodyLabel:p}));if(n===ot.TEXT_EDIT){const{buttonSave:x,buttonClose:C}=t.locale.canvasControls,R={type:n,isVisible:e.isVisible,confirmLabel:x,dismissLabel:C,headerLabel:t.locale.canvasControls.inputText,maxLength:r.config.text.maxCharacterLimit};if(t.isTextSelected)return Ts.default.createElement(D.TextEditModal,y(y({},R),{defaultText:fe.defaultText(),handleConfirm:t.changeText,handleDismiss:t.setEditMode,text:t.text}),Ts.default.createElement(S,{type:n,isVisible:a,identifier:s,position:d,handleClose:b,confirmLabel:x,dismissLabel:C,headerLabel:t.locale.canvasControls.inputText}));if(i.isTextDesignSelected)return Ts.default.createElement(D.TextEditModal,y(y({},R),{defaultText:Ke.defaultText(),handleConfirm:i.changeText,handleDismiss:i.setEditMode,text:i.text}),Ts.default.createElement(S,{type:n,isVisible:a,identifier:s,position:d,handleClose:b,confirmLabel:x,dismissLabel:C,headerLabel:t.locale.canvasControls.inputText}))}return Ts.default.createElement(D.ActionModal,{type:n,headerLabel:c,bodyLabel:p,confirmLabel:h,dismissLabel:m,handleClose:b,handleConfirm:_,handleDismiss:g},Ts.default.createElement(S,{type:n,isVisible:a,identifier:s,position:d,confirmLabel:h,dismissLabel:m,headerLabel:c,bodyLabel:p,handleClose:b}))};var nh=O("textTool","textDesignTool","modal","config","custom")(I(ij));class ru{constructor(e={},t={}){this.getAdvancedCategoryCard=()=>this.components.advancedUICategoryCard;this.getAdvancedItemCard=()=>this.components.advancedUIItemCard;this.getAdvancedToolbarItem=()=>this.components.advancedUIToolbarItem;this.getDialog=()=>this.components.dialog;this.getButton=e=>this.components.buttons[e];this.getColorItem=()=>this.components.colorItem;this.getCheckbox=()=>this.components.checkbox;const i={dialog:D.Dialog,colorItem:D.ColorItem,checkbox:D.Input.Checkbox,buttons:{mainCanvasActionUndo:ae.Button.TextSecondary,mainCanvasActionRedo:ae.Button.TextSecondary,mainCanvasActionExport:Ud,mainCanvasActionClose:Mn,canvasActionEdit:ae.Controls.SpriteActionButton,canvasActionBringToFront:ae.Controls.SpriteActionButton,canvasActionDuplicate:ae.Controls.SpriteActionButton,canvasActionDelete:ae.Controls.SpriteActionButton,canvasActionInvert:ae.Controls.SpriteActionButton,canvasActionFlip:ae.Controls.SpriteActionButton,transformActionFlipHorizontal:on,transformActionFlipVertical:on,transformActionRotateClockwise:on,transformActionRotateAntiClockwise:on,textAlignment:on,toolControlBarPrimaryButton:Nd,toolControlBarSecondaryButton:Mn}};this.components=Sr([i,t,e])}}function rj(e){return typeof e=="string"&&e.includes("%")}function oj(e){return typeof e=="string"&&e.includes(".")&&parseFloat(e)===1}function ai(e,t){oj(e)&&(e="100%");const i=rj(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function vb(e){return e=parseFloat(e),(Number.isNaN(e)||e<0||e>1)&&(e=1),e}function ou(e){return e<=1?`${Number(e)*100}%`:e}function Ba(e){return e.length===1?`0${e}`:String(e)}function rw(e,t,i){return{r:ai(e,255)*255,g:ai(t,255)*255,b:ai(i,255)*255}}function ow(e,t,i){e=ai(e,255),t=ai(t,255),i=ai(i,255);const r=Math.max(e,t,i),o=Math.min(e,t,i);let n=0,s=0;const a=(r+o)/2;if(r===o)s=0,n=0;else{const l=r-o;s=a>.5?l/(2-r-o):l/(r+o);switch(r){case e:n=(t-i)/l+(t<i?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4;break;default:break}n/=6}return{h:n,s,l:a}}function iF(e,t,i){let r,o,n;e=ai(e,360),t=ai(t,100),i=ai(i,100);function s(a,l,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?a+(l-a)*(6*d):d<1/2?l:d<2/3?a+(l-a)*(2/3-d)*6:a}if(t===0)o=i,n=i,r=i;else{const a=i<.5?i*(1+t):i+t-i*t,l=2*i-a;r=s(l,a,e+1/3),o=s(l,a,e),n=s(l,a,e-1/3)}return{r:r*255,g:o*255,b:n*255}}function nw(e,t,i){e=ai(e,255),t=ai(t,255),i=ai(i,255);const r=Math.max(e,t,i),o=Math.min(e,t,i);let n=0;const s=r,a=r-o,l=r===0?0:a/r;if(r===o)n=0;else{switch(r){case e:n=(t-i)/a+(t<i?6:0);break;case t:n=(i-e)/a+2;break;case i:n=(e-t)/a+4;break;default:break}n/=6}return{h:n,s:l,v:s}}function rF(e,t,i){e=ai(e,360)*6,t=ai(t,100),i=ai(i,100);const r=Math.floor(e),o=e-r,n=i*(1-t),s=i*(1-o*t),a=i*(1-(1-o)*t),l=r%6,d=[i,s,n,n,a,i][l],c=[a,i,i,s,n,n][l],p=[n,n,a,i,i,s][l];return{r:d*255,g:c*255,b:p*255}}function sw(e,t,i,r){const o=[Ba(Math.round(e).toString(16)),Ba(Math.round(t).toString(16)),Ba(Math.round(i).toString(16))];return r&&o[0].charAt(0)===o[0].charAt(1)&&o[1].charAt(0)===o[1].charAt(1)&&o[2].charAt(0)===o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function nj(e){return Math.round(parseFloat(e)*255).toString(16)}function yr(e){return parseInt(e,16)}function aw(e){return yr(e)/255}function oF(e,t,i,r,o){const n=[Ba(Math.round(e).toString(16)),Ba(Math.round(t).toString(16)),Ba(Math.round(i).toString(16)),Ba(nj(r))];return o&&n[0].charAt(0)===n[0].charAt(1)&&n[1].charAt(0)===n[1].charAt(1)&&n[2].charAt(0)===n[2].charAt(1)&&n[3].charAt(0)===n[3].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)+n[3].charAt(0):n.join("")}const sh={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};const sj="[-\\+]?\\d+%?",aj="[-\\+]?\\d*\\.\\d+%?",Ma=`(?:${aj})|(?:${sj})`,lw=`[\\s|\\(]+(${Ma})[,|\\s]+(${Ma})[,|\\s]+(${Ma})\\s*\\)?`,dw=`[\\s|\\(]+(${Ma})[,|\\s]+(${Ma})[,|\\s]+(${Ma})[,|\\s]+(${Ma})\\s*\\)?`,qo={CSS_UNIT:new RegExp(Ma),rgb:new RegExp(`rgb${lw}`),rgba:new RegExp(`rgba${dw}`),hsl:new RegExp(`hsl${lw}`),hsla:new RegExp(`hsla${dw}`),hsv:new RegExp(`hsv${lw}`),hsva:new RegExp(`hsva${dw}`),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function uo(e){return Boolean(qo.CSS_UNIT.exec(String(e)))}function lj(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;let t=!1;if(sh[e])e=sh[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let i=qo.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=qo.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=qo.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=qo.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=qo.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=qo.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=qo.hex8.exec(e),i?{r:yr(i[1]),g:yr(i[2]),b:yr(i[3]),a:aw(i[4]),format:t?"name":"hex8"}:(i=qo.hex6.exec(e),i?{r:yr(i[1]),g:yr(i[2]),b:yr(i[3]),format:t?"name":"hex"}:(i=qo.hex4.exec(e),i?{r:yr(i[1]+i[1]),g:yr(i[2]+i[2]),b:yr(i[3]+i[3]),a:aw(i[4]+i[4]),format:t?"name":"hex8"}:(i=qo.hex3.exec(e),i?{r:yr(i[1]+i[1]),g:yr(i[2]+i[2]),b:yr(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function nF(e){let t={r:0,g:0,b:0},i=1,r=null,o=null,n=null,s=!1,a=!1;if(typeof e=="string"&&(e=lj(e)),Array.isArray(e)){const[l,d,c]=e;uo(l)&&uo(d)&&uo(c)&&(t=rw(l*255,d*255,c*255),s=!0,a="rgb"),e.length===4&&(i=e[3])}return typeof e=="object"&&(uo(e.r)&&uo(e.g)&&uo(e.b)?(t=rw(e.r,e.g,e.b),s=!0,a=String(e.r).substr(-1)==="%"?"prgb":"rgb"):uo(e.h)&&uo(e.s)&&uo(e.v)?(r=ou(e.s),o=ou(e.v),t=rF(e.h,r,o),s=!0,a="hsv"):uo(e.h)&&uo(e.s)&&uo(e.l)&&(r=ou(e.s),n=ou(e.l),t=iF(e.h,r,n),s=!0,a="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=vb(i),{ok:s,format:e.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}class Kr{constructor(e="",t={}){if(e instanceof Kr)return e;this.originalInput=e;const i=nF(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=t.format||i.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}getAlpha(){return this.a}setAlpha(e){return this.a=vb(e),this.roundA=Math.round(100*this.a)/100,this}toHsv(){const e=nw(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}}toHsvString(){const e=nw(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?`hsv(${t}, ${i}%, ${r}%)`:`hsva(${t}, ${i}%, ${r}%, ${this.roundA})`}toHsl(){const e=ow(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}}toHslString(){const e=ow(this.r,this.g,this.b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?`hsl(${t}, ${i}%, ${r}%)`:`hsla(${t}, ${i}%, ${r}%, ${this.roundA})`}toHex(e=!1){return sw(this.r,this.g,this.b,e)}toHexString(e=!1){return`#${this.toHex(e)}`}toHex8(e=!1){return oF(this.r,this.g,this.b,this.a,e)}toHex8String(e=!1){return`#${this.toHex8(e)}`}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbArray(){return[Math.round(this.r),Math.round(this.g),Math.round(this.b),this.a]}toRgbString(){const e=Math.round(this.r),t=Math.round(this.g),i=Math.round(this.b);return`rgba(${e}, ${t}, ${i}, ${this.roundA})`}toPercentageRgb(){const e=t=>`${Math.round(ai(t,255)*100)}%`;return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}}toPercentageRgbString(){const e=t=>Math.round(ai(t,255)*100);return this.a===1?`rgb(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%)`:`rgba(${e(this.r)}%, ${e(this.g)}%, ${e(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;const e=`#${sw(this.r,this.g,this.b,!1)}`;for(const t of Object.keys(sh))if(sh[t]===e)return t;return!1}toString(e){const t=Boolean(e);e=e||this.format;const i=this.a<1&&this.a>=0,r=!t&&i&&e&&(e.startsWith("hex")||e==="name");if(r)return e==="name"&&this.a===0?this.toName():this.toRgbString();switch(e){case"rgb":return this.toRgbString();case"prgb":return this.toPercentageRgbString();case"hex":case"hex6":return this.toHexString();case"hex3":return this.toHexString(!0);case"hex4":return this.toHex8String(!0);case"hex8":return this.toHex8String();case"hsl":return this.toHslString();case"hsv":return this.toHsvString();case"name":return this.toName();default:return this.toHexString()}}clone(){return new Kr(this.toString())}}const sF=v(require("styled-components")),aF=sF.default.div.attrs(e=>({style:{left:e.position.x||`${0}px`,top:e.position.y||`${0}px`}}))`
  &&& {
    position: absolute;
    height: ${e=>e.theme.measurements.color.colorPicker.thumb.size}px;
    width: ${e=>e.theme.measurements.color.colorPicker.thumb.size}px;
    border-radius: 50%;
    border: 2px solid ${e=>e.theme.colorPicker.controlsColor};
    box-sizing: border-box;
    cursor: pointer;
    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.11), 0 1px 3px 0 rgba(0, 0, 0, 0.46);
    z-index: 2;
    pointer-events: none;
  }
`;var ah=aF;aF.defaultProps={theme:X};const _b=v(require("react")),lF=v(require("react-dom")),dF=v(require("styled-components")),cF=v(Uy()),dj=dF.default.div`
  position: relative;
  height: 14px;
  width: 100%;
`;class hF extends _b.default.Component{constructor(e){super(e);this.onDragStart=e=>{this.setState({dragging:!0}),this.onPositionChange(e)};this.onPositionChange=e=>{const{onChange:t,config:i}=this.props,r=i.measurements.color.colorPicker.thumb.size/2,o=i.measurements.color.colorPicker.thumb.size;let n=0,s=0;n=e.clientX,s=e.clientY;const a=lF.default.findDOMNode(this);if(a&&a instanceof HTMLElement){const{top:l,left:d,width:c,height:p}=a.getBoundingClientRect();let h=n-d-r,m=s-l-r;h=Math.max(0,Math.min(c-o,h)),m=Math.max(0,Math.min(p-o,m)),t&&t({x:h,y:m}),this.setState({x:h,y:m})}};this.onDrag=e=>{this.state.dragging&&this.onPositionChange(e)};this.onDragStop=()=>{this.state.dragging&&this.setState({dragging:!1})};this.state={dragging:!1,x:e.defaultPosition.x,y:e.defaultPosition.y},this.debouncedOnDrag=cF.default(this.onDrag,10)}componentWillUnmount(){this.setState({dragging:!1})}render(){const{surface:e,setInnerRef:t,className:i,children:r}=this.props;return _b.default.createElement(dj,{ref:t,className:i},_b.default.createElement(D.DraggableCore,{onStart:this.onDragStart,onDrag:this.debouncedOnDrag,onStop:this.onDragStop},e),r)}}hF.defaultProps={defaultPosition:{x:0,y:0}};var lh=O("config","active")(I(hF));const pF=v(require("styled-components")),cj=pF.css`
  position: absolute;
  top: 3px;
  left: 0;
  width: 100%;
  height: 8px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
`;var Yl=cj;const nu=v(require("react")),uF=v(require("styled-components")),hj=uF.default.div`
  ${Yl}
  background: linear-gradient(90deg, #F00 0%, #FF0 16.66%, #0F0 33.33%, #0FF 50%, #00F 66.66%, #F0F 83.33%, #F00 100%);
  height: 8px;
`;class pj extends nu.default.Component{constructor(e){super(e);this.onKnob=({x:e})=>{const{onChange:t,config:i}=this.props,{offsetWidth:r}=this.node,o=r-i.measurements.color.colorPicker.thumb.size,n=e*r/o,s=Math.max(0,Math.min(360,n/r*360));t(s),this.setState({x:e})};this.setPositionFromColor=e=>{const{config:t}=this.props,{offsetWidth:i}=this.node;let r=0;const o=i-t.measurements.color.colorPicker.thumb.size;this.node&&(r=e.toHsv().h*i/360),this.setState({x:r*o/i})};this.nodeRef=t=>{this.node=t},this.state={x:0}}render(){const{x:e}=this.state;return nu.default.createElement(lh,{surface:nu.default.createElement(hj,null),setInnerRef:this.nodeRef,onChange:this.onKnob},nu.default.createElement(ah,{position:{x:e,y:0}}))}}var mF=O("config")(I(pj));const dh=v(require("react")),cw=v(require("styled-components")),uj=cw.default.div.attrs(e=>({style:{background:`linear-gradient(to left, ${e.transparentColor} 0%, ${e.opaqueColor} 100%)`}}))`
  ${Yl}
  z-index: 1;
`,mj=cw.default.div.attrs(e=>({style:{backgroundImage:`url(${e.url})`}}))`
  ${Yl}
  z-index: 0;
  background-repeat: repeat-x;
  background-size: contain;
  background-position: left;
`;class fj extends dh.default.Component{constructor(e){super(e);this.onKnob=({x:e})=>{const{onChange:t,config:i}=this.props,{offsetWidth:r}=this.node,o=r-i.measurements.color.colorPicker.thumb.size,n=e*r/o,s=(r-n)/r,a=Math.round((s+Number.EPSILON)*100)/100,l=Math.min(1,Math.max(0,a));t(l),this.setState({x:e})};this.setPositionFromColor=e=>{const{config:t}=this.props,{offsetWidth:i}=this.node;let r=0;const o=i-t.measurements.color.colorPicker.thumb.size;this.node&&(r=(1-e.toHsv().a)*i),this.setState({x:r*o/i})};this.nodeRef=t=>{this.node=t},this.state={x:0}}render(){const{opaqueColor:e,transparentColor:t,config:i}=this.props,{x:r}=this.state,o=i.assetProvider.getPath("controls","/tiled-background.png");return dh.default.createElement(lh,{surface:dh.default.createElement(uj,{opaqueColor:e,transparentColor:t}),setInnerRef:this.nodeRef,onChange:this.onKnob},dh.default.createElement(mj,{url:o}),dh.default.createElement(ah,{position:{x:r,y:0}}))}}var fF=O("config")(I(fj));const su=v(require("react")),hw=v(require("styled-components")),gj=hw.default.div.attrs(e=>({style:{backgroundColor:`hsl(${e.hue}, 100%, 50%)`}}))`
  ${Yl}
  background: linear-gradient(to top, rgb(0, 0, 0), rgba(0, 0, 0, 0)),
   linear-gradient(to right, rgb(255, 255, 255), rgba(255, 255, 255, 0));
  height: ${e=>e.theme.measurements.color.colorPicker.saturationSlider.height}px;
  top: 0px;
`,bj=hw.default(lh)`
  height: ${e=>e.theme.measurements.color.colorPicker.saturationSlider.height}px;
  margin-top: 0px;
`;class yj extends su.default.Component{constructor(e){super(e);this.setPositionFromColor=e=>{const{config:t}=this.props,i={x:0,y:0};if(this.node){const{s:r,v:o}=e.toHsv(),{offsetWidth:n,offsetHeight:s}=this.node,a=n-t.measurements.color.colorPicker.thumb.size,l=s-t.measurements.color.colorPicker.thumb.size,d=r*n,c=(1-o)*s;i.x=d*a/n,i.y=c*l/s}this.setState({position:i})};this.onChange=({x:e,y:t})=>{const{onChange:i,config:r}=this.props,{offsetHeight:o,offsetWidth:n}=this.node,s=n-r.measurements.color.colorPicker.thumb.size,a=o-r.measurements.color.colorPicker.thumb.size,l=e*n/s,d=t*o/a,c=Math.min(1,Math.max(0,l/n)),p=Math.min(1,Math.max(0,(o-d)/o));i(c,p),this.setState({position:{x:e,y:t}})};this.nodeRef=t=>{this.node=t},this.state={position:{x:0,y:0}}}render(){const{hue:e}=this.props,{position:t}=this.state;return su.default.createElement(bj,{surface:su.default.createElement(gj,{hue:e}),setInnerRef:this.nodeRef,onChange:this.onChange},su.default.createElement(ah,{position:t}))}}var gF=O("config")(I(yj));const xb=v(require("react")),pw=v(require("styled-components")),vj=pw.default.div`
  text-align: center;
  width: 28px;
  padding-left: 4px;
`,_j=pw.default(D.Input.Text)`
  input {
    text-align: center;
    border-bottom: 1px solid ${e=>e.theme.colorPicker.inputBorderColor};
  }
`,xj=({value:e,label:t,onChange:i})=>xb.default.createElement(vj,null,xb.default.createElement(D.Input.Label,{label:t}),xb.default.createElement(_j,{min:0,max:255,value:e,onChange:i}));var wb=xj;const Cb=v(require("react")),uw=v(require("styled-components")),wj=uw.default.div`
  text-align: left;
  width: 62px;
`,Cj=uw.default(D.Input.Text)`
  input {
    text-align: left;
    border-bottom: 1px solid ${e=>e.theme.colorPicker.inputBorderColor};
  }
`,Sj=({value:e,label:t,onChange:i})=>Cb.default.createElement(wj,null,Cb.default.createElement(D.Input.Label,{label:t}),Cb.default.createElement(Cj,{value:e.toUpperCase(),onChange:i}));var bF=Sj;const Jl=v(require("styled-components")),Tj=Jl.default.div`
  position: absolute;
  width: ${e=>e.theme.measurements.color.colorPicker.arrow.width}px;
  height: ${e=>e.theme.measurements.color.colorPicker.arrow.width/2}px;
  overflow: hidden;
  pointer-events: none;
  ${e=>e.direction==="bottom"?Jl.css`
          bottom: 100%;
        `:Jl.css`
          top: 100%;
        `}
  left: ${e=>e.arrowOffset}px;
  :after {
    content: '';
    position: absolute;
    width: ${e=>e.theme.measurements.color.colorPicker.arrow.width/2}px;
    height: ${e=>e.theme.measurements.color.colorPicker.arrow.width/2}px;
    left: 50%;
    ${e=>e.direction==="bottom"?Jl.css`
            transform: translate(-50%, 50%) rotate(45deg);
          `:Jl.css`
            transform: translate(-50%, -50%) rotate(45deg);
          `}
    background-color: ${e=>e.theme.colorPicker.listBackground};
    pointer-events: none;
  }
`;var yF=Tj;const $t=v(require("react")),Sn=v(require("styled-components")),kj=Sn.default.div`
  position: absolute;
  left: ${e=>e.leftOffset}px;
  top: ${e=>e.topOffset}px;
  z-index: ${e=>e.theme.measurements.zIndex.input.list};
  display: none;
  opacity: 0;
  transition: opacity 0.3s ease-out;
  ${e=>e.show&&Sn.css`
      display: block;
      opacity: 1;
      transition: opacity 0.3s ease-out;
    `}
`,vF=Sn.default.div`
  &&& {
    position: absolute;
    ${e=>e.direction==="top"&&Sn.css`
        transform: translate(0, -100%);
      `}
    padding: 16px;
    box-sizing: border-box;
    box-shadow: ${e=>e.theme.colorPicker.listShadow};
    background: ${e=>e.theme.colorPicker.listBackground};
    border-radius: ${e=>e.theme.shape.radiusMedium}px;
    width: ${e=>e.theme.measurements.color.colorPicker.width}px;
    left: 8px;
    z-index: 1;
  }
`,Ej=Sn.default(mF)`
  margin-top: 8px;
`,Dj=Sn.default(fF)`
  margin-top: 8px;
`,Ij=Sn.default.div`
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
`,Oj=Sn.default.div`
  display: flex;
`;class _F extends $t.default.Component{constructor(e){super(e);this.saturationRef=null;this.hueRef=null;this.opacityRef=null;this.checkId=(e,t,i)=>{let r=e,o=0;for(;r.parentElement&&o<i;)if(r=r.parentElement,o+=1,r.id===t)return!0;return!1};this.handleOutsideClick=e=>{const{parentId:t,onRequestClose:i,onAddSnapshot:r}=this.props,{color:o}=this.state;if(this.node&&this.node.contains(e.target)||this.checkId(e.target,t.replace(" ","-"),5)&&e.target.classList.contains("photoeditorsdk-active"))return;this.setState({hexInputValue:o.toHexString()}),i&&i(),r&&r()};this.onChange=e=>{const{onChange:t}=this.props;t({color:e.toRgbArray(),colorString:e.toRgbString()})};this.onHexValueChange=e=>{if(e.match(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/i)){const t=new Kr(e);this.onChange(t),this.setState({color:t,hue:t.toHsl().h}),this.saturationRef.current.wrappedInstance.setPositionFromColor(t),this.hueRef.current.wrappedInstance.setPositionFromColor(t)}this.setState({hexInputValue:e})};this.onAlphaChange=e=>{const{color:t}=this.state,i=t.setAlpha(e);this.onChange(i),this.setState({color:i,hexInputValue:i.toHexString()})};this.onHueChange=e=>{const{color:t}=this.state,{s:i,v:r,a:o}=t.toHsv(),n=new Kr({h:e,s:i,v:r,a:o});this.onChange(n),this.setState({color:n,hexInputValue:n.toHexString(),hue:e})};this.onSaturationBrightnessChange=(e,t)=>{const{color:i,hue:r}=this.state,{a:o}=i.toHsv(),n=new Kr({h:r,s:e,v:t,a:o});this.onChange(n),this.setState({color:n,hexInputValue:n.toHexString()})};this.onInputChange=e=>t=>{const{color:i}=this.state;if(t.match(/0*([0-9]|[1-8][0-9]|9[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/g)||!t.trim()){const r=i.toRgb();r[e]=parseInt(t,10)||0;const o=new Kr(r);this.onChange(o),this.saturationRef.current.wrappedInstance.setPositionFromColor(o),this.hueRef.current.wrappedInstance.setPositionFromColor(o),this.setState({color:o,hexInputValue:o.toHexString(),hue:o.toHsl().h})}};const t=new Kr(this.props.color);this.state={color:t,hue:t.toHsl().h,hexInputValue:t.toHexString()},this.nodeRef=i=>{this.node=i},this.saturationRef=$t.default.createRef(),this.hueRef=$t.default.createRef(),this.opacityRef=$t.default.createRef()}componentDidMount(){const{color:e}=this.state;document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1),document.addEventListener("keydown",this.handleOutsideClick,!1),this.saturationRef.current.wrappedInstance.setPositionFromColor(e),this.hueRef.current.wrappedInstance.setPositionFromColor(e),this.opacityRef.current.wrappedInstance.setPositionFromColor(e)}componentDidUpdate(e){const{color:t,show:i}=this.props;if(i&&!e.show){const r=new Kr(t);this.saturationRef.current.wrappedInstance.setPositionFromColor(r),this.hueRef.current.wrappedInstance.setPositionFromColor(r),this.opacityRef.current.wrappedInstance.setPositionFromColor(r),this.setState({color:r,hue:r.toHsl().h,hexInputValue:r.toHexString()})}}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1),document.removeEventListener("keydown",this.handleOutsideClick,!1)}render(){const{show:e,direction:t,arrowOffset:i,topOffset:r,leftOffset:o,labelHex:n,labelR:s,labelG:a,labelB:l,labelSliderHue:d,labelSliderOpacity:c}=this.props,{color:p,hexInputValue:h,hue:m}=this.state,{r:b,g:_,b:g}=p.toRgb(),S=p.clone().setAlpha(1).toRgbString(),x=p.clone().setAlpha(0).toRgbString();return $t.default.createElement("div",{ref:this.nodeRef},$t.default.createElement(kj,{show:e,direction:t,leftOffset:o,topOffset:r},$t.default.createElement(vF,{direction:t},$t.default.createElement(yF,{direction:t,arrowOffset:i}),$t.default.createElement(gF,{ref:this.saturationRef,hue:m,onChange:this.onSaturationBrightnessChange}),$t.default.createElement(D.Spacer,{count:2}),$t.default.createElement(D.Input.Label,{label:d}),$t.default.createElement(Ej,{ref:this.hueRef,onChange:this.onHueChange}),$t.default.createElement(D.Spacer,{count:2}),$t.default.createElement(D.Input.Label,{label:c}),$t.default.createElement(Dj,{ref:this.opacityRef,opaqueColor:S,transparentColor:x,onChange:this.onAlphaChange}),$t.default.createElement(Ij,null,$t.default.createElement(bF,{value:h,label:n,onChange:this.onHexValueChange}),$t.default.createElement(Oj,null,$t.default.createElement(wb,{value:b,label:s,onChange:this.onInputChange("r")}),$t.default.createElement(wb,{value:_,label:a,onChange:this.onInputChange("g")}),$t.default.createElement(wb,{value:g,label:l,onChange:this.onInputChange("b")}))))))}}_F.defaultProps={direction:"bottom"};var EC=_F;vF.defaultProps={theme:X};const au=v(require("react")),xF=v(require("styled-components")),mw=v(Ve()),Rj=xF.default.div`
  position: relative;
`;let lu=class extends au.default.Component{constructor(e){super(e);this.onClick=e=>t=>{const{onAddSnapshot:i,config:r,onChange:o,colorPickerDirection:n}=this.props,{activeIdentifier:s,showColorPicker:a,colorList:l}=this.state,d=l.find(c=>c.identifier===e);if(s===d.identifier&&!a){this.UIComponent||Promise.resolve().then(()=>v(DC())).then(({ColorPicker:T})=>{this.UIComponent=T,this.forceUpdate()});const{left:c,width:p,top:h,height:m}=t.currentTarget.getBoundingClientRect(),{left:b,top:_}=t.currentTarget.parentElement.getBoundingClientRect(),{colorPicker:g}=r.measurements.color;let S=c-b+p/2-2;const x=n==="bottom"?h-_+m+g.arrow.width/2:h-_-g.arrow.width/2;let C=-24;const R=g.width-g.arrow.width-12;S>R&&(C+=S-R,S-=C),this.setState({showColorPicker:!0,arrowOffset:S,topOffset:x,leftOffset:C})}else a?this.setState({showColorPicker:!1}):(o(d.color),this.setState({activeIdentifier:e}),i&&i())};this.onChange=({color:e,colorString:t})=>{const{onChange:i}=this.props,{activeIdentifier:r,colorList:o}=this.state,n=o.findIndex(s=>s.identifier===r);if(n!==-1){const s=[...o];s[n]={identifier:o[n].identifier,colorString:t,color:e},this.setState({colorList:s})}i(e)};this.onChangeColorPicker=({color:e,colorString:t})=>{this.onChange({color:[e[0]/255,e[1]/255,e[2]/255,e[3]],colorString:t})};this.closeColorPicker=()=>{this.setState({showColorPicker:!1})};this.getColorPicker=()=>{const{activeColor:e,parentId:t,labelsColor:i,colorPickerDirection:r,onAddSnapshot:o}=this.props,{showColorPicker:n,arrowOffset:s,leftOffset:a,topOffset:l}=this.state;if(!this.UIComponent)return null;const d=this.UIComponent;return au.default.createElement(d,{parentId:t,color:mw.toJS(e),show:n,direction:r,arrowOffset:s,leftOffset:a,topOffset:l,labelHex:i.hex,labelR:i.r,labelG:i.g,labelB:i.b,labelSliderOpacity:i.sliderOpacity,labelSliderHue:i.sliderHue,onChange:this.onChangeColorPicker,onRequestClose:this.closeColorPicker,onAddSnapshot:o})};const{colors:t}=this.props;this.state={activeIdentifier:"",activeSprite:"",colorList:[...t],showColorPicker:!1,arrowOffset:0,leftOffset:0,topOffset:0},this.UIComponent=null}static getDerivedStateFromProps({activeSprite:e,activeColor:t},{activeSprite:i,colorList:r}){if(e!==i||!e){const o=Yn(mw.toJS(t)),n=r.find(({colorString:s})=>s===o);return{activeSprite:e,activeIdentifier:n?n.identifier:""}}return null}render(){const{isDisabled:e,custom:t,config:i}=this.props,{activeIdentifier:r,colorList:o}=this.state,n=t.getColorItem(),s=i.assetProvider.getPath("controls","/tiled-background.png"),a=o.map(l=>au.default.createElement(n,{key:`${l.colorString}-item-${l.identifier}`,isActive:l.identifier===r,isDisabled:e,onClick:this.onClick(l.identifier),color:l.colorString,label:l.identifier,tiledBackgroundUrl:s}));return au.default.createElement(Rj,null,a,this.getColorPicker())}};lu.defaultProps={colorPickerDirection:"bottom",isDisabled:!1},lu=u([O("config","custom"),I],lu);var jt=lu;const Sb=v(require("react")),Zl=v(require("styled-components")),wF=Zl.default.div`
  z-index: ${e=>e.theme.measurements.zIndex.toolbar};
  flex-shrink: 0;
  background-color: ${e=>e.theme.toolbar.background};
  color: ${e=>e.theme.toolbar.foreground};
  ${e=>{const t=e.theme.toolbar.border?e.theme.toolbar.border:Zl.css`
          1px solid ${e.theme.toolbar.borderColor};
        `;return e.reverse?Zl.css`
          border-left: ${t};
        `:Zl.css`
          border-right: ${t};
        `}}
  height: 100%;
  width: ${e=>e.theme.measurements.advancedUIToolbar.width}px;
  margin-bottom: ${e=>e.theme.measurements.advancedUIToolbar.marginBottom}px;
`,CF=Zl.default.ul.attrs(()=>({role:"menubar","aria-label":"Tool Navigation","data-simplebar":"init","data-simplebar-auto-hide":"false"}))`
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  list-style: none;
  overflow-x: hidden;
  overflow-y: overlay;
  height: 100%;
  .simplebar-content {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
`;class Aj extends Sb.default.Component{constructor(){super(...arguments);this.state={reverse:!1}}componentDidMount(){const e=document.getElementById("photoeditorsdk-AdvancedToolbar");if(e){const{offsetLeft:t}=e,i=window.innerWidth/2;t>i&&this.setState({reverse:!0})}}render(){return Sb.default.createElement(wF,{reverse:this.state.reverse},Sb.default.createElement(CF,{id:"photoeditorsdk-AdvancedToolbar"},this.props.children(this.state.reverse)))}}var SF=Aj;wF.defaultProps={theme:X};CF.defaultProps={theme:X};const fw=v(require("react")),Ql=v(require("styled-components")),Fj=Ql.default($r)`
  width: inherit;
  height: inherit;
  padding: 0;
  margin: 0;
  ${ti()?Ql.css`
        background-color: transparent;
      `:Ql.css`
        background-color: inherit;
      `}

  ${e=>e.isActive&&Ql.css`
      background-color: ${e.theme.toolbar.activeBackground};
      color: ${e.theme.toolbar.activeForeground};
    `}
`,TF=Ql.default.li.attrs({"aria-haspopup":!0,"aria-hidden":!0,role:"menuitem"})`
  height: ${e=>e.theme.measurements.advancedUIToolbar.itemHeight}px;
  cursor: pointer;
  position: relative;
`,Pj=e=>fw.default.createElement(TF,null,fw.default.createElement(Fj,y({isActive:e.isActive,"data-test":e.ariaLabel},e)));var kF=Pj;TF.defaultProps={theme:X};const EF=v(require("styled-components")),DF=EF.default.li.attrs({role:"none"})`
  height: ${e=>e.theme.measurements.advancedUIToolbar.seperatorHeight}px;
  cursor: pointer;
  position: relative;
`;var IF=DF;DF.defaultProps={theme:X};const gw=v(require("react")),ks=v(require("styled-components")),OF=ks.default.div`
  ${ti()?ks.css`
        position: -ms-device-fixed;
      `:ks.css`
        position: fixed;
      `}
  position: -ms-device-fixed;
  top: ${e=>e.position.y-5}px;
  left: ${e=>e.position.x+e.theme.measurements.advancedUIToolbar.width-10}px;
  z-index: ${e=>e.theme.measurements.zIndex.toolbar};
  transition: opacity 0.5s ease-in-out, left 0.25s ease-in-out, right 0.25s ease-in-out, visibility 0.5s ease-in-out;
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
  cursor: pointer;

  &:before {
    content: ' ';
    position: absolute;
    top: 10px;
    left: -8px;
    width: 0;
    height: 0;
    border-right: 8px solid ${e=>e.theme.tooltip.background};
    border-bottom: 6px solid transparent;
    border-top: 6px solid transparent;
  }

  &:after {
    content: '${e=>e.label}';
    position: absolute;
    transition: margin-left 0.15s ease-in-out, opacity 0.15s ease-in-out;
    color: ${e=>e.theme.tooltip.foreground};
    background: ${e=>e.theme.tooltip.background};
    padding: 8px 12px;
    text-align: center;
    vertical-align: super;
    font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
    letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
    text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
    border-radius: ${e=>e.theme.shape.radiusSmall}px;
    white-space: nowrap;
  }

  ${e=>e.reverse&&ks.css`
      left: unset;
      right: ${e.position.x+e.theme.measurements.advancedUIToolbar.width-10}px;
      direction: rtl;

      &:before {
        border-left: 8px solid ${e.theme.tooltip.background};
        border-right: none;
        right: -8px;
        left: unset;
        top: 10px;
      }
    `}

  ${e=>e.show&&!e.reverse&&ks.css`
      opacity: 1;
      visibility: visible;
      left: ${e.position.x+e.theme.measurements.advancedUIToolbar.width+16}px;
    `}

  ${e=>e.show&&e.reverse&&ks.css`
      opacity: 1;
      visibility: visible;
      right: ${e.position.x+e.theme.measurements.advancedUIToolbar.width+16}px;
    `}
`,Bj=ks.default.span`
  display: none;
`,RF=({show:e,reverse:t,position:i,children:r})=>{const o=typeof r=="string"?r:"";return gw.default.createElement(OF,{"data-test":hi.Tooltip,show:e,reverse:t,position:i,label:o},gw.default.createElement(Bj,null,o))};OF.defaultProps={theme:X};RF.defaultProps={show:!1};var AF=RF;const bw=v(require("react")),du=v(require("styled-components")),Mj=du.default.div`
  flex-shrink: 0;
  background: ${e=>e.theme.toolControlBar.background};
  position: relative;
  overflow-x: hidden;
  overflow-y: hidden;
  display: flex;
  flex-direction: column;
  transition: width 0.4s ease-in;
  width: ${e=>e.theme.measurements.advancedUIToolControlBar.width}px;
  margin-bottom: ${e=>e.theme.measurements.advancedUIToolControlBar.marginBottom}px;
  ${e=>e.reverse?du.css`
          border-left: 1px solid ${e.theme.toolControlBar.borderColor};
        `:du.css`
          border-right: 1px solid ${e.theme.toolControlBar.borderColor};
        `}
  z-index: ${e=>e.theme.measurements.zIndex.toolControlBar};
  /* for Firefox */
  min-height: 0;
`,FF="photoeditorsdk-Sidebar";class Lj extends bw.default.Component{constructor(){super(...arguments);this.state={reverse:!1}}componentDidMount(){const e=document.getElementById(FF);if(e){const{offsetLeft:t}=e,i=window.innerWidth/2;t>i&&this.setState({reverse:!0})}}render(){return bw.default.createElement(Mj,{id:FF,reverse:this.state.reverse},this.props.children)}}var PF=Lj;const BF=v(require("styled-components")),MF=BF.default.h2`
  /* Center text horizontally and vertically */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 0;
  padding: 0 4px;
  margin: 0;
  min-height: ${e=>e.theme.measurements.mainCanvasActionBar.height-2}px;
  font-size: ${e=>e.theme.measurements.fontSystem.headline1.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.headline1.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.headline1.case};
  background: ${e=>e.theme.toolControlBar.background};
  color: ${e=>e.theme.toolControlBar.titleForeground};
  border-bottom: 1px solid ${e=>e.theme.toolControlBar.separatorColor};
  font-weight: 500;
  text-align: center;
`;var LF=MF;MF.defaultProps={theme:X};const cu=v(require("react")),yw=v(require("styled-components")),zF=yw.default.div`
  position: relative;
  flex-grow: 0;
  flex-shrink: 0;
  height: ${({height:e})=>e}px;
  opacity: ${({opacity:e})=>e};
  visibility: ${({visibility:e})=>e};
  overflow: ${({shouldAnimateOverflow:e,overflow:t})=>e?t:void 0};
  transition: ${({shouldAnimateHeight:e})=>e?"opacity 0.5s ease-in, height 0.4s ease-out":"opacity 0.5s ease-in"};
  background: ${e=>e.theme.toolControlBar.background};
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
`,zj=yw.default.div`
  position: relative;
  padding: ${e=>e.theme.measurements.advancedUIToolControlBar.padding};
`;class NF extends cu.default.Component{constructor(e){super(e);this.contentRef=null;this.enableOverflow=()=>{const{show:e}=this.props;e&&this.contentRef.current&&this.setState({overflow:!0})};this.contentRef=cu.default.createRef(),this.state={height:0,mounted:!1,overflow:!1}}componentDidMount(){const{overflowAfterExpand:e}=this.props;this.contentRef.current&&(e&&this.contentRef.current.addEventListener("transitionend",this.enableOverflow),this.setState({height:this.contentRef.current.scrollHeight,mounted:!0}))}componentWillUnmount(){this.contentRef.current&&this.contentRef.current.removeEventListener("transitionend",this.enableOverflow)}render(){const{show:e,shouldAnimateOverflow:t,shouldAnimateHeight:i,children:r}=this.props,{height:o,mounted:n,overflow:s}=this.state,a=n&&(e&&t||!t),l=a?o:0,d=a?1:0,c=a?"visible":"hidden";return cu.default.createElement(zF,{"data-test":hi.ToolControlBar,ref:this.contentRef,height:l,opacity:d,visibility:c,overflow:s?"visible":"hidden",shouldAnimateHeight:i,shouldAnimateOverflow:t},cu.default.createElement(zj,null,r))}}NF.defaultProps={show:!0,shouldAnimateOverflow:!0,shouldAnimateHeight:!0};var UF=NF;zF.defaultProps={theme:X};const HF=v(require("styled-components")),GF=HF.default.div.attrs({"data-simplebar":"init","data-simplebar-auto-hide":"false"})`
  &&& {
    flex-grow: 1;
    position: relative;
    box-sizing: border-box;
    padding: ${e=>e.theme.measurements.advancedUIToolControlBar.padding};
    width: ${e=>e.theme.measurements.advancedUIToolControlBar.width}px;
    overflow: visible;
    /* for Firefox */
    min-height: 0;
    transition: height 0.4s cubic-bezier(0.17, 0.04, 0.03, 0.94);
    background: ${e=>e.theme.toolControlBar.background};
    color: ${e=>e.theme.toolControlBar.inputLabelForeground};

    ${zt.HiddenScrollbar}
    .photoeditorsdk-simplebar-placeholder {
      height: 0px !important;
    }
  }
`;var jF=GF;GF.defaultProps={theme:X};const WF=v(require("styled-components")),VF=WF.default.h2`
  color: ${e=>e.theme.toolControlBar.titleForeground};
  font-size: ${e=>e.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.headline2.case};
  font-weight: 500;
  min-height: ${e=>2*e.theme.measurements.advancedSpacer}px;
`;var Tb=VF;VF.defaultProps={theme:X};const kb=v(require("styled-components")),KF=kb.default.div`
  &:after {
    content: '';
    position: absolute;
    bottom: 0px;
    ${e=>e.full?kb.css`
            left: -${3*e.theme.measurements.advancedSpacer/2}px;
            width: calc(100% + ${3*e.theme.measurements.advancedSpacer}px);
          `:`
      left: ${3*e.theme.measurements.advancedSpacer/2}px;
      width: calc(100% - ${3*e.theme.measurements.advancedSpacer}px);
    `}
    border-bottom: 2px solid ${e=>e.theme.toolControlBar.separatorColor};
  }
`;var Eb=KF;KF.defaultProps={theme:X};const ed=v(require("react")),$F=v(require("styled-components")),Nj=$F.default.div`
  position: relative;
  width: 100%;
`,Uj=({name:e,isFirstCategory:t,isLastCategory:i,children:r})=>ed.default.createElement(Nj,null,t&&ed.default.createElement(D.Spacer,{count:2}),ed.default.createElement(Tb,{"data-test":e},e),ed.default.createElement(ob,null,r),ed.default.createElement(D.Spacer,{count:2}),i&&ed.default.createElement(Eb,{full:!0}));var qF=Uj;const ch=v(require("styled-components")),Hj=ch.default.div`
  transition: max-height 0.8s ease-out, transform 0.8s ease-out;
  background: ${e=>e.theme.toolControlBar.background};
  visibility: hidden;
  opacity: 0;
  transform-origin: 0 0;
  display: none;
  flex-wrap: wrap;

  ${({show:e})=>e&&ch.css`
      opacity: 1;
      visibility: visible;
      ${ti()?ch.css`
            display: block;
          `:ch.css`
            display: flex;
          `}
    `}
`;var XF=Hj;const B={Card:Hp,CardContainer:ob,CardLabel:hO,Toolbar:{Index:SF,Item:kF,Separator:IF,Tooltip:AF},Itemsbar:jF,BarSeparator:"",ItemsSeparator:Eb,Controlsbar:UF,Sidebar:{Index:PF,Heading:LF,SubHeading:Tb,TextCategory:qF,ExpandableContainer:XF}};const hh=v(require("react")),YF=v(require("styled-components"));class jj extends hh.default.Component{constructor(e){super(e);this.ref=null;this.updatePosition=()=>{const{isReverse:e}=this.props,t={x:0,y:0};if(this.ref.current){const{top:i,height:r,left:o,right:n}=this.ref.current.getBoundingClientRect();t.y=i+r/4,t.x=e?window.innerWidth-n:o}this.setState({tooltipPosition:t})};this.mouseOver=e=>{this.updatePosition(),this.setState({hoverTool:e})};this.mouseOut=()=>{this.setState({hoverTool:null})};this.state={hoverTool:null,tooltipPosition:{x:0,y:0}},this.ref=hh.default.createRef()}componentDidMount(){this.updatePosition()}componentDidUpdate(e){const{isReverse:t}=this.props;t!==e.isReverse&&this.updatePosition()}render(){const{tool:e,isActive:t,isReverse:i,icon:r,label:o,onClick:n,className:s,children:a}=this.props,{hoverTool:l,tooltipPosition:d}=this.state;return hh.default.createElement(Gj,{ref:this.ref,onMouseOver:()=>this.mouseOver(e),onMouseOut:()=>this.mouseOut(),className:s},hh.default.createElement(B.Toolbar.Item,{ariaLabel:o,isActive:t,onClick:()=>n(e)},r,a),hh.default.createElement(B.Toolbar.Tooltip,{position:d,reverse:i,show:l===e},o))}}var Xu=jj;const Gj=YF.default.div`
  position: relative;
`;const hu=v(require("react"));let Db=class extends hu.default.Component{constructor(){super(...arguments);this.renderIcon=e=>{const t=db[e];return hu.default.createElement(t,null)||null};this.update=e=>{this.props.active.selectTool(e)}}getToolTitle(e){return this.props.config.locale[e].title}render(){const e=this.props.active.tool,{tool:t,custom:i}=this.props;if(t){const r=i.getAdvancedToolbarItem();return hu.default.createElement(r,{key:t,isActive:t===e,isReverse:this.props.isReverse,icon:this.renderIcon(t),onClick:()=>this.update(t),tool:t,label:this.getToolTitle(t)})}return hu.default.createElement(B.Toolbar.Separator,null)}};Db=u([O("active","config","custom"),I],Db);var JF=Db;const Ib=v(require("react"));let Ob=class extends Ib.default.Component{constructor(){super(...arguments);this.renderTools=e=>this.props.config.tools.map((t,i)=>Ib.default.createElement(JF,{key:t||i,tool:t,isReverse:e}))}render(){return Ib.default.createElement(B.Toolbar.Index,null,this.renderTools)}};Ob=u([O("config"),I],Ob);var vw=Ob;const mo=v(require("react")),Wj=({library:e,active:t,custom:i})=>{const r=e.locale.controls.placeholderSearch,{config:o,libraryProvider:n}=e,s=i.getButton("toolControlBarPrimaryButton"),a=i.getButton("toolControlBarSecondaryButton"),l=h=>{const{files:m}=h.target;if(m.length){const b=new FileReader;b.onload=_=>{t.newImage(_.target.result)},b.readAsDataURL(m[0])}},d=()=>{t.selectWebcam(!0)},c=()=>{const h=document.getElementById("fileUpload");h&&h.click()},p=h=>{e.fetchImages(h)};return mo.default.createElement(B.Controlsbar,{shouldAnimateHeight:!1,shouldAnimateOverflow:!1},mo.default.createElement(D.Spacer,null),n&&mo.default.createElement(mo.default.Fragment,null,mo.default.createElement(D.Input.Search,{onChange:p,placeholder:r}),mo.default.createElement(D.Spacer,{count:2})),o.enableUpload&&mo.default.createElement(s,{tool:w.LIBRARY,ariaLabel:e.locale.controls.buttonUpload,onClick:c,fullWidth:!0,label:e.locale.controls.buttonUpload},mo.default.createElement(D.Input.File,{onChange:l})),mo.default.createElement(D.Spacer,null),o.enableWebcam&&mo.default.createElement(a,{tool:w.LIBRARY,ariaLabel:e.locale.controls.buttonWebcamOpen,onClick:d,fullWidth:!0,label:e.locale.controls.buttonWebcamOpen}),mo.default.createElement(B.ItemsSeparator,null))};var ZF=O("library","active","custom")(I(Wj));const Ti=v(require("react")),Vj=({active:e,library:t,custom:i})=>{const{query:r,config:o,selectedCategoryIdentifier:n,categories:s,images:a}=t,l=i.getAdvancedCategoryCard(),d=i.getAdvancedItemCard(),c=(m,b)=>Ti.default.createElement(d,{tool:w.LIBRARY,type:pe.MEDIUM,onClick:()=>e.newImage(m.rawUrl),key:`${m.identifier}-${b}`,image:m.coverImage,label:m.name,style:{animationDelay:`${b*.08}s`}},Ti.default.createElement(B.CardLabel,{hidden:!0},m.name)),p=m=>{const b=n===m.identifier;return m.items?Ti.default.createElement("div",{key:m.identifier},Ti.default.createElement(l,{isActive:b,tool:w.LIBRARY,type:pe.LARGE,onClick:()=>t.toggleCategorySelection(m.identifier),image:m.coverImage,label:m.name,style:{animationDelay:`${m.delay||0}s`}},Ti.default.createElement(B.CardLabel,{withBackground:!0,caret:!0,isActive:b},m.name)),Ti.default.createElement(B.Sidebar.ExpandableContainer,{show:b},m.items.map(c))):null},h=(m,b)=>m.items?Ti.default.createElement(B.Sidebar.TextCategory,{key:m.identifier,name:m.name,isFirstCategory:b!==0,isLastCategory:b!==s.length-1},m.items.map(c)):null;return r?a.length?Ti.default.createElement(Ti.default.Fragment,null,a.map(c)):Ti.default.createElement("p",{"data-test":"LibraryNoResult"},t.locale.controls.noResults):o.flattenCategories?Ti.default.createElement(Ti.default.Fragment,null,a.map(c)):o.categoryHeaderType===Ft.CARD?Ti.default.createElement(Ti.default.Fragment,null,s.map(p)):o.categoryHeaderType===Ft.TEXT?Ti.default.createElement(Ti.default.Fragment,null,s.map(h)):null};var QF=O("library","active","custom")(I(Vj));const La=v(require("react")),Kj=({library:e,displayTitle:t})=>La.default.createElement(La.default.Fragment,null,t&&La.default.createElement(B.Sidebar.Heading,null,e.locale.title),La.default.createElement(ZF,null),La.default.createElement(B.Itemsbar,null,La.default.createElement(B.CardContainer,null,La.default.createElement(QF,null))));var eP=O("library")(I(Kj));const za=v(require("react")),$j=({filterTool:e,custom:t})=>{const i=e.locale.controls,r=e.state,o=t.getButton("toolControlBarSecondaryButton"),n=()=>{e.toolSnapshot()},s=()=>{e.reset()};return za.default.createElement(B.Controlsbar,{show:e.isOptionSelected},za.default.createElement(D.Input.Form,null,za.default.createElement(o,{tool:w.FILTER,ariaLabel:i.buttonReset,onClick:s,fullWidth:!0,label:i.buttonReset}),za.default.createElement(D.Spacer,{count:2}),za.default.createElement(D.Input.Slider,{"aria-hidden":!e.isOptionSelected,label:i.sliderIntensity,value:r.intensity,min:0,max:1,onChange:e.changeIntensity,onMouseUp:n,onTouchEnd:n,snap:r.isDuotone?.5:null}),za.default.createElement(D.Spacer,null)),za.default.createElement(B.ItemsSeparator,null))};var tP=O("filterTool","custom")(I($j));const vr=v(require("react")),qj=({filterTool:e,custom:t})=>{const{categories:i,config:r,entities:o,locale:n}=e,s=t.getAdvancedItemCard(),a=t.getAdvancedCategoryCard(),l=p=>{const h=n.items[p.identifier]||p.name;return vr.default.createElement(s,{tool:w.FILTER,type:pe.MEDIUM,onClick:()=>e.selectFilter(p.identifier,p.defaultIntensity),key:p.identifier,image:p.thumbnail||p.thumbnailURI,label:h,style:{animationDelay:`${p.delay||0}s`},isActive:e.identifier===p.identifier},vr.default.createElement(B.CardLabel,{withBackground:!0},h))},d=p=>{const{selectedCategoryIdentifier:h}=e,m=h===p.identifier,b=n.categories[p.identifier]||p.name;return p.items?vr.default.createElement("div",{key:p.identifier},vr.default.createElement(a,{isActive:m,tool:w.FILTER,type:pe.LARGE,onClick:()=>e.toggleCategorySelection(p.identifier),image:p.thumbnailURI,label:b,style:{animationDelay:`${p.delay||0}s`}},vr.default.createElement(B.CardLabel,{withBackground:!0,caret:!0,isActive:m},b)),vr.default.createElement(B.Sidebar.ExpandableContainer,{show:m},p.items.map(l))):null},c=(p,h)=>{const m=n.categories[p.identifier]||p.name;return p.items?vr.default.createElement(B.Sidebar.TextCategory,{key:p.identifier,name:m,isFirstCategory:h!==0,isLastCategory:h!==i.length-1},p.items.map(l)):null};return r.flattenCategories?vr.default.createElement(vr.default.Fragment,null,o.map(l)):r.categoryHeaderType===Ft.CARD?vr.default.createElement(vr.default.Fragment,null,i.map(d)):r.categoryHeaderType===Ft.TEXT?vr.default.createElement(vr.default.Fragment,null,i.map(c)):null};var iP=O("filterTool","custom")(I(qj));const Na=v(require("react")),Xj=({filterTool:e,displayTitle:t})=>Na.default.createElement(Na.default.Fragment,null,t&&Na.default.createElement(B.Sidebar.Heading,null,e.locale.title),Na.default.createElement(tP,null),Na.default.createElement(B.Itemsbar,{key:"filterToolItemsbar"},Na.default.createElement(B.CardContainer,null,Na.default.createElement(iP,null))));var rP=O("filterTool")(I(Xj));const Ua=v(require("react")),Yj=({focusTool:e,custom:t})=>{const i=e.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{e.toolSnapshot(i.sliderIntensity)},n=()=>{e.reset()};return Ua.default.createElement(B.Controlsbar,{show:e.isOptionSelected},Ua.default.createElement(D.Input.Form,null,Ua.default.createElement(r,{tool:w.FOCUS,ariaLabel:i.buttonReset,onClick:n,fullWidth:!0,label:i.buttonReset}),Ua.default.createElement(D.Spacer,{count:2}),Ua.default.createElement(D.Input.Slider,{"aria-hidden":!e.isOptionSelected,label:i.sliderIntensity,value:e.intensity,min:ze.minIntensity,max:e.maxIntensity,divider:1,onChange:e.changeIntensity,onMouseUp:o,onTouchEnd:o})),Ua.default.createElement(D.Spacer,{count:1}),Ua.default.createElement(B.ItemsSeparator,null))};var oP=O("focusTool","custom")(I(Yj));const pu=v(require("react")),Jj=({focusTool:e,custom:t})=>{const{entities:i}=e,r=o=>{const n=e.locale.items[o.identifier]||o.name,s=t.getAdvancedItemCard();return pu.default.createElement(s,{tool:w.FOCUS,type:pe.LARGE,onClick:()=>e.selectFocus(o.identifier),key:o.identifier,image:o.thumbnailURI,label:n,style:{animationDelay:`${o.delay||0}s`},isActive:o.identifier===e.identifier},pu.default.createElement(B.CardLabel,{withBackground:!0},n))};return pu.default.createElement(B.Itemsbar,null,pu.default.createElement(B.CardContainer,null,i.map(r)))};var nP=O("focusTool","custom")(I(Jj));const ph=v(require("react")),Zj=({focusTool:e,displayTitle:t})=>ph.default.createElement(ph.default.Fragment,null,t&&ph.default.createElement(B.Sidebar.Heading,null,e.locale.title),ph.default.createElement(oP,null),ph.default.createElement(nP,null));var sP=O("focusTool")(I(Zj));const td=v(require("react")),aP=v(require("styled-components")),Qj=aP.default(D.Input.Slider)`
  padding-bottom: 16px;
`,eW=({adjustmentsTool:e})=>{const{categories:t,items:i,config:r,locale:o}=e,n=()=>{e.toolSnapshot()},s=(d,c)=>{e.editAdjustments({type:d,value:c})},a=d=>{const c=e.locale.categories[d.identifier]||d.name;return td.default.createElement(Qj,{adjust:!0,key:d.identifier,label:c,value:e[d.identifier],onChange:p=>s(d.identifier,p),onMouseUp:n,onTouchEnd:n,snap:0})},l=(d,c)=>{const p=o.categories[d.identifier]||d.name;return d.items?td.default.createElement(B.Sidebar.TextCategory,{key:d.identifier,name:p,isFirstCategory:c!==0,isLastCategory:c!==t.length-1},d.items.map(a)):null};return r.flattenCategories?td.default.createElement(td.default.Fragment,null,i.map(a)):td.default.createElement(td.default.Fragment,null,t.map(l))};var lP=O("adjustmentsTool")(I(eW));const Rb=v(require("react")),tW=({adjustmentsTool:e,custom:t})=>{const i=e.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{e.reset()};return Rb.default.createElement(B.Controlsbar,{show:e.isDirty},Rb.default.createElement(r,{tool:w.ADJUSTMENT,label:i.buttonReset,ariaLabel:i.buttonReset,onClick:o,fullWidth:!0}),Rb.default.createElement(B.ItemsSeparator,null))};var dP=O("adjustmentsTool","custom")(I(tW));const id=v(require("react")),iW=({adjustmentsTool:e,displayTitle:t})=>id.default.createElement(id.default.Fragment,null,t&&id.default.createElement(B.Sidebar.Heading,null,e.locale.title),id.default.createElement(dP,null),id.default.createElement(B.Itemsbar,null,id.default.createElement(lP,null)));var cP=O("adjustmentsTool")(I(iW));const Es=v(require("react")),rW=({overlayTool:e,custom:t})=>{const i=e.locale.controls,{allBlendModes:r}=e,{blendMode:o}=e,n=t.getButton("toolControlBarSecondaryButton"),s=()=>{e.toolSnapshot()},a=d=>{e.changeBlendMode(d)},l=()=>{e.reset()};return Es.default.createElement(B.Controlsbar,{show:e.isOptionSelected},Es.default.createElement(n,{tool:w.OVERLAY,ariaLabel:i.buttonReset,onClick:l,fullWidth:!0,label:i.buttonReset}),Es.default.createElement(D.Spacer,{count:2}),Es.default.createElement(D.Input.CarouselSlider,{label:i.carouselBlendMode,defaultIdentifier:o,onSelect:a,list:r}),Es.default.createElement(D.Spacer,{count:2}),Es.default.createElement(D.Input.Slider,{"aria-hidden":!e.isOptionSelected,label:i.sliderOpacity,value:e.opacity,min:0,max:1,onChange:e.changeOpacity,onMouseUp:s,onTouchEnd:s}),Es.default.createElement(D.Spacer,null),Es.default.createElement(B.ItemsSeparator,null))};var hP=O("overlayTool","custom")(I(rW));const uu=v(require("react")),oW=({overlayTool:e,custom:t})=>{const i=r=>{const o=e.locale.items[r.identifier]||r.name,n=t.getAdvancedItemCard();return uu.default.createElement(n,{tool:w.OVERLAY,type:pe.MEDIUM,onClick:()=>e.selectOverlay(r.identifier),key:r.identifier,image:r.thumbnailURI,label:o,style:{animationDelay:`${r.delay||0}s`},isActive:r.identifier===e.identifier},uu.default.createElement(B.CardLabel,{withBackground:!0},o))};return uu.default.createElement(B.Itemsbar,null,uu.default.createElement(B.CardContainer,null,e.entities.map(i)))};var pP=O("overlayTool","custom")(I(oW));const uh=v(require("react")),nW=({overlayTool:e,displayTitle:t})=>uh.default.createElement(uh.default.Fragment,null,t&&uh.default.createElement(B.Sidebar.Heading,null,e.locale.title),uh.default.createElement(hP,null),uh.default.createElement(pP,null));var uP=O("overlayTool")(I(nW));const Xo=v(require("react")),mP=v(require("styled-components")),sW=mP.default.input.attrs({type:"file",id:"fileUpload",accept:"image/*",multiple:!0})`
  ${zt.VisuallyHidden}
`,aW=({stickerTool:e,custom:t})=>{const{colorList:i}=e,r=e.locale.controls,o=e.localeColor.colorPicker,n=t.getButton("toolControlBarPrimaryButton"),s=()=>{e.toolSnapshot()},a=()=>{const p=document.getElementById("fileUpload");p&&(p.value=null,p.click())},l=p=>{const{files:h}=p.target;e.addFiles(h)},d=()=>e.isCustomStickerEnabled?Xo.default.createElement(n,{tool:w.STICKER,ariaLabel:r.buttonUpload,onClick:a,fullWidth:!0,label:r.buttonUpload},Xo.default.createElement(sW,{onChange:l})):null,c=!e.isStickerSelected||!e.tintable&&e.isStickerSelected;return Xo.default.createElement(B.Controlsbar,{shouldAnimateHeight:!1,shouldAnimateOverflow:!1,overflowAfterExpand:!0},Xo.default.createElement(D.Input.Form,null,d(),Xo.default.createElement(D.Spacer,{count:2}),Xo.default.createElement(D.Input.Slider,{isDisabled:!e.isStickerSelected,label:r.sliderOpacity,value:e.opacity,min:0,max:1,onChange:e.changeOpacity,onMouseUp:s,onTouchEnd:s}),Xo.default.createElement(D.Spacer,{count:2}),Xo.default.createElement(D.Input.Selection,{isDisabled:c,label:r.selectColor},Xo.default.createElement(jt,{activeSprite:e.id,parentId:r.selectColor,activeColor:e.tintColor,colors:i,labelsColor:o,isDisabled:c,onChange:e.changeTintColor,onAddSnapshot:e.tintColorSnapshot}))),Xo.default.createElement(B.ItemsSeparator,null))};var fP=O("stickerTool","custom")(I(aW));const _r=v(require("react")),lW=({stickerTool:e,custom:t})=>{const{categories:i,selectedCategoryIdentifier:r,config:o,entities:n,locale:s}=e,a=t.getAdvancedCategoryCard(),l=t.getAdvancedItemCard(),d=h=>{const m=s.items[h.identifier]||h.name;return _r.default.createElement(l,{key:h.identifier,tool:w.STICKER,type:pe.SMALL,onClick:()=>e.add(h.identifier),image:h.thumbnailURI,label:m,style:{backgroundSize:"75%",animationDelay:`${h.delay*.3||0}s`}},_r.default.createElement(B.CardLabel,{hidden:!0},m))},c=h=>{const m=r===h.identifier,b=s.categories[h.identifier]||h.name;return h.items?_r.default.createElement("div",{key:h.identifier},_r.default.createElement(a,{isActive:m,tool:w.STICKER,type:pe.LARGE,onClick:()=>e.toggleCategorySelection(h.identifier),image:h.thumbnailURI,label:b,style:{animationDelay:`${h.delay||0}s`}},_r.default.createElement(B.CardLabel,{withBackground:!0,caret:!0,isActive:m},b)),_r.default.createElement(B.Sidebar.ExpandableContainer,{show:m,key:`${h.identifier}-items`},h.items.map(d))):null},p=(h,m)=>{const b=s.categories[h.identifier]||h.name;return h.items?_r.default.createElement(B.Sidebar.TextCategory,{key:h.identifier,name:b,isFirstCategory:m!==0,isLastCategory:m!==i.length-1},h.items.map(d)):null};return o.flattenCategories?_r.default.createElement(_r.default.Fragment,null,n.map(d)):o.categoryHeaderType===Ft.CARD?_r.default.createElement(_r.default.Fragment,null,i.map(c)):o.categoryHeaderType===Ft.TEXT?_r.default.createElement(_r.default.Fragment,null,i.map(p)):null};var gP=O("stickerTool","custom")(I(lW));const Ha=v(require("react")),dW=({stickerTool:e,displayTitle:t})=>Ha.default.createElement(Ha.default.Fragment,null,t&&Ha.default.createElement(B.Sidebar.Heading,null,e.locale.title),Ha.default.createElement(fP,null),Ha.default.createElement(B.Itemsbar,null,Ha.default.createElement(B.CardContainer,null,Ha.default.createElement(gP,null))));var bP=O("stickerTool")(I(dW));const _t=v(require("react")),mu=v(require("styled-components")),yP=mu.default.div`
  position: relative;
`,cW=mu.default.div`
  display: flex;
  justify-content: space-between;
`,hW=mu.default(D.Input.NumericInput)`
  max-width: 50%;
  margin-right: 16px;
`,pW=mu.default(D.Input.Selection)`
  width: 50%;
`,uW=({textTool:e,custom:t})=>{const i=e.locale.controls,r=e.localeColor.colorPicker,{fontFamilies:o,alignment:n,isTextSelected:s,fontFamily:a,fontStyle:l,fontWeight:d,colorList:c,backgroundColorList:p}=e,h=["left","center","right"],m=t.getButton("textAlignment"),b=t.getButton("toolControlBarPrimaryButton"),_=()=>{e.toolSnapshot()},g=()=>{e.add()},S=T=>{const k=T?parseFloat(T):0;e.setFontSize(Math.max(10,Math.min(690,k)))},x=()=>h.map(T=>{const k=cb[T];return _t.default.createElement(m,{tool:T,isDisabled:!s,ariaLabel:`Align ${T}`,isActive:T===n,key:T,style:{padding:"1px 3px 2px"},icon:_t.default.createElement(k,null),onClick:()=>e.changeAlignment(T)})}),C=o.map(T=>({label:`${T.fontFamily} ${fe.getDisplayFontStyle(T)}`,fontWeight:T.fontWeight||"",fontStyle:T.fontStyle||"",fontFamily:T.fontFamily||"",value:T.identifier})),R=C.filter(({value:T})=>T===e.identifier)[0];return _t.default.createElement(B.Controlsbar,{show:!0,overflowAfterExpand:!0,shouldAnimateHeight:!1},_t.default.createElement(D.Input.Form,null,_t.default.createElement(b,{tool:w.TEXT,ariaLabel:i.buttonNew,onClick:g,fullWidth:!0,label:i.buttonNew}),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(D.Input.Dropdown,{isDisabled:!s,style:{fontFamily:a,fontStyle:l,fontWeight:d},itemStyle:T=>({fontFamily:T.fontFamily,fontStyle:T.fontStyle,fontWeight:T.fontWeight}),label:i.dropdownFontFamily,list:C,onSelect:e.changeFont,selectedItem:R.label}),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(cW,null,_t.default.createElement(hW,{value:e.fontSize.toFixed(0),onSubmit:S,label:i.textFontSize,isDisabled:!s}),_t.default.createElement(pW,{isDisabled:!s,inline:!0,label:i.selectAlignment},x())),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(yP,null,_t.default.createElement(B.ItemsSeparator,{full:!0})),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(D.Input.Selection,{isDisabled:!s,label:i.selectFontColor},_t.default.createElement(jt,{activeSprite:e.id,parentId:i.selectFontColor,activeColor:e.textColor,colors:c,labelsColor:r,isDisabled:!s,onChange:e.changeColor,onAddSnapshot:e.colorSnapshot})),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(D.Input.Selection,{isDisabled:!s,label:i.selectBackgroundColor},_t.default.createElement(jt,{activeSprite:e.id,parentId:i.selectBackgroundColor,activeColor:e.backgroundColor,colors:p,labelsColor:r,isDisabled:!s,onChange:e.changeBackgroundColor,onAddSnapshot:e.backgroundColorSnapshot})),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(yP,null,_t.default.createElement(B.ItemsSeparator,{full:!0})),_t.default.createElement(D.Spacer,{count:2}),_t.default.createElement(D.Input.Slider,{isDisabled:!s,label:i.sliderLineSpacing,value:e.lineHeight,min:.5,max:3,onChange:e.changeLineHeight,onMouseUp:_,onTouchEnd:_,snap:1,divider:1,decimal:1}),_t.default.createElement(D.Spacer,{count:1})))};var vP=O("textTool","custom")(I(uW));const mh=v(require("react")),mW=({textTool:e,displayTitle:t})=>mh.default.createElement(mh.default.Fragment,null,t&&mh.default.createElement(B.Sidebar.Heading,null,e.locale.title),mh.default.createElement(vP,null),mh.default.createElement(B.Itemsbar,null));var _P=O("textTool")(I(mW));const Tn=v(require("react")),fW=({textDesignTool:e,custom:t})=>{const i=e.locale.controls,r=e.localeColor.colorPicker,{colorList:o}=e,n=e.isTextDesignSelected,s=t.getButton("toolControlBarPrimaryButton"),a=t.getButton("toolControlBarSecondaryButton"),l=()=>{e.add()},d=()=>{e.changeSeed()};return Tn.default.createElement(B.Controlsbar,{shouldAnimateOverflow:!1,shouldAnimateHeight:!1},Tn.default.createElement(D.Input.Form,null,Tn.default.createElement(s,{tool:w.TEXT_DESIGN,ariaLabel:i.buttonNew,onClick:l,fullWidth:!0,label:i.buttonNew}),Tn.default.createElement(D.Spacer,{count:2}),Tn.default.createElement(a,{tool:w.TEXT_DESIGN,ariaLabel:i.buttonShuffle,isDisabled:!n,onClick:d,fullWidth:!0,label:i.buttonShuffle}),Tn.default.createElement(D.Spacer,{count:2}),Tn.default.createElement(D.Input.Selection,{isDisabled:!n,label:i.selectColor},Tn.default.createElement(jt,{activeSprite:e.id,parentId:i.selectColor,activeColor:e.color,colors:o,labelsColor:r,isDisabled:!n,onChange:e.changeColor,onAddSnapshot:e.colorSnapshot}))),Tn.default.createElement(B.ItemsSeparator,null))};var xP=O("textDesignTool","custom")(I(fW));const fu=v(require("react")),gW=({textDesignTool:e,custom:t})=>{const{entities:i}=e,{identifier:r}=e,o=s=>{e.changeIdentifier(s)},n=s=>{const a=t.getAdvancedItemCard();return fu.default.createElement(a,{key:s.identifier,tool:w.TEXT_DESIGN,type:pe.MEDIUM,onClick:()=>o(s.identifier),image:s.thumbnailURI,label:s.name||"",style:{animationDelay:`${s.delay||0}s`,backgroundSize:"60%"},isDisabled:!e.isTextDesignSelected,isActive:r===s.identifier},fu.default.createElement(B.CardLabel,{hidden:!0},s.name))};return fu.default.createElement(B.Itemsbar,null,fu.default.createElement(B.CardContainer,null,i.map(n)))};var wP=O("textDesignTool","custom")(I(gW));const fh=v(require("react")),bW=({textDesignTool:e,displayTitle:t})=>fh.default.createElement(fh.default.Fragment,null,t&&fh.default.createElement(B.Sidebar.Heading,null,e.locale.title),fh.default.createElement(xP,null),fh.default.createElement(wP,null));var CP=O("textDesignTool")(I(bW));const gu=v(require("react")),yW=({frameTool:e,custom:t})=>{const{entities:i}=e,r=e.state?e.state.identifier:null,o=n=>{const s=e.locale.items[n.identifier]||n.name,a=t.getAdvancedItemCard();return gu.default.createElement(a,{tool:w.FRAME,type:pe.MEDIUM,onClick:()=>e.selectFrame(n.identifier),key:n.identifier,image:n.thumbnailURI,label:s,style:{backgroundSize:"75%",animationDelay:`${n.delay||0}s`},isActive:n.identifier===r},gu.default.createElement(B.CardLabel,{hidden:!0},s))};return gu.default.createElement(B.Itemsbar,null,gu.default.createElement(B.CardContainer,null,i.map(o)))};var SP=O("frameTool","custom")(I(yW));const Yo=v(require("react")),vW=({frameTool:e,custom:t})=>{const i=e.locale.controls,r=e.localeColor.colorPicker,{tintable:o,colorList:n}=e,s=t.getButton("toolControlBarSecondaryButton"),a=()=>{e.reset()},l=d=>{e.toolSnapshot(d)};return Yo.default.createElement(B.Controlsbar,{show:e.isOptionSelected,overflowAfterExpand:!0},Yo.default.createElement(s,{tool:w.FRAME,ariaLabel:i.buttonReset,onClick:a,fullWidth:!0,label:i.buttonReset}),Yo.default.createElement(D.Spacer,{count:2}),Yo.default.createElement(D.Input.Slider,{"aria-hidden":!e.isOptionSelected,label:i.sliderOpacity,value:e.opacity,min:0,max:1,onChange:e.changeOpacity,onMouseUp:()=>{l(i.sliderOpacity)},onTouchEnd:()=>{l(i.sliderOpacity)}}),Yo.default.createElement(D.Spacer,{count:2}),Yo.default.createElement(D.Input.Slider,{"aria-hidden":!e.isOptionSelected,label:i.sliderSize,value:e.size,min:e.minSize,max:e.maxSize,divider:1,onChange:e.changeWidth,onMouseUp:()=>{l(i.sliderSize)},onTouchEnd:()=>{l(i.sliderSize)}}),Yo.default.createElement(D.Spacer,{count:2}),Yo.default.createElement(D.Input.Selection,{isDisabled:!o,label:i.selectColor},Yo.default.createElement(jt,{parentId:i.selectColor,activeColor:e.color,colors:n,labelsColor:r,isDisabled:!o,onChange:e.changeColor,onAddSnapshot:e.colorSnapshot})),Yo.default.createElement(B.ItemsSeparator,null))};var TP=O("frameTool","custom")(I(vW));const gh=v(require("react")),_W=({frameTool:e,displayTitle:t})=>gh.default.createElement(gh.default.Fragment,null,t&&gh.default.createElement(B.Sidebar.Heading,null,e.locale.title),gh.default.createElement(TP,null),gh.default.createElement(SP,null));var kP=O("frameTool")(I(_W));const xr=v(require("react")),xW=({brushTool:e,custom:t})=>{const{colorList:i}=e,r=e.locale.controls,o=e.localeColor.colorPicker,n=t.getButton("toolControlBarSecondaryButton");return xr.default.createElement(xr.default.Fragment,null,xr.default.createElement(B.Controlsbar,{show:e.isDirty},xr.default.createElement(n,{tool:w.BRUSH,ariaLabel:r.buttonReset,onClick:e.reset,fullWidth:!0,label:r.buttonReset}),xr.default.createElement(B.ItemsSeparator,null)),xr.default.createElement(B.Controlsbar,{overflowAfterExpand:!0},xr.default.createElement(D.Input.Selection,{label:r.selectColor},xr.default.createElement(jt,{parentId:r.selectColor,activeColor:e.color,colors:i,labelsColor:o,onChange:e.changeColor})),xr.default.createElement(D.Spacer,{count:2}),xr.default.createElement(D.Input.Slider,{label:r.sliderSize,value:e.relativeSize,min:1,max:100,divider:1,onChange:e.changeRelativeSize}),xr.default.createElement(D.Spacer,{count:3}),xr.default.createElement(D.Input.Slider,{label:r.sliderHardness,value:e.hardness,min:0,max:1,onChange:e.changeHardness}),xr.default.createElement(D.Spacer,null)))};var EP=O("brushTool","custom")(I(xW));const bh=v(require("react")),wW=({brushTool:e,displayTitle:t})=>bh.default.createElement(bh.default.Fragment,null,t&&bh.default.createElement(B.Sidebar.Heading,null,e.locale.title),bh.default.createElement(EP,null),bh.default.createElement(B.Itemsbar,null));var DP=O("brushTool")(I(wW));const kn=v(require("react")),CW=({transformTool:e,custom:t})=>{const i=e.locale.controls,{forceDimensions:r,lockResolution:o,localOutputHeight:n,localOutputWidth:s}=e,a=t.getButton("toolControlBarSecondaryButton"),l=()=>{e.reset()},d=t.getCheckbox();return kn.default.createElement(B.Controlsbar,{shouldAnimateHeight:!1},kn.default.createElement(D.Input.Form,null,kn.default.createElement(a,{tool:w.TRANSFORM,ariaLabel:i.buttonReset,onClick:l,fullWidth:!0,label:i.buttonReset}),kn.default.createElement(D.Spacer,{count:2}),kn.default.createElement(d,{isDisabled:r,value:o,label:i.checkboxKeepResolution,checkMarkPosition:"right",onClick:e.changeLockResolution,style:{paddingTop:"5px",justifyContent:"space-between"}}),kn.default.createElement(D.Spacer,{count:2}),kn.default.createElement(iu,{isDisabled:r,showLabel:!0,valueHeight:n,valueWidth:s,onSubmitWidth:e.onPixelWidth,onSubmitHeight:e.onPixelHeight,label:i.inputCropSize,labelHeight:i.inputHeight,labelWidth:i.inputWidth}),kn.default.createElement(D.Spacer,{count:1})),kn.default.createElement(B.ItemsSeparator,null))};var IP=O("transformTool","custom")(I(CW));const Ni=v(require("react")),_w=v(require("react-dom/server")),SW=({transformTool:e,custom:t,editor:i})=>{const{categories:r,entities:o,identifier:n,config:s,locale:a}=e,l=t.getAdvancedItemCard(),d=t.getAdvancedCategoryCard(),c=m=>{const{theme:b,measurements:_}=i.configStore,g=a.items[m.identifier]||m.name;let S=m.thumbnailURI||"",x="80%";if(!e.checkIfTransformThumbnailExits(m.thumbnailURI)){const C=m.identifier.includes("imgly_transform_common"),R=Je.crops[m.identifier]||Je.crops.imgly_transform_common_custom,T=Ni.default.createElement(R,{width:_.advancedCard.medium.width-(C?42:0),height:_.advancedCard.medium.height-(C?42:0),main:b.transform.crops.main,highlight:b.transform.crops.highlight,shadow:b.transform.crops.shadow});S=`'data:image/svg+xml,${encodeURIComponent(_w.renderToStaticMarkup(T))}'`,x=ti()||tl()?"auto":"unset"}return Ni.default.createElement(l,{key:m.identifier,tool:w.TRANSFORM,type:pe.MEDIUM,onClick:()=>e.changeIdentifier(m.identifier,!0),image:S,label:g,style:{backgroundSize:x,animationDelay:`${m.delay||0}s`},isActive:m.identifier===n},Ni.default.createElement(B.CardLabel,null,g))},p=m=>{const{theme:b,measurements:_}=i.configStore,g=e.selectedCategoryIdentifier===m.identifier,S=a.categories[m.identifier]||m.name;let x=m.thumbnailURI||"";if(!m.items)return null;if(!e.checkIfTransformThumbnailExits(m.thumbnailURI)){const C=Je.categories[m.identifier]||Je.crops.imgly_transform_common_custom,R=Ni.default.createElement(C,{width:_.advancedCard.large.width-42,height:_.advancedCard.large.height-42,main:b.transform.crops.main,highlight:b.transform.crops.highlight,shadow:b.transform.crops.shadow});x=`'data:image/svg+xml,${encodeURIComponent(_w.renderToStaticMarkup(R))}'`}return Ni.default.createElement("div",{key:m.identifier},Ni.default.createElement(d,{type:m.type,onClick:()=>e.toggleCategorySelection(m.identifier),key:m.identifier,image:x,style:{animationDelay:`${m.delay||0}s`},label:m.name,tool:w.TRANSFORM},Ni.default.createElement(B.CardLabel,{caret:!0,isActive:g},S)),Ni.default.createElement(B.Sidebar.ExpandableContainer,{show:g},m.items.map(c)))},h=(m,b)=>{const _=a.categories[m.identifier]||m.name;return m.items?Ni.default.createElement(B.Sidebar.TextCategory,{key:m.identifier,name:_,isFirstCategory:b!==0,isLastCategory:b!==r.length-1},m.items.map(c)):null};return s.flattenCategories?Ni.default.createElement(Ni.default.Fragment,null,o.map(c)):s.categoryHeaderType===Ft.CARD?Ni.default.createElement(Ni.default.Fragment,null,r.map(p)):s.categoryHeaderType===Ft.TEXT?Ni.default.createElement(Ni.default.Fragment,null,r.map(h)):null};var OP=O("transformTool","custom","editor")(I(SW));const Ga=v(require("react")),TW=({transformTool:e,displayTitle:t})=>Ga.default.createElement(Ga.default.Fragment,null,t&&Ga.default.createElement(B.Sidebar.Heading,null,e.locale.title),Ga.default.createElement(IP,null),Ga.default.createElement(B.Itemsbar,null,Ga.default.createElement(B.CardContainer,null,Ga.default.createElement(OP,null))));var RP=O("transformTool")(I(TW));const St=v(require("react"));let Ab=class extends St.default.Component{render(){const e=this.props.active.tool,t=this.props.config.config.displayToolControlBarTitle;return St.default.createElement(B.Sidebar.Index,null,St.default.createElement(D.Switch.Index,{type:e},St.default.createElement(D.Switch.Case,{value:w.LIBRARY},St.default.createElement(eP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.FILTER},St.default.createElement(rP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.FOCUS},St.default.createElement(sP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.ADJUSTMENT},St.default.createElement(cP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.OVERLAY},St.default.createElement(uP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.STICKER},St.default.createElement(bP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.TEXT},St.default.createElement(_P,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.TEXT_DESIGN},St.default.createElement(CP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.FRAME},St.default.createElement(kP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.BRUSH},St.default.createElement(DP,{displayTitle:t})),St.default.createElement(D.Switch.Case,{value:w.TRANSFORM},St.default.createElement(RP,{displayTitle:t}))))}};Ab=u([O("active","config"),I],Ab);var xw=Ab;const bi=v(require("react")),AP=v(require("styled-components")),FP=AP.default.div`
  position: absolute;
  height: 100%;
  width: ${e=>e.theme.measurements.advancedUIToolbar.width+e.theme.measurements.advancedUIToolControlBar.width}px;
  top: 0;
  background: ${e=>e.theme.webcam.backdrop};
  z-index: ${e=>e.theme.measurements.zIndex.disable};
`;class kW extends bi.default.Component{constructor(){super(...arguments);this.state={hasError:!1}}static getDerivedStateFromError(e){return console.error(e),{hasError:!0}}render(){const{config:e,active:t}=this.props;return e.isOrderDefault?bi.default.createElement(D.Container,{"data-test":hi.EditorContainer},t.isWebcam?bi.default.createElement(FP,{style:{left:0}}):null,bi.default.createElement(nh,null),bi.default.createElement(vw,null),bi.default.createElement(xw,null),bi.default.createElement(fa,null,bi.default.createElement(oh,null),bi.default.createElement(rh,null))):bi.default.createElement(D.Container,{"data-test":hi.EditorContainer},t.isWebcam?bi.default.createElement(FP,{style:{right:0}}):null,bi.default.createElement(nh,null),bi.default.createElement(fa,null,bi.default.createElement(oh,null),bi.default.createElement(rh,null)),bi.default.createElement(xw,null),bi.default.createElement(vw,null))}}var PP=O("config","active")(I(kW));const bu=v(require("react")),BP=v(require("styled-components"));class IC extends bu.default.Component{componentDidMount(){this.editor=this.props.editor,this.storeProps=this.props.storeProps;const e=new ru(this.editor.configStore.config.custom.components,{advancedUICategoryCard:B.Card,advancedUIItemCard:B.Card,advancedUIToolbarItem:Xu}),t={getAdvancedCategoryCard:e.getAdvancedCategoryCard,getAdvancedItemCard:e.getAdvancedItemCard,getAdvancedToolbarItem:e.getAdvancedToolbarItem,getDialog:e.getDialog,getButton:e.getButton,getColorItem:e.getColorItem,getCheckbox:e.getCheckbox};this.storeProps.custom=t,this.forceUpdate()}render(){return this.storeProps?bu.default.createElement(Ol,y({},this.storeProps),bu.default.createElement(BP.ThemeProvider,{theme:y(y({},this.editor.configStore.theme),{measurements:this.editor.configStore.measurements})},bu.default.createElement(PP,null))):null}}document.onkeydown=e=>{e.keyCode===13&&document.activeElement&&document.activeElement.click()};const MP=v(require("styled-components")),LP=MP.default(No)`
  margin: 2px;
  width: ${e=>e.theme.measurements.basicCard.medium.width}px;
  height: ${e=>e.theme.measurements.basicCard.medium.height}px;
  color: ${e=>e.theme.card.foreground};
`;const zP=v(require("styled-components")),NP=zP.default(No)`
  margin: 2px;
  width: ${e=>e.theme.measurements.basicCard.large.width}px;
  height: ${e=>e.theme.measurements.basicCard.large.height}px;
  color: ${e=>e.theme.card.foreground};
`;const UP=v(require("react")),ww=e=>{const t=e.type===pe.LARGE;let i=LP;return t&&(i=NP),UP.default.createElement(i,y({},e))};ww.defaultProps={type:pe.MEDIUM};const yu=v(require("react")),yh=v(require("styled-components")),HP=yh.css`
  width: 100%;
  height: inherit;
  white-space: nowrap;
  overflow: auto;
  transition-property: width;
  transition-duration: 0.4s;
  transition-timing-function: ease-in;
  ${zt.HiddenScrollbar}
`,GP=yh.default.div`
  padding-top: 4px;
`,EW=yh.default.div.attrs({"data-simplebar":"init","data-simplebar-auto-hide":"false"})`
  ${HP}
  /* prevent the native vertical scrollbar */
  .photoeditorsdk-simplebar-mask {
    overflow-y: hidden;
  }
`,jP=e=>{const{children:t}=e,i=Jt(e,["children"]);return yu.default.createElement(EW,y({},i),yu.default.createElement(GP,null,t))},DW=yh.default.div`
  ${HP}
  /* prevent the native vertical scrollbar */
  .photoeditorsdk-simplebar-mask {
    overflow-y: hidden;
  }
`,WP=e=>{const{children:t}=e,i=Jt(e,["children"]);return yu.default.createElement(DW,y({},i),yu.default.createElement(GP,null,t))};const VP=v(require("styled-components")),KP=VP.default(Ip)`
  &&& {
    min-height: 32px;
    font-size: ${e=>e.theme.measurements.fontSystem.basicUICardLabel.size}px;
    letter-spacing: ${e=>e.theme.measurements.fontSystem.basicUICardLabel.letterSpacing}px;
    text-transform: ${e=>e.theme.measurements.fontSystem.basicUICardLabel.case};
  }
`;const $P=v(require("react")),vu=v(require("styled-components")),qP=vu.default.div`
  position: relative;
  overflow: hidden;
  flex-shrink: 0;
  height: ${e=>e.theme.measurements.basicToolControlBar.itemsBarHeight}px;
  width: 100%;
  text-align: center;
  z-index: ${e=>e.theme.measurements.zIndex.toolControlBar};
  ${e=>e.show?vu.css`
          transition-timing-function: ease-in;
          transition-duration: 0.3s;
          transition-property: all;
          padding: 2px;
          max-height: ${e.theme.measurements.basicToolControlBar.itemsBarHeight}px;
          background: ${e.theme.toolControlBar.background};
          color: ${e.theme.toolControlBar.inputLabelForeground};
        `:vu.css`
          max-height: 0px;
        `}
`,IW=({show:e,children:t})=>$P.default.createElement(qP,{show:e},t);var XP=IW;qP.defaultProps={theme:X,show:!0};const YP=v(require("styled-components")),OW=YP.default.div`
  height: ${e=>e.theme.measurements.basicToolControlBar.itemsBarHeight}px;
  width: 2px;
  margin: 0 10px;
  display: inline-flex;
  position: relative;
  &:after {
    content: ' ';
    right: 0px;
    position: absolute;
    top: 8px;
    height: calc(100% - 16px);
    border-right: 1px solid ${e=>e.theme.toolControlBar.separatorColor};
  }
`;var JP=OW;const _u=v(require("styled-components")),ZP=_u.default.div`
  position: relative;
  display: flex;
  flex-shrink: 0;
  height: auto;
  transition: max-height 0.4s ease-in-out;
  ${e=>e.show?_u.css`
          max-height: 80px;
        `:_u.css`
          max-height: 0px;
        `}
`;var QP=ZP;ZP.defaultProps={theme:X,show:!0};const Fb=v(require("styled-components")),eB=Fb.default.div`
  &:after {
    content: '';
    position: absolute;
    bottom: 0px;
    ${e=>e.full?Fb.css`
            left: -24px;
            width: calc(100% + 48px);
          `:`
      left: 24px;
      width: calc(100% - 48px);
    `}
    border-bottom: 1px solid ${e=>e.theme.toolControlBar.separatorColor};
  }
`;var tB=eB;eB.defaultProps={theme:X};const iB=v(require("styled-components")),RW=iB.default.div`
  text-align: -moz-center;
  text-align: center;
  text-align: -webkit-center;
  overflow: visible;
  margin: 0 10vw;
  height: auto;
  box-shadow: ${e=>e.theme.toolControlBar.shadow};
  @media all and (min-width: 0) and (max-width: 599px) {
    margin: 0 5vw;
  }
`;var rB=RW;const Pb=v(require("styled-components")),AW=Pb.default.div`
  position: absolute;
  left: 0%;
  transform: translateY(0%) scaleY(0);
  justify-content: center;
  padding: 0 5vw;
  width: 90%;
  height: ${e=>e.theme.measurements.basicToolControlBar.controlsBarHeight}px;
  display: flex;
  align-items: center;
  transition: transform 0.4s ease-in-out;
  z-index: ${e=>e.theme.measurements.zIndex.controlsBar};
  background: ${e=>e.theme.toolControlBar.background};
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};

  ${({show:e})=>e&&Pb.css`
      transform: translateY(-100%) scaleY(1);
      overflow: visible;
    `}
`;var oB=AW;const rd=v(require("styled-components")),nB=rd.default.span`
  display: flex;
  cursor: pointer;
  z-index: ${e=>e.theme.measurements.zIndex.label};
  transition: bottom 0.3s linear;
`,sB=rd.css`
  background-color: ${e=>e.theme.toolbar.activeBackground};
  color: ${e=>e.theme.toolbar.activeForeground};
`,Bb=rd.default(Mi)`
  display: block;
  height: 100%;
  width: 100%;
  color: ${e=>e.theme.toolbar.foreground};
  background-color: ${e=>e.theme.toolbar.background};
  border: unset;
  box-shadow: unset;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;

  ${({isActive:e})=>e&&sB}

  &:active {
    ${sB}
  }

  svg {
    display: flex;
    transition: visibility 0s, opacity 0.5s linear;
    visibility: visible;
    opacity: 1;
  }
`,aB=rd.default.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,Mb=rd.default.li.attrs({role:"none"})`
  height: ${e=>e.theme.measurements.basicUIToolbar.openHeight}px;
  text-align: center;
  min-width: 100px;
  /* Allow the text to grow in this limit */
  max-width: 150px;
  position: relative;
  display: inline-block;
  /* Position inline-block box at the top of the line box */
  vertical-align: top;
  /* Allow text to wrap again, overwriting the Toolbar style */
  white-space: normal;
  margin: 1px;
`;const xu=v(require("styled-components")),lB=xu.default.ul.attrs(()=>({role:"menubar","aria-label":"Tool Navigation","data-simplebar":"init","data-simplebar-auto-hide":"false"}))`
  width: 100%;
  white-space: nowrap;
  overflow-y: hidden;
  text-align: center;
  list-style: none;
  margin: 0;
  padding: 0;
  position: relative;
  display: flex;
  flex-shrink: 0;
  justify-content: center;
  transition: height 0.2s ease-out, display 0.1s fade-out;
  background-color: ${e=>e.theme.toolbar.background};
  color: ${e=>e.theme.toolbar.foreground};
  z-index: ${e=>e.theme.measurements.zIndex.toolbar};

  ${e=>e.show?xu.css`
          height: ${e.theme.measurements.basicUIToolbar.closeHeight}px;
          ${Bb} {
            svg {
              visibility: hidden;
              opacity: 0;
              height: 0;
            }
          }
          ${Mb} {
            height: ${e.theme.measurements.basicUIToolbar.closeHeight}px;
          }
        `:xu.css`
          height: ${e.theme.measurements.basicUIToolbar.openHeight}px;
        `}
  ${zt.HiddenScrollbar}
`;var dB=lB;lB.defaultProps={theme:X,show:!1};const wu=v(require("react")),FW=({children:e,label:t,isActive:i,onClick:r})=>wu.default.createElement(Mb,{"aria-haspopup":!0,"aria-expanded":i},wu.default.createElement(Bb,{ariaLabel:t,onClick:r,isActive:i},wu.default.createElement(aB,null,e,wu.default.createElement(nB,null,t))));var cB=FW;const Cu=v(require("styled-components")),PW=Cu.default.li.attrs({role:"none"})`
  ${e=>e.active?Cu.css`
          height: ${e.theme.measurements.basicUIToolbar.closeHeight}px;
        `:Cu.css`
          height: ${e.theme.measurements.basicUIToolbar.openHeight}px;
        `}
  width: 2px;
  display: inline-block;
  position: relative;
  &:after {
    content: ' ';
    right: 0px;
    position: absolute;
    top: 8px;
    height: calc(100% - 16px);
    border-right: 1px solid ${e=>e.theme.toolControlBar.separatorColor};
  }
`;var hB=PW;const pB=v(require("react")),uB=v(require("styled-components")),BW=uB.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
`,MW=({label:e,className:t,children:i})=>pB.default.createElement(BW,{"aria-label":e,className:t},i);var Cw=MW;const Sw=v(require("react")),Lb=v(require("styled-components")),mB=Lb.css`
  background: ${e=>e.theme.tabTitle.activeBackground};
  color: ${e=>e.theme.tabTitle.activeForeground};
  border-bottom: 1px solid ${e=>e.theme.tabTitle.activeBorderColor};
`,LW=Lb.default(Co)`
  display: inline-flex;
  align-items: center;
  font-size: ${e=>e.theme.measurements.fontSystem.basicUITabLabel.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.basicUITabLabel.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.basicUITabLabel.case};
  color: ${e=>e.theme.tabTitle.foreground};
  border-radius: 0px;
  padding: 1px 12px 2px;
  background: ${e=>e.theme.tabTitle.background};

  ${({isActive:e})=>e&&mB}

  &:active {
    ${mB}
  }

  @media all and (min-width: 0) and (max-width: 599px) {
    max-width: 150px;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
`;class Tw extends Sw.default.Component{constructor(){super(...arguments);this.onClick=()=>{const{label:e,onClick:t}=this.props;t(e)}}render(){const{activeTab:e,label:t}=this.props;return Sw.default.createElement(LW,{ariaLabel:t,isActive:e===t,onClick:this.onClick},t)}}const fB=v(require("styled-components")),zW=fB.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  animation: ${H2.scale} 0.2s linear;
  animation-fill-mode: both;
  overflow: visible;
  height: 40px;
  min-width: 350px;
  @media all and (min-width: 0) and (max-width: 599px) {
    min-width: 280px;
  }
`;var gB=zW;const rr=v(require("react")),kw=v(require("styled-components")),NW=kw.default($r)`
  display: inline-flex;
  padding: 0 4px;
  height: 20px;
  font-size: 16px;
`,UW=kw.default(Gp)`
  display: inline-flex;
  justify-content: center;
  transform: translate(-100%, -100%);
  @media all and (min-width: 0) and (max-width: 499px) {
    left: 0;
    right: 0;
    transform: translateY(-120%);
    background: transparent;
    overflow: hidden;
    button {
      &:first-child {
        border-bottom-right-radius: 0;
        border-top-right-radius: 0;
      }
      &:last-child {
        border-bottom-left-radius: 0;
        border-top-left-radius: 0;
      }
      &:not(:first-child):not(:last-child) {
        border-radius: 0;
      }
    }
  }
`;class HW extends rr.default.Component{constructor(e){super(e);this.onTabClick=e=>{this.setState({activeTab:e,toggleExtend:!1})};this.getDropUp=()=>{const{length:e}=this.props,{toggleExtend:t}=this.state,i=rr.default.Children.toArray(this.props.children),r=rr.default.Children.count(this.props.children),o=i.slice(e,r);return rr.default.createElement(UW,{show:t},o.map(n=>{const s=n.props.label||"";return rr.default.createElement(Co,{onClick:()=>this.onTabClick(s),key:s,ariaLabel:"More Options"},s)}))};this.extend=()=>{this.setState(({toggleExtend:e})=>({toggleExtend:!e}))};this.getExtension=()=>rr.default.createElement(NW,{onClick:this.extend,ariaLabel:"Select Next"},"...");const t=rr.default.Children.count(this.props.children),i=rr.default.Children.toArray(this.props.children);this.state={activeTab:t&&(i[0].props&&i[0].props.label)||"",toggleExtend:!1}}render(){const{length:e}=this.props,{activeTab:t,toggleExtend:i}=this.state,r=rr.default.Children.toArray(this.props.children).slice(0,e),o=rr.default.Children.count(this.props.children)>e;return rr.default.createElement("div",null,r.map(n=>{if(n){const s=n.props.label||"";return rr.default.createElement(Tw,{activeTab:t,key:s,label:s,onClick:this.onTabClick})}return null}),o?this.getExtension():null,i?this.getDropUp():null,rr.default.Children.map(this.props.children,n=>!n||n.props&&n.props.label!==t?null:rr.default.createElement(gB,{key:n.props.label},n.props.children)))}}var Su=HW;const vh=v(require("react")),bB=v(require("styled-components")),GW=bB.default.div`
  position: relative;
  overflow: visible;
  white-space: nowrap;
  display: flex;
  transition: all 0.2s linear;
`;class Tu extends vh.default.Component{constructor(e){super(e);this.updateLength=()=>{const{maxWidth:e,children:t}=this.props;let i=0;if(e)i=e;else{const n=window.innerWidth,s=n>600?300:200;i=n-s}const r=vh.default.Children.count(t),o=i-r*Tu.TAB_WIDTH;if(o<0){const n=Math.round(Math.abs(o/Tu.TAB_WIDTH));this.setState({length:r-n})}};this.state={length:vh.default.Children.count(this.props.children)}}componentDidMount(){window.addEventListener("resize",this.updateLength),this.updateLength()}componentWillUnmount(){window.removeEventListener("resize",this.updateLength)}render(){const{children:e}=this.props,{length:t}=this.state;return t?vh.default.createElement(GW,null,vh.default.createElement(Su,{length:t},e)):null}}Tu.TAB_WIDTH=120;const yB=v(require("styled-components")),jW=yB.default.div`
  width: 100px;
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 42px;
  }
`;var vB=jW;const _B=v(require("styled-components")),WW=_B.default(D.Input.Slider).attrs(()=>({centerSlider:!0}))`
  max-width: 224px;
`;var xB=WW;const P={CardContainer:jP,DynamicCardContainer:WP,Card:ww,CardLabel:KP,Toolbar:{Index:dB,Item:cB,Separator:hB},BarSeparator:tB,ItemsSeparator:JP,Itemsbar:XP,Controlsbar:QP,ControlsbarContainer:oB,ResponsiveTabWrapper:Tu,Slider:xB,TabWrapper:Su,Tab:Cw,Other:{ControlsWrapper:rB,EmptyDiv:vB}};const ku=v(require("react")),VW=({config:e,active:t})=>{const{tools:i}=e,r=t.tool,o=l=>{const d=db[l];return ku.default.createElement(d,null)||null},n=l=>e.locale[l].title,s=l=>{t.selectTool(l,!0)},a=(l,d)=>l&&ku.default.createElement(P.Toolbar.Item,{onClick:()=>s(l),key:l,label:n(l),isActive:r===l},o(l))||ku.default.createElement(P.Toolbar.Separator,{key:l+d,active:!!r});return ku.default.createElement(P.Toolbar.Index,{role:"menubar",show:!!r},i.map(a))};var wB=O("config","active")(I(VW));const ja=v(require("react")),CB="photoeditorsdk-LibraryConfig";class KW extends ja.default.Component{constructor(){super(...arguments);this.onImageClick=e=>{this.props.active.newImage(e)};this.onCatgoryClick=e=>{this.library.toggleCategorySelection(e),this.library.recalculateScrollContainer()};this.onClick=(e,t,i)=>{e===pe.LARGE?this.onCatgoryClick(t):this.onImageClick(i)};this.renderCard=(e,t)=>ja.default.createElement(P.Card,{isActive:!1,type:e.type,onClick:()=>this.onClick(e.type,e.identifier,e.rawUrl),key:e.name+t,image:e.coverImage,style:{animationDelay:`${e.delay||0}s`},label:e.name,tool:w.LIBRARY},e.type===pe.LARGE?ja.default.createElement(P.CardLabel,{withBackground:!0},e.name):null)}componentDidMount(){this.simpleBar=new yt(document.getElementById(CB),{autoHide:!1}),this.library.saveScrollbar(this.simpleBar)}get library(){return this.props.library}get locale(){return this.library.locale.controls}get config(){return this.library.config}renderCategoryList(){const e=this.library.categoriesAndOptions;return ja.default.createElement("div",null,e&&e.length?e.map(this.renderCard):null)}renderImages(){const{images:e}=this.library,{noResults:t}=this.library.locale.controls;return ja.default.createElement("div",null,e.length?e.map(this.renderCard):ja.default.createElement("p",null,t))}render(){const{query:e}=this.library;return ja.default.createElement(P.DynamicCardContainer,{id:CB},e?this.renderImages():this.renderCategoryList())}}var SB=O("library","active")(I(KW));const _h=v(require("react")),TB="photoeditorsdk-FilterItems";class $W extends _h.default.Component{constructor(){super(...arguments);this.onFilterCilck=e=>{this.filterTool.selectFilter(e.identifier,e.defaultIntensity)};this.onCatgoryClick=e=>{this.filterTool.toggleCategorySelection(e)};this.onClick=e=>{e.type===pe.LARGE?(this.onCatgoryClick(e.identifier),setTimeout(()=>this.simpleBar.recalculate(),0)):this.onFilterCilck(e)};this.renderCard=e=>{const{identifier:t}=this.filterTool;return _h.default.createElement(P.Card,{isActive:t===e.identifier,type:e.type,onClick:()=>this.onClick(e),key:e.identifier,image:e.thumbnail||e.thumbnailURI,style:{animationDelay:`${e.delay||0}s`},label:e.name,tool:w.FILTER},_h.default.createElement(P.CardLabel,{withBackground:!0},this.filterTool.locale.categories[e.identifier]||this.filterTool.locale.items[e.identifier]||e.name))}}componentDidMount(){this.simpleBar=new yt(document.getElementById(TB),{autoHide:!1})}get filterTool(){return this.props.filterTool}render(){const{entities:e}=this.filterTool;return _h.default.createElement(P.DynamicCardContainer,{id:TB},_h.default.createElement("div",null,e&&e.length?e.map(this.renderCard):null))}}var kB=O("filterTool","active")(I($W));const zb=v(require("react")),qW=({focusTool:e})=>{const t=r=>{e.selectFocus(r)},i=r=>zb.default.createElement(P.Card,{key:r.identifier,image:r.thumbnailURI,onClick:()=>t(r.identifier),isActive:r.identifier===e.identifier,style:{animationDelay:`${r.delay||0}s`},label:r.name,type:pe.MEDIUM,tool:w.FOCUS},zb.default.createElement(P.CardLabel,{withBackground:!0},e.locale.items[r.identifier]||r.name));return zb.default.createElement(P.CardContainer,null,e.entities.map(i))};var EB=O("focusTool")(I(qW));const xh=v(require("react")),DB=v(require("styled-components")),IB=DB.default.div`
  position: relative;
  top: -8px;
  color: ${e=>e.theme.card.foreground};
`,XW=({adjustmentsTool:e})=>{const t=r=>{e.toggleOptionSelection(r)},i=(r,o)=>{const n=xA[r.identifier];return r?xh.default.createElement(P.Card,{key:r.identifier,onClick:()=>t(r.identifier),isActive:r.identifier===e.selectedAdjustmentType,style:{animationDelay:`${o*.08}s`},label:r.name,type:pe.MEDIUM,tool:w.ADJUSTMENT},xh.default.createElement(IB,null,xh.default.createElement(n,null)),xh.default.createElement(P.CardLabel,null,e.locale.items[r.identifier]||r.name)):null};return xh.default.createElement(P.CardContainer,null,e.items.map(i))};IB.defaultProps={theme:X};var OB=O("adjustmentsTool")(I(XW));const Nb=v(require("react")),YW=({overlayTool:e})=>{const t=e.identifier,i=o=>{e.selectOverlay(o)},r=o=>Nb.default.createElement(P.Card,{isActive:o.identifier===t,onClick:()=>i(o.identifier),key:o.identifier,image:o.thumbnailURI,style:{animationDelay:`${o.delay||0}s`},label:o.name,type:pe.MEDIUM,tool:w.OVERLAY},Nb.default.createElement(P.CardLabel,{withBackground:!0},e.locale.items[o.identifier]||o.name));return Nb.default.createElement(P.CardContainer,null,e.entities.map(r))};var RB=O("overlayTool")(I(YW));const Wa=v(require("react"));class JW extends Wa.default.Component{constructor(){super(...arguments);this.onClick=e=>{e.type===pe.LARGE?(this.sticker.toggleCategorySelection(e.identifier),setTimeout(()=>this.simpleBar.recalculate(),0)):this.sticker.add(e.identifier)};this.renderCategories=e=>e.map(this.renderCard);this.renderCard=e=>{const t=this.sticker.selectedCategoryIdentifier;return e.type===pe.LARGE?Wa.default.createElement(P.Card,{isActive:t===e.identifier,type:e.type,onClick:()=>this.onClick(e),key:e.identifier,image:e.thumbnailURI,style:{animationDelay:`${e.delay||0}s`},label:e.name,tool:w.STICKER},Wa.default.createElement(P.CardLabel,{withBackground:!0},this.sticker.locale.categories[e.identifier]||e.name)):Wa.default.createElement(P.Card,{type:e.type,onClick:()=>this.onClick(e),key:e.identifier,image:e.thumbnailURI,style:{backgroundSize:"55%",animationDelay:`${e.delay||0}s`},label:e.name,tool:w.STICKER},Wa.default.createElement(P.CardLabel,{hidden:!0},this.sticker.locale.items[e.identifier]||e.name))}}componentDidMount(){this.simpleBar=new yt(document.getElementById("photoeditorsdk-StickerConfig"),{autoHide:!1})}get sticker(){return this.props.stickerTool}render(){const e=this.sticker.entities;return Wa.default.createElement(P.DynamicCardContainer,{id:"photoeditorsdk-StickerConfig"},Wa.default.createElement("div",null,e&&e.length?this.renderCategories(e):null))}}var AB=O("stickerTool","active")(I(JW));const Eu=v(require("react")),FB=v(require("styled-components")),ZW=FB.default.div`
  font-size: 20px;
  position: absolute;
  left: 50%;
  transform-origin: left top;
`;class QW extends Eu.default.Component{constructor(){super(...arguments);this.getWidth=({fontFamily:e,fontStyle:t,fontWeight:i},r)=>{const o=document.createElement("canvas"),n=o.getContext("2d");return n.font=`${t} ${i} 20px ${e}`,n.fillText(r,0,0),n.measureText(r).width};this.renderFonts=()=>{const{config:e}=this.props,{fontsLoaded:t}=this.textTool;if(t){const i=this.textTool.fontFamilies,r=this.textTool.identifier;return i.map((o,n)=>{const{fontFamily:s,fontWeight:a,fontStyle:l,identifier:d}=o,c=`${o.fontFamily} ${fe.getDisplayFontStyle(o)}`,p=this.getWidth(o,c),h=(e.measurements.basicCard.medium.width-20)/p;return Eu.default.createElement(P.Card,{isDisabled:!this.textTool.isTextSelected,isActive:r===d,key:c,onClick:()=>this.textTool.changeFont(d),style:{animationDelay:`${n*.08}s`},label:c,type:pe.MEDIUM,tool:w.TEXT},Eu.default.createElement(ZW,{style:{transform:`scale(${h}) translate(-50%, -50%)`,fontFamily:s,fontStyle:l,fontWeight:a}},c))})}return null}}get textTool(){return this.props.textTool}render(){return Eu.default.createElement(P.CardContainer,null,this.renderFonts())}}var PB=O("textTool","config")(I(QW));const Du=v(require("react"));class eV extends Du.default.Component{constructor(){super(...arguments);this.renderOptions=e=>Du.default.createElement(P.Card,{isDisabled:!this.textDesignTool.isTextDesignSelected,isActive:this.props.textDesignTool.identifier===e.identifier,key:e.identifier,image:e.thumbnailURI,style:{backgroundSize:"60%",animationDelay:`${e.delay||0}s`},onClick:()=>this.textDesignTool.changeIdentifier(e.identifier),label:e.name,tool:w.TEXT_DESIGN,type:pe.MEDIUM},Du.default.createElement(P.CardLabel,{hidden:!0},e.name))}get textDesignTool(){return this.props.textDesignTool}render(){return Du.default.createElement(P.CardContainer,null,this.textDesignTool.entities.map(this.renderOptions))}}var BB=O("textDesignTool")(I(eV));const Ub=v(require("react")),tV=({frameTool:e})=>{const t=e.identifier,i=r=>Ub.default.createElement(P.Card,{key:r.identifier,image:r.thumbnailURI,onClick:()=>e.selectFrame(r.identifier),isActive:r.identifier===t,style:{animationDelay:`${r.delay||0}s`,backgroundSize:"60%"},label:r.name,type:pe.MEDIUM,tool:w.FRAME},Ub.default.createElement(P.CardLabel,{hidden:!0},e.locale.items[r.identifier]||r.name));return Ub.default.createElement(P.CardContainer,null,e.entities.map(i))};var MB=O("frameTool")(I(tV));const Ui=v(require("react")),Ew=v(require("styled-components")),iV=Ew.default.div`
  svg {
    margin-bottom: 12px;
  }
`,rV=Ew.default.div`
  svg {
    width: ${e=>e.theme.measurements.basicCard.medium.height}px;
    height: ${e=>e.theme.measurements.basicCard.medium.height}px;
  }

  ${tr} {
    width: ${e=>e.theme.measurements.basicCard.medium.width-32}px;
    height: ${e=>e.theme.measurements.basicCard.medium.height-32}px;
    padding: 6px 0px 24px;
  }
`;class oV extends Ui.default.Component{constructor(){super(...arguments);this.onClick=e=>{const{transformTool:t}=this.props;e.type===pe.LARGE?(t.toggleCategorySelection(e.identifier),setTimeout(()=>this.simpleBar.recalculate(),0)):t.changeIdentifier(e.identifier,!0)};this.renderCategories=e=>e.map(this.renderCard);this.renderCard=e=>{const{config:t,transformTool:i}=this.props,{theme:r}=t;let o=null;if(e.type===pe.LARGE&&i.checkIfTransformThumbnailExits(e.thumbnailURI))o=Ui.default.createElement(P.Card,{type:e.type,onClick:()=>this.onClick(e),key:e.identifier,image:e.thumbnailURI,style:{animationDelay:`${e.delay||0}s`},label:e.name,tool:w.TRANSFORM},Ui.default.createElement(P.CardLabel,null,e.name));else if(e.type===pe.LARGE)o=Ui.default.createElement(P.Card,{type:e.type,onClick:()=>this.onClick(e),key:e.identifier,image:"",style:{animationDelay:`${e.delay||0}s`},label:e.name,tool:w.TRANSFORM},Ui.default.createElement(iV,null,Je.categories[e.identifier]&&Ui.default.createElement(Je.categories[e.identifier]),Ui.default.createElement(P.CardLabel,null,i.locale.categories[e.identifier]||e.name)));else if(i.checkIfTransformThumbnailExits(e.thumbnailURI))o=Ui.default.createElement(P.Card,{key:e.identifier,type:e.type,onClick:()=>this.onClick(e),image:e.thumbnailURI,style:{backgroundSize:"55%",animationDelay:`${e.delay||0}s`},isActive:e.identifier===i.identifier,label:e.name,tool:w.TRANSFORM},Ui.default.createElement(P.CardLabel,null,e.name));else{const n=Je.crops[e.identifier]||Je.crops.imgly_transform_common_custom;o=Ui.default.createElement(P.Card,{key:e.identifier,type:e.type,onClick:()=>this.onClick(e),image:"",style:{backgroundSize:"55%",animationDelay:`${e.delay||0}s`},isActive:e.identifier===i.identifier,label:e.name,tool:w.TRANSFORM},Ui.default.createElement(rV,null,Ui.default.createElement(n,{main:r.transform.crops.main,highlight:r.transform.crops.highlight,shadow:r.transform.crops.shadow}),Ui.default.createElement(P.CardLabel,null,i.locale.items[e.identifier]||e.name)))}return o}}componentDidMount(){this.simpleBar=new yt(document.getElementById("photoeditorsdk-TransformConfig"),{autoHide:!1})}render(){const{transformTool:e}=this.props,t=e.entities;return Ui.default.createElement(P.DynamicCardContainer,{id:"photoeditorsdk-TransformConfig"},Ui.default.createElement("div",null,t&&t.length?this.renderCategories(t):null))}}var LB=O("transformTool","config")(I(oV));const Hr=v(require("react"));let Hb=class extends Hr.default.Component{constructor(){super(...arguments);this.getToolItemsComponent=e=>{switch(e){case w.LIBRARY:return Hr.default.createElement(SB,null);case w.FILTER:return Hr.default.createElement(kB,null);case w.FOCUS:return Hr.default.createElement(EB,null);case w.ADJUSTMENT:return Hr.default.createElement(OB,null);case w.OVERLAY:return Hr.default.createElement(RB,null);case w.STICKER:return Hr.default.createElement(AB,null);case w.TEXT:return Hr.default.createElement(PB,null);case w.TEXT_DESIGN:return Hr.default.createElement(BB,null);case w.FRAME:return Hr.default.createElement(MB,null);case w.TRANSFORM:return Hr.default.createElement(LB,null)}return null}}render(){const{library:e,active:t}=this.props,i=t.tool;return i===w.BRUSH||i===w.LIBRARY&&!e.libraryProvider?null:Hr.default.createElement(P.Itemsbar,{show:!!i},this.getToolItemsComponent(i))}};Hb=u([O("active","library"),I],Hb);var zB=Hb;const En=v(require("react")),nV=({filterTool:e,custom:t})=>{const{state:i}=e,r=e.locale.controls,o=t.getButton("toolControlBarSecondaryButton"),n=()=>{e.toolSnapshot()};return En.default.createElement(P.ControlsbarContainer,{show:e.isOptionSelected},En.default.createElement(o,{tool:w.FILTER,ariaLabel:e.locale.controls.buttonReset,onClick:e.reset,icon:En.default.createElement(Nt.reset,null),label:e.locale.controls.buttonReset}),En.default.createElement(P.Other.ControlsWrapper,null,En.default.createElement(D.Spacer,{count:2}),En.default.createElement(P.Slider,{"aria-hidden":!e.isOptionSelected,style:{width:"280px"},label:r.sliderIntensity,value:i.intensity,min:0,max:1,onMouseUp:n,onTouchEnd:n,onChange:e.changeIntensity,snap:i.isDuotone?.5:null}),En.default.createElement(D.Spacer,{count:2}),En.default.createElement(P.BarSeparator,null)),En.default.createElement(P.Other.EmptyDiv,null))};var NB=O("filterTool","custom")(I(nV));const Dn=v(require("react")),sV=({focusTool:e,custom:t})=>{const i=e.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{e.toolSnapshot(i.sliderIntensity)};return Dn.default.createElement(P.ControlsbarContainer,{show:e.isOptionSelected},Dn.default.createElement(r,{tool:w.FOCUS,ariaLabel:i.buttonReset,onClick:e.reset,icon:Dn.default.createElement(Nt.reset,null),label:i.buttonReset}),Dn.default.createElement(P.Other.ControlsWrapper,null,Dn.default.createElement(D.Spacer,{count:2}),Dn.default.createElement(P.Slider,{"aria-hidden":!e.isOptionSelected,style:{width:"280px"},label:i.sliderIntensity,value:e.intensity,min:ze.minIntensity,max:e.maxIntensity,divider:1,onChange:e.changeIntensity,onMouseUp:o,onTouchEnd:o}),Dn.default.createElement(D.Spacer,{count:2}),Dn.default.createElement(P.BarSeparator,null)),Dn.default.createElement(P.Other.EmptyDiv,null))};var UB=O("focusTool","custom")(I(sV));const In=v(require("react")),aV=({adjustmentsTool:e,custom:t})=>{const i=e.selectedAdjustmentType.toLowerCase(),r=t.getButton("toolControlBarSecondaryButton"),o=()=>{e.toolSnapshot()};return In.default.createElement(P.ControlsbarContainer,{show:Boolean(i)},In.default.createElement(r,{tool:w.ADJUSTMENT,ariaLabel:e.locale.controls.buttonReset,onClick:e.reset,icon:In.default.createElement(Nt.reset,null),label:e.locale.controls.buttonReset}),In.default.createElement(P.Other.ControlsWrapper,null,In.default.createElement(D.Spacer,{count:2}),In.default.createElement(P.Slider,{"aria-hidden":!i,adjust:!0,style:{width:"280px"},label:e.selectedOptionLabel,value:e[i],onChange:n=>e.editAdjustments({type:i,value:n}),onMouseUp:o,onTouchEnd:o,snap:0}),In.default.createElement(D.Spacer,{count:2}),In.default.createElement(P.BarSeparator,null)),In.default.createElement(P.Other.EmptyDiv,null))};var HB=O("adjustmentsTool","custom")(I(aV));const Gr=v(require("react")),lV=P.TabWrapper,{Tab:GB}=P,dV=({overlayTool:e,custom:t})=>{const{state:i}=e,r=e.locale.controls,{allBlendModes:o}=e,{blendMode:n}=e,s=t.getButton("toolControlBarSecondaryButton"),a=()=>{e.toolSnapshot()},l=d=>{e.changeBlendMode(d)};return Gr.default.createElement(P.ControlsbarContainer,{show:e.isOptionSelected},Gr.default.createElement(s,{tool:w.OVERLAY,ariaLabel:r.buttonReset,onClick:e.reset,icon:Gr.default.createElement(Nt.reset,null),label:r.buttonReset}),Gr.default.createElement(P.Other.ControlsWrapper,null,Gr.default.createElement(D.Spacer,null),Gr.default.createElement(lV,null,Gr.default.createElement(GB,{label:r.tabBlendMode},Gr.default.createElement(D.Input.CarouselSlider,{showLabel:!1,label:r.carouselBlendMode,defaultIdentifier:n,onSelect:l,list:o})),Gr.default.createElement(GB,{label:r.tabOpacity},Gr.default.createElement(P.Slider,{"aria-hidden":!e.isOptionSelected,showLabel:!1,style:{width:"280px"},label:r.sliderOpacity,value:i.opacity,min:0,max:1,onChange:e.changeOpacity,onMouseUp:a,onTouchEnd:a}))),Gr.default.createElement(P.BarSeparator,null)),Gr.default.createElement(P.Other.EmptyDiv,null))};var jB=O("overlayTool","custom")(I(dV));const On=v(require("react")),Gb=v(require("styled-components")),cV=Gb.default(P.ControlsbarContainer)`
  ${e=>e.firstChildMargin&&Gb.css`
      > :first-child {
        margin-right: 16px;
      }
    `}
`,hV=({library:e,active:t,custom:i})=>{const r=e.locale.controls.placeholderSearch,{config:o}=e,n=i.getButton("toolControlBarSecondaryButton"),s=i.getButton("toolControlBarPrimaryButton"),a=p=>{e.fetchImages(p),e.recalculateScrollContainer()},l=p=>{const{files:h}=p.target;if(h.length){const m=new FileReader;m.onload=b=>{t.newImage(b.target.result)},m.readAsDataURL(h[0])}},d=()=>{t.selectWebcam(!0)},c=()=>{const p=document.getElementById("fileUpload");p&&p.click()};return On.default.createElement(cV,{firstChildMargin:o.enableWebcam&&!e.libraryProvider,show:!0},o.enableUpload&&On.default.createElement(s,{tool:w.LIBRARY,ariaLabel:e.locale.controls.buttonUpload,onClick:c,icon:On.default.createElement(Nt.uploadImage,null),label:e.locale.controls.buttonUpload},On.default.createElement(D.Input.File,{onChange:l})),e.libraryProvider&&On.default.createElement(P.Other.ControlsWrapper,null,On.default.createElement(D.Input.Search,{onChange:a,placeholder:r})),o.enableWebcam&&On.default.createElement(n,{tool:w.LIBRARY,ariaLabel:e.locale.controls.buttonWebcamOpen,onClick:d,icon:On.default.createElement(Nt.openWebcam,null),label:e.locale.controls.buttonWebcamOpen}),On.default.createElement(P.BarSeparator,null))};var WB=O("library","active","custom")(I(hV));const Yt=v(require("react")),VB=v(require("styled-components")),pV=P.TabWrapper,{Tab:KB}=P,uV=VB.default.input.attrs({type:"file",id:"fileUpload",accept:"image/*",multiple:!0})`
  ${zt.VisuallyHidden}
`,mV=({stickerTool:e,custom:t})=>{const{colorList:i}=e,r=e.locale.controls,o=e.localeColor.colorPicker,n=t.getButton("toolControlBarPrimaryButton"),s=()=>{e.toolSnapshot()},a=()=>{const h=document.getElementById("fileUpload");h&&(h.value=null,h.click())},l=h=>{const{files:m}=h.target;e.addFiles(m)},d=()=>Yt.default.createElement("div",null,Yt.default.createElement(D.Spacer,{count:2}),Yt.default.createElement(P.Slider,{isDisabled:!e.isStickerSelected,style:{width:"280px"},label:r.sliderOpacity,value:e.opacity,min:0,max:1,onMouseUp:s,onTouchEnd:s,onChange:e.changeOpacity}),Yt.default.createElement(D.Spacer,{count:2})),c=()=>Yt.default.createElement("div",null,Yt.default.createElement(D.Spacer,null),Yt.default.createElement(pV,null,Yt.default.createElement(KB,{label:r.tabColor},Yt.default.createElement(D.Spacer,{count:1}),Yt.default.createElement(D.Input.Selection,{isDisabled:!e.isStickerSelected,showLabel:!1,label:r.selectColor},Yt.default.createElement(jt,{activeSprite:e.id,parentId:r.selectColor,activeColor:e.tintColor,colors:i,labelsColor:o,isDisabled:!e.isStickerSelected,colorPickerDirection:"top",onChange:e.changeTintColor,onAddSnapshot:e.tintColorSnapshot}))),Yt.default.createElement(KB,{label:r.tabOpacity},Yt.default.createElement(P.Slider,{isDisabled:!e.isStickerSelected,showLabel:!1,style:{width:"280px"},label:r.sliderOpacity,value:e.opacity,min:0,max:1,onMouseUp:s,onTouchEnd:s,onChange:e.changeOpacity})))),p=()=>e.isCustomStickerEnabled?Yt.default.createElement(n,{tool:w.STICKER,ariaLabel:r.buttonUpload,onClick:a,icon:Yt.default.createElement(Nt.uploadImage,null),label:r.buttonUpload},Yt.default.createElement(uV,{onChange:l})):null;return Yt.default.createElement(P.ControlsbarContainer,{show:!0},p(),Yt.default.createElement(P.Other.ControlsWrapper,null,e.tintable&&c()||d(),Yt.default.createElement(P.BarSeparator,null)),Yt.default.createElement(P.Other.EmptyDiv,null))};var $B=O("stickerTool","custom")(I(mV));const At=v(require("react")),qB=v(require("styled-components")),fV=P.ResponsiveTabWrapper,{Tab:Iu}=P,gV=qB.default(D.Input.NumericInput)`
  max-width: 55px;
  > div > input {
    text-align: center;
  }
`,bV=({textTool:e,custom:t})=>{const{colorList:i,backgroundColorList:r}=e,o=e.locale.controls,n=e.localeColor.colorPicker,s=["left","center","right"],a=t.getButton("textAlignment"),l=t.getButton("toolControlBarPrimaryButton"),d=()=>s.map(h=>{const m=cb[h];return At.default.createElement(a,{tool:h,isDisabled:!e.isTextSelected,ariaLabel:`Align ${h}`,isActive:h===e.alignment,key:h,icon:At.default.createElement(m,null),onClick:()=>e.changeAlignment(h)})}),c=()=>{e.toolSnapshot()},p=h=>{const m=h?parseFloat(h):0;e.setFontSize(Math.max(10,Math.min(690,m)))};return At.default.createElement(P.ControlsbarContainer,{show:!0},At.default.createElement(l,{tool:w.TEXT,ariaLabel:o.buttonNew,onClick:e.add,icon:At.default.createElement(Nt.addText,null),label:o.buttonNew}),At.default.createElement(P.Other.ControlsWrapper,null,At.default.createElement(D.Spacer,null),At.default.createElement(fV,null,At.default.createElement(Iu,{label:o.tabFontSize},At.default.createElement(gV,{value:e.fontSize.toFixed(0),onSubmit:p,isDisabled:!e.isTextSelected})),At.default.createElement(Iu,{label:o.tabAlignment},At.default.createElement(D.Input.Selection,{isDisabled:!e.isTextSelected,showLabel:!1,label:o.selectAlignment},d())),At.default.createElement(Iu,{label:o.tabColor},At.default.createElement(D.Spacer,null),At.default.createElement(D.Input.Selection,{isDisabled:!e.isTextSelected,showLabel:!1,label:o.selectFontColor},At.default.createElement(jt,{activeSprite:e.id,parentId:o.selectFontColor,activeColor:e.textColor,colors:i,labelsColor:n,colorPickerDirection:"top",isDisabled:!e.isTextSelected,onChange:e.changeColor,onAddSnapshot:e.colorSnapshot}))),At.default.createElement(Iu,{label:o.tabBgColor},At.default.createElement(D.Spacer,null),At.default.createElement(D.Input.Selection,{isDisabled:!e.isTextSelected,showLabel:!1,label:o.selectBackgroundColor},At.default.createElement(jt,{activeSprite:e.id,parentId:o.selectBackgroundColor,activeColor:e.backgroundColor,colors:r,labelsColor:n,colorPickerDirection:"top",isDisabled:!e.isTextSelected,onChange:e.changeBackgroundColor,onAddSnapshot:e.backgroundColorSnapshot}))),At.default.createElement(Iu,{label:o.tabLineHeight},At.default.createElement(P.Slider,{isDisabled:!e.isTextSelected,showLabel:!1,label:o.sliderLineSpacing,value:e.lineHeight,min:.5,max:3,onChange:e.changeLineHeight,onMouseUp:c,onTouchEnd:c,snap:1,divider:1,decimal:1}))),At.default.createElement(P.BarSeparator,null)),At.default.createElement(P.Other.EmptyDiv,null))};var XB=O("textTool","custom")(I(bV));const Rn=v(require("react")),yV=({textDesignTool:e,custom:t})=>{const i=e.locale.controls,r=e.localeColor.colorPicker,{colorList:o}=e,n=t.getButton("toolControlBarSecondaryButton"),s=t.getButton("toolControlBarPrimaryButton");return Rn.default.createElement(P.ControlsbarContainer,{show:!0},Rn.default.createElement(s,{tool:w.TEXT_DESIGN,ariaLabel:i.buttonNew,onClick:e.add,icon:Rn.default.createElement(Nt.addText,null),label:i.buttonNew}),Rn.default.createElement(P.Other.ControlsWrapper,null,Rn.default.createElement(D.Input.Selection,{isDisabled:!e.isTextDesignSelected,label:i.selectColor},Rn.default.createElement(jt,{activeSprite:e.id,parentId:i.selectColor,activeColor:e.color,colors:o,labelsColor:r,colorPickerDirection:"top",isDisabled:!e.isTextDesignSelected,onChange:e.changeColor,onAddSnapshot:e.colorSnapshot}))),Rn.default.createElement(n,{tool:w.TEXT_DESIGN,ariaLabel:i.buttonShuffle,onClick:e.changeSeed,icon:Rn.default.createElement(Nt.shuffle,null),label:i.buttonShuffle}),Rn.default.createElement(P.BarSeparator,null))};var YB=O("textDesignTool","custom")(I(yV));const ki=v(require("react")),vV=P.TabWrapper,{Tab:Dw}=P,_V=({frameTool:e,custom:t})=>{const i=e.locale.controls,r=e.localeColor.colorPicker,{tintable:o,colorList:n}=e,s=t.getButton("toolControlBarSecondaryButton"),a=l=>{e.toolSnapshot(l)};return ki.default.createElement(P.ControlsbarContainer,{show:e.isOptionSelected},ki.default.createElement(s,{tool:w.FRAME,ariaLabel:i.buttonReset,onClick:e.reset,icon:ki.default.createElement(Nt.reset,null),label:i.buttonReset}),ki.default.createElement(P.Other.ControlsWrapper,null,ki.default.createElement(D.Spacer,null),ki.default.createElement(vV,null,ki.default.createElement(Dw,{label:i.tabOpacity},ki.default.createElement(P.Slider,{"aria-hidden":!e.isOptionSelected,showLabel:!1,style:{width:"280px"},label:i.sliderOpacity,value:e.opacity,min:0,max:1,onChange:e.changeOpacity,onMouseUp:()=>{a(i.sliderOpacity)},onTouchEnd:()=>{a(i.sliderOpacity)}})),ki.default.createElement(Dw,{label:i.tabSize},ki.default.createElement(P.Slider,{"aria-hidden":!e.isOptionSelected,showLabel:!1,style:{width:"280px"},label:i.sliderSize,value:e.size,min:e.minSize,max:e.maxSize,divider:1,onChange:e.changeWidth,onMouseUp:()=>{a(i.sliderSize)},onTouchEnd:()=>{a(i.sliderSize)}})),o&&ki.default.createElement(Dw,{label:i.tabColor},ki.default.createElement(D.Spacer,{count:1}),ki.default.createElement(D.Input.Selection,{label:i.selectColor,showLabel:!1},ki.default.createElement(jt,{parentId:i.selectColor,activeColor:e.color,colors:n,labelsColor:r,colorPickerDirection:"top",onChange:e.changeColor,onAddSnapshot:e.colorSnapshot})))||null),ki.default.createElement(P.BarSeparator,null)),ki.default.createElement(P.Other.EmptyDiv,null))};var JB=O("frameTool","canvas","custom")(I(_V));const or=v(require("react")),xV=P.TabWrapper,{Tab:Iw}=P,wV=({brushTool:e,custom:t})=>{const{colorList:i}=e,r=e.locale.controls,o=e.localeColor.colorPicker,n=t.getButton("toolControlBarSecondaryButton");return or.default.createElement(P.ControlsbarContainer,{style:{justifyContent:"center"},show:!0},or.default.createElement(n,{tool:w.BRUSH,ariaLabel:r.buttonReset,onClick:e.reset,icon:or.default.createElement(Nt.reset,null),isDisabled:!e.isDirty,label:r.buttonReset}),or.default.createElement(P.Other.ControlsWrapper,null,or.default.createElement(D.Input.Form,null,or.default.createElement(xV,null,or.default.createElement(Iw,{label:r.tabColor},or.default.createElement(D.Spacer,{count:1}),or.default.createElement(D.Input.Selection,{showLabel:!1,label:r.selectColor},or.default.createElement(jt,{parentId:r.selectColor,activeColor:e.color,colors:i,labelsColor:o,colorPickerDirection:"top",onChange:e.changeColor}))),or.default.createElement(Iw,{label:r.tabSize},or.default.createElement(P.Slider,{style:{width:"280px"},showLabel:!1,label:r.sliderSize,value:e.relativeSize,min:1,max:100,divider:1,onChange:e.changeRelativeSize})),or.default.createElement(Iw,{label:r.tabHardness},or.default.createElement(P.Slider,{style:{width:"280px"},showLabel:!1,label:r.sliderHardness,value:e.hardness,min:0,max:1,onChange:e.changeHardness}))))))};var ZB=O("brushTool","custom")(I(wV));const nr=v(require("react")),CV=P.ResponsiveTabWrapper,{Tab:Ow}=P,SV=({transformTool:e,custom:t})=>{const i=e.locale.controls,{forceDimensions:r}=e,o=t.getCheckbox(),n=t.getButton("toolControlBarSecondaryButton");return nr.default.createElement(P.ControlsbarContainer,{show:!0},nr.default.createElement(n,{tool:w.TRANSFORM,ariaLabel:e.locale.controls.buttonReset,onClick:e.reset,icon:nr.default.createElement(Nt.reset,null),label:e.locale.controls.buttonReset}),nr.default.createElement(P.Other.ControlsWrapper,null,nr.default.createElement(D.Spacer,null),nr.default.createElement(CV,null,nr.default.createElement(Ow,{label:i.tabCropSize},nr.default.createElement(iu,{isDisabled:r,showLabel:!1,valueHeight:e.localOutputHeight,valueWidth:e.localOutputWidth,onSubmitWidth:e.onPixelWidth,onSubmitHeight:e.onPixelHeight,label:i.inputCropSize,labelHeight:i.inputHeight,labelWidth:i.inputWidth})),nr.default.createElement(Ow,{label:i.tabFlipAndRotate},nr.default.createElement(Zp,null)),nr.default.createElement(Ow,{label:i.tabResolution},nr.default.createElement(o,{isDisabled:r,style:{paddingTop:"5px",justifyContent:"center"},value:e.lockResolution,checkMarkPosition:"left",label:i.checkboxKeepResolution,onClick:e.changeLockResolution}))),nr.default.createElement(P.BarSeparator,null)),nr.default.createElement(P.Other.EmptyDiv,null))};var QB=O("transformTool","custom")(I(SV));const Tt=v(require("react"));let jb=class extends Tt.default.Component{render(){const e=this.props.active.tool;return Tt.default.createElement(P.Controlsbar,{show:!!e},Tt.default.createElement(D.Switch.Index,{type:e},Tt.default.createElement(D.Switch.Case,{value:w.FILTER},Tt.default.createElement(NB,null)),Tt.default.createElement(D.Switch.Case,{value:w.FOCUS},Tt.default.createElement(UB,null)),Tt.default.createElement(D.Switch.Case,{value:w.ADJUSTMENT},Tt.default.createElement(HB,null)),Tt.default.createElement(D.Switch.Case,{value:w.OVERLAY},Tt.default.createElement(jB,null)),Tt.default.createElement(D.Switch.Case,{value:w.STICKER},Tt.default.createElement($B,null)),Tt.default.createElement(D.Switch.Case,{value:w.TEXT},Tt.default.createElement(XB,null)),Tt.default.createElement(D.Switch.Case,{value:w.TEXT_DESIGN},Tt.default.createElement(YB,null)),Tt.default.createElement(D.Switch.Case,{value:w.LIBRARY},Tt.default.createElement(WB,null)),Tt.default.createElement(D.Switch.Case,{value:w.FRAME},Tt.default.createElement(JB,null)),Tt.default.createElement(D.Switch.Case,{value:w.BRUSH},Tt.default.createElement(ZB,null)),Tt.default.createElement(D.Switch.Case,{value:w.TRANSFORM},Tt.default.createElement(QB,null))))}};jb=u([O("active","config"),I],jb);var eM=jb;const Jo=v(require("react")),tM=v(require("styled-components")),TV=tM.default.div`
  position: absolute;
  width: 100%;
  height: ${e=>e.theme.measurements.basicToolControlBar.maxHeight}px;
  bottom: 0;
  left: 0;
  background: ${e=>e.theme.webcam.backdrop};
  z-index: ${e=>e.theme.measurements.zIndex.disable};
`;class kV extends Jo.default.Component{constructor(){super(...arguments);this.state={hasError:!1}}static getDerivedStateFromError(e){return console.error(e),{hasError:!0}}render(){return Jo.default.createElement(D.Container,{"data-test":hi.EditorContainer},this.props.active.isWebcam?Jo.default.createElement(TV,null):null,Jo.default.createElement(nh,null),Jo.default.createElement(fa,null,Jo.default.createElement(oh,null),Jo.default.createElement(rh,null),Jo.default.createElement(eM,null),Jo.default.createElement(zB,null),Jo.default.createElement(wB,null)))}}var iM=O("active","modal")(I(kV));const Ou=v(require("react")),rM=v(require("styled-components"));class OC extends Ou.default.Component{componentDidMount(){this.editor=this.props.editor,this.storeProps=this.props.storeProps;const e=new ru(this.editor.configStore.config.custom.components,{}),t={getDialog:e.getDialog,getButton:e.getButton,getColorItem:e.getColorItem,getCheckbox:e.getCheckbox};this.storeProps.custom=t,this.forceUpdate()}render(){return this.storeProps?Ou.default.createElement(Ol,y({},this.storeProps),Ou.default.createElement(rM.ThemeProvider,{theme:y(y({},this.editor.configStore.theme),{measurements:this.editor.configStore.measurements})},Ou.default.createElement(iM,null))):null}}const Wb=v(require("react")),Rw=v(require("react-dom"));class EV extends Tr{constructor(e,t){super();this.dispose=()=>{this.container&&(Rw.default.unmountComponentAtNode(this.container),this.removeAllListeners(Ie.EXPORT),this.removeAllListeners(Ie.HISTORY_CHANGE),this.removeAllListeners(Ie.EDITOR_READY),this.removeAllListeners(Ie.ERROR_IMAGE_LOADING))};this.serialize=e=>this.editor.serialize(e);this.deserialize=e=>this.editor.deserialize(e);this.export=e=>this.editor.export(e);this.close=()=>this.editor.close();this.setImage=e=>this.editor.setImage(e);this.container=t,this.editor=new It(y({},e)),this.editor.configStore.events.on(Ie.EXPORT,i=>{this.emit(Ie.EXPORT,i)}),this.editor.configStore.events.on(Ie.CLOSE,()=>{this.dispose(),this.emit(Ie.CLOSE)}),this.editor.configStore.events.on(Ie.HISTORY_CHANGE,()=>{this.emit(Ie.HISTORY_CHANGE)})}hasChanges(){return this.editor.hasChanges()}}class IV{constructor(){this.container=null}init(e){return new Promise((t,i)=>{this.container=typeof e.container=="string"?document.querySelector(e.container):e.container,this.container?(this.editorApi=new EV(e,this.container),Rw.default.render(Wb.default.createElement(DV,{editor:this.editorApi.editor}),this.container),this.editorApi.editor.configStore.events.on(Ie.EDITOR_READY,()=>{setTimeout(()=>{this.editorApi.emit(Ie.EDITOR_READY)},0),t(this.editorApi)}),this.editorApi.editor.configStore.events.on(Ie.ERROR_IMAGE_LOADING,r=>{setTimeout(()=>{this.editorApi.emit(Ie.ERROR_IMAGE_LOADING,r)},0),t(this.editorApi)})):i(new Error("Provide a container"))})}}class DV extends Wb.default.Component{constructor(){super(...arguments);this.UIComponent=null}componentDidMount(){this.editor=this.props.editor,this.storeProps={filterTool:this.editor.filterToolStore,focusTool:this.editor.focusToolStore,adjustmentsTool:this.editor.adjustmentsToolStore,overlayTool:this.editor.overlayToolStore,frameTool:this.editor.frameToolStore,brushTool:this.editor.brushToolStore,transformTool:this.editor.transformToolStore,scale:this.editor.scale,sprite:this.editor.spriteStore,stickerTool:this.editor.spriteStore.stickerToolStore,textTool:this.editor.spriteStore.textToolStore,textDesignTool:this.editor.spriteStore.textDesignToolStore,library:this.editor.libraryStore,modal:this.editor.modalStore,snapping:this.editor.snappingStore,config:this.editor.configStore,active:this.editor.activeStore,canvas:this.editor.canvasStore,history:this.editor.historyStore,editor:this.editor},this.editor.configStore.config.layout==="basic"?Promise.resolve().then(()=>v(Vy())).then(({BasicUI:e})=>{this.UIComponent=e,this.forceUpdate()}):Promise.resolve().then(()=>v(Yu())).then(({AdvancedUI:e})=>{this.UIComponent=e,this.forceUpdate()})}componentWillUnmount(){this.editor.engine.dispose(),this.editor.configStore.events.removeAllListeners(Ie.EXPORT),this.editor.configStore.events.removeAllListeners(Ie.CLOSE),this.editor.configStore.events.removeAllListeners(Ie.HISTORY_CHANGE),this.editor.configStore.events.removeAllListeners(Ie.EDITOR_READY),this.editor.configStore.events.removeAllListeners(Ie.ERROR_IMAGE_LOADING)}render(){if(this.editor){const e=this.UIComponent;return this.storeProps&&e?Wb.default.createElement(e,{editor:this.editor,storeProps:this.storeProps}):null}return null}}const Ky={init:e=>{const t=new IV;return t.init(e)}};const Aw=v(require("react"));class $y extends Aw.default.Component{constructor(e){super(e);this.ui=new Tr;this.serialize=e=>this.editor.serialize(e);this.deserialize=e=>this.editor.deserialize(e);this.export=e=>this.editor.export(e);this.close=()=>this.editor.close();this.setImage=e=>this.editor.setImage(e);this.editor=new It(y({},e)),this.editor.configStore.events.on(Ie.EXPORT,t=>{this.ui.emit(Ie.EXPORT,t)}),this.editor.configStore.events.on(Ie.CLOSE,()=>{this.componentWillUnmount(),this.ui.emit(Ie.CLOSE)}),this.editor.configStore.events.on(Ie.HISTORY_CHANGE,()=>{this.ui.emit(Ie.HISTORY_CHANGE)}),this.editor.configStore.events.on(Ie.EDITOR_READY,()=>{this.ui.emit(Ie.EDITOR_READY)}),this.editor.configStore.events.on(Ie.ERROR_IMAGE_LOADING,t=>{this.ui.emit(Ie.ERROR_IMAGE_LOADING,t)}),this.storeProps={filterTool:this.editor.filterToolStore,focusTool:this.editor.focusToolStore,adjustmentsTool:this.editor.adjustmentsToolStore,overlayTool:this.editor.overlayToolStore,frameTool:this.editor.frameToolStore,brushTool:this.editor.brushToolStore,transformTool:this.editor.transformToolStore,scale:this.editor.scale,sprite:this.editor.spriteStore,stickerTool:this.editor.spriteStore.stickerToolStore,textTool:this.editor.spriteStore.textToolStore,textDesignTool:this.editor.spriteStore.textDesignToolStore,library:this.editor.libraryStore,modal:this.editor.modalStore,snapping:this.editor.snappingStore,config:this.editor.configStore,active:this.editor.activeStore,canvas:this.editor.canvasStore,history:this.editor.historyStore,editor:this.editor},this.editor.configStore.config.layout==="basic"?Promise.resolve().then(()=>v(Vy())).then(({BasicUI:t})=>{this.UIComponent=t,this.forceUpdate()}):Promise.resolve().then(()=>v(Yu())).then(({AdvancedUI:t})=>{this.UIComponent=t,this.forceUpdate()})}componentWillUnmount(){this.ui.removeAllListeners(Ie.EXPORT),this.ui.removeAllListeners(Ie.HISTORY_CHANGE),this.ui.removeAllListeners(Ie.EDITOR_READY),this.ui.removeAllListeners(Ie.ERROR_IMAGE_LOADING)}hasChanges(){return this.editor.hasChanges()}render(){if(this.editor){const e=this.UIComponent;return this.storeProps&&e?Aw.default.createElement(e,{editor:this.editor,storeProps:this.storeProps}):null}return null}}const Hd=v(Yu()),oM=v(Ve());oM.configure({isolateGlobalState:!0});const{Input:OV,ColorItem:RC,ColorItemBase:AC,ColorItemBackground:FC,ColorItemTiledBackground:PC,ColorItemActiveOverlay:BC,Dialog:MC,DialogBase:LC,DialogContainer:zC,DialogBackdrop:NC,DialogHeader:UC,DialogBody:HC,DialogFooter:GC,DialogSpinner:jC}=D,{Label:WC,Checkbox:VC,CheckboxBase:KC,CheckboxInput:$C,CheckboxCheckMark:qC}=OV,XC=Hp,YC=Hp;return oS();})();
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Mller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
 * Native Promise Only
 * v0.8.0-a (c) Kyle Simpson
 * MIT License: http://getify.mit-license.org
 */
/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2019 img.ly GmbH <contact@img.ly>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/*! https://mths.be/punycode v1.3.2 by @mathias */
/**
 * Adapted from https://github.com/Grsmto/simplebar
 * MIT License (MIT) Copyright (c) 2015 Jonathan Nicol
 * @license
 */
/** @license mobx-react v5.4.4
 * index.module.js
 *
 * Copyright (c) 2015 Michel Weststrate.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
